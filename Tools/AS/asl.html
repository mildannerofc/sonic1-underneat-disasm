<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Flamewing&#39;s Enhanced AS</title>
  <style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}
.display.math{display: block; text-align: center; margin: 0.5rem auto;}

pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
  <style type="text/css">html {font-size: 100%;overflow-y: scroll;-webkit-text-size-adjust: 100%;-ms-text-size-adjust: 100%;}body {font-family: Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif;font-size: 12px;line-height: 1.7;padding: 1em;margin: auto;max-width: 95%;}a {text-decoration: none;}a:focus {outline: thin dotted;}p {margin: 1em 0;}img {max-width: 100%;}h1,h2,h3,h4,h5,h6 {line-height: 125%;margin-top: 2em;font-weight: normal;}h4,h5,h6 {font-weight: bold;}h1 {font-size: 2.5em;}h2 {font-size: 2em;}h3 {font-size: 1.5em;}h4 {font-size: 1.2em;}h5 {font-size: 1em;}h6 {font-size: 0.9em;}blockquote {margin: 0;padding-left: 3em;border-left-width: 0.5em;border-left-style: solid;}hr {display: block;height: 2px;border: 0;border-top-width: 1px;border-top-style: solid;border-bottom-width: 1px;border-bottom-style: solid;margin: 1em 0;padding: 0;}pre,code,kbd,samp {font-family: monospace, monospace;_font-family: 'courier new', monospace;font-size: 0.98em;}pre {white-space: pre;white-space: pre-wrap;word-wrap: break-word;}b,strong {font-weight: bold;}dfn {font-style: italic;}ins {text-decoration: none;}mark {font-style: italic;font-weight: bold;}sub,sup {font-size: 75%;line-height: 0;position: relative;vertical-align: baseline;}sup {top: -0.5em;}sub {bottom: -0.25em;}ul,ol {margin: 1em 0;padding: 0 0 0 2em;}li p:last-child {margin-bottom: 0;}ul ul,ol ol {margin: .3em 0;}dl {margin-bottom: 1em;}dt {font-weight: bold;margin-bottom: .8em;}dd {margin: 0 0 .8em 2em;}dd:last-child {margin-bottom: 0;}img {border: 0;-ms-interpolation-mode: bicubic;vertical-align: baseline;}figure {display: block;text-align: center;margin: 1em 0;}figure img {border: none;margin: 0 auto;}figcaption {font-size: 0.8em;font-style: italic;margin: 0 0 .8em;}table {margin-bottom: 2em;border-bottom-width: 1px;border-bottom-style: solid;border-right-width: 1px;border-right-style: solid;border-spacing: 0;border-collapse: collapse;}table th {padding: .2em 1em;border-top-width: 1px;border-top-style: solid;border-left-width: 1px;border-left-style: solid;}table td {padding: .2em 1em;border-top-width: 1px;border-top-style: solid;border-left-width: 1px;border-left-style: solid;vertical-align: baseline;}.author {font-size: 1.2em;text-align: center;}@media only screen and (min-width: 480px) {body {font-size: 14px;}}@media only screen and (min-width: 768px) {body {font-size: 16px;}}@media print {* {background: transparent !important;color: black !important;filter: none !important;-ms-filter: none !important;}body {font-size: 12pt;max-width: 100%;}a,a:visited {text-decoration: underline;}hr {height: 1px;border: 0;border-bottom: 1px solid black;}a[href]:after {content: " (" attr(href) ")";}abbr[title]:after {content: " (" attr(title) ")";}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after {content: "";}pre,blockquote {border: 1px solid #999999;padding-right: 1em;page-break-inside: avoid;}tr,img {page-break-inside: avoid;}img {max-width: 100% !important;}@page :left {margin: 15mm 20mm 15mm 10mm;}@page :right {margin: 15mm 10mm 15mm 20mm;}p,h2,h3 {orphans: 3;widows: 3;}h2,h3 {page-break-after: avoid;}}body {color: #444444;background: #fefefe;}a {color: #0645ad;}a:visited {color: #0b0080;}a:hover {color: #0066ee;}a:active {color: #faa700;}a:focus {outline: thin dotted;}*::-moz-selection {background: rgba(255, 255, 0, 0.3);color: #000000;}*::selection {background: rgba(255, 255, 0, 0.3);color: #000000;}a::-moz-selection {background: rgba(255, 255, 0, 0.3);color: #0645ad;}a::selection {background: rgba(255, 255, 0, 0.3);color: #0645ad;}h1,h2,h3,h4,h5,h6 {color: #111111;}blockquote {color: #666666;border-left-color: #cccccc;background: #eeeeee;}hr {border-top: 1px solid #aaaaaa;border-bottom-color: #eeeeee;}pre,code,kbd,samp {color: #000000;background-color: #eeeeee;}ins {background: #ffff99;color: #000000;}mark {background: #ffff00;color: #000000;}table {border-bottom-color: #dddddd;border-right-color: #dddddd;}table th {background-color: #eeeeee;border-top-color: #dddddd;border-left-color: #dddddd;}table td {border-top-color: #dddddd;border-left-color: #dddddd;}code {white-space: pre-wrap;}span.smallcaps {font-variant: small-caps;}span.underline {text-decoration: underline;}div.column {display: inline-block;vertical-align: baseline;width: 50%;}div.hanging-indent {margin-left: 1.5em;text-indent: -1.5em;}ul.task-list {list-style: none;}pre>code.sourceCode {white-space: pre;position: relative;}pre>code.sourceCode>span {display: inline-block;line-height: 1.25;}pre>code.sourceCode>span:empty {height: 1.2em;}.sourceCode {overflow: visible;}code.sourceCode>span {color: inherit;text-decoration: inherit;}div.sourceCode {margin: 1em 0;}pre.sourceCode {margin: 0;}@media screen {div.sourceCode {overflow: auto;}}@media print {pre>code.sourceCode {white-space: pre-wrap;}pre>code.sourceCode>span {text-indent: -5em;padding-left: 5em;}}pre.numberSource code {counter-reset: source-line 0;}pre.numberSource code>span {position: relative;left: -4em;counter-increment: source-line;}pre.numberSource code>span>a:first-child::before {content: counter(source-line);position: relative;left: -1em;text-align: right;vertical-align: baseline;border: none;display: inline-block;-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;padding: 0 4px;width: 4em;color: #aaaaaa;}pre.numberSource {margin-left: 3em;border-left: 1px solid #aaaaaa;padding-left: 4px;}div.sourceCode {background-color: #f8f8f8;}@media screen {pre>code.sourceCode>span>a:first-child::before {text-decoration: underline;}}code span.al {color: #ef2929;}code span.an {color: #8f5902;font-weight: bold;font-style: italic;}code span.at {color: #c4a000;}code span.bn {color: #0000cf;}code span.cf {color: #204a87;font-weight: bold;}code span.ch {color: #4e9a06;}code span.cn {color: #000000;}code span.co {color: #8f5902;font-style: italic;}code span.cv {color: #8f5902;font-weight: bold;font-style: italic;}code span.do {color: #8f5902;font-weight: bold;font-style: italic;}code span.dt {color: #204a87;}code span.dv {color: #0000cf;}code span.er {color: #a40000;font-weight: bold;}code span.fl {color: #0000cf;}code span.fu {color: #000000;}code span.in {color: #8f5902;font-weight: bold;font-style: italic;}code span.kw {color: #204a87;font-weight: bold;}code span.op {color: #ce5c00;font-weight: bold;}code span.ot {color: #8f5902;}code span.pp {color: #8f5902;font-style: italic;}code span.sc {color: #000000;}code span.ss {color: #4e9a06;}code span.st {color: #4e9a06;}code span.va {color: #000000;}code span.vs {color: #4e9a06;}code span.wa {color: #8f5902;font-weight: bold;font-style: italic;}.display.math {display: block;text-align: center;margin: 0.5rem auto;}@media screen and (prefers-color-scheme: dark) {body {color: #d1cbc7;background: #222425;}a {color: #75b6ea;}a:visited {color: #a075ea;}a:hover {color: #90c4ee;}a:active {color: #faa700;}a:focus {outline: thin dotted;}*::-moz-selection {background: rgba(162, 162, 0, 0.3);color: #d1cbc7;}*::selection {background: rgba(162, 162, 0, 0.3);color: #d1cbc7;}a::-moz-selection {background: rgba(162, 162, 0, 0.3);color: #75b6ea;}a::selection {background: rgba(162, 162, 0, 0.3);color: #75b6ea;}h1,h2,h3,h4,h5,h6 {color: #e0dad6;}blockquote {color: #c8c0bc;border-left-color: #7e6d67;background: #181a1b;}hr {border-top: 1px solid #666666;border-bottom-color: #181a1b;}pre,code,kbd,samp {color: #d1cbc7;background-color: #333536;}ins {background: #faa700;color: #d1cbc7;}mark {background: #faa700;color: #d1cbc7;}table {border-bottom-color: #83716b;border-right-color: #83716b;}table th {background-color: #333536;border-top-color: #83716b;border-left-color: #83716b;}table td {border-top-color: #83716b;border-left-color: #83716b;}code {white-space: pre-wrap;}span.smallcaps {font-variant: small-caps;}span.underline {text-decoration: underline;}div.column {display: inline-block;vertical-align: baseline;width: 50%;}div.hanging-indent {margin-left: 1.5em;text-indent: -1.5em;}ul.task-list {list-style: none;}pre>code.sourceCode {white-space: pre;position: relative;}pre>code.sourceCode>span {display: inline-block;line-height: 1.25;}pre>code.sourceCode>span:empty {height: 1.2em;}.sourceCode {overflow: visible;}code.sourceCode>span {color: inherit;text-decoration: inherit;}div.sourceCode {margin: 1em 0;}pre.sourceCode {margin: 0;}@media screen {div.sourceCode {overflow: auto;}}@media print {pre>code.sourceCode {white-space: pre-wrap;}pre>code.sourceCode>span {text-indent: -5em;padding-left: 5em;}}pre.numberSource code {counter-reset: source-line 0;}pre.numberSource code>span {position: relative;left: -4em;counter-increment: source-line;}pre.numberSource code>span>a:first-child::before {content: counter(source-line);position: relative;left: -1em;text-align: right;vertical-align: baseline;border: none;display: inline-block;-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;padding: 0 4px;width: 4em;background-color: #232629;color: #7a7c7d;}pre.numberSource {margin-left: 3em;border-left: 1px solid #7a7c7d;padding-left: 4px;}div.sourceCode {color: #cfcfc2;background-color: #232629;}@media screen {pre>code.sourceCode>span>a:first-child::before {text-decoration: underline;}}code span {color: #cfcfc2;}code span.al {color: #95da4c;background-color: #4d1f24;font-weight: bold;}code span.an {color: #3f8058;}code span.at {color: #2980b9;}code span.bn {color: #f67400;}code span.bu {color: #7f8c8d;}code span.cf {color: #fdbc4b;font-weight: bold;}code span.ch {color: #3daee9;}code span.cn {color: #27aeae;font-weight: bold;}code span.co {color: #7a7c7d;}code span.cv {color: #7f8c8d;}code span.do {color: #a43340;}code span.dt {color: #2980b9;}code span.dv {color: #f67400;}code span.er {color: #da4453;text-decoration: underline;}code span.ex {color: #0099ff;font-weight: bold;}code span.fl {color: #f67400;}code span.fu {color: #8e44ad;}code span.im {color: #27ae60;}code span.in {color: #c45b00;}code span.kw {color: #cfcfc2;font-weight: bold;}code span.op {color: #cfcfc2;}code span.ot {color: #27ae60;}code span.pp {color: #27ae60;}code span.re {color: #2980b9;background-color: #153042;}code span.sc {color: #3daee9;}code span.ss {color: #da4453;}code span.st {color: #f44f4f;}code span.va {color: #27aeae;}code span.vs {color: #da4453;}code span.wa {color: #da4453;}.display.math {display: block;text-align: center;margin: 0.5rem auto;}}</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Flamewing&#39;s Enhanced AS</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#flamewings-enhanced-as" id="toc-flamewings-enhanced-as">Flamewing&#39;s Enhanced AS</a></li>
<li><a href="#macro-assembler-as-v142" id="toc-macro-assembler-as-v142">Macro Assembler AS V1.42</a></li>
<li><a href="#users-manual" id="toc-users-manual">User&#39;s Manual</a></li>
<li><a href="#introduction" id="toc-introduction">Introduction</a>
<ul>
<li><a href="#license-agreement" id="toc-license-agreement">License Agreement</a></li>
<li><a href="#general-capabilities-of-the-assembler" id="toc-general-capabilities-of-the-assembler">General Capabilities of the Assembler</a></li>
<li><a href="#supported-platforms" id="toc-supported-platforms">Supported Platforms</a></li>
</ul></li>
<li><a href="#assembler-usage" id="toc-assembler-usage">Assembler Usage</a>
<ul>
<li><a href="#delivery" id="toc-delivery">Delivery</a></li>
<li><a href="#start-up-command-parameters" id="toc-start-up-command-parameters">Start-Up Command, Parameters</a></li>
<li><a href="#format-of-the-input-files" id="toc-format-of-the-input-files">Format of the Input Files</a></li>
<li><a href="#format-of-the-listing" id="toc-format-of-the-listing">Format of the Listing</a></li>
<li><a href="#symbol-conventions" id="toc-symbol-conventions">Symbol Conventions</a></li>
<li><a href="#temporary-symbols" id="toc-temporary-symbols">Temporary Symbols</a></li>
<li><a href="#named-temporary-symbols" id="toc-named-temporary-symbols">Named Temporary Symbols</a>
<ul>
<li><a href="#nameless-temporary-symbols" id="toc-nameless-temporary-symbols">Nameless Temporary Symbols</a></li>
<li><a href="#composed-temporary-symbols" id="toc-composed-temporary-symbols">Composed Temporary Symbols</a></li>
</ul></li>
<li><a href="#formula-expressions" id="toc-formula-expressions">Formula Expressions</a>
<ul>
<li><a href="#integer-constants" id="toc-integer-constants">Integer Constants</a></li>
<li><a href="#floating-point-constants" id="toc-floating-point-constants">Floating Point Constants</a></li>
<li><a href="#string-constants" id="toc-string-constants">String Constants</a></li>
<li><a href="#string-to-integer-conversion-and-character-constants" id="toc-string-to-integer-conversion-and-character-constants">String to Integer Conversion and Character Constants</a></li>
<li><a href="#evaluation" id="toc-evaluation">Evaluation</a></li>
<li><a href="#operators" id="toc-operators">Operators</a></li>
<li><a href="#functions" id="toc-functions">Functions</a></li>
</ul></li>
<li><a href="#forward-references-and-other-disasters" id="toc-forward-references-and-other-disasters">Forward References and Other Disasters</a></li>
<li><a href="#register-symbols" id="toc-register-symbols">Register Symbols</a></li>
<li><a href="#share-file" id="toc-share-file">Share File</a></li>
<li><a href="#processor-aliases" id="toc-processor-aliases">Processor Aliases</a></li>
</ul></li>
<li><a href="#pseudo-instructions" id="toc-pseudo-instructions">Pseudo Instructions</a>
<ul>
<li><a href="#definitions" id="toc-definitions">Definitions</a>
<ul>
<li><a href="#set-equ-and-constant" id="toc-set-equ-and-constant">SET, EQU, and CONSTANT</a></li>
<li><a href="#sfr-and-sfrb" id="toc-sfr-and-sfrb">SFR and SFRB</a></li>
<li><a href="#xsfr-and-ysfr" id="toc-xsfr-and-ysfr">XSFR and YSFR</a></li>
<li><a href="#label" id="toc-label">LABEL</a></li>
<li><a href="#bit" id="toc-bit">BIT</a></li>
<li><a href="#dbit" id="toc-dbit">DBIT</a></li>
<li><a href="#defbit-and-defbitb" id="toc-defbit-and-defbitb">DEFBIT and DEFBITB</a>
<ul>
<li><a href="#s12z" id="toc-s12z">S12Z</a></li>
<li><a href="#super8" id="toc-super8">Super8</a></li>
<li><a href="#z8000" id="toc-z8000">Z8000</a></li>
</ul></li>
<li><a href="#defbitfield" id="toc-defbitfield">DEFBITFIELD</a></li>
<li><a href="#port" id="toc-port">PORT</a></li>
<li><a href="#reg-and-namereg" id="toc-reg-and-namereg">REG and NAMEREG</a></li>
<li><a href="#liv-and-riv" id="toc-liv-and-riv">LIV and RIV</a></li>
<li><a href="#charset" id="toc-charset">CHARSET</a></li>
<li><a href="#codepage" id="toc-codepage">CODEPAGE</a></li>
<li><a href="#enum-nextenum-and-enumconf" id="toc-enum-nextenum-and-enumconf">ENUM, NEXTENUM, and ENUMCONF</a></li>
<li><a href="#pushv-and-popv" id="toc-pushv-and-popv">PUSHV and POPV</a></li>
</ul></li>
<li><a href="#code-modification" id="toc-code-modification">Code Modification</a>
<ul>
<li><a href="#org" id="toc-org">ORG</a></li>
<li><a href="#rorg" id="toc-rorg">RORG</a></li>
<li><a href="#cpu" id="toc-cpu">CPU</a></li>
<li><a href="#supmode-fpu-pmmu-custom" id="toc-supmode-fpu-pmmu-custom">SUPMODE, FPU, PMMU, CUSTOM</a></li>
<li><a href="#fullpmmu" id="toc-fullpmmu">FULLPMMU</a></li>
<li><a href="#padding" id="toc-padding">PADDING</a></li>
<li><a href="#packing" id="toc-packing">PACKING</a></li>
<li><a href="#maxmode" id="toc-maxmode">MAXMODE</a></li>
<li><a href="#extmode-and-lwordmode" id="toc-extmode-and-lwordmode">EXTMODE and LWORDMODE</a></li>
<li><a href="#srcmode" id="toc-srcmode">SRCMODE</a></li>
<li><a href="#bigendian" id="toc-bigendian">BIGENDIAN</a></li>
<li><a href="#wrapmode" id="toc-wrapmode">WRAPMODE</a></li>
<li><a href="#segment" id="toc-segment">SEGMENT</a></li>
<li><a href="#phase-and-dephase" id="toc-phase-and-dephase">PHASE and DEPHASE</a></li>
<li><a href="#save-and-restore" id="toc-save-and-restore">SAVE and RESTORE</a></li>
<li><a href="#assume" id="toc-assume">ASSUME</a>
<ul>
<li><a href="#65ce02" id="toc-65ce02">65CE02</a></li>
<li><a href="#6809" id="toc-6809">6809</a></li>
<li><a href="#68hc11k4" id="toc-68hc11k4">68HC11K4</a></li>
<li><a href="#68hc12x" id="toc-68hc12x">68HC12X</a></li>
<li><a href="#68hc16" id="toc-68hc16">68HC16</a></li>
<li><a href="#h8500" id="toc-h8500">H8/500</a></li>
<li><a href="#melps740" id="toc-melps740">MELPS740</a></li>
<li><a href="#melps770065816" id="toc-melps770065816">MELPS7700/65816</a></li>
<li><a href="#mcs-196296" id="toc-mcs-196296">MCS-196/296</a></li>
<li><a href="#8086" id="toc-8086">8086</a></li>
<li><a href="#xa" id="toc-xa">XA</a></li>
<li><a href="#29k" id="toc-29k">29K</a></li>
<li><a href="#80c166167" id="toc-80c166167">80C166/167</a></li>
<li><a href="#tlcs-47" id="toc-tlcs-47">TLCS-47</a></li>
<li><a href="#st6" id="toc-st6">ST6</a></li>
<li><a href="#st9" id="toc-st9">ST9</a></li>
<li><a href="#78k2" id="toc-78k2">78K2</a></li>
<li><a href="#78k3" id="toc-78k3">78K3</a></li>
<li><a href="#78k4" id="toc-78k4">78K4</a></li>
<li><a href="#320c3xc4x" id="toc-320c3xc4x">320C3x/C4x</a></li>
<li><a href="#μpd78c10" id="toc-μpd78c10">μPD78(C)10</a></li>
<li><a href="#75k0" id="toc-75k0">75K0</a></li>
<li><a href="#f2mc16l" id="toc-f2mc16l">F<sup>2</sup>MC16L</a></li>
<li><a href="#mn1613" id="toc-mn1613">MN1613</a></li>
</ul></li>
<li><a href="#ckpt" id="toc-ckpt">CKPT</a></li>
<li><a href="#emulated" id="toc-emulated">EMULATED</a></li>
<li><a href="#branchext" id="toc-branchext">BRANCHEXT</a></li>
<li><a href="#z80syntax" id="toc-z80syntax">Z80SYNTAX</a></li>
<li><a href="#expect-and-endexpect" id="toc-expect-and-endexpect">EXPECT and ENDEXPECT</a></li>
</ul></li>
<li><a href="#data-definitions" id="toc-data-definitions">Data Definitions</a>
<ul>
<li><a href="#dcsize" id="toc-dcsize">DC[.Size]</a></li>
<li><a href="#dssize" id="toc-dssize">DS[.Size]</a></li>
<li><a href="#dndbdwdddq-and-dt" id="toc-dndbdwdddq-and-dt">DN,DB,DW,DD,DQ, and DT</a></li>
<li><a href="#ds-ds8" id="toc-ds-ds8">DS, DS8</a></li>
<li><a href="#byt-or-fcb" id="toc-byt-or-fcb">BYT or FCB</a></li>
<li><a href="#byte" id="toc-byte">BYTE</a></li>
<li><a href="#dc8" id="toc-dc8">DC8</a></li>
<li><a href="#adr-or-fdb" id="toc-adr-or-fdb">ADR or FDB</a></li>
<li><a href="#word" id="toc-word">WORD</a></li>
<li><a href="#dw16" id="toc-dw16">DW16</a></li>
<li><a href="#long" id="toc-long">LONG</a></li>
<li><a href="#single-double-and-extended" id="toc-single-double-and-extended">SINGLE, DOUBLE, and EXTENDED</a></li>
<li><a href="#float-and-double" id="toc-float-and-double">FLOAT and DOUBLE</a></li>
<li><a href="#single-and-double" id="toc-single-and-double">SINGLE and DOUBLE</a></li>
<li><a href="#efloat-bfloat-and-tfloat" id="toc-efloat-bfloat-and-tfloat">EFLOAT, BFLOAT, and TFLOAT</a></li>
<li><a href="#qxx-and-lqxx" id="toc-qxx-and-lqxx">Qxx and LQxx</a></li>
<li><a href="#data" id="toc-data">DATA</a></li>
<li><a href="#zero-cp-1600" id="toc-zero-cp-1600">ZERO, CP-1600</a></li>
<li><a href="#fb-and-fw" id="toc-fb-and-fw">FB and FW</a></li>
<li><a href="#ascii-and-asciz" id="toc-ascii-and-asciz">ASCII and ASCIZ</a></li>
<li><a href="#string-and-rstring" id="toc-string-and-rstring">STRING and RSTRING</a></li>
<li><a href="#fcc" id="toc-fcc">FCC</a></li>
<li><a href="#text" id="toc-text">TEXT</a></li>
<li><a href="#dfs-or-rmb" id="toc-dfs-or-rmb">DFS or RMB</a></li>
<li><a href="#block" id="toc-block">BLOCK</a></li>
<li><a href="#space" id="toc-space">SPACE</a></li>
<li><a href="#res" id="toc-res">RES</a></li>
<li><a href="#bss" id="toc-bss">BSS</a></li>
<li><a href="#dsb-and-dsw" id="toc-dsb-and-dsw">DSB and DSW</a></li>
<li><a href="#ds16" id="toc-ds16">DS16</a></li>
<li><a href="#align" id="toc-align">ALIGN</a></li>
<li><a href="#ltorg" id="toc-ltorg">LTORG</a></li>
</ul></li>
<li><a href="#macro-instructions" id="toc-macro-instructions">Macro Instructions</a>
<ul>
<li><a href="#macro" id="toc-macro">MACRO</a>
<ul>
<li><a href="#macro-expansion-in-the-listing" id="toc-macro-expansion-in-the-listing">Macro Expansion in the Listing</a></li>
</ul></li>
<li><a href="#irp" id="toc-irp">IRP</a></li>
<li><a href="#irpn" id="toc-irpn">IRPN</a></li>
<li><a href="#irpc" id="toc-irpc">IRPC</a></li>
<li><a href="#rept" id="toc-rept">REPT</a></li>
<li><a href="#while" id="toc-while">WHILE</a></li>
<li><a href="#exitm" id="toc-exitm">EXITM</a></li>
<li><a href="#shift" id="toc-shift">SHIFT</a></li>
<li><a href="#maxnest" id="toc-maxnest">MAXNEST</a></li>
<li><a href="#function" id="toc-function">FUNCTION</a></li>
</ul></li>
<li><a href="#structures" id="toc-structures">Structures</a>
<ul>
<li><a href="#definition" id="toc-definition">Definition</a></li>
<li><a href="#usage" id="toc-usage">Usage</a></li>
<li><a href="#nested-structures" id="toc-nested-structures">Nested Structures</a></li>
<li><a href="#unions" id="toc-unions">Unions</a></li>
<li><a href="#nameless-structures" id="toc-nameless-structures">Nameless Structures</a></li>
<li><a href="#structures-and-sections" id="toc-structures-and-sections">Structures and Sections</a></li>
<li><a href="#structures-and-macros" id="toc-structures-and-macros">Structures and Macros</a></li>
</ul></li>
<li><a href="#conditional-assembly" id="toc-conditional-assembly">Conditional Assembly</a>
<ul>
<li><a href="#if--elseif--endif" id="toc-if--elseif--endif">IF / ELSEIF / ENDIF</a></li>
<li><a href="#switch--case--elsecase--endcase" id="toc-switch--case--elsecase--endcase">SWITCH / CASE / ELSECASE / ENDCASE</a></li>
</ul></li>
<li><a href="#listing-control" id="toc-listing-control">Listing Control</a>
<ul>
<li><a href="#page" id="toc-page">PAGE</a></li>
<li><a href="#newpage" id="toc-newpage">NEWPAGE</a></li>
<li><a href="#macexp_dft-and-macexp_ovr" id="toc-macexp_dft-and-macexp_ovr">MACEXP_DFT and MACEXP_OVR</a></li>
<li><a href="#listing" id="toc-listing">LISTING</a></li>
<li><a href="#prtinit-and-prtexit" id="toc-prtinit-and-prtexit">PRTINIT and PRTEXIT</a></li>
<li><a href="#title" id="toc-title">TITLE</a></li>
<li><a href="#radix" id="toc-radix">RADIX</a></li>
<li><a href="#outradix" id="toc-outradix">OUTRADIX</a></li>
</ul></li>
<li><a href="#local-symbols" id="toc-local-symbols">Local Symbols</a>
<ul>
<li><a href="#basic-definition-sectionendsection" id="toc-basic-definition-sectionendsection">Basic Definition (SECTION/ENDSECTION)</a></li>
<li><a href="#nesting-and-scope-rules" id="toc-nesting-and-scope-rules">Nesting and Scope Rules</a></li>
<li><a href="#public-and-global" id="toc-public-and-global">PUBLIC and GLOBAL</a></li>
<li><a href="#forward" id="toc-forward">FORWARD</a></li>
<li><a href="#performance-aspects" id="toc-performance-aspects">Performance Aspects</a></li>
</ul></li>
<li><a href="#miscellaneous" id="toc-miscellaneous">Miscellaneous</a>
<ul>
<li><a href="#shared" id="toc-shared">SHARED</a></li>
<li><a href="#include" id="toc-include">INCLUDE</a></li>
<li><a href="#binclude" id="toc-binclude">BINCLUDE</a></li>
<li><a href="#message-warning-error-and-fatal" id="toc-message-warning-error-and-fatal">MESSAGE, WARNING, ERROR, and FATAL</a></li>
<li><a href="#read" id="toc-read">READ</a></li>
<li><a href="#intsyntax" id="toc-intsyntax">INTSYNTAX</a></li>
<li><a href="#relaxed" id="toc-relaxed">RELAXED</a></li>
<li><a href="#compmode" id="toc-compmode">COMPMODE</a></li>
<li><a href="#end" id="toc-end">END</a></li>
</ul></li>
</ul></li>
<li><a href="#processor-specific-hints" id="toc-processor-specific-hints">Processor-specific Hints</a>
<ul>
<li><a href="#6811" id="toc-6811">6811</a></li>
<li><a href="#powerpc" id="toc-powerpc">PowerPC</a></li>
<li><a href="#dsp56xxx" id="toc-dsp56xxx">DSP56xxx</a></li>
<li><a href="#h8300" id="toc-h8300">H8/300</a></li>
<li><a href="#h8500-1" id="toc-h8500-1">H8/500</a></li>
<li><a href="#sh700076007700" id="toc-sh700076007700">SH7000/7600/7700</a></li>
<li><a href="#hmcs400" id="toc-hmcs400">HMCS400</a></li>
<li><a href="#h16" id="toc-h16">H16</a></li>
<li><a href="#olms-40" id="toc-olms-40">OLMS-40</a></li>
<li><a href="#olms-50" id="toc-olms-50">OLMS-50</a></li>
<li><a href="#melps-4500" id="toc-melps-4500">MELPS-4500</a></li>
<li><a href="#6502undoc" id="toc-6502undoc">6502UNDOC</a></li>
<li><a href="#melps-740" id="toc-melps-740">MELPS-740</a></li>
<li><a href="#melps-770065816" id="toc-melps-770065816">MELPS-7700/65816</a></li>
<li><a href="#m16" id="toc-m16">M16</a></li>
<li><a href="#40044040" id="toc-40044040">4004/4040</a></li>
<li><a href="#mcs-48" id="toc-mcs-48">MCS-48</a></li>
<li><a href="#mcs-51" id="toc-mcs-51">MCS-51</a></li>
<li><a href="#mcs-251" id="toc-mcs-251">MCS-251</a></li>
<li><a href="#80808085" id="toc-80808085">8080/8085</a></li>
<li><a href="#8085undoc" id="toc-8085undoc">8085UNDOC</a></li>
<li><a href="#8086v35" id="toc-8086v35">8086...V35</a></li>
<li><a href="#8x30x" id="toc-8x30x">8X30x</a></li>
<li><a href="#xa-1" id="toc-xa-1">XA</a></li>
<li><a href="#avr" id="toc-avr">AVR</a></li>
<li><a href="#z80undoc" id="toc-z80undoc">Z80UNDOC</a></li>
<li><a href="#z380" id="toc-z380">Z380</a></li>
<li><a href="#z8-super8-and-ez8" id="toc-z8-super8-and-ez8">Z8, Super8, and eZ8</a></li>
<li><a href="#z8000-1" id="toc-z8000-1">Z8000</a>
<ul>
<li><a href="#conditions" id="toc-conditions">Conditions</a></li>
<li><a href="#flags" id="toc-flags">Flags</a></li>
<li><a href="#indirect-addressing" id="toc-indirect-addressing">Indirect Addressing</a></li>
<li><a href="#direct-versus-immediate-addressing" id="toc-direct-versus-immediate-addressing">Direct versus Immediate Addressing</a></li>
</ul></li>
<li><a href="#tlcs-900l" id="toc-tlcs-900l">TLCS-900(L)</a>
<ul>
<li><a href="#symbol-conventions-1" id="toc-symbol-conventions-1">Symbol Conventions</a></li>
<li><a href="#syntax" id="toc-syntax">Syntax</a></li>
<li><a href="#macro-processor" id="toc-macro-processor">Macro Processor</a></li>
<li><a href="#output-format" id="toc-output-format">Output Format</a></li>
<li><a href="#pseudo-instructions-1" id="toc-pseudo-instructions-1">Pseudo Instructions</a></li>
</ul></li>
<li><a href="#tlcs-90" id="toc-tlcs-90">TLCS-90</a></li>
<li><a href="#tlcs-870" id="toc-tlcs-870">TLCS-870</a></li>
<li><a href="#tlcs-47-1" id="toc-tlcs-47-1">TLCS-47</a></li>
<li><a href="#tlcs-9000" id="toc-tlcs-9000">TLCS-9000</a></li>
<li><a href="#tc9331" id="toc-tc9331">TC9331</a></li>
<li><a href="#29xxx" id="toc-29xxx">29xxx</a></li>
<li><a href="#80c16x" id="toc-80c16x">80C16x</a></li>
<li><a href="#pic16c5x16c8x" id="toc-pic16c5x16c8x">PIC16C5x/16C8x</a></li>
<li><a href="#pic-17c4x" id="toc-pic-17c4x">PIC 17C4x</a></li>
<li><a href="#sx2028" id="toc-sx2028">SX20/28</a></li>
<li><a href="#st6-1" id="toc-st6-1">ST6</a></li>
<li><a href="#st7" id="toc-st7">ST7</a></li>
<li><a href="#st9-1" id="toc-st9-1">ST9</a></li>
<li><a href="#6804" id="toc-6804">6804</a></li>
<li><a href="#tms3201x" id="toc-tms3201x">TMS3201x</a></li>
<li><a href="#tms320c2x" id="toc-tms320c2x">TMS320C2x</a></li>
<li><a href="#tms320c3xc4x" id="toc-tms320c3xc4x">TMS320C3x/C4x</a></li>
<li><a href="#tms9900" id="toc-tms9900">TMS9900</a></li>
<li><a href="#tms70cxx" id="toc-tms70cxx">TMS70Cxx</a></li>
<li><a href="#tms370xxx" id="toc-tms370xxx">TMS370xxx</a></li>
<li><a href="#msp430x" id="toc-msp430x">MSP430(X)</a></li>
<li><a href="#tms1000" id="toc-tms1000">TMS1000</a></li>
<li><a href="#cop8--scmp" id="toc-cop8--scmp">COP8 &amp; SC/MP</a></li>
<li><a href="#sc144xxx" id="toc-sc144xxx">SC144xxx</a></li>
<li><a href="#ns32xxx" id="toc-ns32xxx">NS32xxx</a></li>
<li><a href="#μpd78c1x" id="toc-μpd78c1x">μPD78(C)1x</a></li>
<li><a href="#75k0-1" id="toc-75k0-1">75K0</a></li>
<li><a href="#78k0" id="toc-78k0">78K0</a></li>
<li><a href="#78k278k378k4" id="toc-78k278k378k4">78K2/78K3/78K4</a></li>
<li><a href="#μpd772x" id="toc-μpd772x">μPD772x</a></li>
<li><a href="#f2mc16l-1" id="toc-f2mc16l-1">F<sup>2</sup>MC16L</a></li>
<li><a href="#mn161x" id="toc-mn161x">MN161x</a></li>
<li><a href="#cdp180x" id="toc-cdp180x">CDP180x</a></li>
<li><a href="#kenbak" id="toc-kenbak">KENBAK</a></li>
</ul></li>
<li><a href="#file-formats" id="toc-file-formats">File Formats</a>
<ul>
<li><a href="#code-files" id="toc-code-files">Code Files</a></li>
<li><a href="#debug-files" id="toc-debug-files">Debug Files</a></li>
</ul></li>
<li><a href="#utility-programs" id="toc-utility-programs">Utility Programs</a>
<ul>
<li><a href="#plist" id="toc-plist">PLIST</a></li>
<li><a href="#bind" id="toc-bind">BIND</a></li>
<li><a href="#p2hex" id="toc-p2hex">P2HEX</a></li>
<li><a href="#p2bin" id="toc-p2bin">P2BIN</a></li>
<li><a href="#as2msg" id="toc-as2msg">AS2MSG</a></li>
</ul></li>
<li><a href="#error-messages" id="toc-error-messages">Error Messages</a></li>
<li><a href="#io-error-messages" id="toc-io-error-messages">I/O Error Messages</a></li>
<li><a href="#pseudo-instructions-and-integer-syntax" id="toc-pseudo-instructions-and-integer-syntax">Pseudo-Instructions and Integer Syntax</a>
<ul>
<li><a href="#instructions-that-are-always-available" id="toc-instructions-that-are-always-available">Instructions that are always available</a></li>
<li><a href="#motorola-680x0mcf5xxx" id="toc-motorola-680x0mcf5xxx">Motorola 680x0/MCF5xxx</a></li>
<li><a href="#motorola-56xxx" id="toc-motorola-56xxx">Motorola 56xxx</a></li>
<li><a href="#powerpc-1" id="toc-powerpc-1">PowerPC</a></li>
<li><a href="#motorola-m-core" id="toc-motorola-m-core">Motorola M-Core</a></li>
<li><a href="#motorola-xgate" id="toc-motorola-xgate">Motorola XGATE</a></li>
<li><a href="#motorola-68xxhitachi-63xx" id="toc-motorola-68xxhitachi-63xx">Motorola 68xx/Hitachi 63xx</a></li>
<li><a href="#motorolafreescale-680568hcs08" id="toc-motorolafreescale-680568hcs08">Motorola/Freescale 6805/68HC(S)08</a></li>
<li><a href="#motorola-6809hitachi-6309" id="toc-motorola-6809hitachi-6309">Motorola 6809/Hitachi 6309</a></li>
<li><a href="#motorola-68hc12" id="toc-motorola-68hc12">Motorola 68HC12</a></li>
<li><a href="#nxp-s12z" id="toc-nxp-s12z">NXP S12Z</a></li>
<li><a href="#motorola-68hc16" id="toc-motorola-68hc16">Motorola 68HC16</a></li>
<li><a href="#freescale-68rs08" id="toc-freescale-68rs08">Freescale 68RS08</a></li>
<li><a href="#hitachi-h8300lh" id="toc-hitachi-h8300lh">Hitachi H8/300(L/H)</a></li>
<li><a href="#hitachi-h8500" id="toc-hitachi-h8500">Hitachi H8/500</a></li>
<li><a href="#hitachi-sh7x00" id="toc-hitachi-sh7x00">Hitachi SH7x00</a></li>
<li><a href="#hitachi-hmcs400" id="toc-hitachi-hmcs400">Hitachi HMCS400</a></li>
<li><a href="#hitachi-h16" id="toc-hitachi-h16">Hitachi H16</a></li>
<li><a href="#65xxmelps-740" id="toc-65xxmelps-740">65xx/MELPS-740</a></li>
<li><a href="#65816melps-7700" id="toc-65816melps-7700">65816/MELPS-7700</a></li>
<li><a href="#mitsubishi-melps-4500" id="toc-mitsubishi-melps-4500">Mitsubishi MELPS-4500</a></li>
<li><a href="#mitsubishi-m16" id="toc-mitsubishi-m16">Mitsubishi M16</a></li>
<li><a href="#mitsubishi-m16c" id="toc-mitsubishi-m16c">Mitsubishi M16C</a></li>
<li><a href="#intel-4004" id="toc-intel-4004">Intel 4004</a></li>
<li><a href="#intel-8008" id="toc-intel-8008">Intel 8008</a></li>
<li><a href="#intel-mcs-48" id="toc-intel-mcs-48">Intel MCS-48</a></li>
<li><a href="#intel-mcs-251" id="toc-intel-mcs-251">Intel MCS-(2)51</a></li>
<li><a href="#intel-mcs-96" id="toc-intel-mcs-96">Intel MCS-96</a></li>
<li><a href="#intel-80808085" id="toc-intel-80808085">Intel 8080/8085</a></li>
<li><a href="#intel-808680186nec-v3035" id="toc-intel-808680186nec-v3035">Intel 8086/80186/NEC V30/35</a></li>
<li><a href="#intel-i960" id="toc-intel-i960">Intel i960</a></li>
<li><a href="#signetics-8x30x" id="toc-signetics-8x30x">Signetics 8X30x</a></li>
<li><a href="#signetics-2650" id="toc-signetics-2650">Signetics 2650</a></li>
<li><a href="#philips-xa" id="toc-philips-xa">Philips XA</a></li>
<li><a href="#atmel-avr" id="toc-atmel-avr">Atmel AVR</a></li>
<li><a href="#amd-29k" id="toc-amd-29k">AMD 29K</a></li>
<li><a href="#siemens-80c166167" id="toc-siemens-80c166167">Siemens 80C166/167</a></li>
<li><a href="#zilog-zx80" id="toc-zilog-zx80">Zilog Zx80</a></li>
<li><a href="#zilog-z8" id="toc-zilog-z8">Zilog Z8</a></li>
<li><a href="#zilog-z8000" id="toc-zilog-z8000">Zilog Z8000</a></li>
<li><a href="#xilinx-kcpsm" id="toc-xilinx-kcpsm">Xilinx KCPSM</a></li>
<li><a href="#xilinx-kcpsm3" id="toc-xilinx-kcpsm3">Xilinx KCPSM3</a></li>
<li><a href="#latticemico8" id="toc-latticemico8">LatticeMico8</a></li>
<li><a href="#toshiba-tlcs-900" id="toc-toshiba-tlcs-900">Toshiba TLCS-900</a></li>
<li><a href="#toshiba-tlcs-90" id="toc-toshiba-tlcs-90">Toshiba TLCS-90</a></li>
<li><a href="#toshiba-tlcs-870c" id="toc-toshiba-tlcs-870c">Toshiba TLCS-870(/C)</a></li>
<li><a href="#toshiba-tlcs-470a" id="toc-toshiba-tlcs-470a">Toshiba TLCS-47(0(A))</a></li>
<li><a href="#toshiba-tlcs-9000" id="toc-toshiba-tlcs-9000">Toshiba TLCS-9000</a></li>
<li><a href="#toshiba-tc9331" id="toc-toshiba-tc9331">Toshiba TC9331</a></li>
<li><a href="#microchip-pic16c5x" id="toc-microchip-pic16c5x">Microchip PIC16C5x</a></li>
<li><a href="#microchip-pic16c8x" id="toc-microchip-pic16c8x">Microchip PIC16C8x</a></li>
<li><a href="#microchip-pic17c42" id="toc-microchip-pic17c42">Microchip PIC17C42</a></li>
<li><a href="#parallax-sx20" id="toc-parallax-sx20">Parallax SX20</a></li>
<li><a href="#sgs-thomson-st6" id="toc-sgs-thomson-st6">SGS-Thomson ST6</a></li>
<li><a href="#sgs-thomson-st7stm8" id="toc-sgs-thomson-st7stm8">SGS-Thomson ST7/STM8</a></li>
<li><a href="#sgs-thomson-st9" id="toc-sgs-thomson-st9">SGS-Thomson ST9</a></li>
<li><a href="#6804-1" id="toc-6804-1">6804</a></li>
<li><a href="#texas-instruments-tms3201x" id="toc-texas-instruments-tms3201x">Texas Instruments TMS3201x</a></li>
<li><a href="#texas-instruments-tms32c02x" id="toc-texas-instruments-tms32c02x">Texas Instruments TMS32C02x</a></li>
<li><a href="#texas-instruments-tms320c3xc4x" id="toc-texas-instruments-tms320c3xc4x">Texas Instruments TMS320C3x/C4x</a></li>
<li><a href="#texas-instruments-tm32c020xtm32c05xtm32c054x" id="toc-texas-instruments-tm32c020xtm32c05xtm32c054x">Texas Instruments TM32C020x/TM32C05x/TM32C054x</a></li>
<li><a href="#texas-instruments-tms320c6x" id="toc-texas-instruments-tms320c6x">Texas Instruments TMS320C6x</a></li>
<li><a href="#texas-instruments-tms99xx" id="toc-texas-instruments-tms99xx">Texas Instruments TMS99xx</a></li>
<li><a href="#texas-instruments-instruments-tms1000" id="toc-texas-instruments-instruments-tms1000">Texas Instruments Instruments TMS1000</a></li>
<li><a href="#texas-instruments-tms70cxx" id="toc-texas-instruments-tms70cxx">Texas Instruments TMS70Cxx</a></li>
<li><a href="#texas-instruments-tms370" id="toc-texas-instruments-tms370">Texas Instruments TMS370</a></li>
<li><a href="#texas-instruments-msp430" id="toc-texas-instruments-msp430">Texas Instruments MSP430</a></li>
<li><a href="#national-scmp" id="toc-national-scmp">National SC/MP</a></li>
<li><a href="#national-ins807x" id="toc-national-ins807x">National INS807x</a></li>
<li><a href="#national-cop4" id="toc-national-cop4">National COP4</a></li>
<li><a href="#national-cop8" id="toc-national-cop8">National COP8</a></li>
<li><a href="#national-sc14xxx" id="toc-national-sc14xxx">National SC14xxx</a></li>
<li><a href="#national-ns32xxx" id="toc-national-ns32xxx">National NS32xxx</a></li>
<li><a href="#fairchild-ace" id="toc-fairchild-ace">Fairchild ACE</a></li>
<li><a href="#fairchild-f8" id="toc-fairchild-f8">Fairchild F8</a></li>
<li><a href="#nec-μpd78c1x" id="toc-nec-μpd78c1x">NEC μPD78(C)1x</a></li>
<li><a href="#nec-75xx" id="toc-nec-75xx">NEC 75xx</a></li>
<li><a href="#nec-75k0" id="toc-nec-75k0">NEC 75K0</a></li>
<li><a href="#nec-78k0" id="toc-nec-78k0">NEC 78K0</a></li>
<li><a href="#nec-78k2" id="toc-nec-78k2">NEC 78K2</a></li>
<li><a href="#nec-78k3" id="toc-nec-78k3">NEC 78K3</a></li>
<li><a href="#nec-78k4" id="toc-nec-78k4">NEC 78K4</a></li>
<li><a href="#nec-μpd772x" id="toc-nec-μpd772x">NEC μPD772x</a></li>
<li><a href="#nec-μpd77230" id="toc-nec-μpd77230">NEC μPD77230</a></li>
<li><a href="#symbios-logic-sym53c8xx" id="toc-symbios-logic-sym53c8xx">Symbios Logic SYM53C8xx</a></li>
<li><a href="#fujitsu-f2mc8l" id="toc-fujitsu-f2mc8l">Fujitsu F<sup>2</sup>MC8L</a></li>
<li><a href="#fujitsu-f2mc16l" id="toc-fujitsu-f2mc16l">Fujitsu F<sup>2</sup>MC16L</a></li>
<li><a href="#oki-olms-40" id="toc-oki-olms-40">OKI OLMS-40</a></li>
<li><a href="#oki-olms-50" id="toc-oki-olms-50">OKI OLMS-50</a></li>
<li><a href="#panafacom-mn161x" id="toc-panafacom-mn161x">Panafacom MN161x</a></li>
<li><a href="#padauk-pmcpmspfsxxx" id="toc-padauk-pmcpmspfsxxx">Padauk PMC/PMS/PFSxxx</a></li>
<li><a href="#intersil-180x" id="toc-intersil-180x">Intersil 180x</a></li>
<li><a href="#xmos-xs1" id="toc-xmos-xs1">XMOS XS1</a></li>
<li><a href="#atari-vector" id="toc-atari-vector">ATARI Vector</a></li>
<li><a href="#mil-std-1750" id="toc-mil-std-1750">MIL STD 1750</a></li>
<li><a href="#kenbak-1" id="toc-kenbak-1">KENBAK</a></li>
<li><a href="#cp1600" id="toc-cp1600">CP1600</a></li>
</ul></li>
<li><a href="#predefined-symbols" id="toc-predefined-symbols">Predefined Symbols</a></li>
<li><a href="#shipped-include-files" id="toc-shipped-include-files">Shipped Include Files</a>
<ul>
<li><a href="#bitfuncsinc" id="toc-bitfuncsinc">BITFUNCS.INC</a></li>
<li><a href="#ctypeinc" id="toc-ctypeinc">CTYPE.INC</a></li>
</ul></li>
<li><a href="#acknowledgments" id="toc-acknowledgments">Acknowledgments</a></li>
<li><a href="#frequently-asked-questions" id="toc-frequently-asked-questions">Frequently Asked Questions</a>
<ul>
<li><a href="#editors-note-this-is-alfred-arnolds-faq-section-mostly-unedited-preserved-for-historical-reasons" id="toc-editors-note-this-is-alfred-arnolds-faq-section-mostly-unedited-preserved-for-historical-reasons"><strong>EDITOR&#39;s NOTE:</strong> This is Alfred Arnold&#39;s FAQ section, mostly unedited, preserved for historical reasons</a></li>
</ul></li>
<li><a href="#hints-for-the-as-source-code" id="toc-hints-for-the-as-source-code">Hints for the AS Source Code</a>
<ul>
<li><a href="#editors-notes" id="toc-editors-notes"><strong>EDITOR&#39;s NOTES</strong></a></li>
<li><a href="#end-editors-notes" id="toc-end-editors-notes"><strong>END EDITOR&#39;s NOTES</strong></a></li>
<li><a href="#language-preliminaries" id="toc-language-preliminaries">Language Preliminaries</a></li>
<li><a href="#encapsulating-system-dependencies" id="toc-encapsulating-system-dependencies">Encapsulating System dependencies</a></li>
<li><a href="#editors-note-this-is-alfred-arnolds-writing-mostly-unedited-most-of-it-is-made-irrelevant-due-to-my-changes-to-use-c11-and-cmake" id="toc-editors-note-this-is-alfred-arnolds-writing-mostly-unedited-most-of-it-is-made-irrelevant-due-to-my-changes-to-use-c11-and-cmake"><strong>EDITOR&#39;s NOTE:</strong> This is Alfred Arnold&#39;s writing, mostly unedited. Most of it is made irrelevant due to my changes to use C11 and cmake</a></li>
<li><a href="#system-independent-files" id="toc-system-independent-files">System-Independent Files</a>
<ul>
<li><a href="#modules-used-by-as" id="toc-modules-used-by-as">Modules Used by AS</a>
<ul>
<li><a href="#asc" id="toc-asc">as.c</a></li>
<li><a href="#asmallgc" id="toc-asmallgc">asmallg.c</a></li>
<li><a href="#asmcodec" id="toc-asmcodec">asmcode.c</a></li>
<li><a href="#asmdebugc" id="toc-asmdebugc">asmdebug.c</a></li>
<li><a href="#asmdefc" id="toc-asmdefc">asmdef.c</a></li>
<li><a href="#asmfnumsc" id="toc-asmfnumsc">asmfnums.c</a></li>
<li><a href="#asmifc" id="toc-asmifc">asmif.c</a></li>
<li><a href="#asminclistc" id="toc-asminclistc">asminclist.c</a></li>
<li><a href="#asmitreec" id="toc-asmitreec">asmitree.c</a></li>
<li><a href="#asmmacc" id="toc-asmmacc">asmmac.c</a></li>
<li><a href="#asmparsc" id="toc-asmparsc">asmpars.c</a></li>
<li><a href="#asmsubc" id="toc-asmsubc">asmsub.c</a></li>
<li><a href="#bpemuc" id="toc-bpemuc">bpemu.c</a></li>
<li><a href="#chunksc" id="toc-chunksc">chunks.c</a></li>
<li><a href="#cmdargc" id="toc-cmdargc">cmdarg.c</a></li>
<li><a href="#codepseudoc" id="toc-codepseudoc">codepseudo.c</a></li>
<li><a href="#codevarsc" id="toc-codevarsc">codevars.c</a></li>
<li><a href="#as_endianc" id="toc-as_endianc">as_endian.c</a></li>
<li><a href="#headidsc" id="toc-headidsc">headids.c</a></li>
<li><a href="#ioerrsc" id="toc-ioerrsc">ioerrs.c</a></li>
<li><a href="#nlmessagesc" id="toc-nlmessagesc">nlmessages.c</a></li>
<li><a href="#nlsc" id="toc-nlsc">nls.c</a></li>
<li><a href="#stdhandlc" id="toc-stdhandlc">stdhandl.c</a></li>
<li><a href="#stringlistsc" id="toc-stringlistsc">stringlists.c</a></li>
<li><a href="#strutilc" id="toc-strutilc">strutil.c</a></li>
<li><a href="#versionc" id="toc-versionc">version.c</a></li>
<li><a href="#codec" id="toc-codec">code????.c</a></li>
</ul></li>
<li><a href="#additional-modules-for-the-tools" id="toc-additional-modules-for-the-tools">Additional Modules for the Tools</a>
<ul>
<li><a href="#hexc" id="toc-hexc">hex.c</a></li>
<li><a href="#p2binc" id="toc-p2binc">p2bin.c</a></li>
<li><a href="#p2hexc" id="toc-p2hexc">p2hex.c</a></li>
<li><a href="#pbindc" id="toc-pbindc">pbind.c</a></li>
<li><a href="#plistc" id="toc-plistc">plist.c</a></li>
<li><a href="#toolutilsc" id="toc-toolutilsc">toolutils.c</a></li>
</ul></li>
</ul></li>
<li><a href="#modules-needed-during-the-build-of-as" id="toc-modules-needed-during-the-build-of-as">Modules Needed During the Build of AS</a>
<ul>
<li><a href="#rescompc" id="toc-rescompc">rescomp.c</a></li>
<li><a href="#test_driverc" id="toc-test_driverc">test_driver.c</a></li>
</ul></li>
<li><a href="#generation-of-message-files" id="toc-generation-of-message-files">Generation of Message Files</a>
<ul>
<li><a href="#format-of-the-source-files" id="toc-format-of-the-source-files">Format of the Source Files</a></li>
</ul></li>
<li><a href="#creation-of-documentation" id="toc-creation-of-documentation">Creation of Documentation</a></li>
<li><a href="#test-suite" id="toc-test-suite">Test Suite</a></li>
<li><a href="#adding-a-new-target-processor" id="toc-adding-a-new-target-processor">Adding a New Target Processor</a>
<ul>
<li><a href="#choosing-the-processors-name" id="toc-choosing-the-processors-name">Choosing the Processor&#39;s Name</a></li>
<li><a href="#definition-of-the-code-generator-module" id="toc-definition-of-the-code-generator-module">Definition of the Code Generator Module</a></li>
<li><a href="#writing-the-code-generator-itself" id="toc-writing-the-code-generator-itself">Writing the Code Generator itself</a></li>
<li><a href="#modifications-of-tools" id="toc-modifications-of-tools">Modifications of Tools</a></li>
</ul></li>
<li><a href="#localization-to-a-new-language" id="toc-localization-to-a-new-language">Localization to a New Language</a></li>
</ul></li>
<li><a href="#bibliography" id="toc-bibliography">Bibliography</a></li>
</ul>
</nav>
<h1 id="flamewings-enhanced-as">Flamewing&#39;s Enhanced AS</h1>
<!-- markdownlint-disable MD025 -->

<!-- markdownlint-disable MD030 -->

<p>Welcome to the Flamewing&#39;s Enhanced AS documentation!</p>
<p>Most of this is based on the original documentation from AS, v1.42 Beta <code>[Bld 212</code>].</p>
<h1 id="macro-assembler-as-v142">Macro Assembler AS V1.42</h1>
<p>Alfred Arnold, Stefan Hilse, Stephan Kanthak, Oliver Sellke, Vittorio De Tomasi, flamewing</p>
<h1 id="users-manual">User&#39;s Manual</h1>
<p>Edition November 2024 Note: This is a modified version by flamewing.</p>
<p><em>IBM, PPC403Gx, OS/2, and PowerPC</em> are registered trademarks of IBM Corporation.
<em>Intel, MCS-48, MCS-51, MCS-251, MCS-96, MCS-196 and MCS-296</em> are registered trademarks of Intel Corp.
<em>Motorola and ColdFire</em> are registered trademarks of Motorola Inc.
<em>MagniV</em> is a registered trademark of Freescale Semiconductor.
<em>PicoBlaze</em> is a registered trademark of Xilinx Inc.
<em>UNIX</em> is a registered trademark of the The Open Group.
<em>Linux</em> is a registered trademark of Linus Torvalds.
<em>Microsoft, Windows, and MS-DOS</em> are registered trademarks of Microsoft Corporation.
All other trademarks not explicitly mentioned in this section and used in this manual are properties of their respective owners.</p>
<p>Intended reading order is as follows:</p>
<ol type="1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#assembler-usage">Assembler Usage</a></li>
<li><a href="#pseudo-instructions">Pseudo instructions</a></li>
<li><a href="#processor-specific-hints">Processor specific Hints</a></li>
<li><a href="#file-formats">File Formats</a></li>
<li><a href="#utility-programs">Utility Programs</a></li>
<li><a href="#error-messages">Error Messages</a></li>
<li><a href="#pseudo-instructions-and-integer-syntax">Pseudo Instructions and Integer Syntax</a></li>
<li><a href="#predefined-symbols">Predefined Symbols</a></li>
<li><a href="#shipped-include-files">Shipped Include Files</a></li>
<li><a href="#bibliography">Bibliography</a></li>
</ol>
<p>For historical reasons, the following are preserved:</p>
<ol type="1">
<li><a href="#frequently-asked-questions">Frequently Asked Questions (deprecated)</a></li>
<li><a href="#modifying-as">Modifying AS</a></li>
</ol>
<!-- markdownlint-enable MD030 -->

<!-- markdownlint-enable MD025 -->

<h1 id="introduction">Introduction</h1>
<!-- markdownlint-disable MD025 -->

<!-- markdownlint-disable MD030 -->

<p>This instruction is meant for programmers who are already very familiar with Assembler and who like to know how to work with AS. It is rather a reference than a user&#39;s manual and so it neither tries to explain the &quot;language assembler&quot; nor the processors. I have listed further literature in the bibliography which was substantial in the implementation of the different code generators. There is no book I know where you can learn Assembler from the start, so I generally learned this by &quot;trial and error&quot;.</p>
<h2 id="license-agreement">License Agreement</h2>
<p>Before we can go &quot;in medias res&quot;, first of all the inevitable prologue:</p>
<p>As in the present version is licensed according to the Gnu General Public License (GPL); the details of the GPL may be read in the file COPYING bundled with this distribution. If you did not get it with AS, complain to the one you got AS from!</p>
<p>Shortly said, the GPL covers the following points:</p>
<ul>
<li>Programs based upon AS must also be licensed according to the GPL;</li>
<li>distribution is explicitly allowed;</li>
<li>explicit disclaiming of all warranties for damages resulting from usage of this program.</li>
</ul>
<p>...however, I really urge you to read the file COPYING for the details!</p>
<p>The source code is available here:</p>
<ul>
<li><a href="https://github.com/flamewing/asl-releases">https://github.com/flamewing/asl-releases</a></li>
</ul>
<p>The latest version of AS (Win32, Win64, Ubuntu, Mac OS X) is available here:</p>
<ul>
<li><a href="https://github.com/flamewing/asl-releases/releases">https://github.com/flamewing/asl-releases/releases</a></li>
</ul>
<p>To accelerate the error diagnose and correction, please add the following details to the bug report:</p>
<ul>
<li>Operating system (Windows, Linux, Mac OS X, etc.) and its version</li>
<li>Version of AS used</li>
<li>If you compiled the assembler yourself, the compiler used and its version</li>
<li>If possible, the source file that triggered the bug</li>
</ul>
<p>Now, after this inevitable introduction we can turn to the actual documentation:</p>
<h2 id="general-capabilities-of-the-assembler">General Capabilities of the Assembler</h2>
<p>In contrast to ordinary assemblers, AS offers the possibility to generate code for totally different processors. At the moment, the following processor families have been implemented:</p>
<ul>
<li>Motorola 68000...68040, 683xx, and Coldfire including coprocessor and MMU</li>
<li>Motorola ColdFire</li>
<li>Motorola DSP5600x, DSP56300</li>
<li>Motorola M-Core</li>
<li>Motorola/IBM MPC601/MPC505/PPC403/MPC821</li>
<li>Motorola 6800, 6801, 68(HC)11(K4) and Hitachi 6301</li>
<li>Motorola/Freescale 6805, 68HC(S)08</li>
<li>Motorola 6809 / Hitachi 6309</li>
<li>Motorola/Freescale 68HC12(X) including XGATE</li>
<li>Freescale/NXP S12Z (&quot;MagniV&quot;)</li>
<li>Motorola 68HC16</li>
<li>Freescale 68RS08</li>
<li>Hitachi H8/300(H)</li>
<li>Hitachi H8/500</li>
<li>Hitachi SH7000/7600/7700</li>
<li>Hitachi HMCS400</li>
<li>Hitachi H16</li>
<li>Rockwell 6502, 65(S)C02, Commodore 65CE02, WDC W65C02S, Rockwell 65C19, and Hudson HuC6280</li>
<li>CMD 65816</li>
<li>Mitsubishi MELPS-740</li>
<li>Mitsubishi MELPS-7700</li>
<li>Mitsubishi MELPS-4500</li>
<li>Mitsubishi M16</li>
<li>Mitsubishi M16C</li>
<li>Intel 4004/4040</li>
<li>Intel MCS-48/41, including Siemens SAB80C382, and the OKI variants</li>
<li>Intel MCS-51/251, Dallas DS80C390</li>
<li>Intel MCS-96/196(Nx)/296</li>
<li>Intel 8080/8085</li>
<li>Intel i960</li>
<li>Signetics 8X30x</li>
<li>Signetics 2650</li>
<li>Philips XA</li>
<li>Atmel (Mega-)AVR</li>
<li>AMD 29K</li>
<li>Siemens 80C166/167</li>
<li>Zilog Z80, Z180, Z380</li>
<li>Zilog Z8, Super8, Z8 Encore</li>
<li>Zilog Z8000</li>
<li>Xilinx KCPSM/KCPSM3 (&#39;PicoBlaze&#39;)</li>
<li>LatticeMico8</li>
<li>Toshiba TLCS-900(L)</li>
<li>Toshiba TLCS-90</li>
<li>Toshiba TLCS-870(/C)</li>
<li>Toshiba TLCS-47</li>
<li>Toshiba TLCS-9000</li>
<li>Toshiba TC9331</li>
<li>Microchip PIC16C54...16C57</li>
<li>Microchip PIC16C84/PIC16C64</li>
<li>Microchip PIC17C42</li>
<li>Parallax SX20/28</li>
<li>SGS-Thomson ST6</li>
<li>SGS-Thomson ST7/STM8</li>
<li>SGS-Thomson ST9</li>
<li>SGS-Thomson 6804</li>
<li>Texas Instruments TMS32010/32015</li>
<li>Texas Instruments TMS3202x</li>
<li>Texas Instruments TMS320C3x/TMS320C4x</li>
<li>Texas Instruments TMS320C20x/TMS320C5x</li>
<li>Texas Instruments TMS320C54x</li>
<li>Texas Instruments TMS320C6x</li>
<li>Texas Instruments TMS99xx/99xxx</li>
<li>Texas Instruments TMS7000</li>
<li>Texas Instruments TMS1000</li>
<li>Texas Instruments TMS370xxx</li>
<li>Texas Instruments MSP430(X)</li>
<li>National Semiconductor SC/MP</li>
<li>National Semiconductor INS807x</li>
<li>National Semiconductor COP4</li>
<li>National Semiconductor COP8</li>
<li>National Semiconductor SC144xx</li>
<li>National Semiconductor NS32xxx</li>
<li>Fairchild ACE</li>
<li>Fairchild F8</li>
<li>NEC μPD78(C)0x/μPD 78(C)1x</li>
<li>NEC μPD75xx</li>
<li>NEC μPD 75xxx (alias 75K0)</li>
<li>NEC 78K0</li>
<li>NEC 78K2</li>
<li>NEC 78K3</li>
<li>NEC 78K4</li>
<li>NEC μPD7720/7725</li>
<li>NEC μPD77230</li>
<li>Fujitsu F<sup>2</sup>MC8L</li>
<li>Fujitsu F<sup>2</sup>MC16L</li>
<li>OKI OLMS-40</li>
<li>OKI OLMS-50</li>
<li>Panafacom MN1610/MN1613</li>
<li>Padauk PMS/PMC/PFSxxx</li>
<li>Symbios Logic SYM53C8xx (yes, they are programmable!)</li>
<li>Intersil CDP1802/1804/1805(A)</li>
<li>XMOS XS1</li>
<li>MIL STD 1750</li>
<li>KENBAK-1</li>
<li>GI CP-1600</li>
</ul>
<p>under work / planned / in consideration :</p>
<ul>
<li>Analog Devices ADSP21xx</li>
<li>SGS-Thomson ST20</li>
<li>Texas Instruments TMS320C8x</li>
</ul>
<p>Unloved, but now, however, present :</p>
<ul>
<li>Intel 80x86, 80186, Nec V30 &amp; V35 incl. coprocessor 8087</li>
</ul>
<p>The switch to a different code generator is allowed even within one file, and as often as one wants!</p>
<p>The reason for this flexibility is that AS has a history, which may also be recognized by looking at the version number. AS was created as an extension of a macro assembler for the 68000 family. On special request, I extended the original assembler so that it was able to translate 8051 mnemonics. On this way (decline ?!) from the 68000 to 8051, some other processors were created as by-products. All others were added over time due to user requests. So At least for the processor-independent core of AS, one may assume that it is well-tested and free of obvious bugs. However, I often do not have the chance to test a new code generator in practice (due to lack of appropriate hardware), so surprises are not impossible when working with new features. You see, the things stated in the <a href="#license-agreement">License Agreement</a> section have a reason...</p>
<p>This flexibility implies a somewhat exotic code format, therefore I added some tools to work with it. Their description can be found in <a href="#utility-programs">Utility Programs</a>.</p>
<p>AS is a macro assembler, which means that the programmer has the possibility to define new &quot;commands&quot; by means of macros. Additionally it masters conditional assembling. Labels inside macros are automatically processed as being local.</p>
<p>For the assembler, symbols may have either integer, string or floating point values. These will be stored - like interim values in formulas - with a width of 32 bits for integer values, 80 or 64 bits for floating point values, and 255 characters for strings. For a couple of micro controllers, there is the possibility to classify symbols by segmentation. So the assembler has a (limited) possibility to recognize accesses to wrong address spaces.</p>
<p>The assembler does not know explicit limits in the nesting depth of include files or macros; a limit is only given by the program stack restricting the recursion depth. Nor is there a limit for the symbol length, which is only restricted by the maximum line length.</p>
<p>From version 1.38 on, AS is a multipass-assembler. This pompous term means no more than the fact that the number of passes through the source code need not be exactly two. If the source code does not contain any forward references, AS needs only one pass. In case AS recognizes in the second pass that it must use a shorter or longer instruction coding, it needs a third (fourth, fifth...) pass to process all symbol references correctly. There is nothing more behind the term &quot;multipass&quot;, so it will not be used further more in this documentation.</p>
<p>After so much praise a bitter pill: AS cannot generate linkable code. An extension with a linker needs considerable effort and is not planned at the moment.</p>
<p>Those who want to take a look at the sources of AS can simply get the Unix version of AS, which comes as source for self-compiling. The sources are definitely not in a format that is targeted at easy understanding - the original Pascal version still raises its head at a couple of places, and I do not share a couple of common opinions about &#39;good&#39; C coding.</p>
<h2 id="supported-platforms">Supported Platforms</h2>
<p>In theory, any platform with a reasonably modern C compiler (must support C11) should support AS. This includes modern versions of GCC, clang, Windows with Microsoft&#39;s compiler, and AS even compiles with TinyC Compiler.</p>
<!-- markdownlint-enable MD030 -->

<!-- markdownlint-enable MD025 -->

<h1 id="assembler-usage">Assembler Usage</h1>
<!-- markdownlint-disable MD001 -->

<!-- markdownlint-disable MD025 -->

<!-- markdownlint-disable MD030 -->

<!-- markdownlint-disable MD036 -->

<blockquote>
<p><em>Scotty: Captain, we din&#39; can reference it!</em></p>
<p><em>Kirk: Analysis, Mr. Spock?</em></p>
<p><em>Spock: Captain, it doesn&#39;t appear in the symbol table.</em></p>
<p><em>Kirk: Then it&#39;s of external origin?</em></p>
<p><em>Spock: Affirmative.</em></p>
<p><em>Kirk: Mr. Sulu, go to pass two.</em></p>
<p><em>Sulu: Aye aye, sir, going to pass two.</em></p>
</blockquote>
<h2 id="delivery">Delivery</h2>
<p>Principally, you can obtain AS in one of two forms: as a <em>binary</em> or a <em>source</em> distribution. In case of a binary distribution, one gets AS, the accompanying tools and auxiliary files readily compiled, so you can immediately start to use it after unpacking the archive to the desired destination on your hard drive. Binary distributions are made for widespread platforms. A source distribution in contrast contains the complete set of C sources to generate AS; it is ultimately a snapshot of the source tree I use for development on AS. The generation of AS from the sources and their structure is described in detail in <a href="#modifying-as">Hints for the AS Source Code</a>, which is why at this place, only the contents and installation of a binary distribution will be described:</p>
<p>The contents of the archive is separated into several subdirectories, therefore you get a directory subtree immediately after unpacking without having to sort out things manually. The individual directories contain the following groups of files:</p>
<ul>
<li><p><code>BIN</code>: executable programs, text resources;</p></li>
<li><p><code>INCLUDE</code>: include files for assembler programs, e.g. register definitions or standard macros;</p></li>
<li><p><code>MAN</code>: quick references for the individual programs in Unix &#39;man&#39; format.</p></li>
</ul>
<p>A list of the files found in every binary distribution is given in the following table. In case a file listed in one of these (or the following) tables is missing, someone took a nap during copying (probably me)...</p>
<h5 id="table-standard-contents-of-a-binary-distribution"><strong>Table:</strong> Standard Contents of a Binary Distribution</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">File</th>
<th style="text-align: left;">Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Directory BIN</strong></td>
<td style="text-align: left;"><!-- empty --></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>AS.EXE</code></td>
<td style="text-align: left;">executable of assembler</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>PLIST.EXE</code></td>
<td style="text-align: left;">lists contents of code files</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>PBIND.EXE</code></td>
<td style="text-align: left;">merges code files</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>P2HEX.EXE</code></td>
<td style="text-align: left;">converts code files to hex files</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>P2BIN.EXE</code></td>
<td style="text-align: left;">converts code files to binary files</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>AS.MSG</code></td>
<td style="text-align: left;">text resources for AS</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>PLIST.MSG</code></td>
<td style="text-align: left;">text resources for PLIST</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>PBIND.MSG</code></td>
<td style="text-align: left;">text resources for PBIND</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>P2HEX.MSG</code></td>
<td style="text-align: left;">text resources for P2HEX</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>P2BIN.MSG</code></td>
<td style="text-align: left;">text resources for P2BIN</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>TOOLS.MSG</code></td>
<td style="text-align: left;">common text resources for all tools</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>CMDARG.MSG</code></td>
<td style="text-align: left;">common text resources for all programs</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>IOERRS.MSG</code></td>
<td style="text-align: left;">common text resources for all programs</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Directory DOC</strong></td>
<td style="text-align: left;"><!-- empty --></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Directory INCLUDE</strong></td>
<td style="text-align: left;"><!-- empty --></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>BITFUNCS.INC</code></td>
<td style="text-align: left;">functions for bit manipulation</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>CTYPE.INC</code></td>
<td style="text-align: left;">functions for classification of characters</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>80C50X.INC</code></td>
<td style="text-align: left;">register addresses SAB C50x</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>80C552.INC</code></td>
<td style="text-align: left;">register addresses 80C552</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>H8_3048.INC</code></td>
<td style="text-align: left;">register addresses H8/3048</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>KENBAK.INC</code></td>
<td style="text-align: left;">register addressed Kenbak-1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REG166.INC</code></td>
<td style="text-align: left;">addresses and instruction macros 80C166/167</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REG251.INC</code></td>
<td style="text-align: left;">addresses and bits 80C251</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REG29K.INC</code></td>
<td style="text-align: left;">peripheral addresses AMD 2924x</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REG53X.INC</code></td>
<td style="text-align: left;">register addresses H8/53x</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REG6303.INC</code></td>
<td style="text-align: left;">register addresses 6303</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REG683XX.INC</code></td>
<td style="text-align: left;">register addresses 68332/68340/68360</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REG7000.INC</code></td>
<td style="text-align: left;">register addresses TMS70Cxx</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REG78310.INC</code></td>
<td style="text-align: left;">register addresses &amp; vectors 78K3</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REG78K0.INC</code></td>
<td style="text-align: left;">register addresses 78K0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REG96.INC</code></td>
<td style="text-align: left;">register addresses MCS-96</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REGACE.INC</code></td>
<td style="text-align: left;">register addresses ACE</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REGF8.INC</code></td>
<td style="text-align: left;">register and memory addresses F8</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REGAVROLD.INC</code></td>
<td style="text-align: left;">register and bit addresses AVR family (old)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REGAVR.INC</code></td>
<td style="text-align: left;">register and bit addresses AVR family</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REGCOLD.INC</code></td>
<td style="text-align: left;">register and bit addresses Coldfire family</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REGCOP8.INC</code></td>
<td style="text-align: left;">register addresses COP8</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REGGP32.INC</code></td>
<td style="text-align: left;">register addresses 68HC908GP32</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REGH16.INC</code></td>
<td style="text-align: left;">register addresses H16</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REGHC12.INC</code></td>
<td style="text-align: left;">register addresses 68HC12</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REGM16C.INC</code></td>
<td style="text-align: left;">register addresses Mitsubishi M16C</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REGMSP.INC</code></td>
<td style="text-align: left;">register addresses TI MSP430</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REGPDK.INC</code></td>
<td style="text-align: left;">register and bit addresses PMC/PMS/PFSxxx</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REGS12Z.INC</code></td>
<td style="text-align: left;">register and bit addresses S12Z family</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REGST6.INC</code></td>
<td style="text-align: left;">register and macro definitions ST6</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REGST7.INC</code></td>
<td style="text-align: left;">register and macro definitions ST7</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REGSTM8.INC</code></td>
<td style="text-align: left;">register and macro definitions STM8</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REGST9.INC</code></td>
<td style="text-align: left;">register and macro definitions ST9</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REGZ380.INC</code></td>
<td style="text-align: left;">register addresses Z380</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>STDDEF04.INC</code></td>
<td style="text-align: left;">register addresses 6804</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>STDDEF16.INC</code></td>
<td style="text-align: left;">instruction macros and register addresses PIC16C5x</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>STDDEF17.INC</code></td>
<td style="text-align: left;">register addresses PIC17C4x</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>STDDEF18.INC</code></td>
<td style="text-align: left;">register addresses PIC16C8x</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>STDDEF2X.INC</code></td>
<td style="text-align: left;">register addresses TMS3202x</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>STDDEF37.INC</code></td>
<td style="text-align: left;">register and bit addresses TMS370xxx</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>STDDEF3X.INC</code></td>
<td style="text-align: left;">peripheral addresses TMS320C3x</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>STDDEF4X.INC</code></td>
<td style="text-align: left;">peripheral addresses TMS320C4x</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>STDDEF47.INC</code></td>
<td style="text-align: left;">instruction macros TLCS-47</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>STDDEF51.INC</code></td>
<td style="text-align: left;">definition of SFRs and bits for 8051/8052/80515</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>STDDEF56K.INC</code></td>
<td style="text-align: left;">register addresses DSP56000</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>STDDEF5X.INC</code></td>
<td style="text-align: left;">peripheral addresses TMS320C5x</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>STDDEF60.INC</code></td>
<td style="text-align: left;">instruction macros and register addresses PowerPC</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>REGSX20.INC</code></td>
<td style="text-align: left;">register and bit addresses Parallax SX20/28</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>AVR/*.INC</code></td>
<td style="text-align: left;">register and bit addresses AVR family (do not include directly, use <code>REGAVR.INC</code> )</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>COLDFIRE/*.INC</code></td>
<td style="text-align: left;">register and bit addresses ColdFire family (do not include directly, use <code>REGCOLD.INC</code> )</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>PDK/*.INC</code></td>
<td style="text-align: left;">register and bit addresses PMC/PMS/PFSxxx (do not include directly, use <code>REGPDK.INC</code> )</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>S12Z/*.INC</code></td>
<td style="text-align: left;">register and bit addresses S12Z family (do not include directly, use <code>REGS12Z.INC</code> )</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ST6/*.INC</code></td>
<td style="text-align: left;">register and bit addresses ST6 family (do not include directly, use <code>REGST6.INC</code> )</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ST7/*.INC</code></td>
<td style="text-align: left;">register and bit addresses ST7 family (do not include directly, use <code>REGST7.INC</code> )</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>STM8/*.INC</code></td>
<td style="text-align: left;">register and bit addresses STM8 family (do not include directly, use <code>REGSTM8.INC</code> )</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>STDDEF62.INC</code></td>
<td style="text-align: left;">register addresses and macros ST6 (old)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>STDDEF75.INC</code></td>
<td style="text-align: left;">register addresses 75K0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>STDDEF87.INC</code></td>
<td style="text-align: left;">register and memory addresses TLCS-870</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>STDDEF90.INC</code></td>
<td style="text-align: left;">register and memory addresses TLCS-90</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>STDDEF96.INC</code></td>
<td style="text-align: left;">register and memory addresses TLCS-900</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>STDDEFXA.INC</code></td>
<td style="text-align: left;">SFR and bit addresses Philips XA</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>STDDEFZ8.INC</code></td>
<td style="text-align: left;">register addresses Z8 family (old)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REGZ8.INC</code></td>
<td style="text-align: left;">register addresses Z8 family (new)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Z8/*.INC</code></td>
<td style="text-align: left;">register and bit addresses Z8 family (do not include directly, use <code>REGZ8.INC</code> )</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Directory LIB</strong></td>
<td style="text-align: left;"><!-- empty --></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Directory MAN</strong></td>
<td style="text-align: left;"><!-- empty --></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ASL.1</code></td>
<td style="text-align: left;">Short Reference for <code>AS</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>PLIST.1</code></td>
<td style="text-align: left;">Short Reference for <code>PLIST</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>PBIND.1</code></td>
<td style="text-align: left;">Short Reference for <code>PBIND</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>P2HEX.1</code></td>
<td style="text-align: left;">Short Reference for <code>P2HEX</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>P2BIN.1</code></td>
<td style="text-align: left;">Short Reference for <code>P2BIN</code></td>
</tr>
</tbody>
</table>
<h2 id="start-up-command-parameters">Start-Up Command, Parameters</h2>
<p>AS is a command line driven program, i.e. all parameters and file options are to be given in the command line.</p>
<p>A couple of message files belongs to AS (recognizable by their suffix <code>MSG</code> ) AS accesses to dynamically load the messages appropriate for the national language. AS searches the following directories for these files:</p>
<ul>
<li><p>the current directory;</p></li>
<li><p>the EXE-file&#39;s directory;</p></li>
<li><p>the directory named in the <code>AS_MSGPATH</code> environment variable, or alternatively the directories listed in the <code>PATH</code> environment variable;</p></li>
<li><p>the directory compiled into AS via the <code>LIBDIR</code> macro.</p></li>
</ul>
<p>These files are <em>indispensable</em> for a proper operation of AS, i.e. AS will terminate immediately if these files are not found.</p>
<p>The language selection (currently only German and English) is based on the <code>COUNTRY</code> setting under DOS and OS/2 respectively on the <code>LANG</code> environment variable under Unix.</p>
<p>The command line parameters can roughly be divided into three categories: switches, key file references (see below) and file specifications. Parameters of these two categories may be arbitrarily mixed in the command line. The assembler evaluates at first all parameters and then assembles the specified files. From this follow two things:</p>
<ul>
<li><p>the specified switches affect all specified source files. If several source files shall be assembled with different switches, this has to be done in separate runs.</p></li>
<li><p>it is possible to assemble more than one file in one shot and to bring it to the top, it is allowed that the file specs contain wildcards.</p></li>
</ul>
<p>Parameter switches are recognized by AS by starting with a slash (/) or hyphen (-). There are switches that are only one character long, and additionally switches composed of a whole word. Whenever AS cannot interpret a switch as a whole word, it tries to interpret every letter as an individual switch. For example, if you write</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">-queit</span></span></code></pre></div>
<p>instead of</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">-quiet</span></span></code></pre></div>
<p>AS will take the letters <code>q, u, e, i</code> , and <code>t</code> as individual switches. Multiple-letter switches additionally have the difference to single-letter switches that AS will accept an arbitrary mixture of upper and lower casing, whereas single-letter switches may have a different meaning depending on whether upper or lower case is used.</p>
<p>At the moment, the following switches are defined:</p>
<ul>
<li><p><code>l</code>: sends assembler listing to console terminal (mostly screen). In case several passes have to be done, the listing of all passes will be send to the console (in opposite to the next option).</p></li>
<li><p><code>L</code>: writes assembler listing into a file. The list file will get the same name as the source file, only the extension is replaced by <code>LST</code>. Except one uses...</p></li>
<li><p><code>OLIST</code>: with a fiel name as argument allows to redirect the listing to a different file or a different path. This option may be used multiple times in case multiple files are assembled with one execution.</p></li>
<li><p><code>LISTRADIX</code>: By default, all numeric output in the listing (addresses, generated code, symbol values) is written in hexadecimal notation. This switch requests usage of a different number system in the range of 2 to 36. For instance, &#39;-listradix 8&#39; requests octal output.</p></li>
<li><p><code>SPLITBYTE [character]</code>: Display numbers in the listing in byte groups, separated by the given character. A period is used as separator if no explicit character is given. This option is usually used in conjunction with the <code>LISTRADIX</code> option. For instance, list radix 8 with a period as character results in the so-called &#39;split octal&#39; notation.</p></li>
<li><p><code>o</code>: Sets the new name of the code file generated by AS. If this option is used multiple times, the names will be assigned, one after the other, to the source files which have to be assembled. A negation (see below) of this option in connection with a name erases this name from the list. A negation without a name erases the whole list.</p></li>
<li><p><code>SHAREOUT</code>:ditto for a SHARE file eventually to be created.</p></li>
<li><p><code>c</code>: SHARED-variables will be written in a format which permits an easy integration into a C-source file. The extension of the file is <code>H</code>.</p></li>
<li><p><code>p</code>: SHARED-variables will be written in a format which permits easy integration into the CONST-block of a Pascal program. The extension of the file is <code>INC</code>.</p></li>
<li><p><code>a</code>: SHARED-variables will be written in a format which permits easy integration into an assembler source file. The extension of the file is <code>INC</code>.</p></li>
</ul>
<p>Concerning effect and function of the SHARED-symbols please see <a href="#share-file">Share File</a> resp. <a href="#shared">SHARED</a>.</p>
<ul>
<li><p><code>g [format]</code>: This switch instructs AS to create an additional file that contains debug information for the program. Allowed formats are the AS-specific MAP format (<code>format=MAP</code>), a NoICE-compatible command file (<code>format=NOICE</code>), and the Atmel format used by the AVR tools (<code>format=ATMEL</code>). The information stored in the MAP format is comprised of a symbol table and a table describing the assignment of source lines to machine addresses. A more detailed description of the MAP format can be found in <a href="#debug-files">Debug Files</a> The file&#39;s extension is <code>MAP</code>, <code>NOI</code>, resp. <code>OBJ</code>, depending on the chosen format. If no explicit format specification is done, the MAP format is chosen.</p></li>
<li><p><code>noicemask [value]</code>: By default, AS lists only symbols from the CODE segment in NoICE debug info files. With this option and an integer value interpreted as a bit mask, symbols fom other segments may be added. The assignment of segments to bit positions may be taken from <a href="#table-codings-of-the-segment-field">Codings of the <code>Segment</code> Field table</a>.</p></li>
<li><p><code>w</code>: suppress issue of warnings;</p></li>
<li><p><code>E [file]</code>: error messages and warnings produced by AS will be redirected to a file. Instead of a file, the 5 standard handles (STDIN...STDPRN) can also be specified as <code>!0, !1, !2, !3, or !4</code> . Default is <code>STDERR == !2</code>. If the file option is left out, the name of the error file is the same as of the source file, but with the extension <code>LOG</code>.</p></li>
<li><p><code>q</code>: This switch suppresses all messages of AS, the exceptions are error messages and outputs which are are forced from the source file. The time needed for assembly is slightly reduced hereby and if you call AS from a shell there is no redirection required. The disadvantage is that you may &quot;stay in the dark&quot; for several minutes ... It is valid to write <code>quiet</code> instead of <code>q</code>.</p></li>
<li><p><code>h</code>: write hexadecimal numbers in lowercase instead of capital letters. This option is primarily a question of personal taste.</p></li>
<li><p><code>i &lt;path list&gt;</code>: issues a list of directories where the assembler shall automatically search for include files, in case it didn&#39;t find a file in the current directory. The different directories have to be separated by semicolons.</p></li>
<li><p><code>u</code>: calculate a list of areas which are occupied in the segments. This option is effective only in case a listing is produced. This option requires considerable additional memory and computing performance. In normal operation it should be switched off.</p></li>
<li><p><code>C</code>: generates a list of cross references. It lists which (global) symbols are used in files and lines. This list will also be generated only in case a listing is produced. This option occupies, too, additional memory capacity during assembly.</p></li>
<li><p><code>s</code>: issues a list of all sections (see <a href="#local-symbols">Local Symbols</a>). The nesting is indicated by indentations (Pascal like).</p></li>
<li><p><code>t</code>: by means of this switch it is possible to separate single components of the standard issued assembler-listing. The assignment of bits to parts can be found in the next section, where the exact format of the assembly listing is explained.</p></li>
<li><p><code>D</code>: defines symbols. The symbols which are specified behind this option and separated by commas are written to the global symbol table before starting the assembly. As default these symbols are written as integer numbers with the value TRUE, by means of an appended equal sign, however, you can select other values. The expression following the equals sign may include operators or internal functions, but <strong>not</strong> any further symbols, even if these should have been defined before in the list! Together with the commands for conditional assembly (see there) you may produce different program versions out of one source file by command line inputs. <strong>CAUTION!</strong> If the case-sensitive mode is used, this has to be specified in the command line <em>before</em> any symbol definitions, otherwise symbol names will be converted to upper case at this place!</p></li>
<li><p><code>A</code>: stores the list of global symbols in another, more compact form. Use this option if the assembler crashes with a stack overflow because of too long symbol tables. Sometimes this option can increase the processing speed of the assembler, but this depends on the sources.</p></li>
<li><p><code>x</code>: Sets the level of detail for error messages. The level is increased resp. decreased by one each time this option is given. While on level 0 (default) only the error message itself is printed, an extended message is added beginning at level 1 that should simplify the identification of the error&#39;s cause. <a href="#error-messages">Error messages</a> lists which error messages carry which extended messages. At level 2 (maximum), the source line containing the error is additionally printed.</p></li>
<li><p><code>n</code>: If this option is set, the error messages will be issued additionally with their error number (see <a href="#error-messages">Error messages</a>). This is primarily intended for use with shells or IDE&#39;s to make the identification of errors easier by those numbers.</p></li>
<li><p><code>U</code>: This option switches AS to the case-sensitive mode, i.e. upper and lower case in the names of symbols, sections, macros, character sets, and user-defined functions will be distinguished. This is not the case by default.</p></li>
<li><p><code>P</code>: Instructs AS to write the source text processed by macro processor and conditional assembly into a file. Additional blank and pure comment lines are missing in this file. The extension of this file is <code>I</code>.</p></li>
<li><p><code>M</code>: If this switch is given, AS generates a file, that contains definitions of macros defined in the source file that did not use the <code>NOEXPORT</code> option. This new file has the same name as the source file, only the extension is modified into <code>MAC</code>.</p></li>
<li><p><code>G</code>: this switch defines whether AS should produce code or not. If switched off, the processing will be stopped after the macro processor. This switch is activated by default (logically, otherwise you would not get a code file). This switch can be used in conjunction with the <code>P</code> switch, if only the macro processor of AS shall be used.</p></li>
<li><p><code>r [n]</code>: issue warnings if situations occur that force a further pass. This information can be used to reduce the number of passes. You may optionally specify the number of the first pass where issuing of such messages shall start. Without this argument, warnings will come starting with the first pass. Be prepared for a bunch of messages!!</p></li>
<li><p><code>relaxed</code>: this switch enables the RELAXED mode right from the beginning of the program, which otherwise has to be enabled by the pseudo instruction of sane name (see <a href="#relaxed">RELAXED</a>).</p></li>
<li><p><code>supmode</code>: this switch enables right from the beginning of the program usage of machine instructions that may only be used in the processor&#39;s supervisor mode (see <a href="#supmode-fpu-pmmu-custom">SUPMODE, FPU, PMMU, CUSTOM</a>).</p></li>
<li><p><code>Y</code>: This switch instructs AS to to suppress all messages about out-of-branch conditions, once the necessity for another pass is given. See <a href="#forward-references-and-other-disasters">Forward References and Other Disasters</a> for the (rare) situations that might make use of this switch necessary.</p></li>
<li><p><code>cpu &lt;name&gt;</code>: this switch allows to set the target processor AS shall generate code for, in case the source file does not contain a <code>CPU</code> instruction and is not 68008 code. If the selected target supports CPU arguments (see <a href="#cpu">CPU</a>), they may be used on the command line as well.</p></li>
<li><p><code>alias &lt;new&gt;=&lt;old&gt;</code>: defines the processor type <code>&lt;new&gt;</code> to be an alias for the type <code>&lt;old&gt;</code>. See <a href="#processor-aliases">Processor Aliases</a> for the sense of processor aliases.</p></li>
<li><p><code>gnuerrors</code>: display messages about errors resp. warnings not in the AS standard format, but instead in a format similar to the GNU C compiler. This simplifies the integration of AS into environments tuned for this format, however also suppresses the display of precise error positions in macro bodies!</p></li>
<li><p><code>maxerrors [n]</code>: instructs the assembler to terminate assembly after the given number of errors.</p></li>
<li><p><code>maxinclevel [n]</code>: instructs the assembler to terminate assembly if the include nesting level exceeds the given limit (default is 200).</p></li>
<li><p><code>Werror</code>: instructs the assembler to treat warnings as errors.</p></li>
<li><p><code>compmode</code>: This switch instructs the assembler to operate by default in compatibility mode. See <a href="#compmode">COMPMODE</a> for more information about this mode.</p></li>
</ul>
<p>As long as switches require no arguments and their concatenation does not result in a multi-letter switch, it is possible to specify several switches at one time, as in the following example :</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>as test*.asm firstprog <span class="at">-cl</span> <span class="at">/i</span> c:\as\8051\include</span></code></pre></div>
<p>All files <code>TEST*.ASM</code> as well as the file <code>FIRSTPROG.ASM</code> will be assembled, whereby listings of all files are displayed on the console terminal. Additional sharefiles will be generated in the C- format. The assembler should search for additional include files in the directory <code>C:\AS\8051\INCLUDE</code> .</p>
<p>This example shows that the assembler assumes <code>ASM</code> as the default extension for source files.</p>
<p>A bit of caution should be applied when using switches that have optional arguments: if a file specification immediately follows such a switch without the optional argument, AS will try to interpret the file specification as argument - what of course fails:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>as <span class="at">-g</span> test.asm</span></code></pre></div>
<p>The solution in this case would either be to move the -g option the end or to specify an explicit MAP argument.</p>
<p>Beside from specifying options in the command line, permanently needed options may be placed in the environment variable <code>ASCMD</code> . For example, if someone always wants to have assembly listings and has a fixed directory for include files, he can save a lot of typing with the following command:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="va">ascmd</span>=-L -i c:\as\8051\include</span></code></pre></div>
<p>The environment options are processed before the command line, so options in the command line can override contradicting ones in the environment variable.</p>
<p>In the case of very long path names, space in the <code>ASCMD</code> variable may become a problem. For such cases a key file may be the alternative, in which the options can be written in the same way as in the command line or the <code>ASCMD</code> -variable. But this file may contain several lines each with a maximum length of 255 characters. In a key file it is important, that for options which require an argument, switches and argument have to be written in the <strong>same</strong> line. AS gets informed of the name of the key file by a <code>@</code> ahead in the <code>ASCMD</code> variable, e.g.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="va">ASCMD</span>=@c:\as\as.key</span></code></pre></div>
<p>In order to neutralize options in the <code>ASCMD</code> variable (or in the key file), prefix the option with a plus sign. For example, if you do not want to generate an assembly listing in an individual case, the option can be retracted in this way:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>as +L <span class="kw">&lt;</span>file<span class="kw">&gt;</span></span></code></pre></div>
<p>Naturally it is not consequently logical to deny an option by a plus sign.... UNIX soit qui mal y pense.</p>
<p>References to key files may not only come from the <code>ASCMD</code> variable, but also directly from the command line. Similarly to the <code>ASCMD</code> variable, prepend the file&#39;s name with a character:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>as @<span class="kw">&lt;</span>file<span class="kw">&gt;</span> ....</span></code></pre></div>
<p>The options read from a key file in this situation are processed as if they had been written out in the command line in place of the reference, <em>not</em> like the key file referenced by the <code>ASCMD</code> variable that is processed prior to the command line options.</p>
<p>Referencing a key file from a key file itself is not allowed and will be answered wit an error message by AS.</p>
<p>In case that you like to start AS from another program or a shell and this shell hands over only lower-case or capital letters in the command line, the following workaround exists: if a tilde ( <code>~</code> ) is put in front of an option letter, the following letter is always interpreted as a lower-case letter. Similarly a <code>#</code> demands the interpretation as a capital letter. For example, the following transformations result for:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>/~I ---<span class="kw">&gt;</span> <span class="at">/i</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>-#u ---<span class="kw">&gt;</span> -U</span></code></pre></div>
<p>In dependence of the assembly&#39;s outcome, the assembler ends with the following return codes:</p>
<p>0 error free run, at maximum warnings occurred</p>
<p>1 The assembler displayed only its command-line parameters and terminated immediately afterwards.</p>
<p>2 Errors occurred during assembly, no code file has been produced.</p>
<p>3 A fatal error occurred what led to immediate termination of the run.</p>
<p>4 An error occurred already while starting the assembler. This may be a parameter error or a faulty overlay file.</p>
<p>255 An internal error occurred during initialization that should not occur in any case...reboot, try again, and contact me if the problem is reproducible!</p>
<p>Similar to UNIX, OS/2 extends an application&#39;s data segment on demand when the application really needs the memory. Therefore, an output like</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">511</span> KByte available memory</span></code></pre></div>
<p>does not indicate a shortly to come system crash due to memory lack, it simply shows the distance to the limit when OS/2 will push up the data segment&#39;s size again...</p>
<p>As there is no compatible way in C under different operating systems to find out the amount of available memory resp. stack, both lines are missing completely from the statistics the C version prints.</p>
<h2 id="format-of-the-input-files">Format of the Input Files</h2>
<p>Like most assemblers, AS expects exactly one instruction per line (blank lines are naturally allowed as well). The lines must not be longer than 255 characters, additional characters are discarded.</p>
<p>A single line has following format:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">[label[:]]</span> <span class="op">&lt;</span>mnemonic<span class="op">&gt;</span><span class="pp">[</span><span class="ss">.attr</span><span class="pp">]</span> [param<span class="pp">[</span><span class="ss">,param...</span><span class="pp">]</span>] [<span class="kw">;</span><span class="ex">comment]</span></span></code></pre></div>
<p>A line may also be split over several lines in the source file, continuation characters chain these parts together to a single line. One must however consider that, due to the internal buffer structure, the total line must not be longer than 256 characters. Line references in error messages always relate to the last line of such a composed source line.</p>
<p>The colon for the label is optional, in case the label starts in the first column (the consequence is that a machine or pseudo instruction must not start in column 1). It is necessary to set the colon in case the label does not start in the first column so that AS is able to distinguish it from a mnemonic. In the latter case, there must be at least one space between colon and mnemonic if the processor belongs to a family that supports an attribute that denotes an instruction format and is separated from the mnemonic by a colon. This restriction is necessary to avoid ambiguities: a distinction between a mnemonic with format and a label with mnemonic would otherwise be impossible.</p>
<p>Some signal processor families from Texas Instruments optionally use a double line ( <code>||</code> ) in place of the label to signify the parallel execution with the previous instruction(s). If these two assembler instructions become a single instruction word at machine level (C3x/C4x), an additional label in front of the second instruction of course does not make sense and is not allowed. The situation is different for the C6x with its instruction packets of variable length: If someone wants to jump into the middle of an instruction packet (bad style, if you ask me...), he has to place the necessary label <em>before</em> into a separate line. The same is valid for conditions, which however may be combined with the double line in a single source line.</p>
<p>The attribute is used by a couple of processors to specify variations or different encodings of a certain instruction. The most prominent usage of the attribute is is the specification of the operand size, for example in the case of the 680x0 family:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">attribute</th>
<th style="text-align: left;">arithmetic-logic instruction</th>
<th style="text-align: left;">jump instruction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: left;">byte (8 bits)</td>
<td style="text-align: left;">8-bit-displacement</td>
</tr>
<tr class="even">
<td style="text-align: left;">W</td>
<td style="text-align: left;">word (16 bits)</td>
<td style="text-align: left;">16-bit-displacement</td>
</tr>
<tr class="odd">
<td style="text-align: left;">L</td>
<td style="text-align: left;">long word (32 bits)</td>
<td style="text-align: left;">16-bit-displacement</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q</td>
<td style="text-align: left;">quad word (64 bits)</td>
<td style="text-align: left;">------</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: left;">half precision (16 bits)</td>
<td style="text-align: left;">------</td>
</tr>
<tr class="even">
<td style="text-align: left;">S</td>
<td style="text-align: left;">single precision (32 bits)</td>
<td style="text-align: left;">8-bit-displacement</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D</td>
<td style="text-align: left;">double precision (64 bits)</td>
<td style="text-align: left;">------</td>
</tr>
<tr class="even">
<td style="text-align: left;">X</td>
<td style="text-align: left;">extended precision (80/96 bits)</td>
<td style="text-align: left;">32-bit-displacement</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P</td>
<td style="text-align: left;">decimal floating point (80/96 bits)</td>
<td style="text-align: left;">------</td>
</tr>
</tbody>
</table>
<p>Since this manual is not also meant as a user&#39;s manual for the processor families supported by AS, this is unfortunately not the place to enumerate all possible attributes for all families. It should however be mentioned that in general, not all instructions of a given instruction set allow all attributes and that the omission of an attribute generally leads to the usage of the &quot;natural&quot; operand size of a processor family. For more thorough studies, consult a reasonable programmer&#39;s manual, e.g. <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> for the 68K&#39;s.</p>
<p>In the case of TLCS-9000, H8/500, and M16(C), the attribute serves both as an operand size specifier (if it is not obvious from the operands) and as a description of the instruction format to be used. A colon has to be used to separate the format from the operand size, e.g. like this:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">add.w:g</span>   rw10,rw8</span></code></pre></div>
<p>This example does not show that there may be a format specification without an operand size. In contrast, if an operand size is used without a format specification, AS will automatically use the shortest possible format. The allowed formats and operand sizes again depend on the machine instruction and may be looked up e.g. in <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>, resp. <a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<p>The number of instruction parameters depends on the mnemonic and is principally located between 0 and 20. The separation of the parameters from each other is to be performed only by commas (exception: DSP56xxx, its parallel data transfers are separated with blanks). Commas that are included in brackets or quotes, of course, are not taken into consideration.</p>
<p>Instead of a comment at the end, the whole line can consist of comment if it starts in the first column with a semicolon.</p>
<p>To separate the individual components you may also use tabulators instead of spaces.</p>
<h2 id="format-of-the-listing">Format of the Listing</h2>
<p>The listing produced by AS using the command line options i or I is roughly divisible into the following parts :</p>
<ol type="1">
<li><p>issue of the source code assembled;</p></li>
<li><p>symbol list;</p></li>
<li><p>usage list;</p></li>
<li><p>cross reference list.</p></li>
</ol>
<p>The two last ones are only generated if they have been demanded by additional command line options.</p>
<p>In the first part, AS lists the complete contents of all source files including the produced code. A line of this listing has the following form:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">[</span><span class="op">&lt;</span>n<span class="op">&gt;</span>] <span class="op">&lt;</span>line<span class="op">&gt;</span>/<span class="op">&lt;</span>address<span class="op">&gt;</span> <span class="op">&lt;</span>code<span class="op">&gt;</span> <span class="op">&lt;</span>source<span class="op">&gt;</span></span></code></pre></div>
<p>In the field <code>n</code> , AS displays the include nesting level. The main file (the file where assembly was started) has the depth 0, an included file from there has depth 1 etc... Depth 0 is not displayed.</p>
<p>In the field <code>line</code> , the source line number of the referenced file is issued. The first line of a file has the number 1. The address at which the code generated from this line is written follows after the slash in the field <code>address</code> .</p>
<p>The code produced is written behind <code>address</code> in the field <code>code</code> , in hexadecimal notation. Depending on the processor type and actual segment the values are formatted either as bytes or 16/32-bit-words. If more code is generated than the field can take, additional lines will be generated, in which case only this field is used.</p>
<p>Finally, in the field <code>source</code> , the line of the source file is issued in its original form.</p>
<p>The symbol table was designed in a way that it can be displayed on an 80-column display whenever possible. For symbols of &quot;normal length&quot;, a double column output is used. If symbols exceed (with their name and value) the limit of 40 columns (characters), they will be issued in a separate line. The output is done in alphabetical order. Symbols that have been defined but were never used are marked with a star (*) as prefix.</p>
<!-- markdownlint-disable MD038-->

<p>The parts mentioned so far as well as the list of all macros/functions defined can be selectively masked out from the listing. This can be done by the already mentioned command line switch <code>-t</code> . There is an internal byte inside AS whose bits represent which parts are to be written. The assignment of bits to parts of the listing is listed in the following table:</p>
<!-- markdownlint-enable MD038-->

<table>
<thead>
<tr class="header">
<th style="text-align: left;">bit</th>
<th style="text-align: left;">part</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">source file(s) + produced code</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">symbol table</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">macro list</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">function list</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">line numbering</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">register symbol list</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">character set table</td>
</tr>
</tbody>
</table>
<p>All bits are set to 1 by default, when using the switch</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>-t <span class="kw">&lt;</span>mask<span class="kw">&gt;</span></span></code></pre></div>
<p>Bits set in <code>&lt;mask&gt;</code> are cleared, so that the respective listing parts are suppressed. Accordingly it is possible to switch on single parts again with a plus sign, in case you had switched off too much with the <code>ASCMD</code> variable... If someone wants to have, for example, only the symbol table, it is enough to write:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>-t 2</span></code></pre></div>
<p>The usage list issues the occupied areas hexadecimally for every single segment. If the area has only one address, only this is written, otherwise the first and last address.</p>
<p>The cross reference list issues any defined symbol in alphabetical order and has the following form:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>symbol <span class="op">&lt;</span>symbol name<span class="op">&gt;</span> <span class="op">(=&lt;</span>value<span class="op">&gt;,&lt;</span><span class="dt">file</span><span class="op">&gt;/&lt;</span>line<span class="op">&gt;):</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">file</span> <span class="op">&lt;</span><span class="dt">file</span> <span class="dv">1</span><span class="op">&gt;:</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    &lt;n1<span class="op">&gt;[(</span>m1<span class="op">)]</span>  <span class="op">.....</span> <span class="op">&lt;</span>nk<span class="op">&gt;[(</span>mk<span class="op">)]</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    .</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    .</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">file</span> <span class="op">&lt;</span><span class="dt">file</span> l<span class="op">&gt;:</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    &lt;n1<span class="op">&gt;[(</span>m1<span class="op">)]</span>  <span class="op">.....</span> <span class="op">&lt;</span>nk<span class="op">&gt;[(</span>mk<span class="op">)]</span></span></code></pre></div>
<p>The cross reference list lists for every symbol in which files and lines it has been used. If a symbol was used several times in the same line, this would be indicated by a number in brackets behind the line number. If a symbol was never used, it would not appear in the list; The same is true for a file that does not contain any references for the symbol in question.</p>
<p><strong>CAUTION!</strong> AS can only print the listing correctly if it was previously informed about the output media&#39;s page length and width! This has to be done with the <code>PAGE</code> instruction (see there). The preset default is a length of 60 lines and an unlimited line width.</p>
<h2 id="symbol-conventions">Symbol Conventions</h2>
<p>Symbols are allowed to be up to 255 characters long (as hinted already in the introduction) and are being distinguished on the whole length, but the symbol names have to meet some conventions:</p>
<p>Symbol names are allowed to consist of a random combination of letters, digits, underlines and dots, whereby the first character must not be a digit. The dot is only allowed to meet the MCS-51 notation of register bits and should - as far as possible - not be used in own symbol names. To separate symbol names in any case the underline ( <code>_</code> ) and not the dot ( <code>.</code> ) should be used .</p>
<p>AS is by default not case-sensitive, i.e. it does not matter whether one uses upper or lower case characters. The command line switch <code>U</code> however allows to switch AS into a mode where upper and lower case makes a difference. The predefined symbol <code>CASESENSITIVE</code> signifies whether AS has been switched to this mode: TRUE means case-sensitiveness, and FALSE its absence.</p>
<p>The following table shows the most important symbols which are predefined by AS.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>TRUE</code></td>
<td style="text-align: left;">logically &quot;true&quot;</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>FALSE</code></td>
<td style="text-align: left;">logically &quot;false&quot;</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>CONSTPI</code></td>
<td style="text-align: left;">Pi (3.1415.....)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>VERSION</code></td>
<td style="text-align: left;">version of AS in BCD-coding, e.g. 1331 hex for version 1.33p1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ARCHITECTURE</code></td>
<td style="text-align: left;">target platform AS was compiled for, in the style system</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>DATE</code></td>
<td style="text-align: left;">date of the assembly (start)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>TIME</code></td>
<td style="text-align: left;">time of the assembly (start)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>MOMCPU</code></td>
<td style="text-align: left;">current target CPU (see the CPU instruction)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>MOMFILE</code></td>
<td style="text-align: left;">current source file</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>MOMLINE</code></td>
<td style="text-align: left;">line number in source file</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>MOMPASS</code></td>
<td style="text-align: left;">number of the currently running pass</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>MOMSECTION</code></td>
<td style="text-align: left;">name of the current section or an empty string</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>*</code> , <code>$</code> resp. <code>PC</code></td>
<td style="text-align: left;">current value of program counter</td>
</tr>
</tbody>
</table>
<p><strong>CAUTION!</strong> While it does not matter in case-sensitive mode which combination of upper and lower case to use to reference predefined symbols, one has to use exactly the version given above (only upper case) when AS is in case-sensitive mode!</p>
<p>Additionally some pseudo instructions define symbols that reflect the value that has been set with these instructions. Their descriptions are explained at the individual commands belonging to them.</p>
<p>A hidden feature (that has to be used with care) is that symbol names may be assembled from the contents of string symbols. This can be achieved by framing the string symbol&#39;s name with braces and inserting it into the new symbol&#39;s name. This allows for example to define a symbol&#39;s name based on the value of another symbol:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cnt             set     cnt<span class="op">+</span><span class="dv">1</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>temp            equ     <span class="st">&quot;\{CNT}&quot;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                <span class="cf">jnz</span>     skip<span class="op">{</span>temp<span class="op">}</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                .</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                .</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>skip<span class="op">{</span>temp<span class="op">}:</span>     nop</span></code></pre></div>
<p><strong>CAUTION:</strong> The programmer has to assure that only valid symbol names are generated!</p>
<p>A complete list of all symbols predefined by AS can be found in <a href="#predefined-symbols">Predefined Symbols</a>.</p>
<p>Apart from its value, every symbol also owns a marker which signifies to which <em>segment</em> it belongs. Such a distinction is mainly needed for processors that have more than one address space. The additional information allows AS to issue a warning when a wrong instruction is used to access a symbol from a certain address space. A segment attribute is automatically added to a symbol when is gets defined via a label or a special instruction like <code>BIT</code> ; a symbol defined via the &quot;allround instructions&quot; <code>SET</code> resp. <code>EQU</code> is however &quot;typeless&quot;, i.e. its usage will never trigger warnings. A symbol&#39;s segment attribute may be queried via the built-in function <code>SYMTYPE</code> , e.g.:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Label:</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>Attr    equ     symtype<span class="op">(</span>Label<span class="op">)</span>  <span class="co">; results in 1</span></span></code></pre></div>
<p>The individual segment types have the assigned numbers listed in the following table. Register symbols which do not really fit into the order of normal symbols are explained in <a href="#register-symbols">Register Symbols</a>. The <code>SYMTYPE</code> function delivers -1 as result when called with an undefined symbol as argument. However, if all you want to know is whether a symbol is defined or not, you may as well use the <code>DEFINED</code> function.</p>
<h5 id="table-return-values-of-the-symtype-function"><strong>Table:</strong> return values of the <code>SYMTYPE</code> function</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">segment</th>
<th style="text-align: center;">return value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>&lt;none&gt;</code></td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>CODE</code></td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>DATA</code></td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>IDATA</code></td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>XDATA</code></td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>YDATA</code></td>
<td style="text-align: center;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>BITDATA</code></td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>IO</code></td>
<td style="text-align: center;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REG</code></td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ROMDATA</code></td>
<td style="text-align: center;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>EEDATA</code></td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&lt;register symbol&gt;</code></td>
<td style="text-align: center;">128</td>
</tr>
</tbody>
</table>
<h2 id="temporary-symbols">Temporary Symbols</h2>
<p>Especially when dealing with programs that contain sequences of loops of if-like statements, one is continuously faced with the problem of inventing new names for labels - labels of which you know exactly that you will never need to reference them again afterwards and you really would like to get &#39;rid&#39; of them somehow. A simple solution if you don&#39;t want to swing the large hammer of sections (see <a href="#local-symbols">Local Symbols</a>) are <em>temporary</em> symbols which remain valid as long as a new, non-temporary symbol gets defined. Other assemblers offer a similar mechanism which is commonly referred as &#39;local symbols&#39;; however, for the sake of a better distinction, I want to stay with the term &#39;temporary symbols&#39;. AS knows three different types of temporary symbols, in the hope to offer everyone &#39;switching&#39; to AS a solution that makes conversion as easy as possible. However, practically every assembler has its own interpretation of this feature, so there will be only few cases where a 1:1 solution for existing code:</p>
<h2 id="named-temporary-symbols">Named Temporary Symbols</h2>
<p>A symbol whose name starts with two dollar signs (something that is neither allowed for non-temporary symbols nor for constants) is a named temporary symbol. AS keeps an internal counter which is reset to 0 before assembly begins and which gets incremented upon every definition of a non-temporary symbol. When a temporary symbol is defined or referenced, both leading dollar signs are discarded and the counter&#39;s current value is appended. This way, one regains the used symbol names with every definition of a non-temporary symbol - but you also cannot reach the previously symbols any more! Temporary symbols are therefore especially suited for usage in small instruction blocks, typically a dozen of machine instructions, definitely not more than one screen. Otherwise, one easily gets confused...</p>
<p>Here is a small example:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>$$loop<span class="op">:</span> nop</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>        dbra    d0<span class="op">,$$</span>loop</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">split:</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>$$loop<span class="op">:</span> nop</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        dbra    d0<span class="op">,$$</span>loop</span></code></pre></div>
<p>Without the non-temporary label between the loops, of course an error message about a double-defined symbol would be the result.</p>
<h3 id="nameless-temporary-symbols">Nameless Temporary Symbols</h3>
<p>For all those who regard named temporary symbols still as too complicated, there is an even simpler variant: If one places a single plus or minus sign as a label, this is converted to special internal symbol names. Those symbols are &quot;unpronounceable&quot; and unpredictable, and should not be relied on in a program; instead, they are referenced via the special names <code>- – —</code> respectively <code>+ ++ +++</code> , which refer to the three last &#39;minus symbols&#39; and the next three &#39;plus symbols&#39;. Therefore, the selection between these two variants depends on whether one wants to forward- or backward-reference a symbol.</p>
<p>Apart from plus and minus, <em>defining</em> nameless temporary symbols also exists in a third variant, namely a slash (/). A temporary symbol defined in this way may be referenced both backward and forward, i.e. it is treated either as a plus or a minus, depending on the way it is being referenced.</p>
<p>Nameless temporary symbols are usually used in constructs that fit on one screen page, like skipping a few machine instructions or tight loops - things would become too puzzling otherwise (this only a good advice, however...). An example for this is the following piece of code, this time as 65xx code:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>        cpu     <span class="dv">6502</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>-       ldx     <span class="op">#</span><span class="dv">00</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>-       dex</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        bne     <span class="op">-</span>           <span class="co">; branch to &#39;dex&#39;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        lda     RealSymbol</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>        beq     <span class="op">+</span>           <span class="co">; branch to &#39;bne --&#39;</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        jsr     SomeRtn</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        iny</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>+       bne     <span class="op">--</span>          <span class="co">; branch to &#39;ldx #00&#39;</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">SomeRtn:</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        rts</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">RealSymbol:</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>        dfs     <span class="dv">1</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">inc</span> <span class="dt">ptr</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        bne     <span class="op">+</span>           <span class="co">; branch to &#39;tax&#39;</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">inc</span>     <span class="dt">ptr</span><span class="op">+</span><span class="dv">1</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>+       tax</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        bpl     <span class="op">++</span>          <span class="co">; branch to &#39;dex&#39;</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        beq     <span class="op">+</span>           <span class="co">; branch forward to &#39;rts&#39;</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>        lda     <span class="op">#</span><span class="dv">0</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>/       rts                 <span class="co">; slash used as wildcard.</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>+       dex</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>        beq     <span class="op">-</span>           <span class="co">; branch backward to &#39;rts&#39;</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ptr:</span>    dfs <span class="dv">2</span></span></code></pre></div>
<h3 id="composed-temporary-symbols">Composed Temporary Symbols</h3>
<p>This is maybe the type of temporary symbols that is nearest to the concept of local symbols and sections. Whenever a symbol&#39;s name begins with a dot (.), the symbol is not directly stored with this name in the symbol table. Instead, the name of the most recently-defined symbol not beginning with a dot is prepended to the symbols name. This way, &#39;non-dotted&#39; symbols take the role of section separators and &#39;dotted&#39; symbol names may be reused after a &#39;non-dotted&#39; symbol has been defined. Take a look at the following little example:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">proc1:</span>                      <span class="co">; non-temporary symbol &#39;proc1&#39;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>.<span class="cf">loop</span>   moveq   <span class="op">#</span><span class="dv">20</span><span class="op">,</span>d0      <span class="co">; actually defines &#39;proc1.loop&#39;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        dbra    d0<span class="op">,.</span>loop</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        rts</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">proc2:</span>                      <span class="co">; non-temporary symbol &#39;proc2&#39;</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>.<span class="cf">loop</span>   moveq   <span class="op">#</span><span class="dv">10</span><span class="op">,</span>d1      <span class="co">; actually defines &#39;proc2.loop&#39;</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        jsr proc1</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        dbra    d1<span class="op">,.</span>loop</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        rts</span></code></pre></div>
<p>Note that it is still possible to access all temporary symbols, even without being in the same &#39;area&#39;, by simply using the composed name (like &#39;proc2.loop&#39; in the previous example).</p>
<p>It is principally possible to combine composed temporary symbols with sections, which makes them also to local symbols. Take however into account that the most recent non-temporary symbol is not stored per-section, but simply globally. This may change however in a future version, so one shouldn&#39;t rely on the current behaviour.</p>
<h2 id="formula-expressions">Formula Expressions</h2>
<p>In most places where the assembler expects numeric inputs, it is possible to specify not only simple symbols or constants, but also complete formula expressions. The components of these formula expressions can be either single symbols and constants. Constants may be either integer, floating point, or string constants.</p>
<h3 id="integer-constants">Integer Constants</h3>
<p>Integer constants describe non-fractional numbers. They are written as a sequence of digits. This may be done in different numbering systems, as shown in the following table.</p>
<h5 id="table-defined-numbering-systems-and-notations"><strong>Table:</strong> Defined Numbering Systems and Notations</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><!--  --></th>
<th style="text-align: center;">Intel Mode</th>
<th style="text-align: center;">Motorola Mode</th>
<th style="text-align: center;">C Mode</th>
<th style="text-align: center;">IBM Mode</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Decimal</td>
<td style="text-align: center;">Direct</td>
<td style="text-align: center;">Direct</td>
<td style="text-align: center;">Direct</td>
<td style="text-align: center;">Direct</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hex</td>
<td style="text-align: center;">Suffix <code>H</code></td>
<td style="text-align: center;">Prefix <code>$</code></td>
<td style="text-align: center;">Prefix <code>0x</code></td>
<td style="text-align: center;"><code>X&#39;...&#39;</code> or <code>H&#39;...&#39;</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em>Ident</em></td>
<td style="text-align: center;"><code>hexh</code></td>
<td style="text-align: center;"><code>$hex</code></td>
<td style="text-align: center;"><code>0xhex</code></td>
<td style="text-align: center;"><code>x&#39;hex&#39;</code> or <code>h&#39;hex&#39;</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Binary</td>
<td style="text-align: center;">Suffix <code>B</code></td>
<td style="text-align: center;">Prefix <code>%</code></td>
<td style="text-align: center;">Prefix <code>0b</code></td>
<td style="text-align: center;"><code>O&#39;...&#39;</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em>Ident</em></td>
<td style="text-align: center;"><code>binb</code></td>
<td style="text-align: center;"><code>%bin</code></td>
<td style="text-align: center;"><code>0bbin</code></td>
<td style="text-align: center;"><code>b&#39;bin&#39;</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Octal</td>
<td style="text-align: center;">Suffix <code>O</code> or <code>Q</code></td>
<td style="text-align: center;">Prefix <code>@</code></td>
<td style="text-align: center;">Prefix <code>0</code></td>
<td style="text-align: center;"><code>B&#39;...&#39;</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em>Ident</em></td>
<td style="text-align: center;"><code>octo</code> or <code>octq</code></td>
<td style="text-align: center;"><code>@oct</code></td>
<td style="text-align: center;"><code>0oct</code></td>
<td style="text-align: center;"><code>o&#39;oct&#39;</code></td>
</tr>
</tbody>
</table>
<p>In case the numbering system has not been explicitly stated by adding the special control characters listed in the table, AS assumes the base given with the <code>RADIX</code> statement (which has itself 10 as default). This statement allows to set up &#39;unusual&#39; numbering systems, i.e. others than 2, 8, 10, or 16.</p>
<p>Valid digits are numbers from 0 to 9 and letters from A to Z (value 10 to 35) up to the numbering system&#39;s base minus one. The usage of letters in integer constants however brings along some ambiguities since symbol names also are sequences of numbers and letters: a symbol name must not start with a character from 0 to 9. This means that an integer constant which is not clearly marked a such with a special prefix character never may begin with a letter. One has to add an additional, otherwise superfluous zero in front in such cases. The most prominent case is the writing of hexadecimal constants in Intel mode: If the leftmost digit is between A and F, the trailing H doesn&#39;t help anything, an additional 0 has to be prefixed (e.g. 0F0H instead of F0H). The Motorola and C syntaxes, which both mark the numbering system at the front of a constant, do not have this problem.</p>
<p>Quite tricky is furthermore that the higher the default numbering system set via <code>RADIX</code> becomes, the more letters used to denote numbering systems in Intel and C syntax become &#39;eaten&#39;. For example, you cannot write binary constants anymore after a <code>RADIX 16</code> , and starting at <code>RADIX 18</code> , the Intel syntax even doesn&#39;t allow to write hexadecimal constants any more. Therefore <strong>CAUTION!</strong></p>
<p><a href="#pseudo-instructions-and-integer-syntax">Pseudo-Instructions and Integer Syntax</a> lists which syntax is used by which target by default. Independent of this default, there is always the option to add or delete individual syntax variants via the <code>INTSYNTAX</code> instruction (see <a href="#intsyntax">INTSYNTAX</a>). The names listed as <em>Ident</em>, prefixed with a plus or minus sign, serve as arguments to this instruction.</p>
<p>The <code>RELAXED</code> instruction (see <a href="#relaxed">RELAXED</a>) serves as a sort &#39;global enable switch&#39;: in relaxed mode, all notations may be used, independent of the selected target processor. The result is that an arbitrary syntax may be used (possibly loosing compatibility to standard assemblers).</p>
<p>Both <code>INTSYNTAX</code> and <code>RELAXED</code> specifically enable usage of the &#39;IBM syntax&#39; for all targets, which is sometimes found on other assemblers:</p>
<p>This notation puts the actual value into apostrophes and prepends the numbering system (&#39;x&#39; or &#39;h&#39; for hexadecimal, &#39;o&#39; for octal and &#39;b&#39; for binary). So, the integer constant 305419896 can be written in the following ways:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>x<span class="st">&#39;12345678&#39;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>h<span class="st">&#39;12345678&#39;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>o<span class="st">&#39;2215053170&#39;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>b<span class="st">&#39;00010010001101000101011001111000&#39;</span></span></code></pre></div>
<p>Another variant of this notation for some targets is to leave away the closing apostrophe, to allow simpler porting of existing code. It is not recommended for new programs.</p>
<h3 id="floating-point-constants">Floating Point Constants</h3>
<p>Floating point constants are to be written in the usual scientific notation, which is known in the most general form:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>[-]&lt;integer digits<span class="op">&gt;[.</span>post decimal positions<span class="op">][</span>E<span class="op">[-]</span>exponent<span class="op">]</span></span></code></pre></div>
<p><strong>CAUTION!</strong> The assembler first tries to interpret a constant as an integer constant and makes a floating-point format try only in case the first one failed. If someone wants to enforce the evaluation as a floating point number, this can be done by dummy post decimal positions, e.g. <code>2.0</code> instead of <code>2</code> .</p>
<h3 id="string-constants">String Constants</h3>
<p>String constants have to be enclosed in single or double quotation marks. In order to make it possible to include quotation marks or special characters in string constants, an &quot;escape mechanism&quot; has been implemented, which should sound familiar for C programmers:</p>
<p>The assembler understands a backslash ( <code>\</code> ) with a following decimal number of three digits maximum in the string as a character with the according decimal ASCII value. The numerical value may alternatively be written in hexadecimal or octal notation if it is prefixed with an x resp. a 0. In case of hexadecimal notation, the maximum number of digits is limited to 2. For example, it is possible to include an ETC character by writing <code>\3</code> . But be careful with the definition of NUL characters! The C version currently uses C strings to store strings internally. As C strings use a NUL character for termination, the usage of NUL characters in strings is currently not portable!</p>
<p>Some frequently used control characters can also be reached with the following abbreviations:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>\b <span class="op">:</span> Backspace           <span class="op">\</span>a <span class="op">:</span> Bell         <span class="op">\</span>e <span class="op">:</span> Escape</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>\t <span class="op">:</span> Tabulator           <span class="op">\</span>n <span class="op">:</span> Linefeed     <span class="op">\</span>r <span class="op">:</span> Carriage Return</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>\\ : Backslash           <span class="op">\</span><span class="st">&#39; or \H : Apostrophe</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>\&quot; <span class="bu">or</span> <span class="op">\</span>I <span class="op">:</span> Quotation marks</span></code></pre></div>
<p>Both upper and lower case characters may be used for the identification letters.</p>
<p>By means of this escape character, you can even work formula expressions into a string, if they are enclosed by braces: e.g.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>message <span class="st">&quot;root of 81 : \{sqrt(81)}&quot;</span></span></code></pre></div>
<p>results in</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>root of <span class="dv">81</span> <span class="op">:</span> <span class="dv">9</span></span></code></pre></div>
<p>AS chooses with the help of the formula result type the correct output format, further string constants, however, are to be avoided in the expression. Otherwise the assembler will get mixed up at the transformation of capitals into lower case letters. Integer results will by default be written in hexadecimal notation, which may be changed via the <code>OUTRADIX</code> instruction.</p>
<p>Except for the insertion of formula expressions, you can use this &quot;escape-mechanism&quot; as well in ASCII defined integer constants, like this:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>move<span class="op">.</span>b   <span class="op">#</span><span class="st">&#39;\n&#39;</span><span class="op">,</span>d0</span></code></pre></div>
<p>However, everything has its limits, because the parser with higher priority, which disassembles a line into op-code and parameters, does not know what it is actually working with, e.g. here:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>move<span class="op">.</span>l   <span class="op">#</span><span class="st">&#39;\&#39;</span>abc<span class="st">&#39;,d0</span></span></code></pre></div>
<p>After the third apostrophe, it will not find the comma any more, because it presumes that it is the start of a further character constant. An error message about a wrong parameter number is the result. A workaround would be to write e.g., <code>\i</code> instead of <code>\&#39;</code> .</p>
<h3 id="string-to-integer-conversion-and-character-constants">String to Integer Conversion and Character Constants</h3>
<p>Earlier versions of AS strictly distinguished between character strings and so-called &quot;character constants&quot;: At first glance, a character constant looks like a string, the characters are however enclosed in single instead of double quotation marks. Such an object had the data type &#39;Integer&#39;, i.e. it represented a number with the value given by the (ASCII) code of the character, and it was something completely different:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>move<span class="op">.</span>b   <span class="op">#</span><span class="dv">65</span><span class="op">,</span>d0</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>move<span class="op">.</span>b   <span class="op">#</span><span class="st">&#39;A&#39;</span><span class="op">,</span>d0      <span class="co">; equal to first instruction</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>move<span class="op">.</span>b   <span class="op">#</span><span class="st">&quot;A&quot;</span><span class="op">,</span>d0      <span class="co">; not allowed in older versions of AS!</span></span></code></pre></div>
<p>This strict differentiation <em>no longer exists</em>, so it is irrelevant whether single or double quotes are used. If an integer value is expected as argument, and a string is used, the conversion via the character&#39;s (ASCII) value is done &quot;on the fly&quot; at this place. This means that in the example given, <em>all three lines</em> result in the same machine code.</p>
<p>Such an implicit conversion to integer values also take place for strings consisting of multiple constants, which are sometimes called &quot;multi character constants&quot;:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>&#39;A<span class="st">&#39;    ==$41</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>&#39;AB<span class="st">&#39;   ==$4142</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>&#39;ABCD<span class="st">&#39; ==$41424344</span></span></code></pre></div>
<p>Multi character constants are the only case where using single or double quotes still makes a difference. Many targets define pseudo instructions to dispose constants in memory, and which accept different data types. In such a case, it is still necessary to use double quotes if a character string shall be placed in memory:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>dc<span class="op">.</span>w    <span class="st">&quot;ab&quot;</span>  <span class="co">; disposes two words (0x0041,0x0042)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>dc<span class="op">.</span>w    <span class="st">&#39;ab&#39;</span>  <span class="co">; disposes one word (0x4142)</span></span></code></pre></div>
<p>Important: using the correct quotation is not necessary if the character string is longer than the used operand size, which is two characters or 16 bits in this example.</p>
<h3 id="evaluation">Evaluation</h3>
<p>The calculation of intermediary results within formula expressions is always done with the highest available resolution, i.e. 32 or 64 bits for integer numbers, 80 bit for floating point numbers and 255 characters for strings. An possible test of value range overflows is done only on the final result.</p>
<p>The portable C version only supports floating point values up to 64 bits (resulting in a maximum value of roughly 10^308), but in turn features integer lengths of 64 bits on some platforms.</p>
<h3 id="operators">Operators</h3>
<p>The assembler provides the operands listed in the following table for combination.</p>
<!-- markdownlint-disable MD038 -->

<h5 id="table-operators-predefined-by-as"><strong>Table:</strong> Operators Predefined by AS</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">operand</th>
<th style="text-align: left;">function</th>
<th style="text-align: center;">#operands</th>
<th style="text-align: center;">integer</th>
<th style="text-align: center;">float</th>
<th style="text-align: center;">string</th>
<th style="text-align: center;">rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>&lt;&gt;</code></td>
<td style="text-align: left;">inequality</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">14</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>!=</code></td>
<td style="text-align: left;">alias for <code>&lt;&gt;</code></td>
<td style="text-align: center;"><!--  --></td>
<td style="text-align: center;"><!--  --></td>
<td style="text-align: center;"><!--  --></td>
<td style="text-align: center;"><!--  --></td>
<td style="text-align: center;"><!--  --></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>&gt;=</code></td>
<td style="text-align: left;">greater or equal</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">14</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>&lt;=</code></td>
<td style="text-align: left;">less or equal</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">14</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>&lt;</code></td>
<td style="text-align: left;">truly smaller</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">14</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>&gt;</code></td>
<td style="text-align: left;">truly greater</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">14</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>=</code></td>
<td style="text-align: left;">equality</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">14</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>==</code></td>
<td style="text-align: left;">alias for <code>=</code></td>
<td style="text-align: center;"><!--  --></td>
<td style="text-align: center;"><!--  --></td>
<td style="text-align: center;"><!--  --></td>
<td style="text-align: center;"><!--  --></td>
<td style="text-align: center;"><!--  --></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>!!</code></td>
<td style="text-align: left;">log. XOR</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">13</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>||</code></td>
<td style="text-align: left;">log. OR</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>&amp;&amp;</code></td>
<td style="text-align: left;">log. AND</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">11</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>~~</code></td>
<td style="text-align: left;">log. NOT</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>-</code></td>
<td style="text-align: left;">difference</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>+</code></td>
<td style="text-align: left;">sum</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>#</code></td>
<td style="text-align: left;">modulo division</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>/</code></td>
<td style="text-align: left;">quotient</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes*)</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>*</code></td>
<td style="text-align: left;">product</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>^</code></td>
<td style="text-align: left;">power</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>!</code></td>
<td style="text-align: left;">binary XOR</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>|</code></td>
<td style="text-align: left;">binary OR</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>&amp;</code></td>
<td style="text-align: left;">binary AND</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>&gt;&lt;</code></td>
<td style="text-align: left;">mirror of bits</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>&gt;&gt;</code></td>
<td style="text-align: left;">log. shift right</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>&lt;&lt;</code></td>
<td style="text-align: left;">log. shift left</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>~</code></td>
<td style="text-align: left;">binary NOT</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p>*) remainder will be discarded</p>
<!-- markdownlint-enable MD038 -->

<p>&quot;Rank&quot; is the priority of an operator at the separation of expressions into subexpressions. The operator with the highest rank will be evaluated at the very end. The order of evaluation can be defined by new bracketing.</p>
<p>The compare operators deliver TRUE in case the condition fits, and FALSE in case it doesn&#39;t. For the logical operators an expression is TRUE in case it is not 0, otherwise it is FALSE.</p>
<p>The mirroring of bits probably needs a little bit of explanation: the operator mirrors the lowest bits in the first operand and leaves the higher priority bits unchanged. The number of bits which is to be mirrored is given by the right operand and may be between 1 and 32 .</p>
<p>A small pitfall is hidden in the binary complement: As the computation is always done with 32 resp. 64 bits, its application on e.g. 8-bit masks usually results in values that do not fit into 8-bit numbers any more due to the leading ones. A binary AND with a fitting mask is therefore unavoidable!</p>
<h3 id="functions">Functions</h3>
<p>In addition to the operators, the assembler defines another line of primarily transcendental functions with floating point arguments which are listed in this table:</p>
<h5 id="table-functions-predefined-by-as"><strong>Table:</strong> Functions Predefined by AS</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">meaning</th>
<th style="text-align: left;">argument</th>
<th style="text-align: left;">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SQRT</td>
<td style="text-align: left;">square root</td>
<td style="text-align: left;"><em>arg</em> ≥ 0</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="even">
<td style="text-align: left;">SIN</td>
<td style="text-align: left;">sine</td>
<td style="text-align: left;">floating point</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;">COS</td>
<td style="text-align: left;">cosine</td>
<td style="text-align: left;">floating point</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="even">
<td style="text-align: left;">TAN</td>
<td style="text-align: left;">tangent</td>
<td style="text-align: left;"><em>arg</em> ≠ (2<em>n</em>+1) * <em>π</em> / 2</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;">COT</td>
<td style="text-align: left;">cotangent</td>
<td style="text-align: left;"><em>arg</em> ≠ <em>n</em> * <em>π</em></td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="even">
<td style="text-align: left;">ASIN</td>
<td style="text-align: left;">inverse sine</td>
<td style="text-align: left;">∣ <em>arg</em> ∣ ≤ 1</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ACOS</td>
<td style="text-align: left;">inverse cosine</td>
<td style="text-align: left;">∣ <em>arg</em> ∣ ≤ 1</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="even">
<td style="text-align: left;">ATAN</td>
<td style="text-align: left;">inverse tangent</td>
<td style="text-align: left;">floating point</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ACOT</td>
<td style="text-align: left;">inverse cotangent</td>
<td style="text-align: left;">floating point</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="even">
<td style="text-align: left;">EXP</td>
<td style="text-align: left;">exponential function</td>
<td style="text-align: left;">floating point</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ALOG</td>
<td style="text-align: left;">10 power of argument</td>
<td style="text-align: left;">floating point</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="even">
<td style="text-align: left;">ALD</td>
<td style="text-align: left;">2 power of argument</td>
<td style="text-align: left;">floating point</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SINH</td>
<td style="text-align: left;">hyp. sine</td>
<td style="text-align: left;">floating point</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="even">
<td style="text-align: left;">COSH</td>
<td style="text-align: left;">hyp. cosine</td>
<td style="text-align: left;">floating point</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TANH</td>
<td style="text-align: left;">hyp. tangent</td>
<td style="text-align: left;">floating point</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="even">
<td style="text-align: left;">COTH</td>
<td style="text-align: left;">hyp. cotangent</td>
<td style="text-align: left;"><em>arg</em> ≠ 0</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LN</td>
<td style="text-align: left;">nat. logarithm</td>
<td style="text-align: left;"><em>arg</em> &gt; 0</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="even">
<td style="text-align: left;">LOG</td>
<td style="text-align: left;">dec. logarithm</td>
<td style="text-align: left;"><em>arg</em> &gt; 0</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LD</td>
<td style="text-align: left;">bin. logarithm</td>
<td style="text-align: left;"><em>arg</em> &gt; 0</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="even">
<td style="text-align: left;">ASINH</td>
<td style="text-align: left;">inv. hyp. Sine</td>
<td style="text-align: left;">floating point</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ACOSH</td>
<td style="text-align: left;">inv. hyp. Cosine</td>
<td style="text-align: left;"><em>arg</em> ≥ 1</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="even">
<td style="text-align: left;">ATANH</td>
<td style="text-align: left;">inv. hyp. Tangent</td>
<td style="text-align: left;"><em>arg</em> &lt; 1</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ACOTH</td>
<td style="text-align: left;">inv. hyp. Cotangent</td>
<td style="text-align: left;"><em>arg</em> &gt; 1</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="even">
<td style="text-align: left;">INT</td>
<td style="text-align: left;">integer part</td>
<td style="text-align: left;">floating point</td>
<td style="text-align: left;">floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BITCNT</td>
<td style="text-align: left;">number of one&#39;s</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">FIRSTBIT</td>
<td style="text-align: left;">lowest 1-bit</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LASTBIT</td>
<td style="text-align: left;">highest 1-bit</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">BITPOS</td>
<td style="text-align: left;">unique 1-bit</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SGN</td>
<td style="text-align: left;">sign (0/1/-1)</td>
<td style="text-align: left;">floating point or integer</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABS</td>
<td style="text-align: left;">absolute value</td>
<td style="text-align: left;">integer or floating point</td>
<td style="text-align: left;">integer or floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TOUPPER</td>
<td style="text-align: left;">matching capital</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">TOLOWER</td>
<td style="text-align: left;">matching lower case</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">UPSTRING</td>
<td style="text-align: left;">changes all characters into capitals</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="even">
<td style="text-align: left;">LOWSTRING</td>
<td style="text-align: left;">changes all characters into lower case</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="odd">
<td style="text-align: left;">STRLEN</td>
<td style="text-align: left;">returns the length of a string</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">SUBSTR</td>
<td style="text-align: left;">extracts parts of a string</td>
<td style="text-align: left;">string, integer, integer</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CHARFROMSTR</td>
<td style="text-align: left;">extracts a character from a string</td>
<td style="text-align: left;">string, integer</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">STRSTR</td>
<td style="text-align: left;">searches a substring in a string</td>
<td style="text-align: left;">string, string</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VAL</td>
<td style="text-align: left;">evaluates contents as expression</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">depends on argument</td>
</tr>
<tr class="even">
<td style="text-align: left;">EXPRTYPE</td>
<td style="text-align: left;">delivers type of argument</td>
<td style="text-align: left;">integer, float, or string</td>
<td style="text-align: left;">integer = 0, float = 1, string = 2</td>
</tr>
</tbody>
</table>
<p>The functions <code>FIRSTBIT</code> , <code>LASTBIT</code> , and <code>BITPOS</code> return -1 as result if no resp. not exactly one bit is set. <code>BITPOS</code> additionally issues an error message in such a case.</p>
<p>The string function <code>SUBSTR</code> expects the source string as first parameter, the start position as second and the number of characters to be extracted as third parameter (a 0 means to extract all characters up to the end). Similarly, <code>CHARFROMSTR</code> expects the source string as first argument and the character position as second argument. In case the position argument is larger or equal to the source string&#39;s length, <code>SUBSTR</code> returns an empty string while <code>CHARFROMSTR</code> returns -1. A position argument smaller than zero is treated as zero by <code>SUBSTR</code> , while <code>CHARFROMSTR</code> will return -1 also in this case.</p>
<p>Here is an example how to use these both functions. The task is to put a string into memory, with the string end being signified by a set MSB in the last character:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dbstr   macro   arg</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>        <span class="pp">if</span>      strlen<span class="op">(</span>arg<span class="op">)</span> <span class="op">&gt;</span> <span class="dv">1</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>         <span class="dt">db</span>     substr<span class="op">(</span>arg<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> strlen<span class="op">(</span>arg<span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>        endif</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>        <span class="pp">if</span>      strlen<span class="op">(</span>arg<span class="op">)</span> <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>         <span class="dt">db</span>     charfromstr<span class="op">(</span>arg<span class="op">,</span> strlen<span class="op">(</span>arg<span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">|</span> <span class="bn">80h</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        endif</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p><code>STRSTR</code> returns the first occurrence of the second string within the first one resp. -1 if the search pattern was not found. Similarly to <code>SUBSTR</code> and <code>CHARFROMSTR</code> , the first character has the position 0.</p>
<p>If a function expects floating point arguments, this does not mean it is impossible to write e.g.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>sqr2 equ sqrt<span class="op">(</span><span class="dv">2</span><span class="op">)</span></span></code></pre></div>
<p>In such cases an automatic type conversion is engaged. In the reverse case the <code>INT</code> -function has to be applied to convert a floating point number to an integer. When using this function, you have to pay attention that the result produced always is a signed integer and therefore has a value range of approximately +/-2.0E9.</p>
<p>When AS is switched to case-sensitive mode, predefined functions may be accessed with an arbitrary combination of upper and lower case (in contrast to predefined symbols). However, in the case of user-defined functions (see <a href="#function">FUNCTION</a>), a distinction between upper and lower case is made. This has e.g. the result that if one defines a function <code>Sin</code> , one can afterwards access this function via <code>Sin</code> , but all other combinations of upper and lower case will lead to the predefined function.</p>
<h2 id="forward-references-and-other-disasters">Forward References and Other Disasters</h2>
<p>This section is the result of a significant amount of hate on the (legal) way some people program. This way can lead to trouble in conjunction with AS in some cases. The section will deal with so-called &#39;forward references&#39;. What makes a forward reference different from a usual reference? To understand the difference, take a look at the following programming example (please excuse my bias for the 68000 family that is also present in the rest of this manual):</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>        move<span class="op">.</span>l  <span class="op">#</span><span class="dv">10</span><span class="op">,</span>d0</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loop:</span>   move<span class="op">.</span>l  <span class="op">(</span>a1<span class="op">),</span>d1</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>        beq     skip</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">neg</span><span class="op">.</span>l   d1</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">skip:</span>   move<span class="op">.</span>l  d1<span class="op">,(</span>a1<span class="op">+)</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        dbra    d0<span class="op">,</span>loop</span></code></pre></div>
<p>If one overlooks the loop body with its branch statement, a program remains that is extremely simple to assemble: the only reference is the branch back to the body&#39;s beginning, and as an assembler processes a program from the beginning to the end, the symbol&#39;s value is already known before it is needed the first time. If one has a program that only contains such backward references, one has the nice situation that only one pass through the source code is needed to generate a correct and optimal machine code. Some high level languages like Pascal with their strict rule that everything has to be defined before it is used exploit exactly this property to speed up the compilation.</p>
<p>Unfortunately, things are not that simple in the case of assembler, because one sometimes has to jump forward in the code or there are reasons why one has to move variable definitions behind the code. For our example, this is the case for the conditional branch that is used to skip over another instruction. When the assembler hits the branch instruction in the first pass, it is confronted with the situation of either leaving blank all instruction fields related to the target address or offering a value that &quot;hurts no one&quot; via the formula parser (which has to evaluate the address argument). In case of a &quot;simple&quot; assembler that supports only one target architecture with a relatively small number of instructions to treat, one will surely prefer the first solution, but the effort for AS with its dozens of target architectures would have become extremely high. Only the second way was possible: If an unknown symbol is detected in the first pass, the formula parser delivers the program counter&#39;s current value as result! This is the only value suitable to offer an address to a branch instruction with unknown distance length that will not lead to errors. This answers also a frequently asked question why a first-pass listing (it will not be erased e.g. when AS does not start a second pass due to additional errors) partially shows wrong addresses in the generated binary code - they are the result of unresolved forward references.</p>
<p>The example listed above however uncovers an additional difficulty of forward references: Depending on the distance of branch instruction and target in the source code, the branch may be either long or short. The decision however about the code length - and therefore about the addresses of following labels - cannot be made in the first pass due to missing knowledge about the target address. In case the programmer did not explicitly mark whether a long or short branch shall be used, genuine 2-pass assemblers like older versions of MASM from Microsoft &quot;solve&quot; the problem by reserving space for the longest version in the first pass (all label addresses have to be fixed after the first pass) and filling the remaining space with <code>NOP</code> s in the second pass. AS versions up to 1.37 did the same before I switched to the multipass principle that removes the strict separation into two passes and allows an arbitrary number of passes. Said in detail, the optimal code for the assumed values is generated in the first pass. In case AS detects that values of symbols changed in the second pass due to changes in code lengths, simply a third pass is done, and as the second passes&#39; new symbol values might again shorten or lengthen the code, a further pass is not impossible. I have seen 8086 programs that needed 12 passes to get everything correct and optimal. Unfortunately, this mechanism does not allow to specify a maximum number passes; I can only advise that the number of passes goes down when one makes more use of explicit length specifications.</p>
<p>Especially for large programs, another situation might arise: the position of a forward directed branch has moved so much in the second pass relative to the first pass that the old label value still valid is out of the allowed branch distance. AS knows of such situations and suppresses all error messages about too long branches when it is clear that another pass is needed. This works for 99% of all cases, but there are also constructs where the first critical instruction appears so early that AS had no chance up to now to recognize that another pass is needed. The following example constructs such a situation with the help of a forward reference (and was the reason for this section&#39;s heading...):</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>        cpu   <span class="dv">6811</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">org</span>     <span class="op">$</span><span class="bn">8000</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>        beq     skip</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>        <span class="pp">rept</span>    <span class="dv">60</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        ldd     Var</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>        endm</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">skip:</span>   <span class="bu">nop</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>Var     equ     <span class="op">$</span><span class="bn">10</span></span></code></pre></div>
<p>Due to the address position, AS assumes long addresses in the first pass for the <code>LDD</code> instructions, what results in a code length of 180 bytes and an out of branch error message in the second pass (at the point of the <code>BEQ</code> instruction, the old value of <code>skip</code> is still valid, i.e. AS does not know at this point that the code is only 120 bytes long in reality) is the result. The error can be avoided in three different ways:</p>
<ol type="1">
<li><p>Explicitly tell AS to use short addressing for the <code>LDD</code> instructions (<code>ldd &lt;Var</code>)</p></li>
<li><p>Remove this damned, rotten forward reference and place the <code>EQU</code> statement at the beginning where it has to be (all right, I&#39;m already calming down...)</p></li>
<li><p>For real die-hards: use the <code>-Y</code> command line option. This option tells AS to forget the error message when the address change has been detected. Not pretty, but...</p></li>
</ol>
<p>Another tip regarding the <code>EQU</code> instruction: AS cannot know in which context a symbol defined with <code>EQU</code> will be used, so an <code>EQU</code> containing forward references will not be done at all in the first pass. Thus, if the symbol defined with <code>EQU</code> gets forward-referenced in the second pass:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>        move<span class="op">.</span>l  <span class="op">#</span>sym2<span class="op">,</span>d0</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>        sym2    equ     sym1<span class="op">+</span><span class="dv">5</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>        sym1    equ     <span class="dv">0</span></span></code></pre></div>
<p>one gets an error message due to an undefined symbol in the second pass...but why on earth do people do such things?</p>
<p>Admittedly, this was quite a lengthy excursion, but I thought it was necessary. Which is the essence you should learn from this section?</p>
<ol type="1">
<li><p>AS always tries to generate the shortest code possible. A finite number of passes is needed for this. If you do not tweak AS extremely, AS will know no mercy...</p></li>
<li><p>Whenever sensible and possible, explicitly specify branch and address lengths. There is a chance of significantly reducing the number of passes by this.</p></li>
<li><p>Limit forward references to what is absolutely needed. You make your and AS&#39;s live much easier this way!</p></li>
</ol>
<h2 id="register-symbols">Register Symbols</h2>
<p><em>valid for: PowerPC, M-Core, XGate, 4004/4040, MCS-48/(2)51, 80C16x, AVR, XS1, Z8, KCPSM, Mico8, MSP430(X), ST9, M16, M16C, H8/300, H8/500, SH7x00, H16, i960, XA, 29K, TLCS-9000, KENBAK</em></p>
<p>Sometimes it is desirable not only to assign symbolic names to memory addresses or constants, but also to a register, to emphasize its function in a certain program section. This is no problem for processors that treat registers simply as another address space, as this allows to use numeric expressions and one can use simple <code>EQU</code>s to define such symbols. (e.g. for the MCS-96 or TMS70000). However, for most processors, register identifiers are fixed literals which are separately treated by AS for speed reasons. Therefore, registers symbols (sometime also called &#39;register aliases&#39;) are also a separate type of symbols in the symbol table. Just like other symbols, they may be defined or re-defined with <code>EQU</code> or <code>SET</code>, and there is a specialized <code>REG</code> instruction which accepts only symbols and expressions of this type.</p>
<p>On the other hand, register symbols are subject of a couple of restrictions: the number of literals is limited and depends on the selected target processor, and arithmetic operations are not possible on registers A construct like this:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>myreg   reg     r17         <span class="co">; definition of register symbol</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>        addi    myreg<span class="op">+</span><span class="dv">1</span><span class="op">,</span><span class="dv">3</span>   <span class="co">; does not work!</span></span></code></pre></div>
<p>is <em>not</em> valid. Simple assignments are however possible:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>myreg   reg     r17         <span class="co">; definition of register symbol</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>myreg2  reg     myreg       <span class="co">; myreg2 -&gt; r17</span></span></code></pre></div>
<p>Furthermore, forward references are even more critical than for other types of symbols. If a symbol is not (yet) defined, AS does not know which type it is going to have,a nd will decide for a plain integer number. For most target processors, a number is the equivalent of absolute memory addressing, and on most processors, usage of memory operands is more limited than of registers. Depending on situation, one will get an error message about a non-allowed addressing mode, and no second pass will be started...</p>
<p>Analogous to ordinary symbols, register symbols are local to sections and it is possible to access a register symbol from a specific section by appending the section&#39;s name enclosed in brackets.</p>
<h2 id="share-file">Share File</h2>
<p>This function is a by-product from the old pure-68000 predecessors of AS, I have kept them in case someone really needs it. The basic problem is to access certain symbols produced during assembly, because possibly someone would like to access the memory of the target system via this address information. The assembler allows to export symbol values by means of <code>SHARED</code> pseudo commands (see there). For this purpose, the assembler produces a text file with the required symbols and its values in the second pass. This file may be included into a higher-level language or another assembler program. The format of the text file (C, Pascal or Assembler) can be set by the command line switches <code>p, c</code> or, <code>a</code>.</p>
<p><strong>CAUTION!</strong> If none of the switches is given, no file will be generated and it makes no difference if <code>SHARED</code>-commands are in the source text or not!</p>
<p>When creating a Sharefile, AS does not check if a file with the same name already exists, such a file will be simply overwritten. In my opinion a request does not make sense, because AS would ask at each run if it should overwrite the old version of the Sharefile, and that would be really annoying...</p>
<h2 id="processor-aliases">Processor Aliases</h2>
<p>Common microcontroller families are like rabbits: They become more at a higher speed than you can provide support for them. Especially the development of processor cores as building blocks for ASICs and of microcontroller families with user-definable peripherals has led to a steeply rising number of controllers that only deviate from a well-known type by a slightly modified peripheral set. But the distinction among them is still important, e.g. for the design of include files that only define the appropriate subset of peripherals. I have struggled up to now to integrate the most important representatives of a processor family into AS (and I will continue to do this), but sometimes I just cannot keep pace with the development...there was an urgent need for a mechanism to extend the list of processors by the user.</p>
<p>The result are processor aliases: the alias command line option allows to define a new processor type, whose instruction set is equal to another processor built into AS. After switching to this processor via the <code>CPU</code> instruction, AS behaves exactly as if the original processor had been used, with a single difference: the variables <code>MOMCPU</code> resp. <code>MOMCPUNAME</code> are set to the alias name, which allows to use the new name for differentiation, e.g. in include files.</p>
<p>There were two reasons to realize the definition of aliases by the command line and not by pseudo instructions: first, it would anyway be difficult to put the alias definitions together with register
definitions into a single include file, because a program that wants to use such a file would have to include it before and after the CPU instruction - an imagination that lies somewhere between inelegant and impossible. Second, the definition in the command line allows to put the definitions in a key file that is executed automatically at startup via the <code>ASCMD</code> variable, without a need for the program to take any further care about this.</p>
<!-- markdownlint-enable MD036 -->

<!-- markdownlint-enable MD030 -->

<!-- markdownlint-enable MD025 -->

<!-- markdownlint-enable MD001 -->

<h1 id="pseudo-instructions">Pseudo Instructions</h1>
<!-- markdownlint-disable MD025 -->

<!-- markdownlint-disable MD030 -->

<!-- markdownlint-disable MD036 -->

<p>Not all pseudo instructions are defined for all processors. A note that shows the range of validity is therefore prepended to every individual description.</p>
<h2 id="definitions">Definitions</h2>
<h3 id="set-equ-and-constant">SET, EQU, and CONSTANT</h3>
<p><em>valid for: all processors, <code>CONSTANT</code> only for KCPSM(3)</em></p>
<p><code>SET</code> and <code>EQU</code> allow the definition of typeless constants, i.e. they will not be assigned to a segment and their usage will not generate warnings because of segment mixing. <code>EQU</code> defines constants which can not be modified (by <code>EQU</code>) again, but <code>SET</code> permits the definition of variables, which can be modified during the assembly. This is useful e.g. for the allocation of resources like interrupt vectors, as shown in the following example:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>VecCnt  set     <span class="dv">0</span>       <span class="co">; somewhere at the beginning</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>DefVec  macro   Name    <span class="co">; allocate a new vector</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>Name    equ     VecCnt</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>VecCnt  set     VecCnt<span class="op">+</span><span class="dv">4</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>        endm</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>        DefVec  Vec1    <span class="co">; results in Vec1=0</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>        DefVec  Vec2    <span class="co">; results in Vec2=4</span></span></code></pre></div>
<p>constants and variables are internally stored in the same way, the only difference is that they are marked as unchangeable if defined via <code>EQU</code>. Trying to change a constant with <code>SET</code> will result in an error message.</p>
<p><code>EQU/SET</code> allow to define constants of all possible types, e.g.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>        IntTwo   equ    <span class="dv">2</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>        FloatTwo equ    <span class="fl">2.0</span></span></code></pre></div>
<p>Some processors unfortunately have already a <code>SET</code> instruction. For these targets, <code>EVAL</code> must be used instead of <code>SET</code> if no differentiation via the argument count is possible.</p>
<p>A simple equation sign may be used instead of <code>EQU</code>. Similarly, one may simply write <code>:=</code> instead of <code>SET</code> resp. <code>EVAL</code>. Furthermore, there is an &#39;alternate&#39; syntax that does not take the symbol&#39;s name from the label field, but instead from the first argument. So for instance, it is valid to write:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>        <span class="pp">EQU</span>   IntTwo<span class="op">,</span><span class="dv">2</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>        <span class="pp">EQU</span>   FloatTwo<span class="op">,</span><span class="fl">2.0</span></span></code></pre></div>
<p>For compatibility reasons to the original assembler, the KCPSM target also knows the <code>CONSTANT</code> statement, which - in contrast to <code>EQU</code> - takes both name and value as argument. For example:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>        CONSTANT  const1<span class="op">,</span> <span class="dv">2</span></span></code></pre></div>
<p><code>CONSTANT</code> is however limited to integer constants.</p>
<p>Symbols defined with <code>SET</code> or <code>EQU</code> are typeless by default, but optionally a segment name (<code>CODE, DATA, IDATA, XDATA, YDATA, BITDATA, IO</code>, or <code>REG</code>) or <code>MOMSEGMENT</code> for the currently active segment may be given as a second or third parameter, allowing to assign the symbol to a specific address space. AS does not check at this point if the used address space exists on the currently active target processor!</p>
<p>A little hidden extra feature allows to set the program counter via <code>SET</code> or <code>EQU</code>, something one would ordinarily do via <code>ORG</code>. To accomplish this, use the special value as symbol name that may also be used to query the current program counter&#39;s value. Depending on the selected target architecture, this is either an asterisk, a dollar sign or <code>PC</code>.</p>
<p>In case the target architecture supports instruction attributes to define the operand size (e.g. on 680x0), those are also allowed for <code>SET</code> and <code>EQU</code>. The operand size will be stored along with the symbol&#39;s value in the symbol table. Its use is architecture-dependant.</p>
<h3 id="sfr-and-sfrb">SFR and SFRB</h3>
<p><em>valid for: various, <code>SFRB</code> only MCS-51</em></p>
<p>These instructions act like <code>EQU</code>, but symbols defined with them are assigned to the directly addressable data resp. I/O segment, i.e. they are preferably used for the definition of (as the name lets guess) hardware registers mapped into the data res. I/O area. The allowed range of values is equal to the range allowed for <code>ORG</code> in the data segment (see <a href="#org">ORG</a>). The difference between <code>SFR</code> and <code>SFRB</code> is that <code>SFRB</code> marks the register as bit addressable, which is why AS generates 8 additional symbols which will be assigned to the bit segment and carry the names xx.0 to xx.7, e.g.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>    PSW     sfr     <span class="bn">0d0h</span>    <span class="co">; results in PSW = D0H (data segment)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    PSW     sfrb    <span class="bn">0d0h</span>    <span class="co">; results in extra PSW.0 = D0H (bit)</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                            <span class="co">;               to PSW.7 = D7H (bit)</span></span></code></pre></div>
<p>The <code>SFRB</code> instruction is not any more defined for the 80C251 as it allows direct bit access to all SFRs without special bit symbols; bits like <code>PSW.0</code> to <code>PSW.7</code> are automatically present.</p>
<p>Whenever a bit-addressable register is defined via <code>SFRB</code>, AS checks if the memory address is bit addressable (range 20h...3fh resp. 80h, 88h, 90h, 98h...0f8h). If it is not bit-addressable, a warning is issued and the generated bit symbols are undefined.</p>
<h3 id="xsfr-and-ysfr">XSFR and YSFR</h3>
<p><em>valid for: DSP56xxx</em></p>
<p>Also the DSP56000 has a few peripheral registers memory-mapped to the RAM, but the affair becomes complicated because there are two data areas, the X- and Y-area. This architecture allows on the one hand a higher parallelism, but forces on the other hand to divide the normal <code>SFR</code> instruction into the two above mentioned variations. They works identically to <code>SFR</code>, just that <code>XSFR</code> defines a symbol in the X- addressing space and YSFR a corresponding one in the Y-addressing space. The allowed value range is 0...$ffff.</p>
<h3 id="label">LABEL</h3>
<p><em>valid for: all processors</em></p>
<p>The function of the <code>LABEL</code> instruction is identical to <code>EQU</code>, but the symbol does not become typeless, it gets the attribute &quot;code&quot;. <code>LABEL</code> is needed exactly for one purpose: Labels are normally local in macros, that means they are not accessible outside of a macro. With an <code>EQU</code> instruction you could get out of it nicely, but the phrasing</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>&lt;name<span class="op">&gt;</span>  label   <span class="op">$</span></span></code></pre></div>
<p>generates a symbol with correct attributes.</p>
<h3 id="bit">BIT</h3>
<p><em>valid for: MCS/(2)51, XA, 80C166, 75K0, ST9, AVR, S12Z, SX20/28, H16, H8/300, H8/500, KENBAK, Padauk</em></p>
<p><code>BIT</code> serves to equate a single bit of a memory cell with a symbolic name. This instruction varies from target platform to target platform due to the different ways in which processors handle bit manipulation and addressing:</p>
<p>The MCS/51 family has an own address space for bit operands. The function of <code>BIT</code> is therefore quite similar to <code>SFR</code>, i.e. a simple integer symbol with the specified value is generated and assigned to the <code>BDATA</code> segment. For all other processors, bit addressing is done in a two-dimensional fashion with address and bit position. In these cases, AS packs both parts into an integer symbol in a way that depends on the currently active target processor and separates both parts again when the symbol is used. The latter is is also valid for the 80C251: While an instruction like</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>    My_Carry bit    PSW<span class="op">.</span><span class="dv">7</span></span></code></pre></div>
<p>would assign the value 0d7h to <code>My_Carry</code> on an 8051, a value of 070000d0h would be generated on an 80C251, i.e. the address is located in bits 0...7 and the bit position in bits 24...26. This procedure is equal to the way the <code>DBIT</code> instruction handles things on a TMS370 and is also used on the 80C166, with the only difference that bit positions may range from 0...15:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>    MSB     BIT     r5<span class="op">.</span><span class="dv">15</span></span></code></pre></div>
<p>On a Philips XA, the bit&#39;s address is located in bits 0...9 just with the same coding as used in machine instructions, and the 64K bank of bits in RAM memory is placed in bits 16...23.</p>
<p>The <code>BIT</code> instruction of the 75K0 family even goes further: As bit expressions may not only use absolute base addresses, even expressions like</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>    bit1    BIT     <span class="fu">@</span><span class="er">h</span><span class="op">+</span><span class="fl">5.2</span></span></code></pre></div>
<p>are allowed.</p>
<p>The ST9 in turn allows to invert bits, what is also allowed in the <code>BIT</code> instruction:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>    invbit  BIT     r6<span class="op">.!</span><span class="dv">3</span></span></code></pre></div>
<p>More about the ST9&#39;s <code>BIT</code> instruction can be found in the processor specific hints.</p>
<p>In case of H16, note that the address and bit position arguments are swapped. This was done to make the syntax of BIT consistent with the machine instructions that manipulate individual bits.</p>
<h3 id="dbit">DBIT</h3>
<p><em>valid for: TMS 370xxx</em></p>
<p>Though the TMS370 series does not have an explicit bit segment, single bit symbols may be simulated with this instruction. <code>DBIT</code> requires two operands, the address of the memory cell that contains the bit and the exact position of the bit in the byte. For example,</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="bu">INT3</span>        EQU  P019</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>INT3_ENABLE DBIT <span class="dv">0</span><span class="op">,</span>INT3</span></code></pre></div>
<p>defines the bit that enables interrupts via the INT3 pin. Bits defined this way may be used in the instructions <code>SBIT0, SBIT1, CMPBIT, JBIT0</code>, and <code>JBIT</code>.</p>
<h3 id="defbit-and-defbitb">DEFBIT and DEFBITB</h3>
<h4 id="s12z">S12Z</h4>
<p>The S12Z family&#39;s processor core provides instructions to manipulate individual bits in registers or memory cells. To conveniently address bits in the CPU&#39;s I/O area (first 4 Kbytes of the address space), a bit may be given a symbolic name. The bit is defined by its memory address and the bit position:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>&lt;name<span class="op">&gt;</span>         defbit<span class="op">[.</span>size<span class="op">]</span>   <span class="op">&lt;</span>address<span class="op">&gt;,&lt;</span>position<span class="op">&gt;</span></span></code></pre></div>
<p>The <code>address</code> must be located within the first 4 Kbytes, and the operand size may be 8, 16, or 32 bits (<code>size</code>=b/w/l). Consequently, the <code>position</code> may at most be 7, 15 or 31. If no operand size is given, byte size (.b) is assumed. A bit defined this way may be used as argument for the instructions <code>BCLR, BSET, BTGL, BRSET,</code> and <code>BRCLR</code>:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>mybit   defbit<span class="op">.</span>b  <span class="op">$</span><span class="bn">200</span><span class="op">,</span><span class="dv">4</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>        bclr<span class="op">.</span>b    <span class="op">$</span><span class="bn">200</span><span class="op">,#</span><span class="dv">4</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>        bclr      mybit</span></code></pre></div>
<p>Both uses of <code>bclr</code> in this example generate identical code. Since a bit defined this way &quot;knows&quot; its size, the size attribute may be omitted when using it.</p>
<p>It is also possible to define bits that are located within a structure&#39;s element:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>mystruct struct    dots</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>reg      <span class="kw">ds</span><span class="op">.</span>w      <span class="dv">1</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>flag     defbit    reg<span class="op">,</span><span class="dv">4</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>        ends</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">org</span>       <span class="op">$</span><span class="bn">100</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="bu">data</span>     mystruct</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>        bset      data<span class="op">.</span>flag  <span class="co">; same as bset.w $100,#4</span></span></code></pre></div>
<h4 id="super8">Super8</h4>
<p>Opposed to the &#39;classic&#39; Z8, the Super8 core supports instructions to operate on bits in working or general registers. ONe however has to to regard that some of them can only operate on bits in one of the 16 working registers. The <code>DEFBIT</code> instruction allows to define bits of either type:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>workbit defbit  r3<span class="op">,#</span><span class="dv">4</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>slow    defbit  emt<span class="op">,#</span><span class="dv">6</span></span></code></pre></div>
<p>Bits that have been defined this way may be used just like a argument duple of register and bit position:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>        ldb     r3<span class="op">,</span>emt<span class="op">,#</span><span class="dv">6</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>        ldb     r3<span class="op">,</span>slo          <span class="co">; same result</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>        bitc    r3<span class="op">,#</span><span class="dv">4</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>        bitc    workbit         <span class="co">; same result</span></span></code></pre></div>
<h4 id="z8000">Z8000</h4>
<p>The Z8000 features instructions to set and clear bits, however they cannot access addresses in I/O space. For this reason, both <code>DEFBIT</code> and <code>DEFBITB</code> only allow to define bit objects in memory space. The differentiation in operand size is important because the Z8000 is a big endian processor: bit <em>n</em> of a 16 bit word at address <em>m</em> corresponds to bit <em>n</em> of an 8-bit byte at address <em>m+1</em>.</p>
<h3 id="defbitfield">DEFBITFIELD</h3>
<p><em>valid for: S12Z</em></p>
<p>The S12Z family&#39;s CPU core not only deals with individual bits, it is also able to extract a field of consecutive bits from an 8/16/24/32 value or to insert a bit field into such a value. Similar to <code>DEFBIT</code>, a bit field may be defined symbolically:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>&lt;Name<span class="op">&gt;</span>     defbitfield<span class="op">[.</span>size<span class="op">]</span> <span class="op">&lt;</span>address<span class="op">&gt;,&lt;</span>width<span class="op">&gt;:&lt;</span>position<span class="op">&gt;</span></span></code></pre></div>
<p>Opposed to individual bits, an operand size of 24 bits (.p) is also allowed. The range of <code>position</code> and <code>width</code> is accordingly 0 to 23 resp. 1 to 24. It is also allowed to define bit fields as parts of structures:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mystruct struct      dots</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>reg      <span class="kw">ds</span><span class="op">.</span>w        <span class="dv">1</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>clksel   defbitfield reg<span class="op">,</span><span class="dv">4</span><span class="op">:</span><span class="dv">8</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>        ends</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">org</span>       <span class="op">$</span><span class="bn">100</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="bu">data</span>     mystruct</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>        bfext     d2<span class="op">,</span>data<span class="op">.</span>clksel <span class="co">; fetch $100.w bits 4...11</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>                                <span class="co">; to D2 bits 0...7</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>        bfins     data<span class="op">.</span>clksel<span class="op">,</span>d2 <span class="co">; insert D2 bits 0...7 into</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>                                <span class="co">; $100.w bits 4...11</span></span></code></pre></div>
<p>The internal representation of bits defined via <code>DEFBIT</code> is equivalent to bit fields with a width of one. Therefore, a symbolically defined bit may also be used as argument for <code>BFINS</code> and <code>BFEXT</code>.</p>
<h3 id="port">PORT</h3>
<p><em>valid for: 8008/8080/8085/8086, XA, Z80, Z8000, 320C2x/5x, TLCS-47, AVR, F8</em></p>
<p><code>PORT</code> works similar to <code>EQU</code>, just the symbol becomes assigned to the I/O-address range. Allowed values are 0...7 for the 3201x and 8008, 0...15 for the 320C2x, 0...65535 for the 8086, Z8000, and 320C5x, 0...63 for the AVR, and 0...255 for the rest.</p>
<p>Example : an 8255 PIO is located at address 20H:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>PIO_port_A port <span class="bn">20h</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>PIO_port_B port PIO_port_A<span class="op">+</span><span class="dv">1</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>PIO_port_C port PIO_port_A<span class="op">+</span><span class="dv">2</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>PIO_ctrl   port PIO_port_A<span class="op">+</span><span class="dv">3</span></span></code></pre></div>
<h3 id="reg-and-namereg">REG and NAMEREG</h3>
<p><em>valid for: 680x0, AVR, M*Core, ST9, 80C16x, Z8000, KCPSM (<code>NAMEREG</code> valid only for KCPSM(3)), LatticeMico8, MSP430(X)</em>
Though it always has the same syntax, this instruction has a slightly different meaning from processor to processor: If the processor uses a separate addressing space for registers, <code>REG</code> has the same effect as a simple <code>EQU</code> for this address space (e.g. for the ST9). <code>REG</code> defines register symbols for all other processors whose function is described in <a href="#register-symbols">Register Symbols</a>.</p>
<p><code>NAMEREG</code> exists for compatibility reasons to the original KCPSM assembler. It has an identical function, however both register and symbolic name are given as arguments, for example:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>        NAMEREG  s08<span class="op">,</span> treg</span></code></pre></div>
<h3 id="liv-and-riv">LIV and RIV</h3>
<p><em>valid for: 8X30x</em></p>
<p><code>LIV</code> and <code>RIV</code> allow to define so-called &quot;IV bus objects&quot;. These are groups of bits located in a peripheral memory cell with a length of 1 up to 8 bits, which can afterwards be referenced symbolically. The result is that one does not anymore have to specify address, position, and length separately for instructions that can refer to peripheral bit groups. As the 8X30x processors feature two peripheral address spaces (a &quot;left&quot; and a &quot;right&quot; one), there are two separate pseudo instructions. The parameters of these instructions are however equal: three parameters have to be given that specify address, start position and length. Further hints for the usage of bus objects can be found in <a href="#8x30x">8X30x</a>.</p>
<h3 id="charset">CHARSET</h3>
<p><em>valid for: all processors</em></p>
<p>Single board systems, especially when driving LCDs, frequently use character sets different to ASCII. So it is probably purely coincidental that the umlaut coding corresponds with the one used by the PC. To avoid error-prone manual encoding, the assembler contains a translation table for characters which assigns a target character to each source-code. To modify this table (which initial translates 1:1), one has to use the <code>CHARSET</code> instruction. <code>CHARSET</code> may be used with different numbers and types of parameters. If there is only a single parameter, it has to be a string expression which is interpreted as a file name by AS. AS reads the first 256 bytes from this table and copies them into the translation table. This allows to activate complex, externally generated tables with a single statement. For all other variants, the first parameter has to be an integer in the range of 0 to 255 which designates the start index of the entries to be modified in the translation table. One or two parameters follow, giving the type of modification:</p>
<p>A single additional integer modifies exactly one entry. For example,</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>        CHARSET <span class="st">&#39;ä&#39;</span><span class="op">,</span><span class="dv">128</span></span></code></pre></div>
<p>means that the target system codes the &#39;ä&#39; into the number 128 (80H). If however two more integers are given, the first one describes the last entry to be modified, and the second the new value of the first table entry. All entries up to the index end are loaded sequentially. For example, in case that the target system does not support lower-case characters, a simple</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>        CHARSET <span class="st">&#39;a&#39;</span><span class="op">,</span><span class="st">&#39;z&#39;</span><span class="op">,</span><span class="st">&#39;A&#39;</span></span></code></pre></div>
<p>translates all lower-case characters automatically into the matching capital letters.</p>
<p>For the last variant, a string follows the start index and contains the characters to be placed in the table. The last example therefore may also be written as</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>        CHARSET <span class="st">&#39;a&#39;</span><span class="op">,</span><span class="st">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span></code></pre></div>
<p><code>CHARSET</code> may also be called without any parameters, which however has a drastic effect: the translation table is reinitialized to its initial state, i.e. all character translations are removed.</p>
<p><strong>CAUTION!</strong> <code>CHARSET</code> not only affects string constants stored in memory, but also integer constants written as &quot;ASCII&quot;. This means that an already modified translation table can lead to other results in the above mentioned examples!</p>
<h3 id="codepage">CODEPAGE</h3>
<p><em>valid for: all processors</em></p>
<p>Though the <code>CHARSET</code> statement gives unlimited freedom in the character assignment between host and target platform, switching among different character <em>sets</em> can become quite tedious if several character sets have to be supported on the target platform. The <code>CODEPAGE</code> instruction however allows to define and keep different character sets and to switch with a single statement among them. <code>CODEPAGE</code> expects one or two arguments: the name of the set to be used hereafter and optionally the name of another table that defines its initial contents (the second parameter therefore only has a meaning for the first switch to the table when AS automatically creates it). If the second parameter is missing, the initial contents of the new table are copied from the previously active set. All subsequent <code>CHARSET</code> statements <em>only</em> modify the new set.</p>
<p>At the beginning of a pass, AS automatically creates a single character set with the name <code>STANDARD</code> with a one-to-one translation. If no <code>CODEPAGE</code> instructions are used, all settings made via <code>CHARSET</code> refer to this table.</p>
<h3 id="enum-nextenum-and-enumconf">ENUM, NEXTENUM, and ENUMCONF</h3>
<p><em>valid for: all processors</em></p>
<p>Similar to the same-named instruction known from C, <code>ENUM</code> is used to define enumeration types, i.e. a sequence of integer constants that are assigned sequential values starting at 0. The parameters are the names of the symbols, like in the following example:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>        ENUM    SymA<span class="op">,</span>SymB<span class="op">,</span>SymC</span></code></pre></div>
<p>This instruction will assign the values 0, 1, and 2 to the symbols <code>SymA, SymB,</code> and <code>SymC</code>.</p>
<p>If you want to split an enumeration over more than one line, use <code>NEXTENUM</code> instead of <code>ENUM</code> for the second and all following lines. The internal counter that assigns sequential values to alls symbols will then not be reset to zero, like in the following case:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>        ENUM     January<span class="op">=</span><span class="dv">1</span><span class="op">,</span>February<span class="op">,</span>March<span class="op">,</span>April<span class="op">,</span>May<span class="op">,</span>June</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>        NEXTENUM July<span class="op">,</span>August<span class="op">,</span>September<span class="op">,</span>October</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>        NEXTENUM November<span class="op">,</span>December</span></code></pre></div>
<p>This example also demonstrates that it is possible to assign explicit values to individual symbols. The internal counter will be updated accordingly if this feature is used.</p>
<p>A definition of a symbol with <code>ENUM</code> is equal to a definition with <code>EQU</code>, i.e. it is not possible to assign a new value to a symbol that already exists.</p>
<p>The <code>ENUMCONF</code> statement allows to influence the behaviour of <code>ENUM</code>. <code>ENUMCONF</code> accepts one or two arguments. The first argument is always the value the internal counter is incremented for every symbol in an enumeration. For instance, the statement</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>        ENUMCONF <span class="dv">2</span></span></code></pre></div>
<p>has the effect that symbols get the values 0,2,4,6... instead of 0,1,2,3...</p>
<p>The second (optional) argument of <code>ENUMCONF</code> rules which address space the defined symbols are assigned to. By default, symbols defined by <code>ENUM</code> are typeless. For instance, the statement</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>        ENUMCONF <span class="dv">1</span><span class="op">,</span>CODE</span></code></pre></div>
<p>defines that they should be assigned to the instruction address space. The names of the address spaces are the same as for the <a href="#segment"><code>SEGMENT</code></a> instruction, with the addition of <code>NOTHING</code> to generate typeless symbols again.</p>
<h3 id="pushv-and-popv">PUSHV and POPV</h3>
<p><em>valid for: all processors</em></p>
<p><code>PUSHV</code> and <code>POPV</code> allow to temporarily save the value of a symbol (that is not macro-local) and to restore it at a later point of time. The storage is done on stacks, i.e. Last-In-First-Out memory structures. A stack has a name that has to fulfill the general rules for symbol names and it exists as long as it contains at least one element: a stack that did not exist before is automatically created upon <code>PUSHV</code>, and a stack becoming empty upon a <code>POPV</code> is deleted automatically. The name of the stack that shall be used to save or restore symbols is the first parameter of <code>PUSH</code> resp. <code>POPV</code>, followed by a list of symbols as further parameters. All symbols referenced in the list already have to exist, it is therefore <strong>not</strong> possible to implicitly define symbols with a <code>POPV</code> instruction.</p>
<p>Stacks are a global resource, i.e. their names are not local to sections.</p>
<p>It is important to note that symbol lists are <strong>always</strong> processed from left to right. Someone who wants to pop several variables from a stack with a <code>POPV</code> therefore has to use the exact reverse order used in the corresponding <code>PUSHV</code>!</p>
<p>The name of the stack may be left blank, like this:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>        pushv   <span class="op">,</span>var1<span class="op">,</span>var2<span class="op">,</span>var3</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>        popv    <span class="op">,</span>var3<span class="op">,</span>var2<span class="op">,</span>var1</span></code></pre></div>
<p>AS will then use a predefined internal default stack.</p>
<p>AS checks at the end of a pass if there are stacks that are not empty and issues their names together with their &quot;filling level&quot;. This allows to find out if there are any unpaired <code>PUSHVs</code> or <code>POPVs</code>. However, it is in no case possible to save values in a stack beyond the end of a pass: all stacks are cleared at the beginning of a pass!</p>
<h2 id="code-modification">Code Modification</h2>
<h3 id="org">ORG</h3>
<p><em>valid for: all processors</em></p>
<p><code>ORG</code> allows to load the internal address counter (of the assembler) with a new value. The value range depends on the currently selected segment and on the processor type (<a href="#table-address-ranges-for-org">Address Ranges for <code>ORG</code> table</a>). The lower bound is always zero, and the upper bound is the given value minus 1.</p>
<p><strong>CAUTION</strong>: If the <code>PHASE</code> instruction is also used, one has to keep in mind that the argument of <code>ORG</code> always is the <em>load address</em> of the code. Expressions using the $ or symbol to refer to the current program counter however deliver the <em>execution address</em> of the code and do not yield the desired result when used as argument for <code>ORG</code>. The <code>RORG</code> statement (<a href="#rorg">RORG</a>) should be used in such cases.</p>
<h5 id="table-address-ranges-for-org"><strong>Table:</strong> Address Ranges for <code>ORG</code></h5>
<!-- markdownlint-disable MD033-->

<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">Target</td>
<td style="text-align: center;">CODE</td>
<td style="text-align: center;">DATA</td>
<td style="text-align: center;">I-DATA</td>
<td style="text-align: center;">X-DATA</td>
<td style="text-align: center;">Y-DATA</td>
<td style="text-align: center;">BIT-DATA</td>
<td style="text-align: center;">IO</td>
<td style="text-align: center;">REG</td>
<td style="text-align: center;">ROM-DATA</td>
<td style="text-align: center;">EE-DATA</td>
</tr>
<tr class="even">
<td style="text-align: left;">68xxx/MCFxxxx</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DSP56000</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">DSP56300</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PowerPC</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">M*Core</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6800</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">6301</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6811</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">6805</td>
<td style="text-align: center;">8K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">68HC08</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">6809</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6309</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">68HC12</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">68HC12X</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">XGATE</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S12Z</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">68HC16</td>
<td style="text-align: center;">1M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">68RS08</td>
<td style="text-align: center;">16K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">H8/300</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H8/300H</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">H8/500</td>
<td style="text-align: center;">64K/16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SH7000</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">SH7600</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SH7700</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">HD614023</td>
<td style="text-align: center;">2K</td>
<td style="text-align: center;">160</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HD614043</td>
<td style="text-align: center;">4K</td>
<td style="text-align: center;">160</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">HD614081</td>
<td style="text-align: center;">8K</td>
<td style="text-align: center;">160</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HD641016</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">6502</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MELPS‑740</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">HUC6280</td>
<td style="text-align: center;">2M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">65816</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">MELPS‑7700</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MELPS‑4500</td>
<td style="text-align: center;">8K</td>
<td style="text-align: center;">416</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">M16</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">M16C</td>
<td style="text-align: center;">1M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">4004</td>
<td style="text-align: center;">4K</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8008</td>
<td style="text-align: center;">16K</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">MCS‑41</td>
<td style="text-align: center;">1/2/4/6/8K<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">256<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MCS‑48</td>
<td style="text-align: center;">1/2/4/6/8K<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">256<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">MCS‑51</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">256<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">80C390</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">256<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">MCS‑251</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MCS‑96</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">MCS‑196</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MCS‑196N</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">MCS‑296</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8080</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">8085</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">80x86</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">68xx0</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8X30x</td>
<td style="text-align: center;">8K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">2650</td>
<td style="text-align: center;">8K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XA</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">2K<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">AVR</td>
<td style="text-align: center;">128K<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a></td>
<td style="text-align: center;">32K<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">8K<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">29XXX</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">80C166</td>
<td style="text-align: center;">256K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">80C167</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">Z80</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Z180</td>
<td style="text-align: center;">512K<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">256</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">Z380</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Z8</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">eZ8</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Z8001</td>
<td style="text-align: center;">8M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">Z8003</td>
<td style="text-align: center;">8M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Z8002</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">Z8004</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KCPSM</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">KCPSM3</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mico8</td>
<td style="text-align: center;">4096</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">TLCS‑900(L)</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TLCS‑90</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">TLCS‑870(/C)</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TLCS‑47</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">1K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">TLCS‑9000</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TC9331</td>
<td style="text-align: center;">320</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIC 16C5x</td>
<td style="text-align: center;">2K</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIC 16C5x</td>
<td style="text-align: center;">2K</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIC 16C64</td>
<td style="text-align: center;">8K</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIC 16C86</td>
<td style="text-align: center;">8K</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a></td>
</tr>
<tr class="even">
<td style="text-align: left;">PIC 17C42</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SX20</td>
<td style="text-align: center;">2K</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">ST6</td>
<td style="text-align: center;">4K</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ST7</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">STM8</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ST9</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">6804</td>
<td style="text-align: center;">4K</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">32010</td>
<td style="text-align: center;">4K</td>
<td style="text-align: center;">144</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">32015</td>
<td style="text-align: center;">4K</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">8</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">320C2x</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">320C3x</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">320C40</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">320C44</td>
<td style="text-align: center;">32M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">320C5x</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">320C20x</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">320C54x</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">TMS 9900</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TMS 70Cxx</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">370xxx</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSP430</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">TMS1000</td>
<td style="text-align: center;">1K</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TMS1200</td>
<td style="text-align: center;">1K</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">TMS1100</td>
<td style="text-align: center;">2K</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TMS1300</td>
<td style="text-align: center;">2K</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">SC/MP</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">807x</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">COP4</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">COP8</td>
<td style="text-align: center;">8K</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">SC144xx</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS16008</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS32008</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS08032</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS16032</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS32016</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS32032</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS32CG16</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS32332</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS32532</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">ACE</td>
<td style="text-align: center;">4K<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F3850</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">F8</td>
<td style="text-align: center;">4K</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">µPD78(C)xx</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">7566</td>
<td style="text-align: center;">1K</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7508</td>
<td style="text-align: center;">4K</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">75K0</td>
<td style="text-align: center;">16K</td>
<td style="text-align: center;">4K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">78K0</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">78K2</td>
<td style="text-align: center;">1M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">78K3</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">78K4</td>
<td style="text-align: center;">16M<a href="#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7720</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">7725</td>
<td style="text-align: center;">2K</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">1024</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">77230</td>
<td style="text-align: center;">8K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">1K</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">53C8XX</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F<sup>2</sup>MC8L</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">F<sup>2</sup>MC16L</td>
<td style="text-align: center;">16M</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSM5840</td>
<td style="text-align: center;">2K</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSM5842</td>
<td style="text-align: center;">768</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSM58421</td>
<td style="text-align: center;">1.5K</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSM58422</td>
<td style="text-align: center;">1.5K</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSM5847</td>
<td style="text-align: center;">1.5K</td>
<td style="text-align: center;">96</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSM5054</td>
<td style="text-align: center;">1K</td>
<td style="text-align: center;">62</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSM5055</td>
<td style="text-align: center;">1.75K</td>
<td style="text-align: center;">96</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSM5056</td>
<td style="text-align: center;">1.75K</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSM6051</td>
<td style="text-align: center;">2.5K</td>
<td style="text-align: center;">119</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">MN1610</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MN1613</td>
<td style="text-align: center;">256K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">PMCxxx</td>
<td style="text-align: center;">1...4K<a href="#fn21" class="footnote-ref" id="fnref21" role="doc-noteref"><sup>21</sup></a></td>
<td style="text-align: center;">64...256<a href="#fn22" class="footnote-ref" id="fnref22" role="doc-noteref"><sup>22</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">32...128<a href="#fn23" class="footnote-ref" id="fnref23" role="doc-noteref"><sup>23</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PMSxxx</td>
<td style="text-align: center;">1...4K<a href="#fn24" class="footnote-ref" id="fnref24" role="doc-noteref"><sup>24</sup></a></td>
<td style="text-align: center;">64...256<a href="#fn25" class="footnote-ref" id="fnref25" role="doc-noteref"><sup>25</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">32...128<a href="#fn26" class="footnote-ref" id="fnref26" role="doc-noteref"><sup>26</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">PFSxxx</td>
<td style="text-align: center;">1...4K<a href="#fn27" class="footnote-ref" id="fnref27" role="doc-noteref"><sup>27</sup></a></td>
<td style="text-align: center;">64...256<a href="#fn28" class="footnote-ref" id="fnref28" role="doc-noteref"><sup>28</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">32...128<a href="#fn29" class="footnote-ref" id="fnref29" role="doc-noteref"><sup>29</sup></a></td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">180x</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">XS1</td>
<td style="text-align: center;">4G</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1750</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">KENBAK</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CP1600</td>
<td style="text-align: center;">64K</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
<td style="text-align: center;">---</td>
</tr>
</tbody>
</table>
<!-- markdownlint-enable MD033-->

<p>In case that different variations in a processor family have address spaces of different size, the maximum range is listed for each.</p>
<p><code>ORG</code> is mostly needed to give the code a new starting address or to put different, non-continuous code parts into one source file. In case there is no explicit other value listed in a table entry, the initial address for this segment (i.e. the start address used without <code>ORG</code>) is 0.</p>
<h3 id="rorg">RORG</h3>
<p><em>valid for: all processors</em></p>
<p><code>RORG</code> modifies the program counter just like <code>ORG</code>, however it does not expect an absolute address as argument. Instead, it expects a relative value (positive or negative) that is added to the current program counter. A possible application of this statement is the reservation of a certain amount of address space, or the use in code parts that are included multiple times (e.g. via macros or includes) and that shall be position-independent. Another application is the use in code that has an execution address different from the load address (i.e. the <code>PHASE</code> statement is used). There is no symbol to refer to the current <em>load address</em>, but it can be referred to indirectly via the <code>RORG</code> statement.</p>
<h3 id="cpu">CPU</h3>
<p><em>valid for: all processors</em></p>
<p>This command rules for which processor the further code shall be generated. Instructions of other processor families are not accessible afterwards and will produce error messages!</p>
<p>The processors can roughly be distinguished in families, inside the families different types additionally serve for a detailed distinction:</p>
<ol type="1">
<li><p>68008 → 68000 → 68010 → 68012 → MCF5202 → MCF5204 → MCF5206 → MCF5208 → MCF52274 → MCF52277 → MCF5307 → MCF5329 → MCF5373 → MCF5407 → MCF5470 → MCF5471 → MCF5472 → MCF5473 → MCF5474 → MCF5475 → MCF51QM → 68332 → 68340 → 68360 → 68020 → 68030 → 68040</p>
<p>The differences in this family are additional instructions and addressing modes (starting from the 68020). A small exception is the step to the 68030 that misses two instructions: <code>CALLM</code> and <code>RTM</code>. The three representatives of the 683xx family have the same processor core (a slightly reduced 68020 CPU), however completely different peripherals. MCF5xxx represents various ColdFire variants from Motorola/Freescale/NXP, RISC processors downwardly binary compatible to the 680x0. For the 68040, additional control registers (reachable via <code>MOVEC</code>) and instructions for control of the on-chip MMU and caches were added.</p></li>
<li><p>56000 → 56002 → 56300</p>
<p>While the 56002 only adds instructions for incrementing and decrementing the accumulators, the 56300 core is almost a new processor: all address spaces are enlarged from 64K words to 16M and the number of instructions almost has been doubled.</p></li>
<li><p>PPC403 → MPPC403 → MPC505 → MPC601 → MPC821 → RS6000</p>
<p>The PPC403 is a reduced version of the PowerPC line without a floating point unit, which is why all floating point instructions are disabled for him; in turn, some microcontroller-specific instructions have been added which are unique in this family. The GC variant of the PPC403 incorporates an additional MMU and has therefore some additional instructions for its control. The MPC505 (a microcontroller variant without a FPU) only differ in its peripheral registers from the 601 as long as I do not know it better - <a href="#fn30" class="footnote-ref" id="fnref30" role="doc-noteref"><sup>30</sup></a> is a bit reluctant in this respect... The RS6000 line knows a few instructions more (that are emulated on many 601-based systems), IBM additionally uses different mnemonics for their pure workstation processors, as a reminiscence of 370 mainframes...</p></li>
<li><p>MCORE</p></li>
<li><p>XGATE</p></li>
<li><p>6800 → 6801 → 6301 → 6811</p>
<p>While the 6801 only offers a few additional instructions (and the 6301 even a few more), the 6811 provides a second index register and much more instructions.</p></li>
<li><p>6809/6309 and 6805/68HC(S)08</p>
<p>These processors are partially source-code compatible to the other 68xx processors, but they have a different binary code format and a significantly reduced (6805) resp. enhanced (6809) instruction set. The 6309 is a CMOS version of the 6809 which is officially only compatible to the 6809, but unofficially offers more registers and a lot of new instructions (see <a href="#fn31" class="footnote-ref" id="fnref31" role="doc-noteref"><sup>31</sup></a>).</p></li>
<li><p>68HC12 → 68HC12X</p>
<p>The 12X core offers a couple of new instructions, and existing
instructions were were enriched with new addressing modes.</p></li>
<li><p>S912ZVC19F0MKH, S912ZVC19F0MLF, S912ZVCA19F0MKH, S912ZVCA19F0MLF, S912ZVCA19F0WKH, S912ZVH128F2CLQ, S912ZVH128F2CLL, S912ZVH64F2CLQ, S912ZVHY64F1CLQ, S912ZVHY32F1CLQ, S912ZVHY64F1CLL, S912ZVHY32F1CLL, S912ZVHL64F1CLQ, S912ZVHL32F1CLQ, S912ZVHL64F1CLL, S912ZVHL32F1CLL, S912ZVFP64F1CLQ, S912ZVFP64F1CLL, S912ZVH128F2VLQ, S912ZVH128F2VLL, S912ZVH64F2VLQ, S912ZVHY64F1VLQ, S912ZVHY32F1VLQ, S912ZVHY64F1VL, S912ZVHY32F1VLL, S912ZVHL64F1VLQ</p>
<p>All variants contain the same processor core and the same instruction
set, only the on-chip peripherals and the amount of built-in memory
(RAM, Flash-ROM, EEPROM) vary from device to device.</p></li>
<li><p>68HC16</p></li>
<li><p>HD6413308 → HD6413309</p>
<p>These both names represent the 300 and 300H variants of the H8 family; the H version owns a larger address space (16Mbytes instead of 64Kbytes), double-width registers (32 bits), and knows a few more instructions and addressing modes. It is still binary upward compatible.</p></li>
<li><p>HD6475328 → HD6475348 → HD6475368 → HD6475388</p>
<p>These processors all share the same CPU core; the different types are only needed to include the correct subset of registers in the file <code>REG53X.INC</code>.</p></li>
<li><p>SH7000 → SH7600 → SH7700</p>
<p>The processor core of the 7600 offers a few more instructions that close gaps in the 7000&#39;s instruction set (delayed conditional and relative and indirect jumps, multiplications with 32-bit operands and multiply/add instructions). The 7700 series (also known as SH3) furthermore offers a second register bank, better shift instructions, and instructions to control the cache.</p></li>
<li><p>HD614023 → HD614043 → HD614081</p>
<p>These three variants of the HMCS400 series differ by the size of the internal ROM and RAM.</p></li>
<li><p>HD641016</p>
<p>This is currently the only target with H16 core.</p></li>
<li><p>6502 → 65(S)C02 → 65CE02 / W65C02S / 65C19 / MELPS740 / HUC6280 / 6502UNDOC</p>
<p>The CMOS version defines some additional instructions, as well as a number of some instruction/addressing mode combinations were added which were not possible on the 6502. The W65C02S adds two opcodes to the 65C02 instruction set to give more fine-grained control over how to stop the CPU for low power modes. The 65SC02 lacks the bit manipulation instructions of the 65C02. The 65CE02 adds branch instructions with 16-bit displacement, a Z register, a 16 bit stack pointer, a programmable base page, and a couple of new instructions.</p>
<p>The 65C19 is <em>not</em> binary upward compatible to the original 6502! Some addressing modes have been replaced by others. Furthermore, this processor contains instruction set extensions that facilitate digital signal processing.</p>
<p>The Mitsubishi micro controllers in opposite expand the 6502 instruction set primarily to bit operations and multiplication / division instructions. Except for the unconditional jump and instructions to increment/decrement the accumulator, the instruction extensions have nothing in common.</p>
<p>For the HuC 6280, the feature that sticks out most is the larger address space of 2 MByte instead of 64 KBytes. This is achieved with a built-tin banking mechanism. Furthermore, it features some special instructions to communicate with a video processor (this chip was used in video games) and to copy memory areas.</p>
<p>The 6502UNDOC processor type enables access to the &quot;undocumented&quot; 6502 instructions, i.e. the operations that result from the usage of bit combinations in the opcode that are not defined as instructions. The variants supported by AS are listed in the appendix containing processor-specific hints.</p></li>
<li><p>MELPS7700, 65816</p>
<p>Apart from a &#39;16-bit-version&#39; of the 6502&#39;s instruction set, these processors both offer some instruction set extensions. These are however orthogonal as they are oriented along their 8-bit predecessors (65C02 resp. MELPS-740). Partially, different mnemonics are used for the same operations.</p></li>
<li><p>MELPS4500</p></li>
<li><p>M16</p></li>
<li><p>M16C</p></li>
<li><p>4004 → 4040</p>
<p>Opposed to its predecessor, the 4040 features about a dozen additional machine instructions.</p></li>
<li><p>8008 → 8008</p>
<p>NEW Intel redefined the mnemonics around 1975, the second variant reflects this new instruction set. A simultaneous support of both sets was not possible due to mnemonic conflicts.</p></li>
<li><p>8021, 8022, 8401, 8411, 8421, 8461, 8039, (MSM)80C39, 8048, (MSM)80C48, 8041, 8042, 80C382</p>
<p>For the ROM-less versions 8039 and 80C39, the commands which are using the BUS (port 0) are forbidden. The 8021 and 8022 are special versions with a strongly shrunk instruction set, for which the 8022 has two A/D- converters and the necessary control-commands. The instruction set of the MAB8401 to 8461 (designed by Philips) is somewhere in between the 8021/8022 and a &quot;complete&quot; MC-48 instruction set. On the other hand, they provide serial ports and up to 8 KBytes of program memory.</p>
<p>It is possible to transfer the CMOS-versions with the <code>IDL</code> resp. <code>HALT</code> command into a stop mode with lower current consumption. The 8041 and 8042 have some additional instructions for controlling the bus interface, but in turn a few other commands were omitted. The code address space of 8041, 8042, 84x1, 8021, and 8022 is not externally extendable, and so AS limits the code segment of these processors to the size of the internal ROM. The (SAB)80C382 is a variant especially designed by Siemens for usage in telephones. It also knows a <code>HALT</code> instruction, plus ist supports indirect addressing for <code>DJNZ</code> and <code>DEC</code>. In turn, several instructions of the &#39;generic&#39; 8048 were left out. The OKI variants (MSM...) also feature indirect addressing for <code>DJNZ</code> and <code>DEC</code>, plus enhanced control of power-down modes, plus the full basic MCS-48 instruction set.</p></li>
<li><p>87C750 → 8051, 8052, 80C320, 80C501, 80C502, 80C504, 80515, and 80517 → 80C390 → 80C251</p>
<p>The 87C750 can only access a maximum of 2 Kbytes program memory which is why it lacks the <code>LCALL</code> and <code>LJMP</code> instructions. AS does not make any distinction among the processors in the middle, instead it only stores the different names in the <code>MOMCPU</code> variable (see below), which allows to query the setting with <code>IF</code> instructions. An exception is the 80C504 that has a mask flaw in its current versions. This flaw shows up when an <code>AJMP</code> or <code>ACALL</code> instruction starts at the second last address of a 2K page. AS will automatically use long instructions or issues an error message in such situations. The 80C251 in contrast represents a drastic progress in the the direction 16/32 bits, larger address spaces, and a more orthogonal instruction set. One might call the 80C390 the &#39;small solution&#39;: Dallas Semiconductor modified instruction set and architecture only as far as it was necessary for the 16 Mbytes large address spaces.</p></li>
<li><p>8096 → 80196 → 80196N → 80296</p>
<p>Apart from a different set of SFRs (which however strongly vary from version to version), the 80196 knows several new instructions and supports a &#39;windowing&#39; mechanism to access the larger internal RAM. The 80196N family extends the address space to 16 Mbytes and introduces a set of instructions to access addresses beyond 64Kbytes. The 80296 extends the CPU core by instructions for signal processing and a second windowing register, however removes the Peripheral Transaction Server (PTS) and therefore looses again two machine instructions.</p></li>
<li><p>8080 → 8085 → 8085UNDOC</p>
<p>The 8085 knows the additional commands <code>RIM</code> and <code>SIM</code> for controlling the interrupt mask and the two I/O-pins. The type <code>8085UNDOC</code> enables additional instructions that are not documented by Intel. These instructions are documented in section <a href="#8085undoc">8085UNDOC</a>.</p></li>
<li><p>8086 → 80186 → V30 → V35</p>
<p>Only new instructions are added in this family. The corresponding 8-bit versions are not mentioned due to their instruction compatibility, so one e.g. has to choose 8086 for an 8088-based system.</p></li>
<li><p>80960</p></li>
<li><p>8X300 → 8X305</p>
<p>The 8X305 features a couple of additional registers that miss on the 8X300. Additionally, it can do new operations with these registers (like direct writing of 8 bit values to peripheral addresses).</p></li>
<li><p>XAG1, XAG2, XAG3</p>
<p>These processors only differ in the size of their internal ROM which is defined in <code>STDDEFXA.INC</code>.</p></li>
<li><p>AT90S1200, AT90S2313, AT90S2323, AT90S233, AT90S2343, AT90S4414, AT90S4433, AT90S4434, AT90S8515, AT90C8534, AT90S8535, ATTINY4, ATTINY5, ATTINY9, ATTINY10, ATTINY11, ATTINY12, ATTINY13, ATTINY13A, ATTINY15, ATTINY20, ATTINY24(A), ATTINY25, ATTINY26, ATTINY28, ATTINY40, ATTINY44(A), ATTINY45, ATTINY48, ATTINY84(A), ATTINY85, ATTINY87, ATTINY88, ATTINY102, ATTINY104, ATTINY167, ATTINY261, ATTINY261A, ATTINY43U, ATTINY441, ATTINY461, ATTINY461A, ATTINY828, ATTINY841, ATTINY861, ATTINY861A, ATTINY1634, ATTINY2313, ATTINY2313A, ATTINY4313, ATMEGA48, ATMEGA8, ATMEGA8515, ATMEGA8535, ATMEGA88, ATMEGA8U2, ATMEGA16U2, ATMEGA32U2, ATMEGA16U4, ATMEGA32U4, ATMEGA32U6, AT90USB646, AT90USB647, AT90USB1286, AT90USB1287, AT43USB355, ATMEGA16, ATMEGA161, ATMEGA162, ATMEGA163, ATMEGA164, ATMEGA165, ATMEGA168, ATMEGA169, ATMEGA32, ATMEGA323, ATMEGA324, ATMEGA325, ATMEGA3250, ATMEGA328, ATMEGA329, ATMEGA3290, ATMEGA406, ATMEGA64, ATMEGA640, ATMEGA644, ATMEGA644RFR2, ATMEGA645, ATMEGA6450, ATMEGA649, ATMEGA6490, ATMEGA103, ATMEGA128, ATMEGA1280, ATMEGA1281, ATMEGA1284, ATMEGA1284RFR2, ATMEGA2560, ATMEGA2561</p>
<p>The various AVR chip variants mainly differ in the amount of on-chip memory (flash, SRAM, EEPROM) an the set of built-in peripherals (GPIO, timers, UART, A/D converter...). Compared to the AT90... predecessors, the ATmega chip also provide additional instructions, while the ATtinys do not support the multiplication instructions.</p></li>
<li><p>AM29245 → AM29243 → AM29240 → AM29000</p>
<p>The further one moves to the right in this list, the fewer the instructions become that have to be emulated in software. While, for example, the 29245 doesn&#39;t even have a hardware multiplier, the two representatives in the middle only lack the floating-point instructions. The 29000 serves as a &#39;generic&#39; type that understands all instructions in hardware.</p></li>
<li><p>80C166 → 80C167, 80C165, 80C163</p>
<p>80C167 and 80C165/163 have an address space of 16 Mbytes instead of 256 Kbytes, and furthermore they know some additional instructions for extended addressing modes and atomic instruction sequences. They are &#39;second generation&#39; processors and differ from each other only in the amount of on-chip peripherals.</p></li>
<li><p>Z80 → Z80UNDOC → Z180 → Z380</p>
<p>While there are only a few additional instructions for the Z180, the Z380 owns 32-bit registers, a linear address space of 4 Gbytes, a couple of instruction set extensions that make the overall instruction set considerably more orthogonal, and new addressing modes (referring to index register halves, stack relative). These extensions partially already exist on the Z80 as undocumented extensions and may be switched on via the Z80UNDOC variant. A list with the additional instructions can be found in the chapter with processor specific hints.</p></li>
<li><p>Z8601, Z8603, z86C03, z86E03, Z86C06, Z86E06, Z86C08, Z86C21, Z86E21, Z86C30, Z86C31, Z86C32
Z86C40 → Z88C00, Z88C01 → eZ8, Z8F0113, Z8F011A, Z8F0123, Z8F012A, Z8F0130, Z8F0131, Z8F0213, Z8F021A, Z8F0223, Z8F022A, Z8F0230, Z8F0231, Z8F0411, Z8F0412, Z8F0413, Z8F041A, Z8F0421, Z8F0422, Z8F0423, Z8F042A, Z8F0430, Z8F0431, Z8F0811, Z8F0812, Z8F0813, Z8F081A, Z8F0821, Z8F0822, Z8F0823, Z8F082A, Z8F0830, Z8F0831, Z8F0880, Z8F1232, Z8F1233, Z8F1621, Z8F1622, Z8F1680, Z8F1681, Z8F1682, Z8F2421, Z8F2422, Z8F2480, Z8F3221, Z8F3222, Z8F3281, Z8F3282, Z8F4821, Z8F4822, Z8F4823, Z8F6081, Z8F6082, Z8F6421, Z8F6422, Z8F6423, Z8F6481, Z8F6482</p>
<p>The variants with Z8 core only differ in internal memory size and on-chip peripherals, i.e. the choice does not have an effect on the supported instruction set. Super8 and eZ8 are substantially different, each with an instruction set that was vastly extended (into different directions), and they are not fully upward-compatible on source code level as well.</p></li>
<li><p>Z8001, Z8002, Z8003, Z8004</p>
<p>The operation mode (segmented for Z8001 and Z8003, non-segmented for Z8002 and Z8004) is selected via the processor type. There is currently no further differentiation between Z8001/8002 and Z8003/8004.</p></li>
<li><p>KCPSM</p>
<p>Both processor cores are not available as standalone components, they are provided as logic cores for gate arrays made by Xilinx The -3 variant offers a larger address space and some additional instructions. Note that it is not binary upward-compatible!</p></li>
<li><p>MICO8_05, MICO8_V3, MICO8_V31</p>
<p>Lattice unfortunately changed the machine instructions more than once, so different targets became necessary to provide continued support for older projects. The first variant is the one described in the 2005 manual, the two other ones represent versions 3.0 resp. 3.1.</p></li>
<li><p>96C141, 93C141</p>
<p>These two processors represent the two variations of the processor family: TLCS-900 and TLCS-900L. The differences of these two variations will be discussed in detail in <a href="#tlcs-900l">TLCS-900(L)</a>.</p></li>
<li><p>90C141</p></li>
<li><p>87C00, 87C20, 87C40, 87C70</p>
<p>The processors of the TLCS-870 series have an identical CPU core, but different peripherals depending on the type. In part registers with the same name are located at different addresses. The file <code>STDDEF87.INC</code> uses, similar to the MCS-51-family, the distinction possible by different types to provide the correct symbol set automatically.</p></li>
<li><p>TLCS-870/C</p>
<p>Currently, only the processor core of the TLCS-870/C family is implemented.</p></li>
<li><p>47C00 → 470C00 → 470AC00</p>
<p>These three variations of the TLCS-47-family have on-chip RAM and ROM of different size, which leads to several bank switching instructions being added or suppressed.</p></li>
<li><p>97C241</p></li>
<li><p>TC9331</p></li>
<li><p>16C54 → 16C55 → 16C56 → 16C57</p>
<p>These processors differ by the available code area, i.e. by the address limit after which AS reports overruns.</p></li>
<li><p>16C84, 16C64</p>
<p>Analog to the MCS-51 family, no distinction is made in the code generator, the different numbers only serve to include the correct SFRs in <code>STDDEF18.INC</code>.</p></li>
<li><p>17C42</p></li>
<li><p>SX20, SX28</p>
<p>The SX20 uses a smaller housing and lacks port C.</p></li>
<li><p>ST6200, ST6201, ST6203, ST6208, ST6209, ST6210, ST6215, ST6218, ST6220, ST6225, ST6228, ST6230, ST6232, ST6235, ST6240, ST6242, ST6245, ST6246, ST6252, ST6253, ST6255, ST6260, ST6262, ST6263, ST6265, ST6280, ST6285</p>
<p>The various ST6 derivates differ in the amount of on-chip peripherals and built-in memory.</p></li>
<li><p>ST7
ST72251G1, ST72251G2, ST72311J2, ST72311J4, ST72321BR6, ST72321BR7, ST72321BR9, ST72325S4, ST72325S6, ST72325J7, ST72325R9, ST72324J6, ST72324K6, ST72324J4, ST72324K4, ST72324J2, ST72324JK21, ST72325S4, ST72325J7, ST72325R9, ST72521BR6, ST72521BM9, ST7232AK1, ST7232AK2, ST7232AJ1, ST7232AJ2, ST72361AR4, ST72361AR6, ST72361AR7, ST72361AR9, ST7FOXK1, ST7FOXK2, ST7LITES2Y0, ST7LITES5Y0, ST7LITE02Y0, ST7LITE05Y0, ST7LITE09Y0
ST7LITE10F1, ST7LITE15F1, ST7LITE19F1, ST7LITE10F0, ST7LITE15F0, ST7LITE15F1, ST7LITE19F0, ST7LITE19F1, ST7LITE20F2, ST7LITE25F2, ST7LITE29F2, ST7LITE30F2, ST7LITE35F2, ST7LITE39F2, ST7LITE49K2, ST7MC1K2, ST7MC1K4, ST7MC2N6, ST7MC2S4, ST7MC2S6, ST7MC2S7, ST7MC2S9, ST7MC2R6, ST7MC2R7, ST7MC2R9, ST7MC2M9, STM8
STM8S001J3, STM8S003F3, STM8S003K3, STM8S005C6, STM8S005K6, STM8S007C8, STM8S103F2, STM8S103F3, STM8S103K3, STM8S105C4, STM8S105C6, STM8S105K4, STM8S105K6, STM8S105S4, STM8S105S6, STM8S207MB, STM8S207M8, STM8S207RB, STM8S207R8, STM8S207R6, STM8S207CB, STM8S207C8, STM8S207C6, STM8S207SB, STM8S207S8, STM8S207S6, STM8S207K8, STM8S207K6, STM8S208MB, STM8S208RB, STM8S208R8, STM8S208R6, STM8S208CB, STM8S208C8, STM8S208C6, STM8S208SB, STM8S208S8, STM8S208S6, STM8S903K3, STM8S903F3, STM8L050J3, STM8L051F3, STM8L052C6, STM8L052R8, STM8L001J3, STM8L101F1, STM8L101F2, STM8L101G2, STM8L101F3, STM8L101G3, STM8L101K3, STM8L151C2, STM8L151K2, STM8L151G2, STM8L151F2, STM8L151C3, STM8L151K3, STM8L151G3, STM8L151F3, STM8L151C4, STM8L151C6, STM8L151K4, STM8L151K6, STM8L151G4, STM8L151G6, STM8L152C4, STM8L152C6, STM8L152K4, STM8L152K6, STM8L151R6, STM8L151C8, STM8L151M8, STM8L151R8, STM8L152R6, STM8L152C8, STM8L152K8, STM8L152M8, STM8L152R8, STM8L162M8, STM8L162R8, STM8AF6366, STM8AF6388, STM8AF6213, STM8AF6223, STM8AF6226, STM8AF6246, STM8AF6248, STM8AF6266, STM8AF6268, STM8AF6269, STM8AF6286, STM8AF6288, STM8AF6289, STM8AF628A, STM8AF62A6, STM8AF62A8, STM8AF62A9, STM8AF62AA, STM8AF5268, STM8AF5269, STM8AF5286, STM8AF5288, STM8AF5289, STM8AF528A, STM8AF52A6, STM8AF52A8, STM8AF52A9, STM8AF52AA, STM8AL3136, STM8AL3138, STM8AL3146, STM8AL3148, STM8AL3166, STM8AL3168, STM8AL3L46, STM8AL3L48, STM8AL3L66, STM8AL3L68, STM8AL3188, STM8AL3189, STM8AL318A, STM8AL3L88, STM8AL3L89, STM8AL3L8A, STM8TL52F4, STM8TL52G4, STM8TL53C4, STM8TL53F4, STM8TL53G4</p>
<p>The STM8 core extends the address space to 16 Mbytes and introduces a couple of new instructions. Though many instructions have the same machine code as for ST7, it is not binary upward compatible.</p></li>
<li><p>ST9020, ST9030, ST9040, ST9050</p>
<p>These 4 names represent the four &quot;sub-families&quot; of the ST9 family, which only differ in their on-chip peripherals. Their processor cores are identical, which is why this distinction is again only used in the include file containing the peripheral addresses.</p></li>
<li><p>6804</p></li>
<li><p>32010 → 32015</p>
<p>The TMS32010 owns just 144 bytes of internal RAM, and so AS limits addresses in the data segment just up to this amount. This restriction does not apply for the 32015, the full range from 0...255 can be used.</p></li>
<li><p>320C25 → 320C26 → 320C28</p>
<p>These processors only differ slightly in their on-chip peripherals and in their configuration instructions.</p></li>
<li><p>320C30, 320C31 → 320C40, 320C44</p>
<p>The 320C31 is a reduced version with the same instruction set, however fewer peripherals. The distinction is exploited in <code>STDDEF3X.INC</code>. The C4x variants are source-code upward compatible, the machine codes of some instructions are however slightly different. Once again, the C44 is a stripped-down version of the C40, with less peripherals and a smaller address space.</p></li>
<li><p>320C203 → 320C50, 320C51, 320C53</p>
<p>The first one represents the C20x family of signal processors which implement a subset of the C5x instruction set. The distinction among the C5x processors is currently not used by AS.</p></li>
<li><p>320C541</p>
<p>This one at the moment represents the TMS320C54x family...</p></li>
<li><p>TI990/4, TI990/10, TI990/12
TMS9900, TMS9940, TMS9995, TMS99105, TMS99110</p>
<p>The TMS99xx/99xxx processors are basically single chip implementations of the TI990 minicomputers. Some TI990 models are even based on such a processor instead of a discrete CPU. The individual models differ in their instruction set (the TI990/12 has the largest one) and the presence of a privileged mode.</p></li>
<li><p>TMS70C00, TMS70C20, TMS70C40, TMS70CT20, TMS70CT40, TMS70C02, TMS70C42, TMS70C82, TMS70C08, TMS70C48</p>
<p>All members of this family share the same CPU core, they therefore do not differ in their instruction set. The differences manifest only in the file <code>REG7000.INC</code> where address ranges and peripheral addresses are defined. Types listed in the same row have the same amount of internal RAM and the same on-chip peripherals, they differ only in the amount of integrated ROM.</p></li>
<li><p>370C010, 370C020, 370C030, 370C040 and 370C050</p>
<p>Similar to the MCS-51 family, the different types are only used to differentiate the peripheral equipment in <code>STDDEF37.INC</code>; the instruction set is always the same.</p></li>
<li><p>MSP430 → MSP430X</p>
<p>The X variant of the CPU core extends the address space from 64 KiBytes to 1 MiByte and augments the instruction set, e.g. by prefixed to repeat instructions.</p></li>
<li><p>TMS1000, TMS1100, TMS1200, TMS1300</p>
<p>TMS1000 and TMS1200 each provide 1 KByte of ROM and 64 nibbles of RAM, while TMS1100 and TMS1300 provide twice the amount of RAM and ROM. Furthermore, TI has defined a significantly different default instruction set fot TMS1100 and TMS1300(AS only knows the default instruction sets!)</p></li>
<li><p>SC/MP</p></li>
<li><p>8070</p>
<p>This processor represents the whole 807x family (which consists at least of the 8070, 8072, and 8073), which however shares identical CPU cores.</p></li>
<li><p>COP87L84</p>
<p>This is the only member of National Semiconductor&#39;s COP8 family that is currently supported. I know that the family is substantially larger, and that there are representatives with differently sized instruction sets which will be added when a need occurs. It is a beginning, and National&#39;s documentation is quite extensive...</p></li>
<li><p>COP410 → COP420 → COP440 → COP444</p>
<p>The COP42x derivates offer some additional instructions, plus other instructions have an extended operand range.</p></li>
<li><p>SC14400, SC14401, SC14402, SC14404, SC14405, SC14420, SC14421, SC14422, SC14424</p>
<p>This series of DECT controllers differentiates itself by the amount of instructions, since each of them supports different B field formats and their architecture has been optimized over time.</p></li>
<li><p>NS16008, NS32008, NS08032, NS16032, NS32016, NS32032, NS32332, NS32CG16, NS32532</p>
<p>National renamed the first-generation CPUs several times in the early years, NS16008/NS32008/NS08032 resp. NS16032/NS32016 are the same chips. NS32332 and NS32532 support an address space of 4 GBytes instead of 16 MBytes, and the NS32CG16 is an embedded variant with additional instructions for bit block transfers.</p></li>
<li><p>ACE1101, ACE1202</p></li>
<li><p>F3850, MK3850, MK3870, MK3870/10, MK3870/12, MK3870/20, MK3870/22, MK3870/30, MK3870/32, MK3870/40, MK3870/42, MK3872, MK3873, MK3873/10, MK3873/12, MK3873/20, MK3873/22, MK3874, MK3875, MK3875/22, MK3875/42, MK3876, MK38P70/02, MK38C70, MK38C70/10, MK38C70/20, MK97400, MK97410, MK97500, MK97501, MK97503</p>
<p>This huge amount of variants partially results from the fact that Mostek renamed some variants in the early 80s. The new naming scheme allows to deduce the amount of internal ROM (0 to 4 for 0 to 4 Kbytes) and executable RAM (0 or 2 for 0 or 64 bytes) from the suffix. 3850 and MK975xx support a 64K address space, which is only 4 Kbytes for all other variants. P variants have an EEPROM piggyback socket for prototyping, C variants are fabricated in CMOS technology and feature two new machine instructions (HET and HAL). The MK3873&#39;s feature is a built-in serial port, while the MK3875 offers a second supply voltage pin to buffer the internal memory in standby mode.</p></li>
<li><p>7800, 7801, 7802
78C05, 78C06
7810 → 78C10, 78C11, 78C12, 78C14, 78C17, 78C18</p>
<p>μPD7800 to μPD7802 represent the &quot;first generation&quot; of the uCOM87 family from NEC. μPD78C05 and μPD78C06 are reduced variants that implement only a subset of the instruction set. All μPD781x variants belong to the uCOM87AD series, which - aside from an A/D converter - also supports additional registers and machine instructions.</p>
<p><strong>NOTE:</strong> The instruction set is only partially binary upward compatible! The NMOS version μPD7810 has no stop-mode; the respective command and the ZCM register are omitted.</p>
<p><strong>CAUTION!</strong> NMOS and CMOS version partially differ in the reset values of some registers!</p></li>
<li><p>7500 ↔︎ 7508</p>
<p>There are two different types of CPU cores in the μPD75xx family: the 7566 represents the the &#39;instruction set B&#39;, which provides less instructions, less registers and smaller address spaces. The 7508 represents the &#39;full&#39; instruction set A.</p>
<p><strong>CAUTION!</strong> These instruction sets are not 100% binary compatible!</p></li>
<li><p>75402, 75004, 75006, 75008, 75268, 75304, 75306, 75308, 75312, 75316, 75328, 75104, 75106, 75108, 75112, 75116, 75206, 75208, 75212, 75216, 75512, 75516</p>
<p>This &#39;cornucopia&#39; of processors differs only by the RAM size in one group; the groups themselves again differ by their on-chip peripherals on the one hand and by their instruction set&#39;s power on the other hand.</p></li>
<li><p>78070</p>
<p>This is currently the only member of NEC&#39;s 78K0 family I am familiar with. Similar remarks like for the COP8 family apply!</p></li>
<li><p>78214</p>
<p>This is currently the representor of NEC&#39;s 78K2 family.</p></li>
<li><p>78310</p>
<p>This is currently the representor of NEC&#39;s 78K3 family.</p></li>
<li><p>784026</p>
<p>This is currently the representor of NEC&#39;s 78K4 family.</p></li>
<li><p>7720 → 7725</p>
<p>The μPD7725 offers larger address spaces and som more instructions compared to his predecessor.</p>
<p><strong>CAUTION!</strong> The processors are not binary compatible to each other!</p></li>
<li><p>77230</p></li>
<li><p>SYM53C810, SYM53C860, SYM53C815, SYM53C825, SYM53C875, SYM53C895</p>
<p>The simpler members of this family of SCSI processors lack some instruction variants, furthermore they are different in their set of internal registers.</p></li>
<li><p>MB89190</p>
<p>This processor type represents Fujitsu&#39;s F<sup>2</sup>MC8L series...</p></li>
<li><p>MB9500</p>
<p>...just like this one does it currently for the 16-bit variants from Fujitsu!</p></li>
<li><p>MSM5840, MSM5842, MSM58421, MSM58422, MSM5847</p>
<p>These variants of the OLMS-40 family differ in their instruction set and in the amount of internal program and data memory.</p></li>
<li><p>MSM5054, MSM5055, MSM5056, MSM6051, MSM6052</p>
<p>The as for the OLMS-40 family: differences in instruction set and the amount of internal program and data memory.</p></li>
<li><p>MN1610[ALT] → MN1613[ALT]</p>
<p>In addition to its predecessor&#39;s features, the MN1613 offers a larger address space, a floating point unit and a couple of new machine instructions.</p></li>
<li><p>PMC150, PMS150, PFS154, PMC131, PMS130, PMS131
PMS132, PMS132B, PMS152, PMS154B, PMS154C, PFS173
PMS133, PMS134, DF69, MCS11, PMC232, PMC234, PMC251
PMC271,PMC884, PMS232, PMS234, PMS271</p>
<p>The Padauk controllers differ in the size of the internal (ROM/RAM) memory, the type of internal ROM (erasable or OTP), the built-in peripherals, and their instruction set (both extent and binary coding).</p></li>
<li><p>1802 → 1804, 1805, 1806 → 1804A, 1805A, 1806A</p>
<p>1804, 1805, and 1806 feature an instruction set that is slightly enhanced, compared to the &#39;original&#39; 1802, plus on-chip RAM and an integrated timer. The A variants extend the instruction set by <code>DSAV</code>, <code>DBNZ</code>, and instructions for addition and subtraction in BCD format.</p></li>
<li><p>XS1</p>
<p>This type represents the XCore-&quot;family&quot;.</p></li>
<li><p>1750</p>
<p>MIL STD 1750 is a standard, therefore there is only one (standard) variant...</p></li>
<li><p>KENBAK</p>
<p>Since there has never been a KENBAK-2, the target is simply KENBAK...</p></li>
<li><p>CP-1600</p>
<p>The <code>CPU</code> instruction needs the processor type as a simple literal, a calculation like:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>    CPU     <span class="dv">68010</span><span class="op">+</span><span class="dv">10</span></span></code></pre></div>
<p>is not allowed. Valid calls are e.g.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>    CPU     <span class="dv">8051</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>    CPU     <span class="dv">6800</span></span></code></pre></div></li>
</ol>
<p>Regardless of the processor type currently set, the integer variable <code>MOMCPU</code> contains the current status as a hexadecimal number. For example, <code>MOMCPU</code>=$68010 for the 68010 or <code>MOMCPU</code>=80C48H for the 80C48. As one cannot express all letters as hexadecimal digits (only A...F are possible), all other letters must must be omitted in the hex notation; for example, <code>MOMCPU</code>=80H for the Z80.</p>
<p>You can take advantage of this feature to generate different code depending on the processor type. For example, the 68000 does not have a machine instruction for a subroutine return with stack correction. With the variable <code>MOMCPU</code> you can define a macro that uses the machine instruction or emulates it depending on the processor type:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>myrtd   macro   disp</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>        <span class="pp">if</span>      MOMCPU<span class="op">&lt;$</span><span class="bn">68010</span> <span class="co">; emulate for 68008 &amp; 68000</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>        move<span class="op">.</span>l <span class="op">(</span><span class="kw">sp</span><span class="op">),</span>disp<span class="op">(</span><span class="kw">sp</span><span class="op">)</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">lea</span>    disp<span class="op">(</span><span class="kw">sp</span><span class="op">),</span><span class="kw">sp</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>        rts</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>        elseif</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>        rtd    <span class="op">#</span>disp         <span class="co">; direct use on &gt;=68010</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>        endif</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>        endm</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>        cpu     <span class="dv">68010</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>        myrtd   <span class="dv">12</span>            <span class="co">; results in RTD #12</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>        cpu     <span class="dv">68000</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>        myrtd   <span class="dv">12</span>            <span class="co">; results in MOVE.../LEA.../RTS</span></span></code></pre></div>
<p>As not all processor names are built only out of numbers and letters from A...F, the full name is additionally stored in the string variable named <code>MOMCPUNAME</code>.</p>
<p>The assembler implicitly switches back to the <code>CODE</code> segment when a <code>CPU</code> instruction is executed. This is done because <code>CODE</code> is the only segment all processors support.</p>
<p>The default processor type is 68008, unless it has been changed via the command line option with same name.</p>
<p>Some targets define options or variants that are so fundamental for operation, that they have to be selected with the <code>CPU</code> instruction. Such options are appended to the argument, separated by double colons:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>      CPU <span class="op">&lt;</span>CPU Name<span class="op">&gt;:&lt;</span>var1<span class="op">&gt;=&lt;</span>val1<span class="op">&gt;:&lt;</span>var2<span class="op">&gt;=&lt;</span>val2<span class="op">&gt;:...</span></span></code></pre></div>
<p>See the respective section with processor-specific hints to check whether a certain target supports such options.</p>
<h3 id="supmode-fpu-pmmu-custom">SUPMODE, FPU, PMMU, CUSTOM</h3>
<p><em>SUPMODE valid for: 680x0, i960, TLCS-900, SH7000, i960, 29K, XA, PowerPC, M*Core, and TMS9900</em>
<em>FPU valid for: 680x0, NS32xxx, 80x86</em>
<em>PMMU valid for: 680x0, NS32xxx</em>
<em>CUSTOM valid for: NS32xxx</em></p>
<p>These three switches allow to define which parts of the instruction set shall be disabled because the necessary preconditions are not valid for the following piece of code. The parameter for these instructions may be either <code>ON</code> or <code>OFF</code>, the current status can be read out of a variable which is either TRUE or FALSE.</p>
<p>The commands have the following meanings in detail:</p>
<ul>
<li><p><code>SUPMODE</code>: allows or prohibits commands, for whose execution the processor has to be within the supervisor mode. The status variable is called <code>INSUPMODE</code>.</p></li>
<li><p><code>FPU</code>: allows or prohibits the commands of the numerical coprocessors 8087, NS32081/32381 resp. 68881 or 68882. The status variable is called <code>FPUAVAIL</code>. For NS32xxx as target, specifying the explicit FPU type (<code>NS32081</code>, <code>NS32181</code>, <code>NS32381</code>, or <code>NS32580</code>) is also possible, to enable or disable the additional registers and instructions.</p></li>
<li><p><code>PMMU</code>: allows or prohibits the commands of the memory management unit 68851 resp. of the built-in MMU of the 68030.</p>
<p><strong>CAUTION!</strong> The 68030-MMU supports only a relatively small subset of the 68851 instructions. This is controlled via the <code>FULLPMMU</code> statement. The status variable is called <code>PMMUAVAIL</code>. For NS32xxx as target, specifying the explicit MMU type as target (<code>NS32082</code>, <code>NS32381</code>, or <code>NS32352</code>) is also possible, to enable access to the MMU-type-specific register set.</p></li>
<li><p><code>CUSTOM</code>: allows or prohibits the commands reserved for custom slave processors.</p></li>
</ul>
<p>The usage of of instructions prohibited in this manner will generate a warning at <code>SUPMODE</code>, at <code>PMMU</code> and <code>FPU</code> a real error message.</p>
<h3 id="fullpmmu">FULLPMMU</h3>
<p><em>valid for: 680x0</em></p>
<p>Motorola integrated the MMU into the processor starting with the 68030, but the built-in FPU is equipped only with a relatively small subset of the 68851 instruction set. AS will therefore disable all extended MMU instructions when the target processor is 68030 or higher. It is however possible that the internal MMU has been disabled in a 68030-based system and the processor operates with an external 68851. One can the use a <code>FULLPMMU ON</code> to tell AS that the complete MMU instruction set is allowed. Vice versa, one may use a <code>FULLPMMU OFF</code> to disable all additional instruction in spite of a 68020 target platform to assure that portable code is written. The switch between full and reduced instruction set may be done as often as needed, and the current setting may be read from a symbol with the same name.</p>
<p><strong>CAUTION!</strong> The <code>CPU</code> instruction implicitly sets or resets this switch when its argument is a 68xxx processor! <code>FULLPMMU</code> therefore has to be written after the <code>CPU</code> instruction!</p>
<h3 id="padding">PADDING</h3>
<p><em>valid for: 680x0, 68xx, M*Core, XA, H8, SH7000, MSP430(X), TMS9900, ST7/STM8, AVR (only if code segment granularity is 8 bits)</em></p>
<p>Various processor families have a requirement that objects of more than one byte length must be located on a n even address. Aside from data objects, this may also include instruction words. For instance, word accesses to an odd address result in an exception on a 68000, while other processors like the H8 force the lowest address bit to zero.</p>
<p>The <code>PADDING</code> instruction allows to activate a mechanism that tries to avoid such misalignments. If the situation arises that an instruction word, or a data object of 16 bits or more (created e.g. via <code>DC</code>) would be stored on an odd address, a padding byte is automatically inserted before. Such a padding byte is displayed in the listing in a separate line that contains the remark</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>    &lt;padding<span class="op">&gt;</span></span></code></pre></div>
<p>If the source line also contained a label, the label still points to the address of the code or data object, i.e. right behind the pad byte. The same is true for a label in a source line immediately before, as long as this line only holds the label and no other instruction. So, in the following example:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>        padding  on</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">org</span>      <span class="op">$</span><span class="bn">1000</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>        dc<span class="op">.</span>b     <span class="dv">1</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">adr1:</span>  <span class="bu">nop</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>        dc<span class="op">.</span>b     <span class="dv">1</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">adr2:</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">nop</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>        dc<span class="op">.</span>b     <span class="dv">1</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="fu">adr3:</span>  <span class="pp">equ</span>      <span class="op">*</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">nop</span></span></code></pre></div>
<p>the labels <code>adr1</code> and <code>adr2</code> hold the addresses of the respective <code>NOP</code> instructions, which were made even by inserting a pad byte. <code>adr3</code> in contrast holds the address of the pad byte preceding the third <code>NOP</code>.</p>
<p>Similar to the previous instructions, the argument to <code>PADDING</code> may be either <code>ON</code> or <code>OFF</code>, and the current setting may be read from a symbol with the same name. <code>PADDING</code> is by default only enabled for the 680x0 family, it has to be turned on explicitly for all other families.</p>
<h3 id="packing">PACKING</h3>
<p><em>valid for: AVR</em></p>
<p>In some way, <code>PACKING</code> is similar to <code>PADDING</code>, it just has a somewhat opposite effect: While <code>PADDING</code> extends the disposed data to get full words and keep a possible alignment, <code>PACKING</code> squeezes several values into a single word. This makes sense for the AVR&#39;s code segment since the CPU has a special instruction (<code>LPM</code>) to access single bytes within a 16-bit word. In case this option is turned on (argument <code>ON</code>), two byte values are packed into a single word by <code>DATA</code>, similar to the single characters of string arguments. The value range of course reduces to -128...+255. If this option is turned off (argument <code>OFF</code>), each integer argument obtains its own word and may take values from -32768...+65535.</p>
<p>This distinction is only made for integer arguments of <code>DATA</code>, strings will always be packed. Keep further in mind that packing of values only works within the arguments of a <code>DATA</code> statement; if one has subsequent <code>DATA</code> statements, there will still be half-filled words when the argument count is odd!</p>
<h3 id="maxmode">MAXMODE</h3>
<p><em>valid for: TLCS-900, H8</em></p>
<p>The processors of the TLCS-900-family are able to work in 2 modes, the minimum and maximum mode. Depending on the actual mode, the execution environment and the assembler are a little bit different. Along with this instruction and the parameter <code>ON</code> or <code>OFF</code>, AS is informed that the following code will run in maximum resp. minimum mode. The actual setting can be read from the variable <code>INMAXMODE</code>. Presetting is <code>OFF</code>, i.e. minimum mode.</p>
<p>Similarly, one uses this instruction to tell AS in H8 mode whether the address space is 64K or 16 Mbytes. This setting is always <code>OFF</code> for the &#39;small&#39; 300 version and cannot be changed.</p>
<h3 id="extmode-and-lwordmode">EXTMODE and LWORDMODE</h3>
<p><em>valid for: Z380</em></p>
<p>The Z380 may operate in altogether 4 modes, which are the result of setting two flags: The XM flag rules whether the processor shall operate wit an address space of 64 Kbytes or 4 Gbytes and it may only be set to 1 (after a reset, it is set to 0 for compatibility with the Z80). The LW flag in turn rules whether word operations shall work with a word size of 16 or 32 bits. The setting of these two flags influences range checks of constants and addresses, which is why one has to tell AS the setting of these two flags via these instructions. The default assumption is that both flags are 0, the current setting (<code>ON</code> or <code>OFF</code>) may be read from the predefined symbols <code>INEXTMODE</code> resp. <code>INLWORDMODE.</code></p>
<h3 id="srcmode">SRCMODE</h3>
<p><em>valid for: MCS-251</em></p>
<p>Intel substantially extended the 8051 instruction set with the 80C251, but unfortunately there was only a single free opcode for all these new instructions. To avoid a processor that will be eternally crippled by a prefix, Intel provided two operating modes: the binary and the source mode. The new processor is fully binary compatible to the 8051 in binary mode, all new instructions require the free opcode as prefix. In source mode, the new instructions exchange their places in the code tables with the corresponding 8051 instructions, which in turn then need a prefix. One has to inform AS whether the processor operates in source mode (<code>ON</code>) or binary mode (<code>OFF</code>) to enable AS to add prefixes when required. The current setting may be read from the variable <code>INSRCMODE</code>. The default is <code>OFF</code>.</p>
<h3 id="bigendian">BIGENDIAN</h3>
<p><em>valid for: MCS-51/251, PowerPC, SC/MP</em></p>
<p>Intel broke with its own principles when the 8051 series was designed: in contrast to all traditions, the processor uses big-endian ordering for all multi-byte values! While this was not a big deal for MCS-51 processors (the processor could access memory only in 8-bit portions, so everyone was free to use whichever endianess one wanted), it may be a problem for the 251 as it can fetch whole (long-)words from memory and expects the MSB to be first. As this is not the way of constant disposal earlier versions of AS used, one can use this instruction to toggle between big and little endian mode for the instructions <code>DB, DW, DD, DQ,</code> and <code>DT</code>. <code>BIGENDIAN OFF</code> (the default) puts the LSB first into memory as it used to be on earlier versions of AS, <code>BIGENDIAN ON</code> engages the big-endian mode compatible to the MCS-251. One may of course change this setting as often as one wants; the current setting can be read from the symbol with the same name.</p>
<h3 id="wrapmode">WRAPMODE</h3>
<p><em>valid for: Atmel AVR</em></p>
<p>After this switch has been set to <code>ON</code>, AS will assume that the processor&#39;s program counter does not have the full length of 16 bits given by the architecture, but instead a length that is exactly sufficient to address the internal ROM. For example, in case of the AT90S8515, this means 12 bits, corresponding to 4 Kwords or 8 Kbytes. This assumption allows relative branches from the ROM&#39;s beginning to the end and vice versa which would result in an out-of-branch error when using strict arithmetics. Here, they work because the carry bits resulting from the target address computation are discarded. Assure that the target processor you are using works in the outlined way before you enable this option! In case of the aforementioned AT90S8515, this option is even necessary because it is the only way to perform a direct jump through the complete address space...</p>
<p>This switch is set to <code>OFF</code> by default, and its current setting may be read from a symbol with same name.</p>
<h3 id="segment">SEGMENT</h3>
<p><em>valid for: all processors</em></p>
<p>Some microcontrollers and signal processors know various address ranges, which do not overlap with each other and require also different instructions and addressing modes for access. To manage these ones also, the assembler provides various program counters, you can switch among them to and from by the use of the <code>SEGMENT</code> instruction. For subroutines included with <code>INCLUDE</code>, this e.g. allows to define data used by the main program or subroutines near to the place they are used. In detail, the following segments with the following names are supported:</p>
<ul>
<li><code>CODE</code>: program code;</li>
<li><code>DATA</code>: directly addressable data (including SFRs);</li>
<li><code>XDATA</code>: data in externally connected RAM or X-addressing space of the DSP56xxx or ROM data for the μPD772x;</li>
<li><code>YDATA</code>: Y-addressing space of the DSP56xxx;</li>
<li><code>IDATA</code>: indirectly addressable (internal) data;</li>
<li><code>BITDATA</code>: the part of the 8051-internal RAM that is bitwise addressable;</li>
<li><code>IO</code>: I/O-address range;</li>
<li><code>REG</code>: register bank of the ST9;</li>
<li><code>ROMDATA</code>: constant ROM of the NEC signal processors;</li>
<li><code>EEDATA</code>: built-in EEPROM.</li>
</ul>
<p>See also <a href="#org">ORG</a> for detailed information about address ranges and initial values of the segments. Depending on the processor family, not all segment types will be permitted.</p>
<p>The bit segment is managed as if it would be a byte segment, i.e. the addresses will be incremented by 1 per bit.</p>
<p>Labels get the same type as attribute as the segment that was active when the label was defined. So the assembler has a limited ability to check whether you access symbols of a certain segment with wrong instructions. In such cases the assembler issues a warning.</p>
<p>Example:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>        CPU     <span class="dv">8051</span>    <span class="co">; MCS-51-code</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">segment</span> code    <span class="co">; test code</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">setb</span>    flag    <span class="co">; no warning</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">setb</span>    var     <span class="co">; warning : wrong segment</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">segment</span> data</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>var     <span class="dt">db</span>      <span class="op">?</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">segment</span> bitdata</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>flag    <span class="dt">db</span>      <span class="op">?</span></span></code></pre></div>
<h3 id="phase-and-dephase">PHASE and DEPHASE</h3>
<p><em>valid for: all processors</em></p>
<p>For some applications (especially on Z80 systems), the code must be moved to another address range before execution. If the assembler didn&#39;t know about this, it would align all labels to the load address (not the start address). The programmer is then forced to write jumps within this area either independent of location or has to add the offset at each symbol manually. The first one is not possible for some processors, the last one is extremely error-prone. With the commands <code>PHASE</code> and <code>DEPHASE</code>, it is possible to inform the assembler at which address the code will really be executed on the target system:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>        phase   <span class="op">&lt;</span>address<span class="op">&gt;</span></span></code></pre></div>
<p>informs the assembler that the following code shall be executed at the specified address. The assembler calculates thereupon the difference to the real program counter and adds this difference for the following operations:</p>
<ul>
<li>address values in the listing</li>
<li>filing of label values</li>
<li>program counter references in relative jumps and address expressions</li>
<li>readout of the program counter via the symbols * or $</li>
</ul>
<p>By using the instruction</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>        DEPHASE</span></code></pre></div>
<p>this &quot;shifting&quot; is reverted to the value previous to the most recent <code>PHASE</code> instruction. <code>PHASE</code> und <code>DEPHASE</code> may be used in a nested manner.</p>
<p>The assembler keeps phase values for all defined segments, although this instruction pair only makes real sense in the code segment.</p>
<h3 id="save-and-restore">SAVE and RESTORE</h3>
<p><em>valid for: all processors</em></p>
<p>The command <code>SAVE</code> forces the assembler to push the contents of following variables onto an internal stack:</p>
<ul>
<li>currently selected processor type (set by <code>CPU</code>);</li>
<li>currently active memory area (set by <code>SEGMENT</code>);</li>
<li>the flag whether listing is switched on or off (set by <code>LISTING</code>);</li>
<li>the flags that define which part of expanded macros shall be printed in the assembly listing (set by <code>/MACEXP_DFT/MACEXP_OVR</code>).</li>
<li>currently active character translation table (set by <code>CODEPAGE</code>).</li>
</ul>
<p>The counterpart <code>RESTORE</code> pops the values saved last from this stack. These two commands were primarily designed for include files, to change the above mentioned variables in any way inside of these files, without loosing their original content. This may be helpful e.g. in include files with own, fully debugged subroutines, to switch the listing generation off:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>        SAVE            <span class="co">; save old status</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>        LISTING OFF     <span class="co">; save paper</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>        .               <span class="co">; the actual code</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>        <span class="pp">RESTORE</span>         <span class="co">; restore</span></span></code></pre></div>
<p>In opposite to a simple <code>LISTING OFF ... ON</code>-pair, the correct status will be restored, in case the listing generation was switched off already before.</p>
<p>The assembler checks if the number of <code>SAVE</code>-and <code>RESTORE</code>-commands corresponds and issues error messages in the following cases:</p>
<ul>
<li><code>RESTORE</code>, but the internal stack is empty;</li>
<li>the stack not empty at the end of a pass.</li>
</ul>
<h3 id="assume">ASSUME</h3>
<p><em>valid for: various</em></p>
<p>This instruction allows to tell AS the current setting of certain registers whose contents cannot be described with a simple <code>ON</code> or <code>OFF</code>. These are typically registers that influence addressing modes and whose contents are important to know for AS in order to generate correct addressing. It is important to note that <code>ASSUME</code> only informs AS about these, <strong>no</strong> machine code is generated that actually loads these values into the appropriate registers!</p>
<p>A value defined with <code>ASSUME</code> can be queried or integrated into expressions via the built-in function <code>ASSUMEDVAL</code>. This is the case for all architectures listed in the following sub-sections except for the 8086.</p>
<h4 id="65ce02">65CE02</h4>
<p>The 65CE02 features a a register named &#39;B&#39; that is used to set the &#39;base page&#39;. In comparison to the original 6502, this allows the programmer to place the memory page addressable with short (8 bit) addresses anywhere in the 64K address space. This register is set to zero after a reset, so the 65CE02 behaves like its predecessor. A base page at zero is also the default assumption of the assembler. It may be informed about its actual contents via a <code>ASSUME B:xx</code> statement. Addresses located in this page will then automatically be addressed via short addressing modes.</p>
<h4 id="6809">6809</h4>
<p>In contrast to its &#39;predecessors&#39; like the 6800 and 6502, the position of the direct page, i.e. the page of memory that can be reached with single-byte addresses, can be set freely. This is done via the &#39;direct page register&#39; that sets the page number. One has to assign a corresponding value to this register via <code>ASSUME</code> is the contents are different from the default of 0, otherwise wrong addresses will be generated!</p>
<h4 id="68hc11k4">68HC11K4</h4>
<p>Also for the HC11, the designers finally weren&#39;t able to avoid the major sin: using a banking scheme to address more than 64 Kbytes with only 16 address lines. The registers <code>MMSIZ</code>, <code>MMWBR</code>, <code>MM1CR</code>, and <code>MM2CR</code> control whether and how the additional 512K address ranges are mapped into the physical address space. AS initially assumes the reset state of these registers, i.e. all are set to $00 and windowing is disabled.</p>
<h4 id="68hc12x">68HC12X</h4>
<p>Similar to its cousin without the appended &#39;X&#39;, the HC12X supports a short direct addressing mode. In this case however, it can be used to address more than just the first 256 bytes of the address space. The <code>DIRECT</code> register specifies which 256 byte page of the address space is addressed by this addressing mode. <code>ASSUME</code> is used to tell AS the current value of this register, so it is able to automatically select the most efficient address ing mode when absolute addresses are used. The default is 0, which corresponds to the reset state.</p>
<h4 id="68hc16">68HC16</h4>
<p>The 68HC16 employs a set of bank registers to address a space of 1 Mbyte with its registers that are only 16 bits wide. These registers supply the upper 4 bits. Of these, the EK register is responsible for absolute data accesses (not jumps!). AS checks for each absolute address whether the upper 4 bits of the address are equal to the value of EK specified via <code>ASSUME</code>. AS issues a warning if they differ. The default for EK is 0.</p>
<h4 id="h8500">H8/500</h4>
<p>In maximum mode, the extended address space of these processors is addressed via a couple of bank registers. They carry the names DP (registers from 0...3, absolute addresses), EP (register 4 and 5), and TP (stack). AS needs the current value of DP to check if absolute addresses are within the currently addressable bank; the other two registers are only used for indirect addressing and can therefore not be monitored; it is a question of personal taste whether one specifies their values or not. The BR register is in contrast important because it rules which 256-byte page may be accessed with short addresses. It is common for all registers that AS does not assume <strong>any</strong> default value for them as they are undefined after a CPU reset. Everyone who wants to use absolute addresses must therefore assign values to at least DR and DP!</p>
<h4 id="melps740">MELPS740</h4>
<p>Microcontrollers of this series know a &quot;special page&quot; addressing mode for the <code>JSR</code> instruction that allows a shorter coding for jumps into the last page of on-chip ROM. The size of this ROM depends of course on the exact processor type, and there are more derivatives than it would be meaningful to offer via the CPU instruction...we therefore have to rely on <code>ASSUME</code> to define the address of this page, e.g.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>        ASSUME  <span class="kw">SP</span><span class="op">:$</span><span class="bn">1f</span></span></code></pre></div>
<p>in case the internal ROM is 8K.</p>
<h4 id="melps770065816">MELPS7700/65816</h4>
<p>These processors contain a lot of registers whose contents AS has to know in order to generate correct machine code. These are the registers in question:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">function</th>
<th style="text-align: left;">value range</th>
<th style="text-align: left;">default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DT/DBR</td>
<td style="text-align: left;">data bank</td>
<td style="text-align: left;">0-$ff</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">PG/PBR</td>
<td style="text-align: left;">code Bank</td>
<td style="text-align: left;">0-$ff</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DPR</td>
<td style="text-align: left;">directly addr. page</td>
<td style="text-align: left;">0-$ffff</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">X</td>
<td style="text-align: left;">index register width</td>
<td style="text-align: left;">0 or 1</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">M</td>
<td style="text-align: left;">accumulator width</td>
<td style="text-align: left;">0 or 1</td>
<td style="text-align: left;">0</td>
</tr>
</tbody>
</table>
<p>To avoid endless repetitions, see section <a href="#melps-770065816">MELPS-7700/65816</a> for instructions how to use these registers. The handling is otherwise similar to the 8086, i.e. multiple values may be set with one instruction and no code is generated that actually loads the registers with the given values. This is again up to the programmer!</p>
<h4 id="mcs-196296">MCS-196/296</h4>
<p>Starting with the 80196, all processors of the MCS-96 family have a register &#39;WSR&#39; that allows to map memory areas from the extended internal RAM or the SFR range into areas of the register file which may then be accessed with short addresses. If one informs AS about the value of the WSR register, it can automatically find out whether an absolute address can be addressed with a single-byte address via windowing; consequently, long addresses will be automatically generated for registers covered by windowing. The 80296 contains an additional register WSR1 to allow simultaneous mapping of two memory areas into the register file. In case it is possible to address a memory cell via both areas, AS will always choose the way via WSR!</p>
<p>For indirect addressing, displacements may be either short (8 bits, -128 to +127) or long (16 bits). The assembler will automatically use the shortest possible encoding for a given displacement. It is however possible to enforce a 16-bit coding by prefixing the displacement argument with a greater than sign (<code>&gt;</code>). Similarly, absolute addresses in the area from 0ff80h to 0ffffh may be reached via a short offset relative to the &quot;null register&quot;.</p>
<h4 id="8086">8086</h4>
<p>The 8086 is able to address data from all segments in all instructions, but it however needs so-called &quot;segment prefixes&quot; if another segment register than DS shall be used. In addition it is possible that the DS register is adjusted to another segment, e.g. to address data in the code segment for longer parts of the program. As AS cannot analyze the code&#39;s meaning, it has to informed via this instruction to what segments the segment registers point at the moment, e.g.:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>        ASSUME  <span class="kw">CS</span><span class="op">:</span>CODE<span class="op">,</span> <span class="kw">DS</span><span class="op">:</span>DATA</span></code></pre></div>
<p>It is possible to assign assumptions to all four segment registers in this way. This instruction produces <strong>no</strong> code, so the program itself has to do the actual load of the registers with the values.</p>
<p>The usage of this instruction has on the one hand the result that AS is able to automatically put ahead prefixes at sporadic accesses into the code segment, or on the other hand, one can inform AS that the DS-register was modified and you can save explicit <code>CS:</code>-instructions.</p>
<p>Valid arguments behind the colon are <code>CODE</code>, <code>DATA</code> and <code>NOTHING</code>. The latter value informs AS that a segment register contains no usable value (for AS). The following values are pre-initialized:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>      <span class="fu">CS:</span>CODE<span class="op">,</span> <span class="kw">DS</span><span class="op">:</span>DATA<span class="op">,</span> <span class="kw">ES</span><span class="op">:</span>NOTHING<span class="op">,</span> <span class="kw">SS</span><span class="op">:</span>NOTHING</span></code></pre></div>
<h4 id="xa">XA</h4>
<p>The XA family has a data address space of 16 Mbytes, a process however can always address within a 64K segment only that is given by the DS register. One has to inform AS about the current value of this register in order to enable it to check accesses to absolute addresses.</p>
<h4 id="29k">29K</h4>
<p>The processors of the 29K family feature a register RBP that allows to protect banks of 16 registers against access from user mode. The corresponding bit has to be set to achieve the protection. <code>ASSUME</code> allows to tell AS which value RBP currently contains. AS can warn this way in case a try to access protected registers from user mode is made.</p>
<h4 id="80c166167">80C166/167</h4>
<p>Though none of the 80C166/167&#39;s registers is longer than sixteen bits, this processor has 18/24 address lines and can therefore address up to 256Kbytes/16Mbytes. To resolve this contradiction, it neither uses the well-known (and ill-famed) Intel method of segmentation nor does it have inflexible bank registers...no, it uses paging! To accomplish this, the logical address space of 64 Kbytes is split into 4 pages of 16 Kbytes, and for each page there is a page register (named DPP0...DPP3) that rules which of the 16/1024 physical pages shall be mapped to this logical page. AS always tries to present the address space with a size of 256Kbytes/16MBytes in the sight of the programmer, i.e. the physical page is taken for absolute accesses and the setting of bits 14/15 of the logical address is deduced. If no page register fits, a warning is issued. AS assumes by default that the four registers linearly map the first 64 Kbytes of memory, in the following style:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>        ASSUME  DPP0<span class="op">:</span><span class="dv">0</span><span class="op">,</span>DPP1<span class="op">:</span><span class="dv">1</span><span class="op">,</span>DPP2<span class="op">:</span><span class="dv">2</span><span class="op">,</span>DPP3<span class="op">:</span><span class="dv">3</span></span></code></pre></div>
<p>The 80C167 knows some additional instructions that can override the page registers&#39; function. The chapter with processor-specific hints describes how these instructions influence the address generation.</p>
<p>Some machine instructions have a shortened form that can be used if the argument is within a certain range:</p>
<ul>
<li><code>MOV Rn,#&lt;0...15&gt;</code></li>
<li><code>ADD/ADDC/SUB/SUBC/CMP/XOR/AND/OR Rn, #&lt;0...7&gt;</code></li>
<li><code>LOOP Rn,#&lt;0...15&gt;</code></li>
</ul>
<p>The assembler automatically uses to the shorter coding if possible. If one wants to enforce the longer coding, one may place a &#39;bigger&#39; character right before the expression (behind the double cross character!). Vice versa, a &#39;smaller&#39; character can be used to assure the shorter coding is used. In case the operand does not fulfill the range restrictions for the shorter coding, an error is generated. This syntax may also be used for branches and calls which may either have a short displacement or a long absolute argument.</p>
<h4 id="tlcs-47">TLCS-47</h4>
<p>The direct data address space of these processors (it makes no difference whether you address directly or via the HL register) has a size of only 256 nibbles. Because the &quot;better&quot; family members have up to 1024 nibbles of RAM on chip, Toshiba was forced to introduce a banking mechanism via the DMB register. AS manages the data segment as a continuous addressing space and checks at any direct addressing if the address is in the currently active bank. The bank AS currently expects can be set by means of</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>        ASSUME  DMB<span class="op">:&lt;</span><span class="fl">0.</span><span class="op">..</span><span class="dv">3</span><span class="op">&gt;</span></span></code></pre></div>
<p>The default value is 0.</p>
<h4 id="st6">ST6</h4>
<p>The microcontrollers of the ST62 family are able to map a part (64 bytes) of the code area into the data area, e.g. to load constants from the ROM. This means also that at one moment only one part of the ROM can be addressed. A special register rules which part it is. AS cannot check the contents of this register directly, but it can be informed by this instruction that a new value has been assigned to the register. AS then can test and warn if necessary, in case addresses of the code segment are accessed, which are not located in the &quot;announced&quot; window. If, for example, the variable <code>VARI</code> has the value 456h, so</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>        ASSUME  ROMBASE<span class="op">:</span>VARI<span class="op">&gt;&gt;</span><span class="dv">6</span></span></code></pre></div>
<p>sets the AS-internal variable to 11h, and an access to <code>VARI</code> generates an access to address 56h in the data segment.</p>
<p>It is possible to assign a simple <code>NOTHING</code> instead of a value, e.g. if the bank register is used temporarily as a memory cell. This value is also the default.</p>
<p>The program counter of these controller only has a width of 12 bits. This means that some sort of banking scheme had to be introduced if a device includes more than 4 KBytes of program memory. The banking scheme splits both program space and program memory in pages of 2 KBytes. Page one of the program space always accesses page one of program memory. The <code>PRPR</code> register present on such devices selects which page of program memory is accessed via addresses 000h to 7ffh of program space. As an initial approximation, AS regards program space to be linear and of the size of program memory. If a jump or call from page one is made to code in one of the other pages, it checks whether the assumed contents of the <code>PRPR</code> register match the destination address. If a jump or call is done from one of the other pages to an address outside of page one, it checks whether the destination address is within the same page. <strong>IMPORTANT</strong>: The program counter itself is only 12 bits wide. It is therefore not possible to jump from one page to another one, without an intermediate step of jumping back to page one. Changing the <code>PRPR</code> register while operating outside of page one would result in &quot;pulling out&quot; the code from under one&#39;s feet.</p>
<h4 id="st9">ST9</h4>
<p>The ST9 family uses exactly the same instructions to address code and data area. It depends on the setting of the flag register&#39;s DP flag which address space is referenced. To enable AS to check if one works with symbols from the correct address space (this of course <strong>only</strong> works with absolute accesses!), one has to inform AS whether the DP flag is currently 0 (code) or 1 (data). The initial value of this assumption is 0.</p>
<h4 id="78k2">78K2</h4>
<p>78K2 is an 8/16 bit architecture, which has later been extended to a one-megabyte address space via banking. Banking is realized with the registers PM6 (normal case) resp. P6 (alternate case with <code>&amp;</code> as prefix) that supply the missing upper four address bits. At least for absolute addresses, AS can check whether the current, linear 20-bit address is within the given 64K window.</p>
<h4 id="78k3">78K3</h4>
<p>Processors with a 78K3 core have register banks that consist of 16 registers. These registers may be used via their numbers (<code>R0</code> to <code>R15</code>) or their symbolic names
(<code>X=R0</code>, <code>A=R1</code>, <code>C=R2</code>, <code>B=R3</code>, <code>VPL=R8</code>, <code>VPH=R9</code>, <code>UPL=R10</code>, <code>UPH=R11</code>, <code>E=R12</code>, <code>D=R13</code>, <code>L=R14</code>, <code>H=R15</code>). The processor core has a register select bit ( <code>RSS</code>) to switch the mapping of A/X and B/C from R0...R3 to R4...R7. This is mainly important for instructions that implicitly use one of these registers (i.e. instruction that do not encode the register number in the machine code). However, it is also possible to inform the assembler about the changed mapping via a</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>      assume rss<span class="op">:</span><span class="dv">1</span></span></code></pre></div>
<p>The assembler will then insert the alternate register numbers into machine instructions that explicitly encode the register numbers. Vice versa, <code>R5</code> will be treated like <code>A</code> instead of <code>R1</code> in the source code.</p>
<h4 id="78k4">78K4</h4>
<p>78K4 was designed as an &#39;upgrade path&#39; from 78K3, which is why this processor core contains the same RSS bit to control the mapping of registers AX and BC (though NEC discourages use of it in new code).</p>
<p>Aside from many new instructions and addressing modes, the most significant extension is the larger address space of 16 MBytes, of which only the first MByte may be used for program code. The CPU-internal RAM and all special function registers may be positioned either at the top of the first MByte or the top of the first 64 KByte page. Choice is made via the <code>LOCATION</code> machine instruction that either takes a 0 or 15 as argument. Together with remapping RAM and SFRs, the processor also switches the address ranges that may be reached with short (8 bit) addresses. Parallel to using <code>LOCATION</code>, one has to inform the assembler about this setting via a <code>ASSUME LOCATION:...</code> statement. It will then use short addressing for the proper ranges. The assembler will assume a default of 0 for LOCATION.</p>
<h4 id="320c3xc4x">320C3x/C4x</h4>
<p>As all instruction words of this processor family are only 32 bits long (of which only 16 bits were reserved for absolute addresses), the missing upper 8/16 bits have to be added from the DP register. It is however still possible to specify a full 24/32-bit address when addressing, AS will check then whether the upper 8 bits are equal to the DP register&#39;s assumed values. <code>ASSUME</code> is different to the <code>LDP</code> instruction in the sense that one cannot specify an arbitrary address out of the bank in question, one has to extract the upper bits by hand:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>        ldp     <span class="fu">@</span><span class="er">a</span>ddr</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>        assume  <span class="dt">dp</span><span class="op">:</span>addr<span class="op">&gt;&gt;</span><span class="dv">16</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>        ldi     <span class="fu">@</span><span class="er">a</span>ddr<span class="op">,</span>r2</span></code></pre></div>
<h4 id="μpd78c10">μPD78(C)10</h4>
<p>These processors have a register (V) that allows to move the &quot;zero page&quot;, i.e. page of memory that is addressable by just one byte, freely in the address space, within page limits. By reasons of comforts you don&#39;t want to work with expressions such as</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>        inrw    Lo<span class="op">(</span>counter<span class="op">)</span></span></code></pre></div>
<p>so AS takes over this job, but only under the premise that it is informed via the <code>ASSUME</code>-command about the contents of the V register. If an instruction with short addressing is used, it will be checked if the upper half of the address expression corresponds to the expected content. A warning will be issued if both do not match.</p>
<h4 id="75k0">75K0</h4>
<p>As the whole address space of 12 bits could not be addressed even by the help of register pairs (8 bits), NEC had to introduce banking (like many others too...): the upper 4 address bits are fetched from the MBS register (which can be assigned values from 0 to 15 by the <code>ASSUME</code> instruction), which however will only be regarded if the MBE flag has been set to 1. If it is 0 (default), the lowest and highest 128 nibbles of the address space can be reached without banking. The <code>ASSUME</code> instruction is undefined for the 75402 as it contains neither a MBE flag nor an MBS register; the initial values cannot be changed therefore.</p>
<h4 id="f2mc16l">F<sup>2</sup>MC16L</h4>
<p>Similar to many other families of microcontrollers, this family suffers somewhat from its designers miserliness: registers of only 16 bits width are faced with an address space of 24 bits. Once again, bank registers had to fill the gap. In detail, these are PCB for the program code, DTB for all data accesses, ADB for indirect accesses via RW2/RW6, and SSB/USB for the stacks. They may all take values from 0 to 255 and are by default assumed to be 0, with the exception of 0ffh for PCB.</p>
<p>Furthermore, a DPR register exists that specifies which memory page within the 64K bank given by DTB may be reached with 8 bit addresses. The default for DPR is 1, resulting in a default page of 0001xxh when one takes DTB&#39;s default into account.</p>
<h4 id="mn1613">MN1613</h4>
<p>The MN1613 is an extension of an architecture with 16 bit addresses. The address extension is done by a set of &quot;segment registers&quot; (CSBR, SSBR, TSR0, and TSR1), each of which is four bits wide. The contents of a segment register, left-shifted by 14 bits, is added to the 16 bit addresses. This way, a process may access a memory window of 64 KWords within the address space of 256 KWords. The assembler uses segment register values reported via <code>ASSUME</code> to warn whether an absolute address is outside the window defined by the used segment register. If the address is within the window, it will compute the correct t16-bit offset. Naturally, this cannot be done when indirect addressing is used.</p>
<h3 id="ckpt">CKPT</h3>
<p><em>valid for: TI990/12</em></p>
<p>Type 12 instructions require a <em>checkpoint register</em> for execution. This register may either be specified explicitly as fourth argument, or a default for all following code may be given via this instruction. If neither a <code>CKPT</code> instruction nor an explicit checkpoint register was used, an error is reported. The default of no default register may be restored by using <code>NOTHING</code> as argument to <code>CKPT</code>.</p>
<h3 id="emulated">EMULATED</h3>
<p><em>valid for: 29K</em></p>
<p>AMD defined the 29000&#39;s series exception handling for undefined instructions in a way that there is a separate exception vector for each instruction. This allows to extend the instruction set of a smaller member of this family by a software emulation. To avoid that AS quarrels about these instructions as being undefined, the <code>EMULATED</code> instruction allows to tell AS that certain instructions are allowed in this case. The check if the currently set processors knows the instruction is then skipped. For example, if one has written a module that supports 32-bit IEEE numbers and the processor does not have a FPU, one writes</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>        EMULATED FADD<span class="op">,</span>FSUB<span class="op">,</span>FMUL<span class="op">,</span>FDIV</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>        EMULATED FEQ<span class="op">,</span>FGE<span class="op">,</span>FGT<span class="op">,</span>SQRT<span class="op">,</span>CLASS</span></code></pre></div>
<h3 id="branchext">BRANCHEXT</h3>
<p><em>valid for: XA</em></p>
<p><code>BRANCHEXT</code> with either <code>ON</code> or <code>OFF</code> as argument tells AS whether short branches that are only available with an 8-bit displacement shall automatically be &#39;extended&#39;, for example by replacing a single instruction like</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>        bne     target</span></code></pre></div>
<p>with a longer sequence of same functionality, in case the branch target is out of reach for the instruction&#39;s displacement. For example, the replacement sequence for <code>bne</code> would be</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>        beq     skip</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">jmp</span>     target</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">skip:</span></span></code></pre></div>
<p>In case there is no fitting &#39;opposite&#39; for an instruction, the sequence may become even longer, e.g. for <code>jbc</code>:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>        jbc     dobr</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>        bra     skip</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dobr:</span>   <span class="cf">jmp</span>     target</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">skip:</span></span></code></pre></div>
<p>This feature however has the side effect that there is no unambiguous assignment between machine and assembly code any more. Furthermore, additional passes may be the result if there are forward branches. One should therefore use this feature with caution!</p>
<h3 id="z80syntax">Z80SYNTAX</h3>
<p><em>valid for: 8008, 8080/8085</em></p>
<p>With <code>ON</code> as argument, one can optionally write (almost) all 8008/8080 instructions in the form Zilog defined them for the Z80. For instance, you simply use <code>LD</code> with self-explaining operands instead of <code>MVI, LXI, MOV, STA, LDA, SHLD, LHLD, LDAX, STAX</code> or <code>SPHL</code>.</p>
<p>Since some mnemonics have a different meaning in 8008/8080 and Z80 syntax, it is not possible to program in &#39;Z80 style&#39; all the time, unless the &#39;8080 syntax&#39; is turned off entirely by using <code>EXCLUSIVE</code> as argument. The details of this operation mode can be looked up in <a href="#80808085">8080/8085</a>.</p>
<p>A built-in symbol of same name allows to query the operation mode. The mapping is <code>0=OFF</code>, <code>1=ON</code>, and <code>2=EXCLUSIVE</code>.</p>
<h3 id="expect-and-endexpect">EXPECT and ENDEXPECT</h3>
<p>This pair of instructions may be used to frame a piece of code that is <em>expected</em> to trigger one or more error or warning messages. If the errors or warnings (identified by their numbers, see chapter <a href="#error-messages">Error Messages</a>) do occur, they are suppressed and assembly continues without any error (naturally, without creating code at the erroneous places). However, if warnings or errors that were expected do not occur, <code>ENDEXPECT</code> will emit errors about them. The main usage scenario of these instructions are the self tests in the tests/ subdirectory. For instance, one may check this way if range checking of operands works as expected:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>        cpu      <span class="dv">68000</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>        expect   <span class="dv">1320</span>     <span class="co">; immediate shift only for 1...8</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">lsl</span><span class="op">.</span>l    <span class="op">#</span><span class="dv">10</span><span class="op">,</span>d0</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>        endexpect</span></code></pre></div>
<h2 id="data-definitions">Data Definitions</h2>
<p>The instructions described in this section partially overlap in their functionality, but each processor family defines other names for the same function. To stay compatible with the standard assemblers, this way of implementation was chosen.</p>
<p>If not explicitly mentioned otherwise, all instructions for data deposition (not those for reservation of memory!) allow an arbitrary number of parameters which are being processed from left to right.</p>
<h3 id="dcsize">DC[.Size]</h3>
<p><em>valid for: 680x0, M*Core, 68xx, H8, SH7x00, DSP56xxx, XA, ST7/STM8, MN161x</em></p>
<p>This instruction places one or several constants of the type specified by the attribute into memory. The attributes are the same ones as defined in <a href="#format-of-the-input-files">Format of the Input Files</a>, and there is additionally the possibility for byte constants to place string constants in memory, like</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>String  dc<span class="op">.</span>B <span class="st">&quot;Hello world!\0&quot;</span></span></code></pre></div>
<p>The parameter count may be between 1 and 20. A repeat count enclosed in brackets may additionally be prefixed to each parameter; for example, one can for example fill the area up to the next page boundary with zeroes with a statement like</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>        dc<span class="op">.</span>b    <span class="op">[(*+</span><span class="dv">255</span><span class="op">)&amp;$</span>ffffff00<span class="op">-*]</span><span class="dv">0</span></span></code></pre></div>
<p><strong>CAUTION!</strong> This function easily allows to reach the limit of 1 Kbyte of generated code per line!</p>
<p>The assembler can automatically add another byte of data in case the byte sum should become odd, to keep the word alignment. This behaviour may be turned on and off via the <code>PADDING</code> instruction.</p>
<p>Decimal floating point numbers stored with this instruction (<code>DC.P...</code>) can cover the whole range of extended precision, one however has to pay attention to the detail that the coprocessors currently available from Motorola (68881/68882) ignore the thousands digit of the exponent at the read of such constants!</p>
<p>The default attribute is <code>W</code>, that means 16-bit-integer numbers.</p>
<p>For the DSP56xxx, the data type is fixed to integer numbers (an attribute is therefore neither necessary nor allowed), which may be in the range of -8M up to 16M-1. String constants are also allowed, whereby three characters are packed into each word.</p>
<p>Opposed to the standard Motorola assembler, it is also valid to reserve memory space with this statement, by using a question mark as operand. This is an extension added by some third-party suppliers for 68K assemblers, similar to what Intel assemblers provide. However, it should be clear that usage of this feature may lead to portability problems. Furthermore, question marks as operands must not be mixed with &#39;normal&#39; constants in a single statement.</p>
<h3 id="dssize">DS[.Size]</h3>
<p><em>valid for: 680x0, M*Core, 68xx, H8, SH7x00, DSP56xxx, XA, ST7/STM8, MN161x</em></p>
<p>On the one hand, this instruction enables to reserve memory space for the specified count of numbers of the type given by the attribute. Therefore,</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>        DS<span class="op">.</span>B    <span class="dv">20</span></span></code></pre></div>
<p>for example reserves 20 bytes of memory, but</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>        DS<span class="op">.</span>X    <span class="dv">20</span></span></code></pre></div>
<p>reserves 240 bytes!</p>
<p>The other purpose is the alignment of the program counter which is achieved by a count specification of 0. In this way, with a</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>        DS<span class="op">.</span>W    <span class="dv">0</span></span></code></pre></div>
<p>the program counter will be rounded up to the next even address, with a</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>        DS<span class="op">.</span>D    <span class="dv">0</span></span></code></pre></div>
<p>in contrast to the next double word boundary. Memory cells possibly staying unused thereby are neither zeroed nor filled with NOPs, they simply stay undefined.</p>
<p>The default for the operand length is - as usual - <code>W</code>, i.e. 16 bits.</p>
<p>For the 56xxx, the operand length is fixed to words (of 24 bit), attributes therefore do not exist just as in the case of <code>DC</code>.</p>
<h3 id="dndbdwdddq-and-dt">DN,DB,DW,DD,DQ, and DT</h3>
<p><em>valid for: Intel (except for 4004/4040), Zilog, Toshiba, NEC, TMS370, Siemens, AMD, MELPS7700/65816, M16(C), National, ST9, Atmel, TMS70Cxx, TMS1000, Signetics, μPD77230, Fairchild, Intersil, XS1</em></p>
<p>These commands are - one could say - the Intel counterpart to <code>DS</code> and <code>DC</code>, and as expected, their logic is a little bit different: First, the specification of the operand length is moved into the mnemonic:</p>
<ul>
<li><code>DN</code>: 4-bit integer</li>
<li><code>DB</code>: byte or ASCII string similar to <code>DC.B</code></li>
<li><code>DW</code>: 16-bit integer or half precision</li>
<li><code>DD</code>: 32-bit integer or single precision</li>
<li><code>DQ</code>: double precision (64 bits)</li>
<li><code>DT</code>: extended precision (80 bits)</li>
</ul>
<p>Second, the distinction between constant definition and memory
reservation is done by the operand. A reservation of memory is marked by
a <code>?</code> :</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>        <span class="dt">db</span>      <span class="op">?</span>       <span class="co">; reserves a byte</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>        <span class="dt">dw</span>      <span class="op">?,?</span>     <span class="co">; reserves memory for 2 words (=4 byte)</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">dd</span>      <span class="op">-</span><span class="dv">1</span>      <span class="co">; places the constant -1 (FFFFFFFFH) !</span></span></code></pre></div>
<p>Reserved memory and constant definitions <strong>must not</strong> be mixed within
one instruction:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>        <span class="dt">db</span>      <span class="st">&quot;hello&quot;</span><span class="op">,?</span>       <span class="co">; --&gt; error message</span></span></code></pre></div>
<p>Additionally, the <code>DUP</code> Operator permits the repeated placing of
constant sequences or the reservation of whole memory blocks:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>        <span class="dt">db</span>      <span class="dv">3</span> dup <span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">)</span>     <span class="co">; --&gt; 1 2 1 2 1 2</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>        <span class="dt">dw</span>      <span class="dv">20</span> dup <span class="op">(?)</span>      <span class="co">; reserves 40 bytes of memory</span></span></code></pre></div>
<p>As you can see, the <code>DUP</code>-argument must be enclosed in parentheses, which is also why it may consist of several components, that may themselves be <code>DUP</code>s...the stuff therefore works recursively.</p>
<p><code>DUP</code> is however also a place where one can get in touch with another limit of the assembler: a maximum of 1024 bytes of code or data may be generated in one line. This is not valid for the reservation of memory, only for the definition of constant arrays!</p>
<p>The <code>DUP</code> operator only gets recognized if it is itself not enclosed in parentheses, and if there is a non-empty argument to its left. This way, it is possible to use a symbol of same name as argument.</p>
<p>In order to be compatible to the M80, <code>DEFB/DEFW</code> may be used instead of <code>DB/DW</code> in Z80-mode.</p>
<p>Similarly, <code>BYTE/ADDR</code> resp. <code>WORD/ADDRW</code> in COP4/8 mode are an alias for <code>DB</code> resp. <code>DW</code>, with the pairs differing in byte order: instructions defined by National for address storage use big endian, <code>BYTE</code> resp. <code>WORD</code> in contrast use little endian.</p>
<p>If <code>DB</code> is used in an address space that is not byte addressable (like the Atmel AVR&#39;s <code>CODE</code> segment), bytes are packed in pairs into 16 bit words, according to the endianess given by the architecture: for little endian, the LSB is filled first. If the total number of bytes is odd, one half of the last word remains unused, just like the argument list had been padded. It will also not be used if another <code>DB</code> immediately follows in source code. The analogous is true for <code>DN</code>, just with the difference that two or four nibbles are packet into a byte or 16 bit word.</p>
<p>The NEC 77230 is special with its <code>DW</code> instruction: It more works like the <code>DATA</code> statement of its smaller brothers, but apart from string and integer arguments, it also accepts floating point values (and stores them in the processor&#39;s proprietary 32-bit format). There is <em>no</em> <code>DUP</code> operator!</p>
<h3 id="ds-ds8">DS, DS8</h3>
<p><em>valid for: Intel, Zilog, Toshiba, NEC, TMS370, Siemens, AMD, M16(C), National, ST9, TMS7000, TMS1000, Intersil</em></p>
<p>With this instruction, you can reserve a memory area:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>        DS      <span class="op">&lt;</span>count<span class="op">&gt;</span></span></code></pre></div>
<p>It is an abbreviation of</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>        <span class="dt">DB</span>      <span class="op">&lt;</span>count<span class="op">&gt;</span> DUP <span class="op">(?)</span></span></code></pre></div>
<p>Although this could easily be made by a macro, some people grown up with Motorola CPUs (Hi Michael!) suggest <code>DS</code> to be a built-in instruction...I hope they are satisfied now <code>;-)</code></p>
<p><code>DS8</code> is defined as an alias for <code>DS</code> on the National SC14xxx. Beware that the code memory of these processors is organized in words of 16 bits, it is therefore impossible to reserve individual bytes. In case the argument of <code>DS</code> is odd, it will be rounded up to the next even number.</p>
<h3 id="byt-or-fcb">BYT or FCB</h3>
<p><em>valid for: 6502, 68xx</em></p>
<p>By this instruction, byte constants or ASCII strings are placed in 65xx/68xx-mode, it therefore corresponds to <code>DC.B</code> on the 68000 or <code>DB</code> on Intel. Similarly to <code>DC</code>, a repetition factor enclosed in brackets ([...]) may be prepended to every single parameter.</p>
<h3 id="byte">BYTE</h3>
<p><em>valid for: ST6, 320C2(0)x, 320C5x, MSP, TMS9900, CP-1600, 6502, 68xx</em></p>
<p>By this instruction, byte constants or ASCII strings are placed in 65xx/68xx-mode, it therefore corresponds to <code>DC.B</code> on the 68000 or <code>DB</code> on Intel. Similarly to <code>DC</code>, a repetition factor enclosed in brackets ([...]) may be prepended to every single parameter.</p>
<p>Note that when in 320C2(0)x/5x mode, the assembler assumes that a label on the left side of this instruction has no type, i.e. it belongs to no address space. This behaviour is explained in the processor-specific hints.</p>
<p>The <code>PADDING</code> instruction allows to set whether odd counts of bytes shall be padded with a zero byte in MSP/TMS9900 mode.</p>
<p>The operation of <code>BYTE</code> on CP-1600 is somewhat different: the 16-bit integer arguments are stored byte-wise in two consecutive words of memory (LSB first). If individual 8-bit values shall be stored in memory (optionally packed), use the <code>TEXT</code> instruction!</p>
<h3 id="dc8">DC8</h3>
<p><em>valid for: SC144xx</em></p>
<p>This statement is an alias for <code>DB</code>, i.e. it may be used to dump byte constants or strings to memory.</p>
<h3 id="adr-or-fdb">ADR or FDB</h3>
<p><em>valid for: 6502, 68xx</em></p>
<p><code>ADR</code> resp. <code>FDB</code> stores word constants when in 65xx/68xx mode. It is therefore the equivalent to <code>DC.W</code> on the 68000 or <code>DW</code> on Intel platforms. Similarly to <code>DC</code>, a repetition factor enclosed in brackets ([...]) may be prepended to every single parameter.</p>
<h3 id="word">WORD</h3>
<p><em>valid for: ST6, i960, 320C2(0)x, 320C3x/C4x/C5x, MSP, CP-1600</em></p>
<p>If assembling for the 320C3x/C4x or i960, this command stores 32-bit words, 16-bit words for the other families. Note that when in 320C2(0)x/5x mode, the assembler assumes that a label on the left side of this instruction has no type, i.e. it belongs to no address space. This behaviour is explained at the discussion on processor-specific hints.</p>
<h3 id="dw16">DW16</h3>
<p><em>valid for: SC144xx</em></p>
<p>This instruction is for SC144xx targets a way to dump word (16 bit) constants to memory. <code>CAUTION!!</code> It is therefore an alias for <code>DW</code>.</p>
<h3 id="long">LONG</h3>
<p><em>valid for: 320C2(0)x, 320C5x</em></p>
<p>LONG stores a 32-bit integer to memory with the order LoWord-HiWord. Note that when in 320C2(0)x/5x mode, the assembler assumes that a label on the left side of this instruction has no type, i.e. it belongs to no address space. This behaviour is explained in the processor-specific hints.</p>
<h3 id="single-double-and-extended">SINGLE, DOUBLE, and EXTENDED</h3>
<p><em>valid for: 320C3x/C4x (not <code>DOUBLE</code>), 320C6x (not <code>EXTENDED</code>)</em></p>
<p>Both commands store floating-point constants to memory. In case of the 320C3x/C4x, they are <strong>not</strong> stored in IEEE-format. Instead the processor-specific formats with 32 and 40 bit are used. In case of <code>EXTENDED</code> the resulting constant occupies two memory words. The most significant 8 bits (the exponent) are written to the first word while the other ones (the mantissa) are copied into the second word.</p>
<h3 id="float-and-double">FLOAT and DOUBLE</h3>
<p><em>valid for: 320C2(0)x, 320C5x</em></p>
<p>These two commands store floating-point constants in memory using the standard IEEE 32-bit and 64-bit IEEE formats. The least significant byte is copied to the first allocated memory location. Note that when in 320C2(0)x/5x mode the assembler assumes that all labels on the left side of an instruction have no type, i.e. they belong to no address space. This behaviour is explained in the processor-specific hints.</p>
<h3 id="single-and-double">SINGLE and DOUBLE</h3>
<p><em>valid for: TMS99xxx</em></p>
<p>These two commands store floating-point constants in memory using the processor&#39;s floating point format, which is equal to the IBM/360 floating point format.</p>
<h3 id="efloat-bfloat-and-tfloat">EFLOAT, BFLOAT, and TFLOAT</h3>
<p><em>valid for: 320C2(0)x, 320C5x</em></p>
<p>Another three floating point commands. All of them support non-IEEE formats, which should be easily applicable on signal processors:</p>
<ul>
<li><code>EFLOAT</code>: mantissa with 16 bits, exponent with 16 bits</li>
<li><code>BFLOAT</code>: mantissa with 32 bits, exponent with 16 bits</li>
<li><code>DFLOAT</code>: mantissa with 64 bits, exponent with 32 bits</li>
</ul>
<p>The three commands share a common storage strategy. In all cases the mantissa precedes the exponent in memory, both are stored as 2&#39;s complement with the least significant byte first. Note that when in 320C2(0)x/5x mode the assembler assumes that all labels on the left side of an instruction have no type, i.e. they belong to no address space. This behaviour is explained in the processor-specific hints.</p>
<h3 id="qxx-and-lqxx">Qxx and LQxx</h3>
<p><em>valid for: 320C2(0)x, 320C5x</em></p>
<p><code>Qxx</code> and <code>LQxx</code> can be used to generate constants in a fixed point format. <code>xx</code> denotes a 2-digit number. The operand is first multiplied by 2<sup><em>x**x</em></sup> before converting it to binary notation. Thus <code>xx</code> can be viewed as the number of bits which should be reserved for the fractional part of the constant in fixed point format. <code>Qxx</code> stores only one word (16 bit) while <code>LQxx</code> stores two words (low word first):</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>        q05     <span class="fl">2.5</span>     <span class="co">; --&gt; 0050h</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>        lq20    ConstPI <span class="co">; --&gt; 43F7h 0032h</span></span></code></pre></div>
<p>Please do not flame me in case I calculated something wrong on my HP28...</p>
<h3 id="data">DATA</h3>
<p><em>valid for: PIC, 320xx, AVR, MELPS-4500, H8/500, HMCS400, 4004/4040, μPD772x, OLMS-40/50, Padauk</em></p>
<p>This command stores data in the current segment. Both integer values as well as character strings are supported. On 16C5x/16C8x, 17C4x in data segment, and on the 4500, 4004, and HMCS400 in code segment, characters occupy one word. On AVR, 17C4x in code segment, μPD772x in the data segments, and on 3201x/3202x, in general two characters fit into one word (LSB first). The μPD77C25 can hold three bytes per word in the code segment. When in 320C3x/C4x, mode the assembler puts four characters into one word (MSB first). In contrast to this characters occupy two memory locations in the data segment of the 4500, similar in the 4004 and HMCS400. The range of integer values corresponds to the word width of each processor in a specific segment. This means that <code>DATA</code> has the same result than <code>WORD</code> on a 320C3x/C4x (and that of <code>SINGLE</code> if AS recognizes the operand as a floating-point constant).</p>
<h3 id="zero-cp-1600">ZERO, CP-1600</h3>
<p><em>valid for: PIC</em></p>
<p>Generates a continuous string of zero words in memory (which equals a NOP on PIC).</p>
<h3 id="fb-and-fw">FB and FW</h3>
<p><em>valid for: COP4/8</em></p>
<p>These instruction allow to fill memory blocks with a byte or word constant. The first operand specifies the size of the memory block while the second one sets the filling constant itself.</p>
<h3 id="ascii-and-asciz">ASCII and ASCIZ</h3>
<p><em>valid for: ST6</em></p>
<p>Both commands store string constants to memory. While <code>ASCII</code> writes the character information only, <code>ASCIZ</code> additionally appends a zero to the end of the string.</p>
<h3 id="string-and-rstring">STRING and RSTRING</h3>
<p><em>valid for: 320C2(0)x, 320C5x</em></p>
<p>These commands are functionally equivalent to <code>DATA</code>, but integer values are limited to the range of byte values. This enables two characters or numbers to be packed together into one word. Both commands only differ in the order they use to write bytes: <code>STRING</code> stores the upper one first then the lower one, <code>RSTRING</code> does this vice versa. Note that when in 320C2(0)x/5x mode the assembler assumes that a label on the left side of this instruction has no type, i.e. it belongs to no address space. This behaviour is explained in the processor-specific hints.</p>
<h3 id="fcc">FCC</h3>
<p><em>valid for: 6502, 68xx</em></p>
<p>When in 65xx/68xx mode, string constants are generated using this instruction. In contrast to the original assembler AS11 from Motorola (this is the main reason why AS understands this command, the functionality is contained within the <code>BYT</code> instruction) you must enclose the string argument by double quotation marks instead of single quotation marks or slashes. Similarly to <code>DC</code>, a repetition factor enclosed in brackets ([...]) may be prepended to every single parameter.</p>
<h3 id="text">TEXT</h3>
<p>In CP-1600 mode, This instruction is used to store string constants in packed format, i.e. two characters per word.</p>
<h3 id="dfs-or-rmb">DFS or RMB</h3>
<p><em>valid for: 6502, 68xx</em></p>
<p>Reserves a memory block when in 6502/68xx mode. It is therefore the equivalent to <code>DS.B</code> on the 68000 or <code>DB ?</code> on Intel platforms.</p>
<h3 id="block">BLOCK</h3>
<p><em>valid for: ST6</em></p>
<p>Ditto.</p>
<h3 id="space">SPACE</h3>
<p><em>valid for: i960</em></p>
<p>Ditto.</p>
<h3 id="res">RES</h3>
<p><em>valid for: PIC, MELPS-4500, HMCS400, 3201x, 320C2(0)x, 320C5x, AVR, μPD772x, OLMS-40/50, Padauk, CP-1600</em></p>
<p>This command allocates memory. When used in code segments the argument counts words (10/12/14/16 bit). In data segments it counts bytes for PICs, nibbles for 4500 and OLMS-40/50 and words for the TI devices.</p>
<h3 id="bss">BSS</h3>
<p><em>valid for: 320C2(0)x, 320C3x/C4x/C5x/C6x, MSP</em></p>
<p><code>BSS</code> works like <code>RES</code>, but when in 320C2(0)x/5x mode, the assembler assumes that a label on the left side of this instruction has no type, i.e it belongs to no address space. This behaviour is explained in the processor-specific hints.</p>
<h3 id="dsb-and-dsw">DSB and DSW</h3>
<p><em>valid for: COP4/8</em></p>
<p>Both instructions allocate memory and ensure compatibility to ASMCOP from National. While <code>DSB</code> takes the argument as byte count, <code>DSW</code> uses it as word count (thus it allocates twice as much memory than <code>DSB</code>).</p>
<h3 id="ds16">DS16</h3>
<p><em>valid for: SC144xx</em></p>
<p>This instruction reserves memory in steps of full words, i.e. 16 bits. It is an alias for <code>DW</code>.</p>
<h3 id="align">ALIGN</h3>
<p><em>valid for: all processors</em></p>
<p>Takes the argument to align the program counter to a certain address boundary. AS increments the program counter to the next multiple of the argument. So, <code>ALIGN</code> corresponds to <code>DS.x</code> on 68000, but is much more flexible at the same time.</p>
<p>Example:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">align</span>     <span class="dv">2</span></span></code></pre></div>
<p>aligns to an even address (PC mod 2 = 0). If Align is used in this form with only one argument, the contents of the skipped memory space is not defined. An optional second argument may be used to define the (byte) value used to fill the area.</p>
<h3 id="ltorg">LTORG</h3>
<p><em>valid for: SH7x00</em></p>
<p>Although the SH7000 processor can do an immediate register load with 8 bit only, AS shows up with no such restriction. This behaviour is instead simulated through constants in memory. Storing them in the code segment (not far away from the register load instruction) would require an additional jump. AS Therefore gathers the constants an stores them at an address specified by <code>LTORG</code>. Details are explained in the processor-specific section somewhat later.</p>
<h2 id="macro-instructions">Macro Instructions</h2>
<p><em>valid for: all processors</em></p>
<p>Now we finally reach the things that make a macro assembler different from an ordinary assembler: the ability to define macros (guessed it !?).</p>
<p>When speaking about &#39;macros&#39;, I generally mean a sequence of (machine or pseudo) instructions which are united to a block by special statements and can then be treated in certain ways. The assembler knows the following statements to work with such blocks:</p>
<h3 id="macro">MACRO</h3>
<p>is probably the most important instruction for macro programming. The instruction sequence</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>&lt;name<span class="op">&gt;</span>  MACRO   <span class="op">[</span>parameter list<span class="op">]</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>        &lt;instructions<span class="op">&gt;</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>        ENDM</span></code></pre></div>
<p>defines the macro <code>&lt;name&gt;</code> to be the enclosed instruction sequence. This definition by itself does not generate any code! In turn, from now on the instruction sequence can simply be called by the name, the whole construct therefore shortens and simplifies programs. A parameter list may be added to the macro definition to make things even more useful. The parameters&#39; names have to be separated by commas (as usual) and have to conform to the conventions for symbol names (see <a href="#symbol-conventions">Symbol Conventions</a>) - like the macro name itself.</p>
<p><strong>Note:</strong> AS defines <code>ENDR</code> as a synonym of <code>ENDM</code>, which can be used whenever <code>ENDM</code> is used.</p>
<p>A switch to case-sensitive mode influences both macro names and parameters.</p>
<p>Similar to symbols, macros are local, i.e. they are only known in a section and its subsections when the definition is done from within a section. This behaviour however can be controlled in wide limits via the options <code>PUBLIC</code> and <code>GLOBAL</code> described below.</p>
<p>A default value may be provided for each macro parameter (appended via an equal sign). This value is used if there is no argument for this parameter at macro call or if the positional argument (see below) for this parameter is empty.</p>
<p>Apart from the macro parameters themselves, the parameter list may contain control parameters which influence the processing of the macro. These parameters are distinguished from normal parameters by being enclosed in braces. The following control parameters are defined:</p>
<ul>
<li><code>EXPAND/NOEXPAND</code>: rule whether the enclosed code shall be written to the listing when the macro is expanded. The default is the value set by the pseudo instruction <code>MACEXP_DFT</code>.</li>
<li><code>EXPIF/NOEXPIF</code>: rule whether instructions for conditional assembly and code excluded by it shall be written to the listing when the macro is expanded. The default is the value set by the pseudo instruction <code>MACEXP_DFT</code>.</li>
<li><code>EXPMACRO/NOEXPMACRO</code>: rule whether macros defined in the macro&#39;s body shall be written to the listing when the macro is expanded. The default is the value set by the pseudo instruction <code>MACEXP_DFT</code>.</li>
<li><code>EXPREST/NOEXPREST</code> : rule whether a macro body&#39;s lines not fitting into the first two categories shall be written to the listing when the macro is expanded. The default is the value set by the pseudo instruction <code>MACEXP_DFT</code>.</li>
<li><code>PUBLIC[:section name]</code>: assigns the macro to a parent section instead of the current section. A section can make macros accessible for the outer code this way. If the section specification is missing, the macro becomes completely global, i.e. it may be referenced from everywhere.</li>
<li><code>GLOBAL[:section name]</code>: rules that in addition to the macro itself, another macro shall be generated that has the same contents but is assigned to the specified section. Its name is constructed by concatenating the current section&#39;s name to the macro name. The section specified must be a parent section of the current section; if the specification is missing, the additional macro becomes globally visible. For example, if a macro <code>A</code> is defined in a section <code>B</code> that is a child section of section <code>C</code>, an additional global macro named <code>C_B_A</code> would be generated. In contrast, if <code>C</code> had been specified as target section, the macro would be named <code>B_A</code> and be assigned to section <code>C</code>. This option is turned off by default and it only has an effect when it is used from within a section. The macro defined locally is not influenced by this option.</li>
<li><code>EXPORT/NOEXPORT</code>: rules whether the definition of this macro shall be written to a separate file in case the <code>-M</code> command line option was given. This way, definitions of &#39;private&#39; macros may be mapped out selectively. The default is FALSE, i.e. the definition will not be written to the file. The macro will be written with the concatenated name if the <code>GLOBAL</code> option was additionally present.</li>
<li><code>INTLABEL/NOINTLABEL</code> : rules whether a label defined in a line that calls this macro may be used as an additional parameter inside the label or not, instead of simply &#39;labeling&#39; the line.</li>
<li><code>GLOBALSYMBOLS/NOGLOBALSYMBOLS</code> : rules whether labels defined in the macro&#39;s body shall be local to this macro or also be available outside the macro. The default is to keep them local, since using a macro multiple time would be difficult otherwise.</li>
</ul>
<p>The control parameters described above are removed from the parameter list by AS, i.e. they do not have a further influence on processing and usage.</p>
<p>When a macro is called, the parameters given for the call are textually inserted into the instruction block and the resulting assembler code is assembled as usual. Zero length parameters are inserted in case too few parameters are specified. It is important to note that string constants are not protected from macro expansions. The old IBM rule:</p>
<blockquote>
<p><em>It&#39;s not a bug, it&#39;s a feature!</em></p>
</blockquote>
<p>applies for this detail. The gap was left to allow checking of parameters via string comparisons. For example, one can analyze a macro parameter in the following way:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="bu">mul</span>     MACRO   para<span class="op">,</span>parb</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>        <span class="pp">IF</span>      UpString<span class="op">(</span><span class="st">&quot;PARA&quot;</span><span class="op">)&lt;&gt;</span><span class="st">&quot;A&quot;</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">MOV</span>    a<span class="op">,</span>para</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>        ENDIF</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>        <span class="pp">IF</span>      UpString<span class="op">(</span><span class="st">&quot;PARB&quot;</span><span class="op">)&lt;&gt;</span><span class="st">&quot;B&quot;</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">MOV</span>    b<span class="op">,</span>parb</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>        ENDIF</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>        !<span class="bu">mul</span>     ab</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>        ENDM</span></code></pre></div>
<p>It is important for the example above that the assembler converts all parameter names to upper case when operating in case-insensitive mode, but this conversion never takes place inside of string constants. Macro parameter names therefore have to be written in upper case when they appear in string constants.</p>
<p>Macro arguments may be given in either of two forms: <em>positional</em> or <em>keyword</em> arguments.</p>
<p>For positional arguments, the assignment of arguments to macro parameters simply results from the position of arguments, i.e. the first argument is assigned to the first parameter, the second argument to the second parameter and so on. If the number of arguments is smaller than the number of parameters, eventually defined default values or simply an empty string are inserted. The same is valid for empty arguments in the argument list.</p>
<p>Keyword arguments on the other hand explicitly define which parameter they relate to, by being prefixed with the parameter&#39;s name:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mul</span>  para<span class="op">=</span>r0<span class="op">,</span>parb<span class="op">=</span>r1</span></code></pre></div>
<p>Again, non-assigned parameters will use an eventually defined default or an empty string.</p>
<p>As a difference to positional arguments, keyword arguments allow to assign an empty string to a parameter with a non-empty default.</p>
<p>Mixing of positional and keyword arguments in one macro call is possible, however it is not allowed to use positional arguments after the first keyword argument.</p>
<p>The same naming rules as for usual symbols also apply for macro parameters, with the exception that only letters and numbers are allowed, i.e. dots and underscores are forbidden. This constraint has its reason in a hidden feature: the underscore allows to concatenate macro parameter names to a symbol, like in the following example:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>concat  macro   part1<span class="op">,</span>part2</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">call</span>    part1_part2</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>The call</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>        concat  module<span class="op">,</span>function</span></code></pre></div>
<p>will therefore result in</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>        <span class="cf">call</span>    module_function</span></code></pre></div>
<p>Additionally, parameter names surrounded by <code>\\</code> will be replaced as one. For example:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>concat  macro   part1<span class="op">,</span>part2</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">call</span>    <span class="op">\</span>part1<span class="op">\\</span>part2<span class="op">\</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>The call</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>        concat  module<span class="op">,</span>function</span></code></pre></div>
<p>will therefore result in</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>        <span class="cf">call</span>    modulefunction</span></code></pre></div>
<p>Apart from the parameters explicitly declared for a macro, four more &#39;implicitly&#39; declared parameters exist. Since they are always present, they cannot not be redeclared as explicit parameters:</p>
<ul>
<li><code>ATTRIBUTE</code> refers to the attribute appended to the macro call, in case the currently active architecture supports attributes for machine instructions. See below for an example!</li>
<li><code>ALLARGS</code> refers to a comma-separated list of all arguments passed to a macro, usable e.g. to pass them on to a IRP statement.</li>
<li><code>ARGCOUNT</code> refers to the actual count of parameters passed to a macro. Note however that this number is never lower than the formal parameter count of the macro, since AS will fill up missing arguments with empty strings!</li>
<li><code>__LABEL__</code> refers to a label present in a line that calls the macro. This replacement only takes place if the <code>INTLABEL</code> option was set for this macro!</li>
</ul>
<p><strong>IMPORTANT:</strong> the names of these implicit parameters are also case-insensitive if AS was told to operate case-sensitive!</p>
<p>The purpose of being able to &#39;internally&#39; use a label in a macro is surely not immediately obvious. There might be cases where moving the macro&#39;s entry point into its body may be useful. The most important application however are TI signal processors that use a double pipe symbol in the label&#39;s column to mark parallelism, like this:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>        instr1</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    ||  instr2</span></code></pre></div>
<p>(since both instructions merge into a single word of machine code, you cannot branch to the second instruction - so occupying the label&#39;s position doesn&#39;t hurt). The problem is however that some &#39;convenience instructions&#39; are realized as macros. A parallelization symbol written in front of a macro call normally would be assigned to the macro itself, <em>not to the macro body&#39;s first instruction</em>. However, things work with this trick:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>myinstr macro <span class="op">{</span>INTLABEL<span class="op">}</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>__LABEL__</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>        instr2</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>        endm</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>        instr1</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>||      myinstr</span></code></pre></div>
<p>The result after expanding <code>myinstr</code> is identical to the previous example without macro.</p>
<p>Recursion of macros, i.e. the repeated call of a macro from within its own body is completely legal. However, like for any other sort of recursion, one has to assure that there is an end at someplace. For cases where one forgot this, AS keeps an internal counter for every macro that is incremented when an expansion of this macro is begun and decremented again when the expansion is completed. In case of recursive calls, this counter reaches higher and higher values, and at a limit settable via <code>NESTMAX</code>, AS will refuse to expand. Be careful when you turn off this emergency brake: the memory consumption on the heap may go beyond all limits and even shut down a Unix system...</p>
<p>A small example to remove all clarities ;-)</p>
<p>A programmer brain damaged by years of programming Intel processors wants to have the instructions <code>PUSH/POP</code> also for the 68000. He solves the &#39;problem&#39; in the following way:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="bu">push</span>    macro   op</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>        move<span class="op">.</span>ATTRIBUTE op<span class="op">,-(</span><span class="kw">sp</span><span class="op">)</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>        endm</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="bu">pop</span>     macro   op</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>        move<span class="op">.</span>ATTRIBUTE <span class="op">(</span><span class="kw">sp</span><span class="op">)+,</span>op</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>If one writes</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">push</span>    d0</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">pop</span><span class="op">.</span>l   a2</span></code></pre></div>
<p>this results in</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>        move<span class="op">.</span>   d0<span class="op">,-(</span><span class="kw">sp</span><span class="op">)</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>        move<span class="op">.</span>l  <span class="op">(</span><span class="kw">sp</span><span class="op">)+,</span>a2</span></code></pre></div>
<p>A macro definition must not cross include file boundaries.</p>
<p>Labels defined in macros always are regarded as being local, unless the <code>GLOBALSYMBOLS</code> was used in the macro&#39;s definition. If a single label shall be made public in a macro that uses local labels otherwise, it may be defined with a <code>LABEL</code> statement which always creates global symbols (similar to <code>BIT, SFR...</code>):</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>&lt;Name<span class="op">&gt;</span>  label   <span class="op">$</span></span></code></pre></div>
<p>When parsing a line, the assembler first checks the macro list afterwards looks for processor instructions, which is why macros allow to redefine processor instructions. However, the definition should appear previously to the first invocation of the instruction to avoid phase errors like in the following example:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">bsr</span>     target</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="bu">bsr</span>     macro   targ</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>        jsr     targ</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>        endm</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">bsr</span>     target</span></code></pre></div>
<p>In the first pass, the macro is not known when the first <code>BSR</code> instruction is assembled; an instruction with 4 bytes of length is generated. In the second pass however, the macro definition is immediately available (from the first pass), a <code>JSR</code> of 6 bytes length is therefore generated. As a result, all labels following are too low by 2 and phase errors occur for them. An additional pass is necessary to resolve this.</p>
<p>Because a machine or pseudo instruction becomes hidden when a macro of same name is defined, there is a backdoor to reach the original meaning: the search for macros is suppressed if the name is prefixed with an exclamation mark (!). This may come in handy if one wants to extend existing instructions in their functionality, e.g. the TLCS-90&#39;s shift instructions:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>srl     macro   op<span class="op">,</span>n            <span class="co">; shift by n places</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>        <span class="pp">rept</span>    n               <span class="co">; n simple instructions</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>        !srl   op</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>        endm</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>From now on, the <code>SRL</code> instruction has an additional parameter...</p>
<h4 id="macro-expansion-in-the-listing">Macro Expansion in the Listing</h4>
<p>If a macro is being called, the macro&#39;s body is included in the assembly listing, after arguments have been expanded. This can significantly increase the listing&#39;s size and make it hard to read. It is therefore possible to suppress this expansion totally or in parts. Fundamentally, AS divides the source lines contained in a macro&#39;s body into three classes:</p>
<ul>
<li>Macro definitions, i.e. the macro is used to define another macro, or it contains <code>REPT/IRP/IRPC/WHILE</code> blocks.</li>
<li>Instructions for conditional assembly plus any source lines that have <em>not</em> been assembled due to conditional assembly. Since conditional assembly may depend on macro arguments, this subset may also vary.</li>
<li>All remaining source lines that do not fall under the first two categories.</li>
</ul>
<p>Which parts occur in the listing may be defined individually for every macro. When defining a macro, the default is the set defined by the most recent <code>MACEXP_DFT</code> instruction (<a href="#macexp_dft-and-macexp_ovr">MACEXP_DFT and MACEXP_OVR</a>). If one of the <code>EXPAND/NOEXPAND</code>, <code>EXPIF/NOEXPIF</code> <code>EXPMACRO/NOEXPMACRO</code>, or <code>EXPREST/NOEXPREST</code> directives is used in the macro&#39;s definition, they act <em>additionally</em>, but with higher preference. For instance, if expansion had been disabled completely (<code>MACEXP_DFT OFF</code>), adding the directive <code>EXPREST</code> has the effect that when using this macro, only lines are written to the listing that remain after conditional assembly and are no macro definitions themselves.</p>
<p>In consequence, changing the set via <code>MACEXP_DFT</code> has no effect on macros that have been <em>defined before</em> this statement. The listing&#39;s section shows for defined macros the effective set of expansion directives. The list given in curly braces is shortened so that it only contains the last (and therefore valid) directive for a certain class of source lines. A <code>NOIF</code> given via <code>MACEXP_DFT</code> will therefore not show up if the directive <code>EXPIF</code> had been given specifically for this macro.</p>
<p>There might be cases where it is useful to override the expansion rules for a certain macro, regardless whether they were given by <code>MACEXP_DFT</code> or individual directives. The statement <code>MACEXP_OVR</code> (<a href="#macexp_dft-and-macexp_ovr">MACEXP_DFT and MACEXP_OVR</a>) exists for such cases. It only has an effects on macros subsequently being <em>expanded</em>. Once again, directives given by this instruction are regarded in addition to a macro&#39;s rules, and they do with higher priority. A <code>MACEXP_OVR</code> without any arguments disables such an override.</p>
<h3 id="irp">IRP</h3>
<p>is a simplified macro definition for the case that an instruction sequence shall be applied to a couple of operands and the the code is not needed any more afterwards. <code>IRP</code> needs a symbol for the operand as its first parameter, and an (almost) arbitrary number of parameters that are sequentially inserted into the block of code. For example, one can write</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>        <span class="pp">irp</span>     op<span class="op">,</span> acc<span class="op">,</span>b<span class="op">,</span>dpl<span class="op">,</span>dph</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">push</span>    op</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>to push a couple of registers to the stack, what results in</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">push</span>    acc</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">push</span>    b</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">push</span>    dpl</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">push</span>    dph</span></code></pre></div>
<p>Analog to a macro definition, the argument list may contain the control parameters <code>GLOBALSYMBOLS</code> resp. <code>NOGLOBALSYMBOLS</code> (marked as such by being enclosed in curly braces). This allows to control whether used labels are local for every pass or not.</p>
<h3 id="irpn">IRPN</h3>
<p>is similar to <code>IRP</code>, but it uses a specifiable amount of arguments each expansion. <code>IRPN</code> needs a number of arguments per iteration as its first parameter (lets call this <code>count</code>), <code>count</code> symbol names, and an (almost) arbitrary number of parameters that are sequentially inserted in batches of <code>count</code> parameters into the block of code. For example, one can write</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>        irpn <span class="dv">2</span><span class="op">,</span>addr<span class="op">,</span>pos<span class="op">,</span>label1<span class="op">,</span><span class="dv">0</span><span class="op">,</span>label2<span class="op">,</span><span class="dv">16</span><span class="op">,</span>label3<span class="op">,</span><span class="dv">27</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>        dc<span class="op">.</span>l addr</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>        dc<span class="op">.</span>w <span class="op">$</span>C000 <span class="op">+</span> pos</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>to define the following table</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>        dc<span class="op">.</span>l label1</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>        dc<span class="op">.</span>w <span class="op">$</span>C000</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>        dc<span class="op">.</span>l label2</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>        dc<span class="op">.</span>w <span class="op">$</span>C010</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>        dc<span class="op">.</span>l label3</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>        dc<span class="op">.</span>w <span class="op">$</span>C01B</span></code></pre></div>
<p>Analog to a macro definition, the argument list may contain the control parameters <code>GLOBALSYMBOLS</code> resp. <code>NOGLOBALSYMBOLS</code> (marked as such by being enclosed in curly braces). This allows to control whether used labels are local for every pass or not.</p>
<h3 id="irpc">IRPC</h3>
<p><code>IRPC</code> is a variant of <code>IRP</code> where the first argument&#39;s occurrences in the lines up to <code>ENDM</code> are successively replaced by the characters of a string instead of further parameters. For example, an especially complicated way of placing a string into memory would be:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>        irpc    char<span class="op">,</span><span class="st">&quot;Hello World&quot;</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>        <span class="dt">db</span>      <span class="st">&#39;CHAR&#39;</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p><strong>CAUTION!</strong> As the example already shows, <code>IRPC</code> only inserts the pure character; it is the programmer&#39;s task to assure that valid code results (in this example by inserting quotes, including the detail that no automatic conversion to uppercase characters is done).</p>
<h3 id="rept">REPT</h3>
<p>is the simplest way to employ macro constructs. The code between <code>REPT</code> and <code>ENDM</code> is assembled as often as the integer argument of <code>REPT</code> specifies. This statement is commonly used in small loops to replace a programmed loop to save the loop overhead.</p>
<p>An example for the sake of completeness:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>        <span class="pp">rept</span>    <span class="dv">3</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>        rr      a</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>rotates the accumulator to the right by three digits.</p>
<p>The optional control parameters <code>GLOBALSYMBOLS</code> resp. <code>NOGLOBALSYMBOLS</code> (marked as such by being enclosed in curly braces) may also be used here to decide whether labels are local to the individual repetitions.</p>
<p>In case <code>REPT</code>&#39;s argument is equal to or smaller than 0, no expansion at all is done. This is different to older versions of AS which used to be a bit &#39;sloppy&#39; in this respect and always made a single expansion.</p>
<h3 id="while">WHILE</h3>
<p><code>WHILE</code> operates similarly to <code>REPT</code>, but the fixed number of repetitions given as an argument is replaced by a boolean expression. The code framed by <code>WHILE</code> and <code>ENDM</code> is assembled until the expression becomes logically false. This may mean in the extreme case that the enclosed code is not assembled at all in case the expression was already false when the construct was found. On the other hand, it may happen that the expression stays true forever and AS will run infinitely...one should apply therefore a bit of accuracy when one uses this construct, i.e. the code must contain a statement that influences the condition, e.g. like this:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>cnt     set     <span class="dv">1</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>sq      set     cnt<span class="op">*</span>cnt</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>        <span class="pp">while</span>   sq<span class="op">&lt;=</span><span class="dv">1000</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>        dc<span class="op">.</span>l    sq</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>cnt     set     cnt<span class="op">+</span><span class="dv">1</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>sq      set     cnt<span class="op">*</span>cnt</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>This example stores all square numbers up to 1000 to memory.</p>
<p>Currently there exists a little ugly detail for <code>WHILE</code>: an additional empty line that was not present in the code itself is added after the last expansion. This is a &#39;side effect&#39; based on a weakness of the macro processor and it is unfortunately not that easy to fix. I hope no one minds...</p>
<h3 id="exitm">EXITM</h3>
<p><code>EXITM</code> offers a way to terminate a macro expansion or one of the instructions <code>REPT, IRP,</code> or <code>WHILE</code> prematurely. Such an option helps for example to replace encapsulations with <code>IF-ENDIF</code>-ladders in macros by something more readable. Of course, an <code>EXITM</code> itself always has to be conditional, what leads us to an important detail: When an <code>EXITM</code> is executed, the stack of open <code>IF</code> and <code>SWITCH</code> constructs is reset to the state it had just before the macro expansion started. This is imperative for conditional <code>EXITM</code>&#39;s as the <code>ENDIF</code> resp. <code>ENDCASE</code> that frames the <code>EXITM</code> statement will not be reached any more; AS would print an error message without this trick. Please keep also in mind that <code>EXITM</code> always only terminates the innermost construct if macro constructs are nested! If one want to completely break out of a nested construct, one has to use additional <code>EXITM</code>&#39;s on the higher levels!</p>
<h3 id="shift">SHIFT</h3>
<p><code>SHIFT</code> is a tool to construct macros with variable argument lists: it discards the first parameter, with the result that the second parameter takes its place and so on. This way one could process a variable argument list...if you do it the right way. For example, the following does not work...</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>pushlist  macro reg</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>        <span class="pp">rept</span>  ARGCOUNT</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">push</span>  reg</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>        shift</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>        endm</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>...because the macro gets expanded <code>once</code>, its output is captured by <code>REPT</code> and then executed n times. Therefore, the first argument is saved n times...the following approach works better:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>pushlist  macro reg</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>        <span class="pp">if</span>      <span class="st">&quot;REG&quot;</span><span class="op">&lt;&gt;</span><span class="st">&quot;&quot;</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">push</span>    reg</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>        shift</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>        pushlist ALLARGS</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>        endif</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>Effectively, this is a recursion that shortens the argument list once per step. The important trick is that a new macro expansion is started in each step... An alternative to recursion is to use <code>IRP</code> or <code>IRPN</code> instead of <code>REPT</code>:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>pushlist  macro reg</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>        <span class="pp">irp</span>  reg<span class="op">,</span> ALLARGS</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">push</span>  reg</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>        endm</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>In case <code>SHIFT</code> ist already a machine instruction for a certain target, one has to use <code>SHIFT</code> instead.</p>
<h3 id="maxnest">MAXNEST</h3>
<p><code>MAXNEST</code> allows to adjust how often a macro may be called recursively before AS terminates with an error message. The argument may be an arbitrary positive integer value, with the special value 0 turning the this security brake completely off (be careful with that...). The default value for the maximum nesting level is 256; its current value may be read from the integer symbol of same name.</p>
<h3 id="function">FUNCTION</h3>
<p>Though <code>FUNCTION</code> is not a macro statement in the inner sense, I will describe this instruction at this place because it uses similar principles like macro replacements.</p>
<p>This instruction is used to define new functions that may then be used in formula expressions like predefined functions. The definition must have the following form:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>&lt;name<span class="op">&gt;</span>  FUNCTION <span class="op">&lt;</span>arg<span class="op">&gt;,...,&lt;</span>arg<span class="op">&gt;,&lt;</span>expression<span class="op">&gt;</span></span></code></pre></div>
<p>The arguments are the values that are &#39;fed into&#39; the function. The definition uses symbolic names for the arguments. The assembler knows by this that where to insert the actual values when the function is called. This can be seen from the following example:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>isdigit FUNCTION <span class="kw">ch</span><span class="op">,(</span><span class="kw">ch</span><span class="op">&gt;=</span><span class="st">&#39;0&#39;</span><span class="op">)&amp;&amp;(</span><span class="kw">ch</span><span class="op">&lt;=</span><span class="st">&#39;9&#39;</span><span class="op">)</span></span></code></pre></div>
<p>This function checks whether the argument (interpreted as a character) is a number in the currently valid character set (the character set can be modified via <code>CHARSET</code>, therefore the careful wording).</p>
<p>The arguments&#39; names (<code>CH</code> in this case) must conform to the stricter rules for macro parameter names, i.e. the special characters . and _ are not allowed.</p>
<p>User-defined functions can be used in the same way as builtin functions, i.e. with a list of parameters, separated by commas, enclosed in parentheses:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>        <span class="pp">IF</span> isdigit<span class="op">(</span>char<span class="op">)</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>        message <span class="st">&quot;\{char} is a number&quot;</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>        ELSEIF</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>        message <span class="st">&quot;\{char} is not a number&quot;</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>        ENDIF</span></code></pre></div>
<p>When the function is called, all parameters are calculated once and are then inserted into the function&#39;s formula. This is done to reduce calculation overhead and to avoid side effects. The individual arguments have to be separated by commas when a function has more than one parameter.</p>
<p><strong>CAUTION!</strong> Similar to macros, one can use user-defined functions to override builtin functions. This is a possible source for phase errors. Such definitions therefore should be done before the first call!</p>
<p>The result&#39;s type may depend on the type of the input arguments as the arguments are textually inserted into the function&#39;s formula. For example, the function</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>double  function x<span class="op">,</span>x<span class="op">+</span>x</span></code></pre></div>
<p>may have an integer, a float, or even a string as result, depending on the argument&#39;s type!</p>
<p>When AS operates in case-sensitive mode, the case matters when defining or referencing user-defined functions, in contrast to builtin functions!</p>
<h2 id="structures">Structures</h2>
<p><em>valid for: all processors</em></p>
<p>Even in assembly language programs, there is sometimes the necessity to define composed data structures, similar to high-level languages. AS supports both the definition and usage of structures with a couple of statements. These statements shall be explained in the following section.</p>
<h3 id="definition">Definition</h3>
<p>The definition of a structure is begun with the statement <code>STRUCT</code> and ends with <code>ENDSTRUCT</code> (lazy people may also write <code>STRUC</code> resp. <code>ENDSTRUC</code> or <code>ENDS</code> instead). A optional label preceding these instructions is taken as the name of the structure to be defined; it is optional at the end of the definition and may be used to redefine the length symbol&#39;s name (see below). The remaining procedure is simple: Together with <code>STRUCT</code>, the current program counter is saved and reset to zero. All labels defined between <code>STRUCT</code> and <code>ENDSTRUCT</code> therefore are the offsets of the structure&#39;s data fields. Reserving space is done via the same instructions that are also otherwise used for reserving space, like e.g. <code>DS.x</code> for Motorola CPUs or <code>DB</code> &amp; co. for Intel-style processors. The rules for rounding up lengths to assure certain alignments also apply here - if one wants to define &#39;packed&#39; structures, a preceding <code>PADDING OFF</code> may be necessary. Vice versa, alignments may be forced with <code>ALIGN</code> or similar instructions.</p>
<p>Since such a definition only represents a sort of &#39;prototype&#39;, only instructions that reserve memory may be used, no instructions that dispose constants or generate code.</p>
<p>Labels defined inside structures (i.e. the elements&#39; names) are not stored as-is. Instead, the structure&#39;s name is prepended to them, separated with a special character. By default, this is the underline (_). This behaviour however may be modified with two arguments passed to the <code>STRUCT</code> statement:</p>
<ul>
<li><code>NOEXTNAMES</code> suppressed the prepending of the structure&#39;s name. In this case, it is the programmer&#39;s responsibility to assure that field names are not used more than once.</li>
<li><code>DOTS</code> instructs AS to use the dot as connecting character instead of the underline. It should however be pointed out that on certain target architectures, the dot has a special meaning for bit addressing, which may lead to problems!</li>
</ul>
<p>It is futhermore possible to turn the usage of a dot on resp. off for all following structures:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>dottedstructs <span class="op">&lt;</span>on<span class="op">|</span>off<span class="op">&gt;</span></span></code></pre></div>
<p>Aside from the element names, AS also defines a further symbol with the structure&#39;s overall length when the definition has been finished. This symbol has the name <code>LEN</code>, which is being extended with the structure&#39;s name via the same rules - or alternatively with the label name given with the <code>ENDSTRUCT</code> statement.</p>
<p>In practice, this may things may look like in this example:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>Rec     STRUCT</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>Ident   <span class="dt">db</span>      <span class="op">?</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>Pad     <span class="dt">db</span>      <span class="op">?</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>Pointer <span class="dt">dd</span>      <span class="op">?</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>Rec     ENDSTRUCT</span></code></pre></div>
<p>In this example, the symbol <code>REC_LEN</code> would be assigned the value 6.</p>
<h3 id="usage">Usage</h3>
<p>Once a structure has been assigned, usage is as simple as possible and similar to a macro: a simple</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>thisrec Rec</span></code></pre></div>
<p>reserves as much memory as needed to hold an instance of the structure, and additionally defines a symbol for every element of the structure with its address, in this case <code>THISREC_IDENT, THISREC_PAD</code>, and <code>THISREC_POINTER</code>. A label naturally must not be omitted when calling a structure; if it is missing, an error will be emitted.</p>
<p>Additional arguments allow to reserve memory for a whole array of structures. The dimensions (up to three) are defined via arguments in square brackets:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>thisarray Rec <span class="op">[</span><span class="dv">10</span><span class="op">],[</span><span class="dv">2</span><span class="op">]</span></span></code></pre></div>
<p>In this example, space for 2 * 10 = 20 structures is reserved. For each individual structure in the array, proper symbols are generated that have the array indices in their name.</p>
<h3 id="nested-structures">Nested Structures</h3>
<p>Is is perfectly valid to call an already defined structure within the definition of another structure. The procedure that is taking place then is a combination of the definition and calling described in the previous two sections: elements of the substructure are being defined, the name of the instance is being prepended, and the name of the super-structure is once again getting prepended to this concatenated name. This may look like the following:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>TreeRec struct</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>left    <span class="dt">dd</span>         <span class="op">?</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>right   <span class="dt">dd</span>         <span class="op">?</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="bu">data</span>    Rec</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>TreeRec endstruct</span></code></pre></div>
<p>It is also allowed to define one structure inside of another structure:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>TreeRec struct</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>left    <span class="dt">dd</span>         <span class="op">?</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>right   <span class="dt">dd</span>         <span class="op">?</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>TreeData struct</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>name    <span class="dt">db</span>         <span class="dv">32</span> dup<span class="op">(?)</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>id      <span class="dt">dw</span>         <span class="op">?</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>TreeData endstruct</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>TreeRec endstruct</span></code></pre></div>
<h3 id="unions">Unions</h3>
<p>A union is a special form of a structure whose elements are not laid out sequentially in memory. Instead all elements occupy the <em>same</em> memory and are located at offset 0 in the structure. Naturally, such a definition basically does nothing more than to assign the value of zero to a couple of symbols. It may however be useful to clarify the overlap in a program and therefore to make it more &#39;readable&#39;. The size of a union is the maximum of all elements&#39; lengths.</p>
<h3 id="nameless-structures">Nameless Structures</h3>
<p>The name of a structure or union is optional if it is part of another (named) structure or union. Elements of this structure will then become part of of the &#39;next higher&#39; named structure. For example,</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>TreeRec struct</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>left    <span class="dt">dd</span>         <span class="op">?</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>right   <span class="dt">dd</span>         <span class="op">?</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>        struct</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>name    <span class="dt">db</span>         <span class="dv">32</span> dup<span class="op">(?)</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>id      <span class="dt">dw</span>         <span class="op">?</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>        endstruct</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>TreeRec endstruct</span></code></pre></div>
<p>generates the symbols <code>TREEREC_NAME</code> and <em>TREEREC_ID</em>.</p>
<p>Futhermore, no symbol holding its length is generated for an unnamed structure or union.</p>
<h3 id="structures-and-sections">Structures and Sections</h3>
<p>Symbols that are created in the course of defining or usage of structures are treated just like normal symbols, i.e. when used within a section, these symbols are local to the section. The same is however also true for the structures themselves, i.e. a structure defined within a section cannot be used outside of the section.</p>
<h3 id="structures-and-macros">Structures and Macros</h3>
<p>If one wants to instantiate structures via macros, one has to use the <code>GLOBALSYMBOLS</code> options when defining the macro to make the defined symbols visible outside the macro. For instance, a list of structures can be defined in the following way:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>        <span class="pp">irp</span>     name<span class="op">,{</span>GLOBALSYMBOLS<span class="op">},</span>rec1<span class="op">,</span>rec2<span class="op">,</span>rec3</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>name    Rec</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<h2 id="conditional-assembly">Conditional Assembly</h2>
<p><em>valid for: all processors</em></p>
<p>The assembler supports conditional assembly with the help of statements like <code>IF...</code> or <code>SWITCH...</code>. These statements work at assembly time, allowing or disallowing the assembly of program parts based on conditions. They are therefore not to be compared with IF statements of high-level languages (though it would be tempting to extend assembly language with structurization statements of higher-level languages...).</p>
<p>The following constructs may be nested arbitrarily (until a memory overflow occurs).</p>
<h3 id="if--elseif--endif">IF / ELSEIF / ENDIF</h3>
<p><code>IF</code> is the most common and most versatile construct. The general style of an <code>IF</code> statement is as follows:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>        <span class="pp">IF</span>      <span class="op">&lt;</span>expression <span class="dv">1</span><span class="op">&gt;</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>        &lt;block <span class="dv">1</span><span class="op">&gt;</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>        ELSEIF  <span class="op">&lt;</span>expression <span class="dv">2</span><span class="op">&gt;</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>        &lt;block <span class="dv">2</span><span class="op">&gt;</span></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>        (possibly more ELSEIFs<span class="op">)</span></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>        ELSEIF</span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>        &lt;block n<span class="op">&gt;</span></span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>        ENDIF</span></code></pre></div>
<p><code>IF</code> serves as an entry, evaluates the first expression, and assembles block 1 if the expression is true (i.e. not 0). All further <code>ELSEIF</code>-blocks will then be skipped. However, if the expression is false, block 1 will be skipped and expression 2 is evaluated. If this expression turns out to be true, block 2 is assembled. The number of <code>ELSEIF</code> parts is variable and results in an <code>IF-THEN-ELSE</code> ladder of an arbitrary length. The block assigned to the last <code>ELSEIF</code> (without argument) only gets assembled if all previous expressions evaluated to false; it therefore forms a &#39;default&#39; branch. It is important to note that only <strong>one</strong> of the blocks will be assembled: the first one whose <code>IF/ELSEIF</code> had a true expression as argument.</p>
<p>The <code>ELSEIF</code> parts are optional, i.e. <code>IF</code> may directly be followed by an <code>ENDIF</code>. An <code>ELSEIF</code> without parameters must be the last branch.</p>
<p><code>ELSEIF</code> always refers to the innermost, unfinished <code>IF</code> construct in case <code>IF</code>&#39;s are nested.</p>
<p>In addition to <code>IF</code>, the following further conditional statements are defined:</p>
<ul>
<li><code>IFDEF &lt;symbol&gt;</code>: true if the given symbol has been defined. The definition has to appear before <code>IFDEF</code>.</li>
<li><code>IFNDEF &lt;symbol&gt;</code>: counterpart to <code>IFDEF</code>.</li>
<li><code>IFUSED &lt;symbol&gt;</code>: true if if the given symbol has been referenced at least once up to now.</li>
<li><code>IFNUSED &lt;symbol&gt;</code>: counterpart to <code>IFUSED</code>.</li>
<li><code>IFEXIST &lt;name&gt;</code>: true if the given file exists. The same rules for search paths and syntax apply as for the <code>INCLUDE</code> instruction (see section <a href="#include">INCLUDE</a>).</li>
<li><code>IFNEXIST &lt;name&gt;</code>: counterpart to <code>IFEXIST</code>.</li>
<li><code>IFB &lt;arg-list&gt;</code>: true if all arguments of the parameter list are empty strings.</li>
<li><code>IFNB &lt;arg-list&gt;</code>: counterpart to <code>IFB</code>.</li>
</ul>
<p>It is valid to write <code>ELSE</code> instead of <code>ELSEIF</code> since everybody seems to be used to it...</p>
<p>For every IF... statement, there has to be a corresponding <code>ENDIF</code>. &#39;Open&#39; constructs will lead to an error message at the end of an assembly path. The way AS has &#39;paired&#39; <code>ENDIF</code> statements with <code>IF</code>s may be deduced from the assembly listing: for <code>ENDIF</code>, the line number of the corresponding <code>IF...</code> will be shown.</p>
<h3 id="switch--case--elsecase--endcase">SWITCH / CASE / ELSECASE / ENDCASE</h3>
<p><code>CASE</code> is a special case of <code>IF</code> and is designed for situations when an expression has to be compared with a couple of values. This could of course also be done with a series of <code>ELSEIF</code>s, but the following form</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>        SWITCH  <span class="op">&lt;</span>expression<span class="op">&gt;</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>        CASE    <span class="op">&lt;</span>value <span class="dv">1</span><span class="op">&gt;</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>        &lt;block <span class="dv">1</span><span class="op">&gt;</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>        CASE    <span class="op">&lt;</span>value <span class="dv">2</span><span class="op">&gt;</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>        &lt;block <span class="dv">2</span><span class="op">&gt;</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>        (further CASE blocks<span class="op">)</span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>        CASE    <span class="op">&lt;</span>value n<span class="op">-</span><span class="dv">1</span><span class="op">&gt;</span></span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>        &lt;block n<span class="op">-</span><span class="dv">1</span><span class="op">&gt;</span></span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>        ELSECASE</span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>        &lt;block n<span class="op">&gt;</span></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>        ENDCASE</span></code></pre></div>
<p>has the advantage that the expression is only written once and also only gets evaluated once. It is therefore less error-prone and slightly faster than an <code>IF</code> chain, but obviously not as flexible.</p>
<p>It is possible to specify multiple values separated by commas to a <code>CASE</code> statement in order to assemble the following block in multiple cases. The <code>ELSECASE</code> branch again serves as a &#39;trap&#39; for the case that none of the <code>CASE</code> conditions was met. AS will issue a warning in case it is missing and all comparisons fail.</p>
<p>Even when value lists of <code>CASE</code> branches overlap, only <strong>one</strong> branch is executed, which is the first one in case of ambiguities.</p>
<p><code>SWITCH</code> only serves to open the whole construct; an arbitrary number of statements may be between <code>SWITCH</code> and the first <code>CASE</code> (but don&#39;t leave other <code>IF</code>s open!), for the sake of better readability this should however not be done.</p>
<p>In case that <code>SWITCH</code> is already a machine instruction on the selected processor target, the construct is started instead with <code>SELECT</code>.</p>
<p>Similarly to <code>IF</code> constructs, there must be exactly one <code>ENDCASE</code> for every <code>SWITCH</code>. Analogous to <code>ENDIF</code>, for <code>ENDCASE</code> the line number of the corresponding <code>SWITCH</code> is shown in the listing.</p>
<h2 id="listing-control">Listing Control</h2>
<p><em>valid for: all processors</em></p>
<h3 id="page">PAGE</h3>
<p><code>PAGE</code> is used to tell AS the dimensions of the paper that is used to print the assembly listing. The first parameter is thereby the number of lines after which AS shall automatically output a form feed. One should however take into account that this value does <strong>not</strong> include heading lines including an eventual line specified with <code>TITLE</code>. The minimum number of lines is 5, and the maximum value is 255. A specification of 0 has the result that AS will not do any form feeds except those triggered by a <code>NEWPAGE</code> instruction or those implicitly engaged at the end of the assembly listing (e.g. prior to the symbol table).</p>
<p>The specification of the listing&#39;s length in characters is an optional second parameter and serves two purposes: on the one hand, the internal line counter of AS will continue to run correctly when a source line has to be split into several listing lines, and on the other hand there are printers (like some laser printers) that do not automatically wrap into a new line at line end but instead simply discard the rest. For this reason, AS does line breaks by itself, i.e. lines that are too long are split into chunks whose lengths are equal to or smaller than the specified width. This may lead to double line feeds on printers that can do line wraps on their own if one specifies the exact line width as listing width. The solution for such a case is to reduce the assembly listing&#39;s width by 1. The specified line width may lie between 5 and 255 characters; a line width of 0 means similarly to the page length that AS shall not do any splitting of listing lines; lines that are too long of course cannot be taken into account of the form feed then any more.</p>
<p>The default setting for the page length is 60 lines, the default for the line width is 0; the latter value is also assumed when <code>PAGE</code> is called with only one parameter.</p>
<p>In case <code>PAGE</code> is already a machine instruction on the selected processor target, use instead <code>PAGESIZE</code> to define the paper size.</p>
<p><strong>CAUTION!</strong> There is no way for AS to check whether the specified listing length and width correspond to the reality!</p>
<h3 id="newpage">NEWPAGE</h3>
<p><code>NEWPAGE</code> can be used to force a line feed though the current line is not full up to now. This might be useful to separate program parts in the listing that are logically different. The internal line counter is reset and the page counter is incremented by one. The optional parameter is in conjunction with a hierarchical page numbering AS supports up to a chapter depth of 4. 0 always refers to the lowest depth, and the maximum value may vary during the assembly run. This may look a bit puzzling, as the following example shows:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>        page <span class="dv">1</span><span class="op">,</span> instruction <span class="op">`</span>NEWPAGE <span class="dv">0</span><span class="op">`</span> → page <span class="dv">2</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>        page <span class="dv">2</span><span class="op">,</span> instruction <span class="op">`</span>NEWPAGE <span class="dv">1</span><span class="op">`</span> → page <span class="fl">2.1</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>        page <span class="fl">2.1</span><span class="op">,</span> instruction <span class="op">`</span>NEWPAGE <span class="dv">1</span><span class="op">`</span> → page <span class="fl">3.1</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>        page <span class="fl">3.1</span><span class="op">,</span> instruction <span class="op">`</span>NEWPAGE <span class="dv">0</span><span class="op">`</span> → page <span class="fl">3.2</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>        page <span class="fl">3.2</span><span class="op">,</span> instruction <span class="op">`</span>NEWPAGE <span class="dv">2</span><span class="op">`</span> → page <span class="fl">4.1</span><span class="op">.</span><span class="dv">1</span></span></code></pre></div>
<p><code>NEWPAGE &lt;number&gt;</code> may therefore result in changes in different digits, depending on the current chapter depth. An automatic form feed due to a line counter overflow or a <code>NEWPAGE</code> without parameter is equal to <code>NEWPAGE 0</code>. Previous to the output of the symbol table, an implicit <code>NEWPAGE &lt;maximum up to now&gt;</code> is done to start a new &#39;main chapter&#39;.</p>
<h3 id="macexp_dft-and-macexp_ovr">MACEXP_DFT and MACEXP_OVR</h3>
<p>Once a macro is tested and &#39;done&#39;, one might not want to see it in the listing when it is used. As described in the section about defining and using macros (<a href="#macro">MACRO</a>), additional arguments to the <code>MACRO</code> statement allow to control whether a macro&#39;s body is expanded upon its usage and if yes, which parts of it. In case that several macros are defined in a row, it is not necessary to give these directives for every single macro. The pseudo instruction <code>MACEXP_DFT</code> defines for all following macros which parts shall be expanded upon invocation of the macro:</p>
<ul>
<li><code>ON</code> resp. <code>OFF</code> enable or disable expansion completely.</li>
<li>The arguments <code>IF</code> resp. <code>NOIF</code> enable or disable expansion of instructions for conditional assembly, plus the expansion of code parts the were excluded because of conditional assembly.</li>
<li>Macro definitions (which includes <code>REPT</code>, <code>WHILE</code> and <code>IRP(C)</code>) may be excluded from or included in the expanded parts via the arguments <code>MACRO</code> resp. <code>NOMACRO</code>.</li>
<li>All other lines not fitting into the first two categories may be excluded from or included in the expanded parts via the arguments <code>REST</code> resp. <code>NOREST</code>.</li>
</ul>
<p>The default is <code>ON</code>, i.e. defined macros will be expanded completely, of course unless specific expansion arguments were given to individual macros. Furthermore, arguments given to <code>MACEXP_DFT</code> work relative to the current setting: for instance, if expansion is turned on completely initially, the statement</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>MACEXP_DFT  noif<span class="op">,</span>nomacro</span></code></pre></div>
<p>has the result that for macros defined in succession, only code parts that are no macro definition and that are not excluded via conditional assembly will be listed.</p>
<p>This instruction plus the per-macro directives provide fine-grained per-macro over the parts being expanded. However, there may be cases in practice where one wants to see the expanded code of a macro at one place and not at the other. This is possible by using the statement <code>MACEXP_OVR</code>: it accepts the same arguments like <code>MACEXP_DFT</code>, these however act as overrides for all macros being <em>expanded</em> in the following code. This is in contrast to <code>MACEXP_DFT</code> which influences macros being <em>defined</em> in the following code. For instance, if one defined for a macro that neither macro definitions nor conditional assembly shall be expanded in the listing, a</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>MACEXP_OVR  MACRO</span></code></pre></div>
<p>re-enables expansion of macro definitions for its following usages, while a</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>MACEXP_OVR  ON</span></code></pre></div>
<p>forces expansion of the complete macro body in the listing. <code>MACEXP_OVR</code> without arguments again disables all overrides, macros will again behave as individually specified upon definition.</p>
<p>Both statements also have an effect on other macro-like constructs (<code>REPT, IRP, IRPC WHILE</code>). However, since these are expanded only one and &quot;in-place&quot;, the functional difference of these two statements becomes minimal. In case of differences, the override set via <code>MACEXP_OVR</code> has a higher priority.</p>
<p>The Setting currently made via <code>MACEXP_DFT</code> may be read from the predefined symbol <code>MACEXP</code>. For backward compatibility reasons, it is possible to use the statement <code>MACEXP</code> instead of <code>MACEXP_DFT</code>. However, one should not make use of this in new programs.</p>
<h3 id="listing">LISTING</h3>
<p>works like <code>MACEXP</code> and accepts the same parameters, but is much more radical: After a</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>        listing off</span></code></pre></div>
<p>nothing at all will be written to the listing. This directive makes sense for tested code parts or include files to avoid a paper consumption going beyond all bounds. <strong>CAUTION!</strong> If one forgets to issue the counterpart somewhere later, even the symbol table will not be written any more! In addition to <code>ON</code> and <code>OFF</code>, <code>LISTING</code> also accepts <code>NOSKIPPED</code> and <code>PURECODE</code> as arguments. Program parts that were not assembled due to conditional assembly will not be written to the listing when <code>NOSKIPPED</code> is set, while <code>PURECODE</code> - as the name indicates - even suppresses the <code>IF</code> directives themselves in the listing. These options are useful if one uses macros that act differently depending on parameters and one only wants to see the used parts in the listing.</p>
<p>The current setting may be read from the symbol <code>LISTING</code> (0=<code>OFF</code>, 1=<code>ON</code>, 2=<code>NOSKIPPED</code>, 3=<code>PURECODE</code>).</p>
<h3 id="prtinit-and-prtexit">PRTINIT and PRTEXIT</h3>
<p>Quite often it makes sense to switch to another printing mode (like compressed printing) when the listing is sent to a printer and to deactivate this mode again at the end of the listing. The output of the needed control sequences can be automated with these instructions if one specifies the sequence that shall be sent to the output device prior to the listing with <code>PRTINIT &lt;string&gt;</code> and similarly the de-initialization string with <code>PRTEXIT &lt;string&gt;</code>. <code>&lt;string&gt;</code> has to be a string expression in both cases. The syntax rules for string constants allow to insert control characters into the string without too much tweaking.</p>
<p>When writing the listing, the assembler does <strong>not</strong> differentiate where the listing actually goes, i.e. printer control characters are sent to the screen without mercy!</p>
<p>Example:</p>
<p>For Epson printers, it makes sense to switch them to compressed printing because listings are so wide. The lines</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>        prtinit <span class="st">&quot;\15&quot;</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>        prtexit <span class="st">&quot;\18&quot;</span></span></code></pre></div>
<p>assure that the compressed mode is turned on at the beginning of the listing and turned off afterwards.</p>
<h3 id="title">TITLE</h3>
<p>The assembler normally adds a header line to each page of the listing that contains the source file&#39;s name, date, and time. This statement allows to extend the page header by an arbitrary additional line. The string that has to be specified is an arbitrary string expression.</p>
<p>Example:</p>
<p>For the Epson printer already mentioned above, a title line shall be written in wide mode, which makes it necessary to turn off the compressed mode before:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>        title   <span class="st">&quot;\18\14Wide Title\15&quot;</span></span></code></pre></div>
<p>(Epson printers automatically turn off the wide mode at the end of a line.)</p>
<h3 id="radix">RADIX</h3>
<p><code>RADIX</code> with a numerical argument between 2 and 36 sets the default numbering system for integer constants, i.e. the numbering system used if nothing else has been stated explicitly. The default is 10, and there are some possible pitfalls to keep in mind which are described in <a href="#integer-constants">Integer Constants</a>.</p>
<p>Independent of the current setting, the argument of <code>RADIX</code> is <em>always decimal</em>; furthermore, no symbolic or formula expressions may be used as argument. Only use simple constant numbers!</p>
<h3 id="outradix">OUTRADIX</h3>
<p><code>OUTRADIX</code> can in a certain way be regarded as the opposite to <code>RADIX</code>: This statement allows to configure which numbering system to use for integer results when <code>\{...}</code> constructs are used in string constants (see <a href="#string-constants">String Constants</a>). Valid arguments range again from 2 to 36, while the default is 16.</p>
<h2 id="local-symbols">Local Symbols</h2>
<p><em>valid for: all processors</em></p>
<p>local symbols and the section concept introduced with them are a completely new function that was introduced with version 1.39. One could say that this part is version &quot;1.0&quot; and therefore probably not the optimum. Ideas and (constructive) criticism are therefore especially wanted. I admittedly described the usage of sections how I imagined it. It is therefore possible that the reality is not entirely equal to the model in my head. I promise that in case of discrepancies, changes will occur that the reality gets adapted to the documentation and not vice versa (I was told that the latter sometimes takes place in larger companies...).</p>
<p>AS does not generate linkable code (and this will probably not change in the near future <code>:-(</code>). This fact forces one to always assemble a program in a whole. In contrast to this technique, a separation into linkable modules would have several advantages:</p>
<ul>
<li>shorter assembly times as only the modified modules have to be reassembled;</li>
<li>the option to set up defined interfaces among modules by definition of private and public symbols;</li>
<li>the smaller length of the individual modules reduces the number of symbols per module and therefore allows to use shorter symbol names that are still unique.</li>
</ul>
<p>Especially the last item was something that always nagged me: once there was a label&#39;s name defined at the beginning of a 2000-lines program, there was no way to reuse it somehow - even not at the file&#39;s other end where routines with a completely different context were placed. I was forced to use concatenated names in the style of</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>&lt;subprogram name<span class="op">&gt;</span>_<span class="op">&lt;</span>symbol name<span class="op">&gt;</span></span></code></pre></div>
<p>that had lengths ranging from 15 to 25 characters and made the program difficult to overlook. The concept of section described in detail in the following text was designed to cure at least the second and third item of the list above. It is completely optional: if you do not want to use sections, simply forget them and continue to work like you did with previous versions of AS.</p>
<h3 id="basic-definition-sectionendsection">Basic Definition (SECTION/ENDSECTION)</h3>
<p>A section represents a part of the assembler program enclosed by special statements and has a unique name chosen by the programmer:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>        &lt;other code<span class="op">&gt;</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">SECTION</span> <span class="op">&lt;</span>section<span class="st">&#39;s name&gt;</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>        &lt;code inside of the section<span class="op">&gt;</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>        ENDSECTION <span class="op">[</span>section<span class="st">&#39;s name]</span></span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>        &lt;other code<span class="op">&gt;</span></span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>        .</span></code></pre></div>
<p>The name of a section must conform to the conventions for s symbol name; AS stores section and symbol names in separate tables which is the reason why a name may be used for a symbol and a section at the same time. Section names must be unique in a sense that there must not be more than one section on the same level with the same name (I will explain in the next part what &quot;levels&quot; mean). The argument of <code>ENDSECTION</code> is optional, it may also be omitted; if it is omitted, AS will show the section&#39;s name that has been closed with this <code>ENDSECTION</code>. Code inside a section will be processed by AS exactly as if it were outside, except for three decisive differences:</p>
<ul>
<li>Symbols defined within a section additionally get an internally generated number that corresponds to the section. These symbols are not accessible by code outside the section (this can be changed by pseudo instructions, later more about this).</li>
<li>The additional attribute allows to define symbols of the same name inside and outside the section; the attribute makes it possible to use a symbol name multiple times without getting error messages from AS.</li>
<li>If a symbol of a certain name has been defined inside and outside of a section, the &quot;local&quot; one will be preferred inside the section, i.e. AS first searches the symbol table for a symbol of the referenced name that also was assigned to the section. A search for a global symbol of this name only takes place if the first search fails.</li>
</ul>
<p>This mechanism e.g. allows to split the code into modules as one might have done it with linkable code. A more fine-grained approach would be to pack every routine into a separate section. Depending on the individual routines&#39; lengths, the symbols for internal use may obtain very short names.</p>
<p>AS will by default not differentiate between upper and lower case in section names; if one however switches to case-sensitive mode, the case will be regarded just like for symbols.</p>
<p>The organization described up to now roughly corresponds to what is possible in the C language that places all functions on the same level. However, as my &quot;high-level&quot; ideal was Pascal and not C, I went one step further:</p>
<h3 id="nesting-and-scope-rules">Nesting and Scope Rules</h3>
<p>It is valid to define further sections within a section. This is analog to the option given in Pascal to define procedures inside a procedure or function. The following example shows this:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>sym     EQU        <span class="dv">0</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">SECTION</span>    ModuleA</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">SECTION</span>    ProcA1</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>sym     EQU        <span class="dv">5</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>        ENDSECTION ProcA1</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">SECTION</span>    ProcA2</span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>sym     EQU        <span class="dv">10</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>        ENDSECTION ProcA2</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>        ENDSECTION ModuleA</span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">SECTION</span>    ModuleB</span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a>sym     EQU        <span class="dv">15</span></span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">SECTION</span>    ProcB</span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-26"><a href="#cb155-26" aria-hidden="true" tabindex="-1"></a>        ENDSECTION ProcB</span>
<span id="cb155-27"><a href="#cb155-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-28"><a href="#cb155-28" aria-hidden="true" tabindex="-1"></a>        ENDSECTION ModuleB</span></code></pre></div>
<p>When looking up a symbol, AS first searches for a symbol assigned to the current section, and afterwards traverses the list of parent sections until the global symbols are reached. In our example, the individual sections see the values given in <a href="#table-valid-values-for-the-individual-sections">Valid values for the Individual Sections table</a> for the symbol <code>sym</code>:</p>
<h5 id="table-valid-values-for-the-individual-sections"><strong>Table:</strong> Valid values for the Individual Sections</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">section</th>
<th style="text-align: left;">value</th>
<th style="text-align: left;">from section...</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Global</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">Global</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ModuleA</code></td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">Global</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ProcA1</code></td>
<td style="text-align: left;">5</td>
<td style="text-align: left;"><code>ProcA1</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ProcA2</code></td>
<td style="text-align: left;">10</td>
<td style="text-align: left;"><code>ProcA2</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ModuleB</code></td>
<td style="text-align: left;">15</td>
<td style="text-align: left;"><code>ModuleB</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ProcB</code></td>
<td style="text-align: left;">15</td>
<td style="text-align: left;"><code>ModuleB</code></td>
</tr>
</tbody>
</table>
<p>This rule can be overridden by explicitly appending a section&#39;s name to the symbol&#39;s name. The section&#39;s name has to be enclosed in brackets:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>        move<span class="op">.</span>l  <span class="op">#</span>sym<span class="op">[</span>ModulB<span class="op">],</span>d0</span></code></pre></div>
<p>Only sections that are in the parent section path of the current section may be used. The special values <code>PARENT0...PARENT9</code> are allowed to reference the n-th &quot;parent&quot; of the current section; <code>PARENT0</code> is therefore equivalent to the current section itself, <code>PARENT1</code> the direct parent and so on. <code>PARENT1</code> may be abbreviated as <code>PARENT</code>. If no name is given between the brackets, like in this example:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>        move<span class="op">.</span>l  <span class="op">#</span>sym<span class="op">[],</span>d0</span></code></pre></div>
<p>one reaches the global symbol.</p>
<p><strong>CAUTION!</strong> If one explicitly references a symbol from a certain section, AS will only seek for symbols from this section, i.e. the traversal of the parent sections path is omitted!</p>
<p>Similar to Pascal, it is allowed that different sections have subsections of the same name; the principle of locality avoids irritations. One should IMHO still use this feature as seldom as possible: Symbols listed in the symbol resp. cross reference list are only marked with the section they are assigned to, not with the &quot;section hierarchy&quot; lying above them (this really would have busted the available space); a differentiation is made very difficult this way.</p>
<p>As a <code>SECTION</code> instruction does not define a label by itself, the section concept has an important difference to Pascal&#39;s concept of nested procedures: a pascal procedure can automatically &quot;see&quot; its sub-procedures(functions), AS requires an explicit definition of an entry point. This can be done e.g. with the following macro pair:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="bu">proc</span>    MACRO   name</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">SECTION</span> name</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>name    LABEL   <span class="op">$</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>        ENDM</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>endp    MACRO   name</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>        ENDSECTION name</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>        ENDM</span></code></pre></div>
<p>This example also shows that the locality of labels inside macros is not influenced by sections. It makes the trick with the <code>LABEL</code> instruction necessary.</p>
<p>This does, of course, not solve the problem completely. The label is still local and not referenceable from the outside. Those who think that it would suffice to place the label in front of the <code>SECTION</code> statement should be quiet because they would spoil the bridge to the next theme:</p>
<h3 id="public-and-global">PUBLIC and GLOBAL</h3>
<p>The <code>PUBLIC</code> statement allows to change the assignment of a symbol to a certain section. It is possible to treat multiple symbols with one statement, but I will use an example with only one symbol in the following (not hurting the generality of this discussion). In the simplest case, one declares a symbol to be global, i.e. it can be referenced from anywhere in the program:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">PUBLIC</span>  <span class="op">&lt;</span>name<span class="op">&gt;</span></span></code></pre></div>
<p>As a symbol cannot be moved in the symbol table once it has been sorted in, this statement has to appear <strong>before</strong> the symbol itself is defined. AS stores all <code>PUBLICs</code> in a list and removes an entry from this list when the corresponding symbol is defined. AS prints errors at the end of a section in case that not all <code>PUBLICs</code> have been resolved.</p>
<p>Regarding the hierarchical section concept, the method of defining a symbol as purely global looks extremely brute. There is fortunately a way to do this in a bit more differentiated way: by appending a section name:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">PUBLIC</span>  <span class="op">&lt;</span>name<span class="op">&gt;:&lt;</span>section<span class="op">&gt;</span></span></code></pre></div>
<p>The symbol will be assigned to the referenced section and therefore also becomes accessible for all its subsections (except they define a symbol of the same name that hides the &quot;more global&quot; symbol). AS will naturally protest if several subsections try to export a symbol of same name to the same level. The special <code>PARENTn</code> values mentioned in the previous section are also valid for <code>&lt;section&gt;</code> to export a symbol exactly <code>n</code> levels up in the section hierarchy. Otherwise only sections that are parent sections of the current section are valid for <code>&lt;section&gt;</code>. Sections that are in another part of the section tree are not allowed. If several sections in the parent section path should have the same name (this is possible), the lowest level will be taken.</p>
<p>This tool lets the aforementioned macro become useful:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="bu">proc</span>    MACRO   name</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">SECTION</span> name</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">PUBLIC</span>  name<span class="op">:</span>PARENT</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>name    LABEL   <span class="op">$</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>        ENDM</span></code></pre></div>
<p>This setting is equal to the Pascal model that also only allows the &quot;father&quot; to see its children, but not the &quot;grandpa&quot;.</p>
<p>AS will quarrel about double-defined symbols if more than one section attempts to export a symbol of a certain name to the same upper section. This is by itself a correct reaction, and one needs to &quot;qualify&quot; symbols somehow to make them distinguishable if these exports were deliberate. A <code>GLOBAL</code> statement does just this. The syntax of <code>GLOBAL</code> is identical to <code>PUBLIC</code>, but the symbol stays local instead of being assigned to a higher section. Instead, an additional symbol of the same value but with the subsection&#39;s name appended to the symbol&#39;s name is created, and only this symbol is made public according to the section specification. If for example two sections <code>A</code> and <code>B</code> both define a symbol named <code>SYM</code> and export it with a <code>GLOBAL</code> statement to their parent section, the symbols are sorted in under the names <code>A_SYM</code> resp. <code>B_SYM</code> .</p>
<p>In case that source and target section are separated by more than one level, the complete name path is prepended to the symbol name.</p>
<h3 id="forward">FORWARD</h3>
<p>The model described so far may look beautiful, but there is an additional detail not present in Pascal that may spoil the happiness: Assembler allows forward references. Forward references may lead to situations where AS accesses a symbol from a higher section in the first pass. This is not a disaster by itself as long as the correct symbol is used in the second pass, but accidents of the following type may happen:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loop:</span>   .</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>        &lt;code<span class="op">&gt;</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">SECTION</span> sub</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>        .               <span class="co">; ***</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>        bra<span class="op">.</span>s   loop</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a><span class="fu">loop:</span>   .</span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>        ENDSECTION</span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">jmp</span>     loop    <span class="co">; main loop</span></span></code></pre></div>
<p>AS will take the global label <code>loop</code> in the first pass and will quarrel about an out-of-branch situation if the program part at <code>&lt;code&gt;</code> is long enough. The second pass will not be started at all. One way to avoid the ambiguity would be to explicitly specify the symbol&#39;s section:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>        bra<span class="op">.</span>s   loop<span class="op">[</span>sub<span class="op">]</span></span></code></pre></div>
<p>If a local symbol is referenced several times, the brackets can be saved by using a <code>FORWARD</code> statement. The symbol is thereby explicitly announced to be local, and AS will only look in the local symbol table part when this symbol is referenced. For our example, the statement</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>        FORWARD loop</span></code></pre></div>
<p>should be placed at the position marked with <code>**</code>.</p>
<p><code>FORWARD</code> must not only be stated prior to a symbol&#39;s definition, but also prior to its first usage in a section to make sense. It does not make sense to define a symbol private and public; this will be regarded as an error by AS.</p>
<h3 id="performance-aspects">Performance Aspects</h3>
<p>The multi-stage lookup in the symbol table and the decision to which section a symbol shall be assigned of course cost a bit of time to compute. An 8086 program of 1800 lines length for example took 34.5 instead of 33 seconds after a modification to use sections (80386 SX, 16MHz, 3 passes). The overhead is therefore limited. As it has already been stated at the beginning, is is up to the programmer if (s)he wants to accept it. One can still use AS without sections.</p>
<h2 id="miscellaneous">Miscellaneous</h2>
<h3 id="shared">SHARED</h3>
<p><em>valid for: all processors</em></p>
<p>This statement instructs AS to write the symbols given in the parameter list (regardless if they are integer, float or string symbols) together with their values into the share file. It depends upon the command line parameters described in section <a href="#start-up-command-parameters">Start-Up Command, Parameters</a> whether such a file is generated at all and in which format it is written. If AS detects this instruction and no share file is generated, a warning is the result.</p>
<p><strong>CAUTION!</strong> A comment possibly appended to the statement itself will be copied to the first line outputted to the share file (if <code>SHARED</code>&#39;s argument list is empty, only the comment will be written). In case a share file is written in C or Pascal format, one has to assure that the comment itself does not contain character sequences that close the comment (<code>*/</code> resp. <code>*)</code>). AS does not check for this!</p>
<h3 id="include">INCLUDE</h3>
<p><em>valid for: all processors</em></p>
<p>This instruction inserts the file given as a parameter into the just as if it would have been inserted with an editor (the file name may optionally be enclosed with &quot; characters). This instruction is useful to split source files that would otherwise not fit into the editor or to create &quot;tool boxes&quot;.</p>
<p>In case that the file name does not have an extension, it will automatically be extended with <code>INC</code>.</p>
<p>The assembler primarily tries to open the file in the directory containing the source file with the <code>INCLUDE</code> statement. This means that a path contained in the file specification is relative to this file&#39;s directory, not to the directory the assembler was called from. Via the <code>-i &lt;path list&gt;</code> option, one can specify a list of directories that will automatically be searched for the file. If the file is not found, a <strong>fatal</strong> error occurs, i.e. assembly terminates immediately.</p>
<p>For compatibility reasons, it is valid to enclose the file name in <code>&quot;</code> characters, i.e.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">include</span> stddef51</span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">include</span> <span class="st">&quot;stddef51.inc&quot;</span></span></code></pre></div>
<p>are equivalent. <strong>CAUTION!</strong> This freedom of choice is the reason why only a string constant but no string expression is allowed!</p>
<p>The search list is ignored if the file name itself contains a path specification.</p>
<h3 id="binclude">BINCLUDE</h3>
<p><em>valid for: all processors</em></p>
<p><code>BINCLUDE</code> can be used to embed binary data generated by other programs into the code generated by AS (this might theoretically even be code created by AS itself...). <code>BINCLUDE</code> has three forms:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>        BINCLUDE <span class="op">&lt;</span><span class="dt">file</span><span class="op">&gt;</span></span></code></pre></div>
<p>This way, the file is completely included.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>        BINCLUDE <span class="op">&lt;</span><span class="dt">file</span><span class="op">&gt;,&lt;</span>offset<span class="op">&gt;</span></span></code></pre></div>
<p>This way, the file&#39;s contents are included starting at <code>&lt;offset&gt;</code> up to the file&#39;s end.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>        BINCLUDE <span class="op">&lt;</span><span class="dt">file</span><span class="op">&gt;,&lt;</span>offset<span class="op">&gt;,&lt;</span>length<span class="op">&gt;</span></span></code></pre></div>
<p>This way, <code>&lt;length&gt;</code> bytes are included starting at <code>&lt;offset&gt;</code>.</p>
<p>The same rules regarding search paths apply as for <code>INCLUDE</code>.</p>
<h3 id="message-warning-error-and-fatal">MESSAGE, WARNING, ERROR, and FATAL</h3>
<p><em>valid for: all processors</em></p>
<p>Though the assembler checks source files as strict as possible and delivers differentiated error messages, it might be necessary from time to time to issue additional error messages that allow an automatic check for logical error. The assembler distinguishes among three different types of error messages that are accessible to the programmer via the following three instructions:</p>
<ul>
<li><code>WARNING</code>: Errors that hint at possibly wrong or inefficient code. Assembly continues and a code file is generated.</li>
<li><code>ERROR</code>: True errors in a program. Assembly continues to allow detection of possible further errors in the same pass. A code file is not generated.</li>
<li><code>FATAL</code>: Serious errors that force an immediate termination of assembly. A code file may be generated but will be incomplete.</li>
</ul>
<p>All three instructions have the same format for the message that shall be issued: an arbitrary (possibly computed?!) string expression which may therefore be either a constant or variable.</p>
<p>These instructions generally only make sense in conjunction wit conditional assembly. For example, if there is only a limited address space for a program, one can test for overflow in the following way:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>ROMSize equ     <span class="bn">8000h</span>   <span class="co">; 27256 EPROM</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ProgStart:</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>        &lt;the program itself<span class="op">&gt;</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ProgEnd:</span></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>        <span class="pp">if</span>      ProgEnd<span class="op">-</span>ProgStart<span class="op">&gt;</span>ROMSize</span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>        error  <span class="st">&quot;\athe program is too long!&quot;</span></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>        endif</span></code></pre></div>
<p>Apart from the instructions generating errors, there is also an instruction <code>MESSAGE</code> that simply prints a message to the assembly listing and the console (the latter only if the quiet mode is not used). Its usage is equal to the other three instructions.</p>
<h3 id="read">READ</h3>
<p><em>valid for: all processors</em></p>
<p>One could say that <code>READ</code> is the counterpart to the previous instruction group: it allows to read values from the keyboard during assembly. You might ask what this is good for. I will break with the previous principles and put an example before the exact description to outline the usefulness of this instruction:</p>
<p>A program needs for data transfers a buffer of a size that should be set at assembly time. One could store this size in a symbol defined with <code>EQU</code>, but it can also be done interactively with <code>READ</code>:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>        <span class="pp">IF</span>      MomPass<span class="op">=</span><span class="dv">1</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>        READ    <span class="st">&quot;buffer size&quot;</span><span class="op">,</span>BufferSize</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>        ENDIF</span></code></pre></div>
<p>Programs can this way configure themselves dynamically during assembly and one could hand over the source to someone who can assemble it without having to dive into the source code. The <code>IF</code> conditional shown in the example should always be used to avoid bothering the user multiple times with questions.</p>
<p><code>READ</code> is quite similar to <code>SET</code> with the difference that the value is read from the keyboard instead of the instruction&#39;s arguments. This for example also implies that AS will automatically set the symbol&#39;s type (integer, float or string) or that it is valid to enter formula expressions instead of a simple constant.</p>
<p><code>READ</code> may either have one or two parameters because the prompting message is optional. AS will print a message constructed from the symbol&#39;s name if it is omitted.</p>
<h3 id="intsyntax">INTSYNTAX</h3>
<p><em>valid for: all processors</em></p>
<p>This instruction allows to modify the set of notations for integer constants in various number systems. - After selection of a CPU target, a certain default set is selected (see section 10(#SectPseudoInst)). This set may be augmented with other notations, or notations may be removed from it. <code>INTSYNTAX</code> takes an arbitrary list of arguments which either begin with aplus or minus character, followed by the notation&#39;s identifier. For instance, the following statement</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>        intsyntax    <span class="op">-</span><span class="bn">0o</span><span class="er">ct</span><span class="op">,+</span><span class="bn">0h</span><span class="er">ex</span></span></code></pre></div>
<p>has the result that a leading zero marks a hexadecimal instead of an octal constant, a common usage on some assemblers for the SC/MP. The notations&#39; identifiers can be found in table <a href="#table-defined-numbering-systems-and-notations">Defined Numbering Systems and Notations table</a>. There is no limit on combining notations, except when they contradict each other. For instance, it would not be allowed to enable <code>0oct</code> and <code>0hex</code> at the same time.</p>
<h3 id="relaxed">RELAXED</h3>
<p><em>valid for: all processors</em></p>
<p>By default, AS assigns a distinct syntax for integer constants to a processor family (which is in general equal to the manufacturer&#39;s specifications, as long as the syntax is not too bizarre...). Everyone however has his own preferences for another syntax and may well live with the fact that his programs cannot be translated any more with the standard assembler. If one places the instruction</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>        RELAXED ON</span></code></pre></div>
<p>right at the program&#39;s beginning, one may further use any syntax for integer constants, even mixed in a program. AS tries to guess automatically for every expression the syntax that was used. This automatism does not always deliver the result one might have in mind, and this is also the reason why this option has to be enable explicitly: if there are no prefixes or postfixes that unambiguously identify either Intel or Motorola syntax, the C mode will be used. Leading zeroes that are superfluous in other modes have a meaning in this mode:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>        move<span class="op">.</span>b  <span class="op">#</span><span class="dv">08</span><span class="op">,</span>d0</span></code></pre></div>
<p>This constant will be understood as an octal constant and will result in an error message as octal numbers may only contain digits from 0 to 7. One might call this a lucky case; a number like 077 would result in trouble without getting a message about this. Without the relaxed mode, both expressions unambiguously would have been identified as decimal constants.</p>
<p>The current setting may be read from a symbol with the same name.</p>
<h3 id="compmode">COMPMODE</h3>
<p><em>valid for: various processors</em></p>
<p>Though the assembler strives to behave like the corresponding &quot;original assemblers&quot;, there are cases when emulating the original assembler&#39;s behaviour would forbid code optimizations which are valid and useful in my opinion. Use the statement</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>        compmode on</span></code></pre></div>
<p>to switch to a &#39;compatibility mode&#39; which prioritizes &#39;original behaviour&#39; to most efficient code. See the respective section with processor-specific hints whether there are any situations for the specific target.</p>
<p>Compatibility mode is disabled by default, unless it was activated by the command line switch of same name. The current setting may be read from a symbol with the same name.</p>
<h3 id="end">END</h3>
<p><em>valid for: all processors</em></p>
<p><code>END</code> marks the end of an assembler program. Lines that eventually follow in the source file will be ignored. <strong>IMPORTANT:</strong> <code>END</code> may be called from within a macro, but the <code>IF</code>-stack for conditional assembly is not cleared automatically. The following construct therefore results in an error:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>        <span class="pp">IF</span>      DontWantAnymore</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>        <span class="pp">END</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>        ELSEIF</span></code></pre></div>
<p><code>END</code> may optionally have an integer expression as argument that marks the program&#39;s entry point. AS stores this in the code file with a special record and it may be post-processed e.g. with P2HEX.</p>
<p><code>END</code> has always been a valid instruction for AS, but the only reason for this in earlier releases of AS was compatibility; <code>END</code> had no effect.</p>
<!-- markdownlint-enable MD036 -->

<!-- markdownlint-enable MD030 -->

<!-- markdownlint-enable MD025 -->

<h1 id="processor-specific-hints">Processor-specific Hints</h1>
<!-- markdownlint-disable MD001 -->

<!-- markdownlint-disable MD025 -->

<!-- markdownlint-disable MD030 -->

<p>When writing the individual code generators, I strived for a maximum amount of compatibility to the original assemblers. However, I only did this as long as it did not mean an unacceptable additional amount of work. I listed important differences, details and pitfalls in the following chapter.</p>
<h2 id="6811">6811</h2>
<p>&quot;Where can I buy such a beast, a HC11 in NMOS?&quot;, some of you might ask. Well, of course it does not exist, but an H cannot be represented in a hexadecimal number (older versions of AS would not have accepted such a name because of this), and so I decided to omit all the letters...</p>
<blockquote>
<p><em>&quot;Someone stating that something is impossible should be at least as cooperative as not to hinder the one who currently does it.&quot;</em></p>
</blockquote>
<p>From time to time, one is forced to revise one&#39;s opinions. Some versions earlier, I stated at his place that I couldn&#39;t use AS&#39;s parser in a way that it is also possible to to separate the arguments of <code>BSET/BCLR</code> resp. <code>BRSET/BRCLR</code> with spaces. However, it seems that it can do more than I wanted to believe...after the n+1th request, I sat down once again to work on it and things seem to work now. You may use either spaces or commas, but not in all variants, to avoid ambiguities: for every variant of an instruction, it is possible to use only commas or a mixture of spaces and commas as Motorola seems to have defined it (their data books do not always have the quality of the corresponding hardware...):</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>Bxxx  abs8 <span class="op">#</span>mask         is equal to Bxxx  abs8<span class="op">,#</span>mask</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>Bxxx  disp8<span class="op">,</span>X <span class="op">#</span>mask      is equal to Bxxx  disp8<span class="op">,</span>X<span class="op">,#</span>mask</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>BRxxx abs8 <span class="op">#</span>mask addr    is equal to BRxxx abs8<span class="op">,#</span>mask<span class="op">,</span>addr</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>BRxxx disp8<span class="op">,</span>X <span class="op">#</span>mask addr is equal to BRxxx disp8<span class="op">,</span>X<span class="op">,#</span>mask<span class="op">,</span>addr</span></code></pre></div>
<p>In this list, <code>xxx</code> is a synonym either for <code>SET</code> or <code>CLR</code>; <code>#mask</code> is the bit mask to be applied (the # sign is optional). Of course, the same statements are also valid for Y-indexed expression (not listed here).</p>
<p>With the K4 version of the HC11, Motorola has introduced a banking scheme, which one one hand easily allows to once again extend an architecture that has become &#39;too small&#39;, but on the other hand not really makes programmers&#39; and tool developers&#39; lives simpler...how does one sensibly map something like this on a model for a programmer?</p>
<p>The K4 architecture <em>extends</em> the HC11 address space by 2x512 Kbytes, which means that we now have a total address space of 64+1024=1088 Kbytes. AS acts like this were one large unified address space, with the following layout:</p>
<ul>
<li><code>$000000...$00ffff</code>: the old HC11 address space</li>
<li><code>$010000...$08ffff</code>: Window 1</li>
<li><code>$090000...$10ffff</code>: Window 2</li>
</ul>
<p>Via the <code>ASSUME</code> statement, one tells AS how the banking registers are set up, which in turn describes which extended areas are mapped to which physical addresses. For absolute addresses modes with addresses beyond $10000, AS automatically computes the address within the first 64K that is to be used. Of course this only works for direct addressing modes, it is the programmer&#39;s responsibility to keep the overview for indirect or indexed addressing modes!</p>
<p>In case one is not really sure if the current mapping is really the desired one, the pseudo instruction <code>PRWINS</code> may be used, which prints the assumes MMxxx register contents plus the current mapping(s), like this:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>MMSIZ <span class="op">$</span>e1 MMWBR <span class="op">$</span><span class="bn">84</span> MM1CR <span class="op">$</span><span class="bn">00</span> MM2CR <span class="op">$</span><span class="bn">80</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>Window <span class="dv">1</span><span class="op">:</span> <span class="fl">10000.</span><span class="op">..</span><span class="dv">12000</span> <span class="op">--&gt;</span> <span class="fl">4000.</span><span class="op">..</span><span class="dv">6000</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>Window <span class="dv">1</span><span class="op">:</span> <span class="fl">90000.</span><span class="op">..</span><span class="dv">94000</span> <span class="op">--&gt;</span> <span class="fl">8000.</span><span class="op">..</span>c000</span></code></pre></div>
<p>An instruction</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>        <span class="cf">jmp</span>     <span class="op">*+</span><span class="dv">3</span></span></code></pre></div>
<p>located at $10000 would effectively result in a jump to address $4003.</p>
<h2 id="powerpc">PowerPC</h2>
<p>Of course, it is a bit crazy idea to add support in AS for a processor that was mostly designed for usage in work stations. Remember that AS mainly is targeted at programmers of single board computers. But things that today represent the absolute high end in computing will be average tomorrow and maybe obsolete the next day, and in the meantime, the Z80 as the 8088 have been retired as CPUs for personal computers and been moved to the embedded market; modified versions are marketed as microcontrollers. With the appearance of the MPC505 and PPC403, my suspicion has proven to be true that IBM and Motorola try to promote this architecture in as many fields as possible.</p>
<p>However, the current support is a bit incomplete: Temporarily, the Intel-style mnemonics are used to allow storage of data and the more uncommon RS/6000 machine instructions mentioned in <a href="#fn32" class="footnote-ref" id="fnref32" role="doc-noteref"><sup>32</sup></a> are missing (hopefully no one misses them!). I will finish this as soon as information about them is available!</p>
<h2 id="dsp56xxx">DSP56xxx</h2>
<p>Motorola, which devil rode you! Which person in your company had the &quot;brilliant&quot; idea to separate the parallel data transfers with spaces! In result, everyone who wants to make his code a bit more readable, e.g. like this:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>        move    x<span class="op">:</span>var9 <span class="op">,</span>r0</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>        move    y<span class="op">:</span>var10<span class="op">,</span>r3</span></code></pre></div>
<p>is p****ed because the space gets recognized as a separator for parallel data transfers!</p>
<p>Well...Motorola defined it that way, and I cannot change it. Using tabs instead of spaces to separate the parallel operations is also allowed, and the individual operations&#39; parts are again separated with commas, as one would expect it.</p>
<p><a href="#fn33" class="footnote-ref" id="fnref33" role="doc-noteref"><sup>33</sup></a> states that instead of using <code>MOVEC</code>, <code>MOVEM</code>, <code>ANDI</code> or <code>ORI</code>, it is also valid to use the more general Mnemonics <code>MODE</code>, <code>AND</code> or <code>OR</code>. AS (currently) does not support this.</p>
<h2 id="h8300">H8/300</h2>
<p>Regarding the assembler syntax of these processors, Hitachi generously copied from Motorola (that wasn&#39;t by far the worst choice...), unfortunately the company wanted to introduce its own format for hexadecimal numbers. To make it even worse, it is a format that uses unbalanced single quotes, just like Microchip does:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>       <span class="bu">mov</span><span class="op">.</span>w <span class="op">#</span>h<span class="st">&#39;ff,r0</span></span></code></pre></div>
<p>This format is not supported by default. Instead, one has to write hexadecimal numbers in the well-known Motorola syntax: with a leading dollar sign. If you really need the &#39;Hitachi Syntax&#39;, e.g. to assemble existing code, enable the RELAXED mode. Bear in mind that this syntax has received few testing so far. I can therefore not guarantee that it will work in all cases!</p>
<h2 id="h8500-1">H8/500</h2>
<p>The H8/500&#39;s <code>MOV</code> instruction features an interesting and uncommon optimization: If the target operand has a size of 16 bits, it is still possible to use an 8-bit (immediate) source operand. For example, for an instruction like this:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>       <span class="bu">mov</span><span class="op">.</span>w <span class="op">#$</span>ffff<span class="op">,</span><span class="fu">@</span><span class="er">$</span><span class="dv">1234</span></span></code></pre></div>
<p>it is possible to encode the source just as a single $ff and to save one byte in code size. The processor automatically performs a sign extension, which turns $ff into the desired value $ffff. AS is aware of this optimization and will use it, unless it was explicitly forbidden via a <code>:16</code> suffix at the immediate operand.</p>
<p>Unfortunately, the original Hitachi assembler seems to implement this optimization in another way: it assumes a zero instead of a sign extension. This means that values from 0 to 255 ($0000 to <span class="math inline">00<em>f</em><em>f</em>)<em>a</em><em>n</em><em>d</em><em>n</em><em>o</em><em>t</em><em>f</em><em>r</em><em>o</em><em>m</em> − 128<em>t</em><em>o</em> + 127(</span>ff80 to $007f) are encoded as one byte. I do not know whether the Hitachi assembler or the H8/500 Programmers Manual is right, and I have no way to verify this. Anyway, if one wants the &quot;Hitachi Assembler Behaviour&quot; for existing source code, one may enable the compatibility mode, either by the statement</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>      compmode on</span></code></pre></div>
<p>or by the respective command line switch.</p>
<p>Aside from this, the same remarks regarding hexadecimal number syntax apply as for H8/500.</p>
<h2 id="sh700076007700">SH7000/7600/7700</h2>
<p>Unfortunately, Hitachi once again used their own format for hexadecimal numbers, and once again I was not able to reproduce this with AS...please use Motorola syntax!</p>
<p>When using literals and the <code>LTORG</code> instruction, a few things have to be kept in mind if you do not want to suddenly get confronted with strange error messages:</p>
<p>Literals exist due to the fact that the processor is unable to load constants out of a range of -128 to 127 with immediate addressing. AS (and the Hitachi assembler) hide this inability by the automatic placement of constants in memory which are then referenced via PC-relative addressing. The question that now arises is where to locate these constants in memory. AS does not automatically place a constant in memory when it is needed; instead, they are collected until an LTORG instruction occurs. The collected constants are then dumped en bloc, and their addresses are stored in ordinary labels which are also visible in the symbol table. Such a label&#39;s name is of the form</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>LITERAL_s_xxxx_n  <span class="op">.</span></span></code></pre></div>
<p>In this name, <code>s</code> represents the literal&#39;s type. Possible values are <code>W</code> for 16-bit constants, <code>L</code> for 32-bit constants and <code>F</code> for forward references where AS cannot decide in anticipation which size is needed. In case of <code>s=W</code> or <code>L</code>, <code>xxxx</code> denotes the constant&#39;s value in a hexadecimal notation, whereas <code>xxxx</code> is a simple running number for forward references (in a forward reference, one does not know the value of a constant when it is referenced, so one obviously cannot incorporate its value into the name). <code>n</code> is a counter that signifies how often a literal of this value previously occurred in the current section. Literals follow the standard rules for localization by sections. It is therefore absolutely necessary to place literals that were generated in a certain section before the section is terminated!</p>
<p>The numbering with <code>n</code> is necessary because a literal may occur multiple times in a section. One reason for this situation is that PC-relative addressing only allows positive offsets; Literals that have once been placed with an <code>LTORG</code> can therefore not be referenced in the code that follows. The other reason is that the displacement is generally limited in length (512 resp. 1024 bytes).</p>
<p>An automatic <code>LTORG</code> at the end of a program or previously to switching to a different target CPU does not occur; if AS detects unplaced literals in such a situation, an error message is printed.</p>
<p>As the PC-relative addressing mode uses the address of the current instruction plus 4, it is not possible to access a literal that is stored directly after the instruction, like in the following example:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span>     <span class="op">#$</span><span class="bn">1234</span><span class="op">,</span>r6</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>        ltorg</span></code></pre></div>
<p>This is a minor item since the CPU anyway would try to execute the following data as code. Such a situation should not occur in a real program...another pitfall is far more real: if PC-relative addressing occurs just behind a delayed branch, the program counter is already set to the destination address, and the displacement is computed relative to the branch target plus 2. Following is an example where this detail leads to a literal that cannot be addressed:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>        bra     Target</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span>     <span class="op">#$</span><span class="bn">12345678</span><span class="op">,</span>r4        <span class="co">; is executed</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>        ltorg                        <span class="co">; here is the literal</span></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a><span class="fu">Target:</span> <span class="bu">mov</span>     r4<span class="op">,</span>r7                <span class="co">; execution continues here</span></span></code></pre></div>
<p>As <code>Target</code>+2 is on an address behind the literal, a negative displacement would result. Things become especially hairy when one of the branch instructions <code>JMP, JSR, BRAF, or BSRF</code> is used: as AS cannot calculate the target address (it is generated at runtime from a register&#39;s contents), a PC value is assumed that should never fit, effectively disabling any PC-relative addressing at this point.</p>
<p>It is not possible to deduce the memory usage from the count and size of literals. AS might need to insert a padding word to align a long word to an address that is evenly divisible by 4; on the other hand, AS might reuse parts of a 32-bit literal for other 16-bit literals. Of course multiple use of a literal with a certain value will create only one entry. However, such optimizations are completely suppressed for forward references as AS does not know anything about their value.</p>
<p>As literals use the PC-relative addressing which is only allowed for the <code>MOV</code> instruction, the usage of literals is also limited to <code>MOV</code> instructions. The way AS uses the operand size is a bit tricky: A specification of a byte or word move means to generate the shortest possible instruction that results in the desired value placed in the register&#39;s lowest 8 resp. 16 bits. The upper 24 resp. 16 bits are treated as &quot;don&#39;t care&quot;. However, if one specifies a long-word move or omits the size specification completely, this means that the complete 32-bit register should contain the desired value. For example, in the following sequence</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span><span class="op">.</span>b   <span class="op">#$</span>c0<span class="op">,</span>r0</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span><span class="op">.</span>w   <span class="op">#$</span>c0<span class="op">,</span>r0</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span><span class="op">.</span>l   <span class="op">#$</span>c0<span class="op">,</span>r0</span></code></pre></div>
<p>the first instruction will result in true immediate addressing, the second and third instruction will use a word literal: As bit 7 in the number is set, the byte instruction will effectively create the value $FFFFFFC0 in the register. According to the convention, this wouldn&#39;t be the desired value in the second and third example. However, a word literal is also sufficient for the third case because the processor will copy a cleared bit 15 of the operand to bits 16...31.</p>
<p>As one can see, the whole literal stuff is rather complex; I&#39;m sorry but there was no chance of making things simpler. It is unfortunately a part of its nature that one sometimes gets error messages about literals that were not found, which logically should not occur because AS does the literal processing completely on his own. However, if other errors occur in the second pass, all following labels will move because AS does not generate any code any more for statements that have been identified as erroneous. As literal names are partially built from other symbols&#39; values, other errors might follow because literal names searched in the second pass differ from the names stored in the first pass and AS quarrels about undefined symbols...if such errors should occur, please correct all other errors first before you start cursing on me and literals...</p>
<p>People who come out of the Motorola scene and want to use PC-relative addressing explicitly (e.g. to address variables in a position-independent way) should know that if this addressing mode is written like in the programmer&#39;s manual:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span><span class="op">.</span>l   <span class="fu">@</span><span class="er">(</span>Var<span class="op">,</span>PC<span class="op">),</span><span class="kw">r8</span></span></code></pre></div>
<p><strong>no</strong> implicit conversion of the address to a displacement will occur, i.e. the operand is inserted as-is into the machine code (this will probably generate a value range error...). If you want to use PC-relative addressing on the SH7x00, simply use &quot;absolute&quot; addressing (which does not exist on machine level):</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span><span class="op">.</span>l   Var<span class="op">,</span><span class="kw">r8</span></span></code></pre></div>
<p>In this example, the displacement will be calculated correctly (of course, the same limitations apply for the displacement as it was the case for literals).</p>
<h2 id="hmcs400">HMCS400</h2>
<p>The instruction set of these 4 bit processors spontaneously reminded me of the 8080/8085 - many mnemonics, the addressing mode (e.g. direct or indirect) is coded into the instruction, and the instructions are sometimes hard to memorize. AS or course supports this syntax as Hitachi defined it. I however implemented another variant for most instructions that is - in my opinion - more beautiful and better to read. The approach is similar to what Zilog did back then for the Z80. For instance, all machine instructions that transfer data in some form, may the operands be constants, registers, or memory cells, may be used via the <code>LD</code> instruction. Similar &#39;meta instructions&#39; exist for arithmetic and logical instructions. A complete list of all meta instructions and their operands can be found in the tables <a href="#table-meta-instructions-hmcs400">Meta Instructions HMCS400</a> and <a href="#table-operand-types-for-hmcs400-meta-instructions">Operand Types for HMCS400 Meta Instructions</a>, their practical use can be seen in the file <code>t_hmcs4x.asm</code>.</p>
<h5 id="table-meta-instructions-hmcs400"><strong>Table:</strong> Meta Instructions HMCS400</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Meta Instruction</th>
<th style="text-align: left;">Replaces</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>LD src, dest</code></td>
<td style="text-align: left;"><code>LAI</code>, <code>LBI</code>, <code>LMID</code>, <code>LMIIY</code>, <code>LAB</code>, <code>LBA</code>, <code>LAY</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>LD src, dest</code></td>
<td style="text-align: left;"><code>LASPX</code>, <code>LASPY</code>, <code>LAMR</code>, <code>LWI</code>, <code>LXI</code>, <code>LYI</code>, <code>LXA</code>, <code>LYA</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>LD src, dest</code></td>
<td style="text-align: left;"><code>LAM</code>, <code>LAMD</code> <code>LBM</code>, <code>LMA</code>, <code>LMAD</code>, <code>LMAIY</code>, <code>LMADY</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>XCH src, dest</code></td>
<td style="text-align: left;"><code>XMRA</code>, <code>XSPX</code>, <code>XSPY</code>, <code>XMA</code>, <code>XMAD</code>, <code>XMB</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ADD src, dest</code></td>
<td style="text-align: left;"><code>AYY</code>, <code>AI</code>, <code>AM</code>, <code>AMD</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ADC src, dest</code></td>
<td style="text-align: left;"><code>AMC</code>, <code>AMCD</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>SUB src, dest</code></td>
<td style="text-align: left;"><code>SYY</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>SBC src, dest</code></td>
<td style="text-align: left;"><code>SMC</code>, <code>SMCD</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>OR src, dest</code></td>
<td style="text-align: left;"><code>OR</code>, <code>ORM</code>, <code>ORMD</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>AND src, dest</code></td>
<td style="text-align: left;"><code>ANM</code>, <code>ANMD</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>EOR src, dest</code></td>
<td style="text-align: left;"><code>EORM</code>, <code>EORMD</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>CP cond, src, dest</code></td>
<td style="text-align: left;"><code>INEM</code>, <code>INEMD</code>, <code>ANEM</code>, <code>ANEMD</code>, <code>BNEM</code>, <code>YNEI</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>CP cond, src, dest</code></td>
<td style="text-align: left;"><code>ILEM</code>, <code>ILEMD</code>, <code>ALEM</code>, <code>ALEMD</code>, <code>BLEM</code>, <code>ALEI</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>BSET bit</code></td>
<td style="text-align: left;"><code>SEC</code>, <code>SEM</code>, <code>SEMD</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>BCLR bit</code></td>
<td style="text-align: left;"><code>REC</code>, <code>REM</code>, <code>REMD</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>BTST bit</code></td>
<td style="text-align: left;"><code>TC</code>, <code>TM</code>, <code>TMD</code></td>
</tr>
</tbody>
</table>
<h5 id="table-operand-types-for-hmcs400-meta-instructions"><strong>Table:</strong> Operand Types for HMCS400 Meta Instructions</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Operand</th>
<th style="text-align: left;">Types</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>src</code>, <code>dest</code></td>
<td style="text-align: left;"><code>A</code>, <code>B</code>, <code>X</code>, <code>Y</code>, <code>W</code>, <code>SPX</code>, <code>SPY</code> <code>(register)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>src</code>, <code>dest</code></td>
<td style="text-align: left;"><code>M</code> (memory addressed by <code>X</code>/<code>Y</code>/<code>W</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>src</code>, <code>dest</code></td>
<td style="text-align: left;"><code>M+</code> (ditto, with auto increment)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>src</code>, <code>dest</code></td>
<td style="text-align: left;"><code>M-</code> (ditto, with auto decrement)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>src</code>, <code>dest</code></td>
<td style="text-align: left;"><code>#val</code> (2/4 bits immediate)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>src</code>, <code>dest</code></td>
<td style="text-align: left;"><code>addr10</code> (memory direct)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>src</code>, <code>dest</code></td>
<td style="text-align: left;"><code>MRn</code> (memory register 0...15)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>cond</code></td>
<td style="text-align: left;"><code>NE</code> (unequal)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>cond</code></td>
<td style="text-align: left;"><code>LE</code> (less or equal)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>bit</code></td>
<td style="text-align: left;"><code>CA</code> (carry)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>bit</code></td>
<td style="text-align: left;"><code>bitpos</code>,<code>M</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>bit</code></td>
<td style="text-align: left;"><code>bitpos</code>,<code>addr10</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>bitpos</code></td>
<td style="text-align: left;"><code>0...3</code></td>
</tr>
</tbody>
</table>
<h2 id="h16">H16</h2>
<p>The instruction set of the H16&#39;s core well deserves the label &quot;CISC&quot;: complex addressing modes, instructions of extremely variable length, and there are many short forms for instructions with common operands. For instance, several instructions know different &quot;formats&quot;, depending on the type of source and destination operand. The general rule is that AS will always use the shortest possible format, unless it was specified explicitly:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span><span class="op">.</span>l     r4<span class="op">,</span>r7     <span class="co">; uses R format</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span><span class="op">.</span>l     <span class="op">#</span><span class="dv">4</span><span class="op">,</span>r7     <span class="co">; uses RQ format</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span><span class="op">.</span>l     <span class="op">#</span><span class="dv">4</span><span class="op">,</span><span class="fu">@r</span><span class="dv">7</span>    <span class="co">; uses Q format</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span><span class="op">.</span>l     <span class="fu">@r</span><span class="dv">4</span><span class="op">,</span><span class="fu">@r</span><span class="dv">7</span>   <span class="co">; uses G format</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mov:</span>q<span class="op">.</span>l   <span class="op">#</span><span class="dv">4</span><span class="op">,</span>r7     <span class="co">; forces Q instead of RQ format</span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mov:</span>g<span class="op">.</span>l   <span class="op">#</span><span class="dv">4</span><span class="op">,</span>r7     <span class="co">; forces G instead of RQ format</span></span></code></pre></div>
<p>For immediate arguments, the &quot;natural&quot; argument length is used, e.g. 2 bytes for 16 bits. Shorter or longer arguments may be forced by an appended operand size (.b, .w, .l or :8, :16, :32). However, the rule for displacements and absolute addresses is that the shortest form will be used if no explicit size is given. This includes exploiting that the processor does not output the uppermost eight bits of an address. Therefore, an absolute address of <span class="math inline"><em>f</em><em>f</em><em>f</em><em>f</em>80<em>c</em><em>a</em><em>n</em><em>b</em><em>e</em><em>c</em><em>o</em><em>d</em><em>e</em><em>d</em><em>a</em><em>s</em><em>a</em><em>s</em><em>i</em><em>n</em><em>g</em><em>l</em><em>e</em><em>b</em><em>y</em><em>t</em><em>e</em>(</span>80).</p>
<p>Furthermore, AS knows the &quot;accumulator bit&quot;, i.e. the second operand of a two-operand instruction my be left away if the destination is register zero. There is currently no override this behaviour.</p>
<p>Additionally, the following optimizations are performed:</p>
<ul>
<li><code>MOV R0,&lt;ea&gt;</code> gets optimized to <code>MOVF &lt;ea&gt;</code>, unless <code>&lt;ea&gt;</code> is a PC-relative expression and the size of the displacement would change. This optimization may be disabled by specifying an explicit format.</li>
<li><code>SUB</code> does not support the Q format, however it may be replaced by ADD:Q` with a negated immediate argument, given the argument is in the range -127...+128. This optimization may as well be disabled by specifying an explicit format.</li>
</ul>
<h2 id="olms-40">OLMS-40</h2>
<p>Similar to the HMCS400, addressing modes are largely encoded (or rather encrypted...) into into the mnemonics, and also here I decided to provide an alternate notation that is more modern and better to read. A complete list of all meta instructions and their operands can be found in the tables <a href="#table-meta-instructions-olms-40">Meta Instructions OLMS-40</a> and <a href="#table-operand-types-for-olms-40-meta-instructions">Operand Types for OLMS-40 Meta Instructions</a>, their practical use can be seen in the file <code>t_olms4.asm</code>.</p>
<h5 id="table-meta-instructions-olms-40"><strong>Table:</strong> Meta Instructions OLMS-40</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Meta Instruction</th>
<th style="text-align: left;">Replaces</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>LD dest, src</code></td>
<td style="text-align: left;"><code>LAI</code>, <code>LLI</code>, <code>LHI</code>, <code>L</code>, <code>LAL</code>, <code>LLA</code>, <code>LAW</code>, <code>LAX</code>, <code>LAY</code>, <code>LAZ</code>, <code>LWA</code>, <code>LXA</code>, <code>LYA</code>, <code>LPA</code>, <code>LTI</code>, <code>RTH</code>, <code>RTL</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>DEC dest</code></td>
<td style="text-align: left;"><code>DCA</code>, <code>DCL</code>, <code>DCM</code>, <code>DCW</code>, <code>DCX</code>, <code>DCY</code>, <code>DCZ</code>, <code>DCH</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>INC dest</code></td>
<td style="text-align: left;"><code>INA</code>, <code>INL</code>, <code>INM</code>, <code>INW</code>, <code>INX</code>, <code>INY</code>, <code>INZ</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>BSET bit</code></td>
<td style="text-align: left;"><code>SPB</code>, <code>SMB</code>, <code>SC</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>BCLR bit</code></td>
<td style="text-align: left;"><code>RPB</code>, <code>RMB</code>, <code>RC</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>BTST bit</code></td>
<td style="text-align: left;"><code>TAB</code>, <code>TMB</code>, <code>Tc</code></td>
</tr>
</tbody>
</table>
<h5 id="table-operand-types-for-olms-40-meta-instructions"><strong>Table:</strong> Operand Types for OLMS-40 Meta Instructions</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Operand</th>
<th style="text-align: left;">Types</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>src</code>, <code>dest</code></td>
<td style="text-align: left;"><code>A</code>, <code>W</code>, <code>X</code>, <code>Y</code>, <code>Z</code>, <code>DPL</code>, <code>DPH</code> (Register)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>src</code>, <code>dest</code></td>
<td style="text-align: left;"><code>T</code>, <code>TL</code>, <code>TH</code> (Timer, upper/lower half)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>src</code>, <code>dest</code></td>
<td style="text-align: left;"><code>(DP)</code>, <code>M</code> (Memory addressed by DPH/DPL)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>src</code>, <code>dest</code></td>
<td style="text-align: left;"><code>#val</code> (4/8 bit immediate)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>src</code>, <code>dest</code></td>
<td style="text-align: left;"><code>PP</code> (Port-Pointer)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>bit</code></td>
<td style="text-align: left;"><code>C</code> (Carry)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>bit</code></td>
<td style="text-align: left;"><code>(PP)</code>, <code>bitpos</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>bit</code></td>
<td style="text-align: left;"><code>(DP)</code>, <code>bitpos</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>bit</code></td>
<td style="text-align: left;"><code>(A)</code>, <code>bitpos</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>bitpos</code></td>
<td style="text-align: left;"><code>0...3</code></td>
</tr>
</tbody>
</table>
<h2 id="olms-50">OLMS-50</h2>
<p>The data memory of these 4 bit controllers consists of up to 128 nibbles. However, only a very small subset of the machine instructions have enough space to accommodate seven address bits, which menas that - once again - banking must help out. The majority of instructions that address memory only contain the lower four bits of the RAM address, and unless the lowest 16 nibbles of the memory shall be addressed, the P register delivers the necessary upper address bits. The assembler is told about its current value via an</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>       assume  p<span class="op">:&lt;</span>value<span class="op">&gt;</span></span></code></pre></div>
<p>statement, e.g. directly after a <code>PAGE</code> instruction.</p>
<p>Speaking of <code>PAGE</code>: both <code>PAGE</code> and <code>SWITCH</code> are machine instructions on these controllers, i.e. the do not have the function known from other targets. The pseudo instruction to start a <code>SWITCH</code>/<code>CASE</code> construct is <code>SELECT</code> in OLMS-50 mode, and the listing&#39;s page size is set via <code>PAGESIZE</code>.</p>
<h2 id="melps-4500">MELPS-4500</h2>
<p>The program memory of these microcontrollers is organized in pages of 128 words. Honestly said, this organization only exists because there are on the one hand branch instructions with a target that must lie within the same page, and on the other hand &quot;long&quot; branches that can reach the whole address space. The standard syntax defined by Mitsubishi demands that page number and offset have to be written as two distinct arguments for the latter instructions. As this is quite inconvenient (except for indirect jumps, a programmer has no other reason to deal with pages), AS also allows to write the target address in a &quot;linear&quot; style, for example</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>        bl      <span class="op">$</span><span class="bn">1234</span></span></code></pre></div>
<p>instead of</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>        bl      <span class="op">$</span><span class="bn">24</span><span class="op">,$</span><span class="bn">34</span></span></code></pre></div>
<h2 id="6502undoc">6502UNDOC</h2>
<p>Since the 6502&#39;s undocumented instructions naturally aren&#39;t listed in any data book, they shall be listed shortly at this place. Of course, you are using them on your own risk. There is no guarantee that all mask revisions will support all variants! They anyhow do not work for the CMOS successors of the 6502, since they allocated the corresponding bit combinations with &quot;official&quot; instructions...</p>
<p>The following symbols are used:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>&amp;</code></td>
<td style="text-align: left;">binary AND</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>|</code></td>
<td style="text-align: left;">binary OR</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>^</code></td>
<td style="text-align: left;">binary XOR</td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>&lt;&lt;</code></td>
<td style="text-align: left;">logical shift left</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>&gt;&gt;</code></td>
<td style="text-align: left;">logical shift right</td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>&lt;&lt;&lt;</code></td>
<td style="text-align: left;">rotate left</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>&gt;&gt;&gt;</code></td>
<td style="text-align: left;">rotate right</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>←</code></td>
<td style="text-align: left;">assignment</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>(...)</code></td>
<td style="text-align: left;">contents of ...</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>...</code></td>
<td style="text-align: left;">bits ...</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>A</code></td>
<td style="text-align: left;">accumulator</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>X</code>,<code>Y</code></td>
<td style="text-align: left;">index registers X,Y</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>S</code></td>
<td style="text-align: left;">stack pointer</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>An</code></td>
<td style="text-align: left;">accumulator bit n</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>M</code></td>
<td style="text-align: left;">operand</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>C</code></td>
<td style="text-align: left;">carry</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>PCH</code></td>
<td style="text-align: left;">upper half of program counter</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>JAM</code> or <code>KIL</code> or <code>CRS</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;">none, processor is halted</td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">implicit</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>SLO</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>M ← ((M) &lt;&lt; 1) | (A)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">absolute long/short, X-indexed long/short, Y-indexed long, X/Y-indirect</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>ANC</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>A ← (A) &amp; (M), C ← A7</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">immediate</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>RLA</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>M ← ((M) &lt;&lt; 1) &amp; (A)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">absolute long/short, X-indexed long/short, Y-indexed long, X/Y-indirect</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>SRE</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>M ← ((M) &gt;&gt; 1) ^ (A)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">absolute long/short, X-indexed long/short, Y-indexed long, X/Y-indirect</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>ASR</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>A ← ((A) &amp; (M)) &gt;&gt; 1</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">immediate</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>RRA</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>M ← ((M) &gt;&gt;&gt; 1)  +  (A) + (C)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">absolute long/short, X-indexed long/short, Y-indexed long, X/Y-indirect</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>ARR</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>A ← ((A) &amp; (M)) &gt;&gt;&gt; 1</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">immediate</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>SAX</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>M ← (A) &amp; (X)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">absolute long/short, Y-indexed short, Y-indirect</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>ANE</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>M ← ((A) &amp; $ee) | ((X) &amp; (M))</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">immediate</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>SHA</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>M ← (A) &amp; (X) &amp; (PCH+1)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">X/Y-indexed long</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>SHS</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>X ← (A) &amp; (X),  S ← (X),  M ← (X) &amp; (PCH+1)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">Y-indexed long</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>SHY</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>M ← (Y) &amp; (PCH+1)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">Y-indexed long</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>SHX</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>M ← (X) &amp; (PCH+1)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">X-indexed long</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>LAX</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>A,  X ← (M)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">absolute long/short, Y-indexed long/short, X/Y-indirect</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>LXA</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>X04 ← (X)04 &amp; (M)04, A04 ← (A)04 &amp; (M)04</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">immediate</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>LAE</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>X,  S,  A ← ((S) &amp; (M))</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">Y-indexed long</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>DCP</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>M ← (M) − 1, Flags ← ((A) − (M))</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">absolute long/short, X-indexed long/short, Y-indexed long, X/Y-indirect</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>SBX</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>X ← ((X) &amp; (A)) − (M)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">immediate</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>ISB</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>M ← (M) + 1,  A ← (A) − (M) − (C)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Addressing Modes</td>
<td style="text-align: left;">absolute long/short, X-indexed long/short, Y-indexed long, X/Y-indirect</td>
</tr>
</tbody>
</table>
<h2 id="melps-740">MELPS-740</h2>
<p>Microcontrollers of this family have a quite nice, however well-hidden feature: If one sets bit 5 of the status register with the <code>SET</code> instruction, the accumulator will be replaced with the memory cell addressed by the X register for all load/store and arithmetic instructions. An attempt to integrate this feature cleanly into the assembly syntax has not been made so far, so the only way to use it is currently the &quot;hard&quot; way (<code>SET</code>...instructions with accumulator addressing...<code>CLT</code>).</p>
<p>Not all MELPS-740 processors implement all instructions. This is a place where the programmer has to watch out for himself that no instructions are used that are unavailable for the targeted processor; AS does not differentiate among the individual processors of this family. For a description of the details regarding special page addressing, see the discussion of the <code>ASSUME</code> instruction.</p>
<h2 id="melps-770065816">MELPS-7700/65816</h2>
<p>As it seems, these two processor families took disjointed development paths, starting from the 6502 via their 8 bit predecessors. Shortly listed, the following differences are present:</p>
<ul>
<li>The 65816 does not have a B accumulator.</li>
<li>The 65816 does not have instructions to multiply or divide.</li>
<li>The 65816 misses the instructions <code>SEB</code>, <code>CLB</code>, <code>BBC</code>, <code>BBS</code>, <code>CLM</code>, <code>SEM</code>, <code>PSH</code>, <code>PUL</code> and <code>LDM</code>. Instead, the instructions <code>TSB</code>, <code>TRB</code>, <code>BIT</code>, <code>CLD</code>, <code>SED</code>, <code>XBA</code>, <code>XCE</code> and <code>STZ</code> take their places in the opcode table.</li>
</ul>
<p>The following instructions have identical function, yet different names:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">65816</th>
<th style="text-align: center;">MELPS-7700</th>
<th style="text-align: center;">65816</th>
<th style="text-align: center;">MELPS-7700</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>REP</code></td>
<td style="text-align: center;"><code>CLP</code></td>
<td style="text-align: center;"><code>PHK</code></td>
<td style="text-align: center;"><code>PHG</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>TCS</code></td>
<td style="text-align: center;"><code>TAS</code></td>
<td style="text-align: center;"><code>TSC</code></td>
<td style="text-align: center;"><code>TSA</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>TCD</code></td>
<td style="text-align: center;"><code>TAD</code></td>
<td style="text-align: center;"><code>TDC</code></td>
<td style="text-align: center;"><code>TDA</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>PHB</code></td>
<td style="text-align: center;"><code>PHT</code></td>
<td style="text-align: center;"><code>PLB</code></td>
<td style="text-align: center;"><code>PLT</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>WAI</code></td>
<td style="text-align: center;"><code>WIT</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>Especially tricky are the instructions <code>PHB</code>, <code>PLB</code> and <code>TSB</code>: these instructions have a totally different encoding and meaning on both processors!</p>
<p>Unfortunately, these processors address their memory in a way that is IMHO even one level higher on the open-ended chart of perversity than the Intel-like segmentation: They do banking! Well, this seems to be the price for the 6502 upward-compatibility; before one can use AS to write code for these processors, one has to inform AS about the contents of several registers (using the <code>ASSUME</code> instruction):</p>
<p>The M flag rules whether the accumulators A and B should be used with 8 bits (1) or 16 bits (0) width. Analogously, the X flag decides the width of the X and Y index registers. AS needs this information for the decision about the argument&#39;s width when immediate addressing (<code>#&lt;constant&gt;</code>) occurs.</p>
<p>The memory is organized in 256 banks of 64 KBytes. As all registers in the CPU core have a maximum width of 16 bits, the upper 8 bits have to be fetched from 2 special bank registers: DT delivers the upper 8 bits for data accesses, and PG extends the 16-bit program counter to 24 bits. A 16 bits wide register DPR allows to move the zero page known from the 6502 to an arbitrary location in the first bank. If AS encounters an address (it is irrelevant if this address is part of an absolute, indexed, or indirect expression), the following addressing modes will be tested:</p>
<ol type="1">
<li>Is the address in the range of <code>DPR...DPR+$ff</code>? If yes, use direct addressing with an 8-bit address.</li>
<li>Is the address contained in the page addressable via DT (resp. PG for branch instructions)? If yes, use absolute addressing with a 16-bit address.</li>
<li>If nothing else helps, use long addressing with a 24-bit address.</li>
</ol>
<p>As one can see from this enumeration, the knowledge about the current values of DT, PG and DPR is essential for a correct operation of AS; if the specifications are incorrect, the program will probably do wrong addressing at runtime. This enumeration also implied that all three address lengths are available; if this is not the case, the decision chain will become shorter.</p>
<p>The automatic determination of the address length described above may be overridden by the usage of prefixes. If one prefixes the address by a <code>&lt;</code>, <code>&gt;</code>, or  <code>&gt;&gt;</code> without a separating space, an address with 1, 2, or 3 bytes of length will be used, regardless if this is the optimal length. If one uses an address length that is either not allowed for the current instruction or too short for the address, an error message is the result.</p>
<p>To simplify porting of 6502 programs, AS uses the Motorola syntax for hexadecimal constants instead of the Intel/IEEE syntax that is the format preferred by Mitsubishi for their 740xxx series. I still think that this is the better format, and it looks as if the designers of the 65816 were of the same opinion (as the <code>RELAXED</code> instruction allows the alternative use of Intel notation, this decision should not hurt anything). Another important detail for the porting of programs is that it is valid to omit the accumulator A as target for operations. For example, it is possible to simply write <code>LDA #0</code> instead of <code>LDA A,#0</code>.</p>
<p>A real goodie in the instruction set are the instructions <code>MVN</code> resp. <code>MVP</code> to do block transfers. However, their address specification rules are a bit strange: bits 0-15 are stored in index registers, bits 16-23 are part of the instruction. When one uses AS, one simply specifies the full destination and source addresses. AS will then automatically grab the correct bits. This is a fine yet important difference Mitsubishi&#39;s assembler where you have to extract the upper 8 bits on your own. Things become really convenient when a macro like the following is used:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>mvpos   macro   src<span class="op">,</span>dest<span class="op">,</span>len</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>        <span class="pp">if</span>      MomCPU<span class="op">=$</span><span class="bn">7700</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>        lda    <span class="op">#</span>len</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>        elseif</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>        lda    <span class="op">#(</span>len<span class="op">-</span><span class="dv">1</span><span class="op">)</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>        endif</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>        ldx     <span class="op">#(</span>src<span class="op">&amp;$</span>ffff<span class="op">)</span></span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>        ldy     <span class="op">#(</span>dest<span class="op">&amp;$</span>ffff<span class="op">)</span></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>        mvp     dest<span class="op">,</span>src</span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>Caution, possible pitfall: if the accumulator contains the value n, the Mitsubishi chip will transfer n bytes, but the 65816 will transfer n+1 bytes!</p>
<p>The <code>PSH</code> and <code>PUL</code> instructions are also very handy because they allow to save a user-defined set to be saved to the stack resp. to be restored from the stack. According to the Mitsubishi data book <a href="#fn34" class="footnote-ref" id="fnref34" role="doc-noteref"><sup>34</sup></a>, the bit mask has to be specified as an immediate operand, so the programmer either has to keep all bit↔︎register assignments in mind or he has to define some appropriate symbols. To make things simpler, I decided to extend the syntax at this point: It is valid to use a list as argument which may contain an arbitrary sequence of register names or immediate expressions. Therefore, the following instructions</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>        psh     <span class="op">#$</span><span class="bn">0f</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>        psh     a<span class="op">,</span>b<span class="op">,#$</span><span class="bn">0c</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>        psh     a<span class="op">,</span>b<span class="op">,</span>x<span class="op">,</span>y</span></code></pre></div>
<p>are equivalent. As immediate expressions are still valid, AS stays upward compatible to the Mitsubishi assemblers.</p>
<p>One thing I did not fully understand while studying the Mitsubishi assembler is the treatment of the <code>PER</code> instruction: this instruction allows to push a 16-bit variable onto the stack whose address is specified relative to the program counter. Therefore, it is an absolute addressing mode from the programmer&#39;s point of view. Nevertheless, the Mitsubishi assembler requests immediate addressing, and the instructions argument is placed into the code just as-is. One has to calculate the address in his own, which is something symbolic assemblers were designed for to avoid...as I wanted to stay compatible, AS contains a compromise: If one chooses immediate addressing (with a leading <code>#</code> sign), AS will behave like the original from Mitsubishi. But if the <code>#</code> sign is omitted, as will calculate the difference between the argument&#39;s value and the current program counter and insert this difference instead.</p>
<p>A similar situation exists for the <code>PEI</code> instruction that pushes the contents of a 16-bit variable located in the zero page: Though the operand represents an address, once again immediate addressing is required. In this case, AS will simply allow both variants (i.e. with or without a <code>#</code> sign).</p>
<h2 id="m16">M16</h2>
<p>The M16 family is a family of highly complex CISC processors with an equally complicated instruction set. One of the instruction set&#39;s properties is the detail that in an instruction with two operands, both operands may be of different sizes. The method of appending the operand size as an attribute of the instruction (known from Motorola and adopted from Mitsubishi) therefore had to be extended: it is valid to append attributes to the operands themselves. For example, the following instruction</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span>     r0<span class="op">.</span>b<span class="op">,</span>r6<span class="op">.</span>w</span></code></pre></div>
<p>reads the lowest 8 bits of register 0, sign-extends them to 32 bits and stores the result into register 6. However, as one does not need this feature in 9 out of 10 cases, it is still valid to append the operand size to the instruction itself, e.g.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span><span class="op">.</span>w   r0<span class="op">,</span>r6</span></code></pre></div>
<p>Both variants may be mixed; in such a case, an operand size appended to an operand overrules the &quot;default&quot;. An exception are instructions with two operands. For these instructions, the default for the source operand is the destination operand&#39;s size. For example, in the following example</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span><span class="op">.</span>h   r0<span class="op">,</span>r6<span class="op">.</span>w</span></code></pre></div>
<p>register 0 is accessed with 32 bits, the size specification appended to the instruction is not used at all. If an instruction does not contain any size specifications, word size (<code>w</code>) will be used. Remember: in contrast to the 68000 family, this means 32 bits instead of 16 bits!</p>
<p>The chained addressing modes are also rather complex; the ability of AS to automatically assign address components to parts of the chain keeps things at least halfway manageable. The only way of influencing AS allows (the original assembler from Mitsubishi/Green Hills allows a bit more in this respect) is the explicit setting of displacement lengths by appending <code>:4</code>, <code>:16</code> and <code>:32</code>.</p>
<h2 id="40044040">4004/4040</h2>
<p>Thanks to John Weinrich, I now have the official Intel data sheets describing these &#39;grandfathers&#39; of all microprocessors, and the questions about the syntax of register pairs (for 8-bit operations) have been weeded out for the moment: It is <code>RnRm</code> with <code>n</code> resp. <code>m</code> being even integers in the range from <code>0</code> to <code>E</code> resp. <code>1</code> to <code>F</code>. The equation <code>m = n + 1</code> must be fulfilled.</p>
<h2 id="mcs-48">MCS-48</h2>
<p>The maximum address space of these processors is 4 Kbytes, resp. up to 8 Kbytes on some Philips variants. This address space is not organized in a linear way (how could this be on an Intel CPU...). Instead, it is split into 2 banks of 2 Kbytes. The only way to change the program counter from one bank to the other are the instructions <code>CALL</code> and <code>JMP</code>, by setting the most significant bit of the address with the instructions <code>SEL MB0</code> to <code>SEL MB3</code>.</p>
<p>The assembler may be informed about the bank currently being selected for jumps and calls, via an <code>ASSUME</code> statement:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>        ASSUME MB<span class="op">:&lt;</span><span class="fl">0.</span><span class="op">..</span><span class="dv">3</span><span class="op">&gt;</span></span></code></pre></div>
<p>If one tries to jump to an address in a different bank, a warning is issued.</p>
<p>If the special value <code>NOTHING</code> is used (this is by the way the default), an automatism built into <code>JMP</code> and <code>CALL</code> is activated. It will insert a <code>SEL MBx</code> instruction if the current program counter and the target address are located in different banks. Explicit usage of <code>SEL MBx</code> instructions is no longer necessary (though it remains possible), and it might interfere with this mechanism, like in the following example:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>000:    SEL      MB1</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">JMP</span>      <span class="bn">200h</span></span></code></pre></div>
<p>AS assumes that the MB flag is 0 and therefore does not insert a <code>SEL MB0</code> instruction, with the result that the CPU jumps to address <code>A00h</code>.</p>
<p>Furthermore, one should keep in mind that a jump instruction might become longer (3 instead of 2 bytes).</p>
<h2 id="mcs-51">MCS-51</h2>
<p>The assembler is accompanied by the files <code>STDDEF51.INC</code> resp. <code>80C50X.INC</code> that define all bits and SFRs of the processors 8051, 8052, and 80515 resp. 80C501, 502, and 504. Depending on the target processor setting (made with the <code>CPU</code> statement), the correct subset will be included. Therefore, the correct order for the instructions at the beginning of a program is</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>        CPU     <span class="op">&lt;</span>processor type<span class="op">&gt;</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">INCLUDE</span> stddef51<span class="op">.</span>inc</span></code></pre></div>
<p>Otherwise, the MCS-51 pseudo instructions will lead to error messages.</p>
<p>As the 8051 does not have instructions to to push the registers 0...7 onto the stack, one has to work with absolute addresses. However, these addresses depend on which register bank is currently active. To make this situation a little bit better, the include files define the macro <code>USING</code> that accepts the symbols <code>Bank0...Bank3</code> as arguments. In response, the macro will assign the registers&#39; correct absolute addresses to the symbols <code>AR0...AR7</code>. This macro should be used after every change of the register banks. The macro itself does <strong>not</strong> generate any code to switch to the bank!</p>
<p>The macro also makes bookkeeping about which banks have been used. The result is stored in the integer variable <code>RegUsage</code>: bit 0 corresponds to bank 0, bit 1 corresponds to bank 1. and so on. To output its contents after the source has been assembled, use something like the following piece of code:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>        <span class="pp">irp</span>       BANK<span class="op">,</span>Bank0<span class="op">,</span>Bank1<span class="op">,</span>Bank2<span class="op">,</span>Bank3</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>        <span class="pp">if</span>        <span class="op">(</span>RegUsage<span class="op">&amp;(</span><span class="dv">2</span><span class="pp">^</span>BANK<span class="op">))&lt;&gt;</span><span class="dv">0</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>        message   <span class="st">&quot;bank \{BANK} has been used&quot;</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>        endif</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>The multipass feature introduced with version 1.38 allowed to introduce the additional instructions <code>JMP</code> and <code>CALL</code>. If branches are coded using these instructions, AS will automatically use the variant that is optimal for the given target address. The options are <code>SJMP</code>, <code>AJMP</code>, or <code>LJMP</code> for <code>JMP</code> resp. <code>ACALL</code> or <code>LCALL</code> for <code>CALL</code>. Of course it is still possible to use these variants directly, in case one wants to force a certain coding.</p>
<h2 id="mcs-251">MCS-251</h2>
<p>When designing the 80C251, Intel really tried to make the move to the new family as smooth as possible for programmers. This culminated in the fact that old applications can run on the new processor without having to recompile them. However, as soon as one wants to use the new features, some details have to be regarded which may turn into hidden pitfalls.</p>
<p>The most important thing is the absence of a distinct address space for bits on the 80C251. All SFRs can now be addressed bitwise, regardless of their address. Furthermore, the first 128 bytes of the internal RAM are also bit addressable. This has become possible because bits are not any more handled by a separate address space that overlaps other address spaces. Instead, similar to other processors, bits are addressed with a two-dimensional address that consists of the memory location containing the bit and the bit&#39;s location in the byte. One result is that in an expression like <code>PSW.7</code>, AS will do the separation of address and bit position itself. Unlike to the 8051, it is not any more necessary to explicitly generate 8 bit symbols. This has the other result that the <code>SFRB</code> instruction does not exist any more. If it is used in a program that shall be ported, it may be replaced with a simple <code>SFR</code> instruction.</p>
<p>Furthermore, Intel cleaned up the cornucopia of different address spaces on the 8051: the internal RAM (<code>DATA</code> resp. <code>IDATA</code>), the <code>XDATA</code> space and the former <code>CODE</code> space were unified to a single <code>CODE</code> space that is now 16 Mbytes large. The internal RAM starts at address 0, the internal ROM starts at address ff0000h, which is the address code has to be relocated to. In contrast, the SFRs were moved to a separate address space (which AS refers to as the <code>IO</code> segment). However, they have the same addresses in this new address space as they used to have on the 8051. The <code>SFR</code> instructions knows of this difference and automatically assigns symbols to either the <code>DATA</code> or <code>IO</code> segment, depending on the target processor. As there is no <code>BIT</code> segment any more, the <code>BIT</code> instruction operates completely different: Instead of a linear address ranging from 0...255, a bit symbol now contains the byte&#39;s address in bit 0...7, and the bit position in bits 24...26. Unfortunately, creating arrays of flags with a symbolic address is not that simple any more: On an 8051, one simply wrote:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">segment</span> bitdata</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>bit1    <span class="dt">db</span>      <span class="op">?</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>bit2    <span class="dt">db</span>      <span class="op">?</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="bu">or</span></span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>defbit  macro   name</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>name    bit     cnt</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>cnt     set     cnt<span class="op">+</span><span class="dv">1</span></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>On a 251, only the second way still works, like this:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>adr     set     <span class="bn">20h</span>     <span class="co">; start address of flags</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>bpos    set     <span class="dv">0</span>       <span class="co">; in the internal RAM</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>defbit  macro   name</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>name    bit     adr<span class="op">.</span>bpos</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>bpos    set     bpos<span class="op">+</span><span class="dv">1</span></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>        <span class="pp">if</span>      bpos<span class="op">=</span><span class="dv">8</span></span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>bpos    set     <span class="dv">0</span></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a>adr     set     adr<span class="op">+</span><span class="dv">1</span></span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>        endif</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>Another small detail: Intel now prefers <code>CY</code> instead of <code>C</code> as a symbolic name for the carry, so you might have to rename an already existing variable of the same name in your program. However, AS will continue to understand also the old variant when using the instructions <code>CLR</code>, <code>CPL</code>, <code>SETB</code>, <code>MOV</code>, <code>ANL</code>, or <code>ORL</code>. The same is conceptually true for the additional registers <code>R8...R15</code>, <code>WR0...WR30</code>, <code>DR0...DR28</code>, <code>DR56</code>, <code>DR60</code>, <code>DPX</code>, and <code>SPX</code>.</p>
<p>Intel would like everyone to write absolute addresses in a syntax of <code>XX:YYYY</code>, where <code>XX</code> is a 64K bank in the address space resp. signifies addresses in the I/O space with an <code>S</code>. As one might guess, I am not amused about this, which is why it is legal to alternatively use linear addresses in all places. Only the <code>S</code> for I/O addresses is inescapable, as in this case:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>Carry   bit     s<span class="op">:</span><span class="bn">0d0h</span><span class="op">.</span><span class="dv">7</span></span></code></pre></div>
<p>Without the prefix, AS would assume an address in the <code>CODE</code> segment, and only the first 128 bits in this space are bit-addressable...</p>
<p>Like for the 8051, the generic branch instructions <code>CALL</code> and <code>JMP</code> exist that automatically choose the shortest machine code depending on the address layout. However, while <code>JMP</code> also may use the variant with a 24-bit address, <code>CALL</code> will not do this for a good reason: In contrast to <code>ACALL</code> and <code>LCALL</code>, <code>ECALL</code> places an additional byte onto the stack. A <code>CALL</code> instruction would result where you would not know what it will do. This problem does not exist for the <code>JMP</code> instructions.</p>
<p>There is one thing I did not understand: The 80251 is also able to push immediate operands onto the stack, and it may push either single bytes or complete words. However, the same mnemonic (<code>PUSH</code>) is assigned to both variants - how on earth should an assembler know if an instruction like</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">push</span>    <span class="op">#</span><span class="dv">10</span></span></code></pre></div>
<p>shall push a byte or a word containing the value 10? So the current rule is that <code>PUSH</code> always pushes a byte; if one wants to push a word, simply use <code>PUSHW</code> instead of <code>PUSH</code>.</p>
<p>Another well-meant advise: If you use the extended instruction set, be sure to operate the processor in source mode; otherwise, all instructions will become one byte longer! The old 8051 instructions that will in turn become one byte longer are not a big matter: AS will either replace them automatically with new, more general instructions or they deal with obsolete addressing modes (indirect addressing via 8 bit registers).</p>
<h2 id="80808085">8080/8085</h2>
<p>As mentioned before, the statement</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>        Z80SYNTAX <span class="op">&lt;</span>ON<span class="op">|</span>OFF<span class="op">|</span>EXCLUSIVE<span class="op">&gt;</span></span></code></pre></div>
<p>makes it possible to write the vast majority of 8080/8085 instructions in &#39;Z80 style&#39;, i.e. with less mnemonics but with operands that are easier to understand. In non-exclusive mode, the Z80 syntax is not allowed for the following instructions, because they conflict with existing 8080 mnemonics:</p>
<ul>
<li><code>CP</code> in &#39;Intel syntax&#39; means &#39;Call on Positive&#39;, in Zilog syntax however it means &#39;Compare&#39;. If you use <code>CP</code> with a numeric value, it is not possible for the assembler to recognize whether a jump to an absolute address or a compare with an immediate value is meant. The assembler will generate a jump in this case, since the Intel syntax has precedence in case of ambiguities. If one wants the comparison, one may explicitly write down the accumulator as destination operand, e.g. <code>CP A,12h</code> instead of <code>CP 12h</code>.</li>
<li><code>JP</code> in Intel syntax means &#39;Jump on Positive&#39;, in Zilog syntax however, this is the jump instruction in general. Conditional jumps in Zilog syntax (<code>JP cond,addr</code>) are unambiguous because of the two arguments. With only one argument, the assembler will however always generate the conditional jump. If you want an unconditional jump to an absolute address, you still have to use the Intel syntax (<code>JMP addr</code>).</li>
</ul>
<p>The 8085 supports the instructions <code>RIM</code> and <code>SIM</code> that are not part of the Z80 instruction set. They may be written in &#39;Z80 style&#39; as <code>LD A,IM</code> resp. <code>LD IM,A</code>.</p>
<h2 id="8085undoc">8085UNDOC</h2>
<p>Similarly to the Z80 or 6502, Intel did not further specify the undocumented 8085 instructions. This however means that other assemblers might use different mnemonics for the same function. Therefore, I will list the instructions in the following. Once again, usage of these instructions is at one&#39;s own risk - even the Z80 which is principally upward compatible to the 8085 uses the opcodes for entirely different functions...</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>DSUB [reg]</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Z80 Syntax</td>
<td style="text-align: left;"><code>SUB HL,reg</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>HL ← HL - reg</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flags</td>
<td style="text-align: left;"><code>CY</code>, <code>S</code>, <code>X5</code>, <code>AC</code>, <code>Z</code>, <code>V</code>, <code>P</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Arguments</td>
<td style="text-align: left;"><code>reg</code> = <code>B</code> for <code>BC</code> (optional for non-Z80 syntax)</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>ARHL</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Z80 Syntax</td>
<td style="text-align: left;"><code>SRA HL</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>HL, CY ← HL &gt;&gt; 1</code> (arithmetic)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flags</td>
<td style="text-align: left;"><code>CY</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Arguments</td>
<td style="text-align: left;">none resp. fixed for Z80 syntax</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>RDEL</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Z80 Syntax</td>
<td style="text-align: left;"><code>RLC DE</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>CY,DE ← DE &lt;&lt; 1</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flags</td>
<td style="text-align: left;"><code>CY</code>, <code>V</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Arguments</td>
<td style="text-align: left;">none resp. fixed for Z80 syntax</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>LDHI d8</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Z80 Syntax</td>
<td style="text-align: left;"><code>ADD DE,HL,d8</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>DE ← HL + d8</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flags</td>
<td style="text-align: left;">none</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arguments</td>
<td style="text-align: left;"><code>d8</code> = 8-bit constant, registers fixed for Z80 syntax</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>LDSI d8</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Z80 Syntax</td>
<td style="text-align: left;"><code>ADD DE,SP,d8</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>DE ← SP + d8</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flags</td>
<td style="text-align: left;">none</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arguments</td>
<td style="text-align: left;"><code>d8</code> = 8-bit constant, registers fixed for Z80 syntax</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>RSTflag</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Z80 Syntax</td>
<td style="text-align: left;"><code>RST flag</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Function</td>
<td style="text-align: left;">restart to <code>40h</code> if <code>flag=1</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flags</td>
<td style="text-align: left;">none</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arguments</td>
<td style="text-align: left;"><code>flag</code> = <code>V</code> for overflow bit</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>SHLX [reg]</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Z80 Syntax</td>
<td style="text-align: left;"><code>LD (reg),HL</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>[reg] ← HL</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flags</td>
<td style="text-align: left;">none</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arguments</td>
<td style="text-align: left;"><code>reg</code> = <code>D</code>/<code>DE</code> for <code>DE</code> (optional for non-Z80 syntax)</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>LHLX [reg]</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Z80 Syntax</td>
<td style="text-align: left;"><code>LD HL,(reg)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Function</td>
<td style="text-align: left;"><code>HL ← [reg]</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flags</td>
<td style="text-align: left;">none</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arguments</td>
<td style="text-align: left;"><code>reg</code> = <code>D</code>/<code>DE</code> for <code>DE</code> (optional for non-Z80 syntax)</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>JNX5 addr</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Z80 Syntax</td>
<td style="text-align: left;"><code>JP NX5, addr</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Function</td>
<td style="text-align: left;">jump to <code>addr</code> if <code>X5=0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flags</td>
<td style="text-align: left;">none</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arguments</td>
<td style="text-align: left;"><code>addr</code> = absolute 16-bit address</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;"><code>JX5 addr</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Z80 Syntax</td>
<td style="text-align: left;"><code>JP X5,addr</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Function</td>
<td style="text-align: left;">jump to <code>addr</code> if <code>X5=1</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flags</td>
<td style="text-align: left;">none</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arguments</td>
<td style="text-align: left;"><code>addr</code> = absolute 16-bit address</td>
</tr>
</tbody>
</table>
<p>X5 refers to the otherwise unused bit 5 in the processor status word (PSW).</p>
<h2 id="8086v35">8086...V35</h2>
<p>Actually, I had sworn myself to keep the segment disease of Intel&#39;s 8086 out of the assembler. However, as there was a request and as students are more flexible than the developers of this processor obviously were, there is now a rudimentary support of these processors in AS. When saying, &#39;rudimentary&#39;, it does not mean that the instruction set is not fully covered. It means that the whole pseudo instruction stuff that is available when using MASM, TASM, or something equivalent does not exist. To put it in clear words, AS was not primarily designed to write assembler programs for PC&#39;s (heaven forbid, this really would have meant reinventing the wheel!); instead, the development of programs for single-board computers was the main goal (which may also be equipped with an 8086 CPU).</p>
<p>For die-hards who still want to write DOS programs with AS, here is a small list of things to keep in mind:</p>
<ul>
<li>Only <code>COM</code> files may be created.</li>
<li>Only use the <code>CODE</code> segment, and place also all variables in this segment.</li>
<li>DOS initializes all segment registers to the code segment. An <code>ASSUME DS:DATA, SS:DATA</code> right at the program&#39;s beginning is therefore necessary.</li>
<li>DOS loads the code to a start address of 100h. An <code>ORG</code> to this address is absolutely necessary.</li>
<li>The conversion to a binary file is done with <code>P2BIN</code> (see later in this document), with an address filter of <code>$-$</code>.</li>
</ul>
<p>For these processors, AS only supports a small programming model, i.e. there is <strong>one</strong> code segment with a maximum of 64 Kbytes and a data segment of equal size for data (which cannot be set to initial values for <code>COM</code> files). The <code>SEGMENT</code> instruction allows to switch between these two segments. From this facts results that branches are always intra-segment branches if they refer to targets in this single code segment. In case that far jumps should be necessary, they are possible via <code>CALLF</code> or <code>JMPF</code> with a memory address or a <code>Segment:Offset</code> value as argument.</p>
<p>Another big problem of these processors is their assembler syntax, which is sometimes ambiguous and whose exact meaning can then only be deduced by looking at the current context. In the following example, either absolute or immediate addressing may be meant, depending on the symbol&#39;s type:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span>     <span class="kw">ax</span><span class="op">,</span>value</span></code></pre></div>
<p>When using AS, an expression without brackets always is interpreted as immediate addressing. For example, when either a variable&#39;s address or its contents shall be loaded, the differences between MASM and AS are as follows:</p>
<ul>
<li><p>To load address of variable <code>vari</code> into <code>ax</code>:</p>
<ul>
<li><p>MASM: either of the following 3 variants have the same effect:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="bu">mov</span> <span class="kw">ax</span><span class="op">,</span>offset vari</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="bu">lea</span> <span class="kw">ax</span><span class="op">,</span>vari</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="bu">lea</span> <span class="kw">ax</span><span class="op">,[</span>vari<span class="op">]</span></span></code></pre></div></li>
<li><p>AS: either of the following 2 variants have the same effect:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="bu">mov</span> <span class="kw">ax</span><span class="op">,</span>vari</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="bu">lea</span> <span class="kw">ax</span><span class="op">,[</span>vari<span class="op">]</span></span></code></pre></div></li>
</ul></li>
<li><p>To load value of variable <code>vari</code> into <code>ax</code>:</p>
<ul>
<li><p>MASM: either of the following 2 variants have the same effect:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="bu">mov</span> <span class="kw">ax</span><span class="op">,</span>vari</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="bu">mov</span> <span class="kw">ax</span><span class="op">,[</span>vari<span class="op">]</span></span></code></pre></div></li>
<li><p>AS:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="bu">mov</span> <span class="kw">ax</span><span class="op">,[</span>vari<span class="op">]</span></span></code></pre></div></li>
</ul></li>
</ul>
<p>When addressing via a symbol, the assembler checks whether they are assigned to the data segment and tries to automatically insert an appropriate segment prefix. This happens for example when symbols from the code segment are accessed without specifying a <code>CS</code> segment prefix. However, this mechanism can only work if the <code>ASSUME</code> instruction (see there) has previously been applied correctly.</p>
<p>The Intel syntax also requires to store whether bytes or words were stored at a symbol&#39;s address. AS will do this only when the <code>DB</code> resp. <code>DW</code> instruction is in the same source line as the label. For any other case, the operand size has to be specified explicitly with the <code>BYTE PTR</code>, <code>WORD PTR</code>, ... operators. As long as a register is the other operator, this may be omitted, as the operand size is then clearly given by the register&#39;s name.</p>
<p>In an 8086-based system, the coprocessor is usually synchronized via via the processor&#39;s TEST input line which is connected to toe coprocessor&#39;s BUSY output line. AS supports this type of handshaking by automatically inserting a <code>WAIT</code> instruction prior to every 8087 instruction. If this is undesired for any reason, an <code>N</code> has to be inserted after the <code>F</code> in the mnemonic; for example,</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">FINIT</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">FSTSW</span>   <span class="op">[</span>vari<span class="op">]</span></span></code></pre></div>
<p>becomes</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">FNINIT</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">FNSTSW</span>  <span class="op">[</span>vari<span class="op">]</span></span></code></pre></div>
<p>This variant is valid for <strong>all</strong> coprocessor instructions.</p>
<h2 id="8x30x">8X30x</h2>
<p>The processors of this family have been optimized for an easy manipulation of bit groups at peripheral addresses. The instructions <code>LIV</code> and <code>RIV</code> were introduced to deal with such objects in a symbolic fashion. They work similar to <code>EQU</code>, however they need three parameters:</p>
<ol type="1">
<li>the address of the peripheral memory cell that contains the bit group (0...255);</li>
<li>the number of the group&#39;s first bit (0...7);</li>
<li>the length of the group, expressed in bits (1...8).</li>
</ol>
<p><strong>CAUTION!</strong> The 8X30x does not support bit groups that span over more than one memory address. Therefore, the valid value range for the length can be stricter limited, depending on the start position. AS does <strong>not</strong> perform any checks at this point, you simply get strange results at runtime!</p>
<p>Regarding the machine code, length and position are expressed vis a 3 bit field in the instruction word and a proper register number (<code>LIVx</code> resp. <code>RIVx</code>). If one uses a symbolic object, AS will automatically assign correct values to this field, but it is also allowed to specify the length explicitly as a third operand if one does not work with symbolic objects. If AS finds such a length specification in spite of a symbolic operand, it will compare both lengths and issue an error if they do not match (the same will happen for the MOVE instruction if two symbolic operands with different lengths are used - the instruction simply only has a single length field...).</p>
<p>Apart from the real machine instructions, AS defines similarly to its &quot;idol&quot; MCCAP some pseudo instructions that are implemented as builtin macros:</p>
<ul>
<li><code>NOP</code> is a short form for <code>MOVE AUX,AUX</code></li>
<li><code>HALT</code> is a short form for <code>JMP *</code></li>
<li><code>XML ii</code> is a short form for <code>XMIT ii,R12</code> (only 8X305)</li>
<li><code>XMR ii</code> is a short form for <code>XMIT ii,R13</code> (only 8X305)</li>
<li><code>SEL &lt;busobj&gt;</code> is a short form for <code>XMIT &lt;adr&gt;,IVL/IVR</code>, i.e. it performs the necessary preselection to access <code>&lt;busobj&gt;</code>.</li>
</ul>
<p>The <code>CALL</code> and <code>RTN</code> instructions MCCAP also implements are currently missing due to sufficient documentation. The same is true for a set of pseudo instructions to store constants to memory. Time may change this...</p>
<h2 id="xa-1">XA</h2>
<p>Similar to its predecessor MCS/51, but in contrast to its &#39;competitor&#39; MCS/251, the Philips XA has a separate address space for bits, i.e. all bits that are accessible via bit instructions have a certain, one-dimensional address which is stored as-is in the machine code. However, I could not take the obvious opportunity to offer this third address space (code and data are the other two) as a separate segment. The reason is that - in contrast to the MCS/51 - some bit addresses are ambiguous: bits with an address from 256 to 511 refer to the bits of memory cells 20h...3fh in the current data segment. This means that these addresses may correspond to different physical bits, depending on the current state. Defining bits with the help of <code>DC</code> instructions - something that would be possible with a separate segment - would not make too much sense. However, the <code>BIT</code> instruction still exists to define individual bits (regardless if they are located in a register, the RAM or SFR space) that can then be referenced symbolically. If the bit is located in RAM, the address of the 64K-bank is also stored. This way, AS can check whether the DS register has previously be assigned a correct value with an <code>ASSUME</code> instruction.</p>
<p>In contrast, nothing can stop AS&#39;s efforts to align potential branch targets to even addresses. Like other XA assemblers, AS does this by inserting <code>NOP</code>s right before the instruction in question.</p>
<h2 id="avr">AVR</h2>
<p>In contrast to the AVR assembler, AS by default uses the Intel format to write hexadecimal constants instead of the C syntax. All right, I did not look into the (free) AVR assembler before, but when I started with the AVR part, there was hardly more information about the AVR than a preliminary manual describing processor types that were never sold...this problem can be solved with a simple RELAXED ON.</p>
<p>Optionally, AS can generate so-called &quot;object files&quot; for the AVRs (it also works for other CPUs, but it does not make any sense for them...). These are files containing code and source line info what e.g. allows a step-by-step execution on source level with the WAVRSIM simulator delivered by Atmel. Unfortunately, the simulator seems to have trouble with source file names longer than approx. 20 characters: Names are truncated and/or extended by strange special characters when the maximum length is exceeded. AS therefore stores file name specifications in object files without a path specification. Therefore, problems may arise when files like includes are not in the current directory.</p>
<p>A small specialty are machine instructions that have already been defined by Atmel as part of the architecture, but up to now haven&#39;t been implemented in any of the family&#39;s members. The instructions in question are <code>MUL</code>, <code>JMP,</code> and <code>CALL</code>. Considering the latter ones, one may ask himself how to reach the 4 Kwords large address space of the AT90S8515 when the &#39;next best&#39; instructions <code>RJMP</code> and <code>RCALL</code> can only branch up to 2 Kwords forward or backward. The trick is named &#39;discarding the upper address bits&#39; and described in detail with the <code>WRAPMODE</code> statement.</p>
<p>All AVR targets support the optional CPU argument <code>CODESEGSIZE</code>. Like in this example,</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>       cpu atmega8<span class="op">:</span>codesegsize<span class="op">=</span><span class="dv">0</span></span></code></pre></div>
<p>it may be used to instruct the assembler to treat the code segment (i.e. the internal flash ROM) as being organized in bytes instead of 16 bit words. This is the view when the <code>LPM</code> instruction is used, and which some other (non Atmel) assemblers use in general. It has the advantage that addresses in the <code>CODE</code> segment need not be multiplied by two if used for data accesses. On the other hand, care has to be taken that instructions do not start on an odd address - this would be the equivalent of an instruction occupying fractions of flash words. The <code>PADDING</code> option is therefore enabled by default, while it remains possible to define arrays of bytes via multiple uses of <code>DB</code> or <code>DATA</code> without the risk of padding bytes inserted in between. Target addresses for relative and absolute branches automatically get divided by two in this &quot;byte mode&quot;. The default is the organization in 16 bit word as used by the original Atmel assembler. This may explicitly be selected by using the argument <code>codesegsize=1</code>.</p>
<h2 id="z80undoc">Z80UNDOC</h2>
<p>As one might guess, Zilog did not make any syntax definitions for the undocumented instructions; furthermore, not everyone might know the full set. It might therefore make sense to list all instructions at this place:</p>
<p>Similar to a Z380, it is possible to access the byte halves of <code>IX</code> and <code>IY</code> separately. In detail, these are the instructions that allow this:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="bu">INC</span> Rx              LD R<span class="op">,</span>Rx             LD  Rx<span class="op">,</span>n</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="bu">DEC</span> Rx              LD Rx<span class="op">,</span>R             LD  Rx<span class="op">,</span>Ry</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="bu">ADD</span><span class="op">/</span>ADC<span class="op">/</span>SUB<span class="op">/</span>SBC<span class="op">/AND/XOR/OR/</span>CP A<span class="op">,</span>Rx</span></code></pre></div>
<p><code>Rx</code> and <code>Ry</code> are synonyms for <code>IXL</code>, <code>IXU</code>, <code>IYL</code> or <code>IYU</code>. Keep however in mind that in the case of <code>LD Rx,Ry</code>, both registers must be part of the same index register.</p>
<p>The coding of shift instructions leaves an undefined bit combination which is now accessible as the <code>SLIA</code> or <code>SLS</code> instruction. <code>SLIA/SLS</code> works like <code>SLA</code> with the difference of entering a 1 into bit position 0. Like all other shift instructions, <code>SLIA</code> also allows another undocumented variant:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>        SLIA    R<span class="op">,(</span>XY<span class="op">+</span>d<span class="op">)</span></span></code></pre></div>
<p>In this case, <code>R</code> is an arbitrary 8-bit register (excluding index register halves...), and <code>(XY+d)</code> is a normal indexed address. This operation has the additional effect of copying the result into the register. This also works for the <code>RES</code> and <code>SET</code> instructions:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">SET</span><span class="op">/</span>RES R<span class="op">,</span>n<span class="op">,(</span>XY<span class="op">+</span>d<span class="op">)</span></span></code></pre></div>
<p>Furthermore, two hidden I/O instructions exist:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>        <span class="bu">IN</span>      <span class="op">(</span>C<span class="op">)</span> resp<span class="op">.</span> TSTI</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">OUT</span>     <span class="op">(</span>C<span class="op">),</span><span class="dv">0</span></span></code></pre></div>
<p>Their operation should be clear.</p>
<p><strong>CAUTION!</strong> No one can guarantee that all mask revisions of the Z80 execute these instructions, and the Z80&#39;s successors will react with traps if they find one of these instructions. Use them on your own risk...</p>
<h2 id="z380">Z380</h2>
<p>As this processor was designed as a grandchild of the still most popular 8-bit microprocessor, it was a sine-qua-non design target to execute existing Z80 programs without modification (of course, they execute a bit faster, roughly by a factor of 10...). Therefore, all extended features can be enabled after a reset by setting two bits which are named XM (eXtended Mode, i.e. a 32-bit instead of a 16-bit address space) respectively LW (long word mode, i.e. 32-bit instead of 16-bit operands). One has to inform AS about their current setting with the instructions <code>EXTMODE</code> resp. <code>LWORDMODE</code>, to enable AS to check addresses and constants against the correct upper limits. The toggle between 32- and 16-bit instruction of course only influences instructions that are available in a 32-bit variant. Unfortunately, the Z380 currently offers such variants only for load and store instructions; arithmetic can only be done in 16 bits. Zilog really should do something about this, otherwise the most positive description for the Z380 would be &quot;16-bit processor with 32-bit extensions&quot;...</p>
<p>The whole thing becomes complicated by the ability to override the operand size set by LW with the instruction prefixes <code>DDIR W</code> resp. <code>DDIR LW</code>. AS will note the occurrence of such instructions and will toggle setting for the instruction following directly. By the way, one should never explicitly use other <code>DDIR</code> variants than <code>W</code> resp. <code>LW</code>, as AS will introduce them automatically when an operand is discovered that is too long. Explicit usage might puzzle AS. The automatism is so powerful that in a case like this:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>        DDIR    LW</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>        LD      BC<span class="op">,</span><span class="bn">12345678h</span></span></code></pre></div>
<p>the necessary <code>IW</code> prefix will automatically be merged into the previous instruction, resulting in</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>        DDIR    LW<span class="op">,</span>IW</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>        LD      BC<span class="op">,</span><span class="bn">12345668h</span></span></code></pre></div>
<p>The machine code that was first created for <code>DDIR LW</code> is retracted and replaced, which is signified with an <code>R</code> in the listing.</p>
<h2 id="z8-super8-and-ez8">Z8, Super8, and eZ8</h2>
<p>The CPU core contained in the Z8 microcontrollers does not contain any specific registers. Instead, a block of 16 consecutive cells of the internal address space (contains RAM and I/O registers) may be used as &#39;work registers&#39; and be addressed with 4-bit addresses. The RP registers define which memory block is used as work registers: on a classic Z8, bits 4 to 7 of RP define the &#39;offset&#39; that is added to a 4-bit work register address to get a complete 8-bit address. The Super8 core features two register pointers (<code>RP0</code> and <code>RP1</code>), which allow mapping the lower and upper half of work registers to separate places.</p>
<p>Usually, one refers to work registers as R0...R15 in assembly statements. It is however also possible to regard work registers as an efficient way to address a block of memory addresses in internal RAM.</p>
<p>The <code>ASSUME</code> statement is used to inform AS about the current value of <code>RP</code>. AS is then capable to automatically decide whether an address in internal RAM may be reached with a 4-bit or 8-bit address. This may be used to assign symbolic names to work registers:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>op1     equ     <span class="bn">040h</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>op2     equ     <span class="bn">041h</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>        srp     <span class="op">#</span><span class="bn">040h</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>        assume  <span class="dt">rp</span><span class="op">:</span><span class="bn">040h</span></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>        ld      op1<span class="op">,</span>op2         <span class="co">; equal to ld r0,r1</span></span></code></pre></div>
<p>Note that though the Super8 does not have an RP register (only RP0 and RP1), RP as argument to <code>ASSUME</code> is still allowed - it will set the assumed values of RP0 and RP1 to <code>value</code> resp. <code>value + 8</code>, as the <code>SRP</code> machine instruction does on the Super 8 core.</p>
<p>Opposed to the original Zilog assembler, it is not necessary to explicitly specify &#39;work register addressing&#39; with a prefixed exclamation mark. AS however also understands this syntax - a prefixed exclamation mark enforces 4-bit addressing, even when the address does not lie within the 16-address block defined by RP (AS will issue a warning in that case). Vice versa, a prefixed <code>&gt;</code> character enforces 8-bit addressing even when the address is within the current 16-address block.</p>
<p>The eZ8 takes this &#39;game&#39; to the next level: the internal address space now has 12 instead of 8 bits. To assure compatibility with the old Z8 core, Zilog placed the additional 4 bits in the <em>lower</em> four bits of RP. For instance, an RP value of 12h defines an address window from 210h to 21fh.</p>
<p>At the same time, the lower four bits of RP define a window of 256 addresses that can be addressed with 8-bit addresses. The mechanism to automatically select between 8- and 12-bit addresses is analogous. &#39;Long&#39; 12-bit addresses may be enforced by prefixing two <code>&gt;</code> characters.</p>
<h2 id="z8000-1">Z8000</h2>
<p>A Z8001/8003 may be operated in one of two modes:</p>
<ul>
<li><em>Non-Segmented</em>: The memory address space is limited to 64 KBytes, and all addresses are &#39;simple&#39; linear 16 bit addresses. Address registers are single 16 bit registers (Rn), and absolute addresses within instructions are one byte long.</li>
<li><em>Segmented</em>: Memory is structured into up to 128 segments of up to 64 KBytes size. Addresses consist of a 7 bit segment number and a 16 bit offset. Address registers are register pairs (RRn). Absolute addresses in instructions occupy two 16 bit words, unless the offset is smaller than 256.</li>
</ul>
<p>The operation mode (segmented or non-segmented) therefore has an influence on the generated code and is selected implicitly via the selected processor type. For instance, if the target is a Z8001 in non-segmented mode, use Z8002 as target.</p>
<p>However, similar to the 8086, there is no &#39;real&#39; support for a segmented memory model in AS. In segmented mode, the segment number is simply interpreted as the upper seven bits of a virtually linear address space. Though this is not what Zilog intended, it is the way the segment number was used on the Z8001 if the system had no MMU.</p>
<p>AS in general implements the Z8000 machine instruction syntax as it is specified by Zilog in its manuals. However, there are assemblers that support extensions or variations of the syntax. AS implements a few of them as well:</p>
<h3 id="conditions">Conditions</h3>
<p>In addition to the conditions defined by Zilog, the following alternative names are defined:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Alternate</th>
<th style="text-align: left;">Zilog</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>ZR</code></td>
<td style="text-align: left;"><code>Z</code></td>
<td style="text-align: left;"><code>Z = 1</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>CY</code></td>
<td style="text-align: left;"><code>C</code></td>
<td style="text-align: left;"><code>C = 1</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>LLE</code></td>
<td style="text-align: left;"><code>ULE</code></td>
<td style="text-align: left;"><code>(C OR Z) = 1</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>LGE</code></td>
<td style="text-align: left;"><code>UGE</code></td>
<td style="text-align: left;"><code>C = 0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>LGT</code></td>
<td style="text-align: left;"><code>UGT</code></td>
<td style="text-align: left;"><code>((C = 0) AND (Z = 0)) = 1</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>LLT</code></td>
<td style="text-align: left;"><code>ULT</code></td>
<td style="text-align: left;"><code>C = 1</code></td>
</tr>
</tbody>
</table>
<h3 id="flags">Flags</h3>
<p><code>SETFLG</code>, <code>COMFLG</code> und <code>RESFLG</code> accept the following alternate names as
arguments:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Alternate</th>
<th style="text-align: left;">Zilog</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>ZR</code></td>
<td style="text-align: left;"><code>Z</code></td>
<td style="text-align: left;">Zero Flag</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>CY</code></td>
<td style="text-align: left;"><code>C</code></td>
<td style="text-align: left;">Carry Flag</td>
</tr>
</tbody>
</table>
<h3 id="indirect-addressing">Indirect Addressing</h3>
<p>It is valid to write <code>Rn^</code> instead of <code>@Rn</code>, if the option <code>AMDSyntax=1</code> was given to the <code>CPU</code> statement. If an I/O address is addressed indirectly, this option even allows to write just <code>Rn</code>.</p>
<h3 id="direct-versus-immediate-addressing">Direct versus Immediate Addressing</h3>
<p>The Zilog syntax mandates that immediate addressing has to be done by prefixing the argument with a hash character. However, if the <code>AMDSyntax=1</code> option was given to the <code>CPU</code> statement, the type of argument (label or constant) decides whether immediate or direct addressing is to be used. Immediate addressing may be forced by prefixing the argument with a circumflex, i.e. to load the address of a label into a register.</p>
<h2 id="tlcs-900l">TLCS-900(L)</h2>
<p>These processors may run in two operating modes: on the one hand, in minimum mode, which offers almost complete source code compatibility to the Z80 and TLCS-90, and on the other hand in maximum mode, which is necessary to make full use of the processor&#39;s capabilities. The main differences between these two modes are:</p>
<ul>
<li>width of the registers WA, BC, DE, and HL: 16 or 32 bits;</li>
<li>number of register banks: 8 or 4;</li>
<li>code address space: 64 Kbytes or 16 Mbytes;</li>
<li>length of return addresses: 16 or 32 bits.</li>
</ul>
<p>To allow AS to check against the correct limits, one has to inform him about the current execution mode via the <code>MAXMODE</code> instruction (see there). The default is the minimum mode.</p>
<p>From this follows that, depending on the operating mode, the 16-bit resp. 32-bit versions of the bank registers have to be used for addressing, i.e. WA, BC, DE and HL for the minimum mode resp. XWA, XBC, XDE and XHL for the maximum mode. The registers XIX...XIZ and XSP are <strong>always</strong> 32 bits wide and therefore always have to to be used in this form for addressing; in this detail, existing Z80 code definitely has to be adapted (not including that there is no I/O space and all I/O registers are memory-mapped...).</p>
<p>Absolute addresses and displacements may be coded in different lengths. Without an explicit specification, AS will always use the shortest possible coding. This includes eliminating a zero displacement, i.e. <code>(XIX+0)</code> becomes <code>(XIX)</code>. If a certain length is needed, it may be forced by appending a suffix (:8, :16, :24) to the displacement resp. the address.</p>
<p>The syntax chosen by Toshiba is a bit unfortunate in the respect of choosing an single quote (<code>&#39;</code>) to reference the previous register bank. The processor independent parts of AS already use this character to mark character constants. In an instruction like</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>        ld      wa<span class="st">&#39;,wa   ,</span></span></code></pre></div>
<p>AS will not recognize the comma for parameter separation. This problem can be circumvented by usage of an inverse single quote (&#39;), for example</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>        ld      wa<span class="op">`,</span>wa</span></code></pre></div>
<p>Toshiba delivers an own assembler for the TLCS-900 series (TAS900), which is different from AS in the following points:</p>
<h4 id="symbol-conventions-1">Symbol Conventions</h4>
<ul>
<li>TAS900 differentiates symbol names only on the first 32 characters. In contrast, AS always stores symbol names with the full length (up to 255 characters) and uses them all for differentiation.</li>
<li>TAS900 allows to write integer constants either in Intel or C notation (with a 0 prefix for octal or a 0x prefix for hexadecimal constants). By default, AS only supports the Intel notation. With the help of the <code>RELAXED</code> instruction, one also gets the C notation among others.</li>
<li>AS does not distinguish between upper and lower case. In contrast, TAS900 differentiates between upper- and lowercase letters in symbol names. One needs to engage the <code>-u</code> command line option to force AS to do this.</li>
</ul>
<h4 id="syntax">Syntax</h4>
<p>For many instructions, the syntax checking of AS is less strict than the checking of TAS900. In some (rare) cases, the syntax is slightly different. These extensions and changes are on the one hand for the sake of a better portability of existing Z80 codes, on the other hand they provide a simplification and better orthogonality of the assembly syntax:</p>
<ul>
<li>In the case of <code>LDA</code>, <code>JP</code>, and <code>CALL</code>, TAS requires that address expressions like <code>XIX+5</code> must not be placed in parentheses, as it is usually the case. For the sake of better orthogonality, AS requires parentheses for <code>LDA</code>. They are optional if <code>JP</code> resp. <code>CALL</code> are used with a simple, absolute address.</li>
<li>In the case of <code>JP</code>, <code>CALL</code>, <code>JR</code>, and <code>SCC</code>, AS leaves the choice to the programmer whether to explicitly write out the default condition <code>T</code> (= true) as first parameter or not. TAS900 in contrast only allows to use the default condition implicitly (e.g. <code>jp (xix+5)</code> instead of <code>jp t,(xix+5)</code>).</li>
<li>For the <code>EX</code> instruction, AS allows operand combinations which are not listed in <a href="#fn35" class="footnote-ref" id="fnref35" role="doc-noteref"><sup>35</sup></a> but can be reduced to a standard combination by swapping the operands. Combinations like <code>EX f&#39;,f</code> or <code>EX wa,(xhl)</code> become possible. In contrast, TAS900 limits to the &#39;pure&#39; combinations.</li>
<li>AS allows to omit an increment resp. decrement of <code>1</code> when using the instructions <code>INC</code> and <code>DEC</code>. TAS900 instead forces the programmer to explicit usage of <code>1</code>.</li>
<li>The similar is true for the shift instructions: If the operand is a register, TAS900 requires that even a shift count of 1 has to be written explicitly; however, when the operand is in memory, the hardware limits the shift count to 1 which must not be written in this case. With AS, a shift count of 1 is always optional and valid for all types of operands.</li>
</ul>
<h4 id="macro-processor">Macro Processor</h4>
<p>The macro processor of TAS900 is an external program that operates like a preprocessor. It consists of two components: The first one is a C-like preprocessor, and the second one is a special macro language (MPL) that reminds of high level languages. The macro processor of AS instead is oriented towards &quot;classic&quot; macro assemblers like MASM or M80 (both programs from Microsoft). It is a fixed component of AS.</p>
<h4 id="output-format">Output Format</h4>
<p>TAS900 generates relocatable code that allows to link separately compiled programs to a single application. AS instead generates absolute machine code that is not linkable. There are currently no plans to extend AS in this respect.</p>
<h4 id="pseudo-instructions-1">Pseudo Instructions</h4>
<p>Due to the missing linker, AS lacks a couple of pseudo instructions needed for relocatable code TAS900 implements. The following instructions are available with equal meaning:</p>
<blockquote>
<p><code>EQU</code>, <code>DB</code>, <code>DW</code>, <code>ORG</code>, <code>ALIGN</code>, <code>END</code>, <code>TITLE</code>, <code>SAVE</code>, <code>RESTORE</code></p>
</blockquote>
<p>The latter two have an extended functionality for AS. Some TAS900 pseudo instructions can be replaced with equivalent AS instructions (see table <a href="#table-equivalent-instructions-tas900-to-as">equivalent instructions TAS900 to AS</a>).</p>
<h5 id="table-equivalent-instructions-tas900-to-as"><strong>Table:</strong> equivalent instructions TAS900 to AS</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">TAS900</th>
<th style="text-align: left;">AS</th>
<th style="text-align: left;">meaning/function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>DL &lt;Data&gt;</code></td>
<td style="text-align: left;"><code>DD &lt;Data&gt;</code></td>
<td style="text-align: left;">define long word constants</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>DSB &lt;number&gt;</code></td>
<td style="text-align: left;"><code>DB &lt;number&gt; DUP (?)</code></td>
<td style="text-align: left;">reserve bytes of memory</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>DSW &lt;number&gt;</code></td>
<td style="text-align: left;"><code>DW &lt;number&gt; DUP (?)</code></td>
<td style="text-align: left;">reserve words of memory</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>DSD &lt;number&gt;</code></td>
<td style="text-align: left;"><code>DD &lt;number&gt; DUP (?)</code></td>
<td style="text-align: left;">reserve long words of memory</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>$MIN[IMUM]</code></td>
<td style="text-align: left;"><code>MAXMODE OFF</code></td>
<td style="text-align: left;">following code runs in minimum mode</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>$MAX[IMUM]</code></td>
<td style="text-align: left;"><code>MAXMODE ON</code></td>
<td style="text-align: left;">following code runs in maximum mode</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>$SYS[TEM]</code></td>
<td style="text-align: left;"><code>SUPMODE ON</code></td>
<td style="text-align: left;">following code runs in system mode</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>$NOR[MAL]</code></td>
<td style="text-align: left;"><code>SUPMODE OFF</code></td>
<td style="text-align: left;">following code runs in user mode</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>$NOLIST</code></td>
<td style="text-align: left;"><code>LISTING OFF</code></td>
<td style="text-align: left;">turn off assembly listing</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>$LIST</code></td>
<td style="text-align: left;"><code>LISTING ON</code></td>
<td style="text-align: left;">turn on assembly listing</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>$EJECT</code></td>
<td style="text-align: left;"><code>NEWPAGE</code></td>
<td style="text-align: left;">start new page in listing</td>
</tr>
</tbody>
</table>
<p>Toshiba manufactures two versions of the processor core, with the L version being an &quot;economy version&quot;. AS will make the following differences between TLCS-900 and TLCS-900L:</p>
<ul>
<li>The instructions <code>MAX</code> and <code>NORMAL</code> are not allowed for the L version; the <code>MIN</code> instruction is disabled for the full version.</li>
<li>The L version does not know the normal stack pointer <code>XNSP</code>/<code>NSP</code>, but instead has the interrupt nesting register <code>INTNEST</code>.</li>
</ul>
<p>The instructions <code>SUPMODE</code> and <code>MAXMODE</code> are not influenced, just as their initial setting <code>OFF</code>. The programmer has to take care of the fact that the L version starts in maximum mode and does not have a normal mode. However, AS shows a bit of mercy against the L variant by suppressing warnings for privileged instructions.</p>
<h2 id="tlcs-90">TLCS-90</h2>
<p>Maybe some people might ask themselves if I mixed up the order a little bit, as Toshiba first released the TLCS-90 as an extended Z80 and afterwards the 16-bit version TLCS-900. Well, I discovered the &#39;90 via the &#39;900 (thank you Oliver!). The two families are quite similar, not only regarding their syntax but also in their architecture. The hints for the &#39;90 are therefore a subset of of the chapter for the &#39;900: As the &#39;90 only allows shifts, increments, and decrements by one, the count need not and must not be written as the first argument. Once again, Toshiba wants to omit parentheses for memory operands of <code>LDA</code>, <code>JP</code>, and <code>CALL</code>, and once again AS requires them for the sake of orthogonality (the exact reason is of course that this way, I saved an extra in the address parser, but one does not say such a thing aloud).</p>
<p>Principally, the TLCS-90 series already has an address space of 1 Mbyte which is however only accessible as data space via the index registers. AS therefore does not regard the bank registers and limits the address space to 64 Kbytes. This should not limit too much as this area above is anyway only reachable via indirect addressing.</p>
<h2 id="tlcs-870">TLCS-870</h2>
<p>Once again Toshiba...a company quite productive at the moment! Especially this branch of the family (all Toshiba microcontrollers are quite similar in their binary coding and programming model) seems to be targeted towards the 8051 market: the method of separating the bit position from the address expression with a dot had its root in the 8051. However, it creates now exactly the sort of problems I anticipated when working on the 8051 part: On the one hand, the dot is a legal part of symbol names, but on the other hand, it is part of the address syntax. This means that AS has to separate address and bit position and must process them independently. Currently, I solved this conflict by seeking the dot starting at the <strong>end</strong> of the expression. This way, the last dot is regarded as the separator, and further dots stay parts of the address. I continue to urge everyone to omit dots in symbol names, they will lead to ambiguities:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>        LD      CF<span class="op">,</span>A<span class="op">.</span><span class="dv">7</span>  <span class="co">; accumulator bit 7 to carry</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>        LD      C<span class="op">,</span>A<span class="op">.</span><span class="dv">7</span>   <span class="co">; constant &#39;A.7&#39; to accumulator</span></span></code></pre></div>
<h2 id="tlcs-47-1">TLCS-47</h2>
<p>This family of 4-bit microcontrollers should mark the low end of what is supportable by AS. Apart from the <code>ASSUME</code> instruction for the data bank register (see there), there is only one thing that is worth mentioning: In the data and I/O segment, nibbles are reserved instead of byte (it&#39;s a 4-bitter...). The situation is similar to the bit data segment of the 8051, where a <code>DB</code> reserves a single bit, with the difference that we are dealing with nibbles.</p>
<p>Toshiba defined an &quot;extended instruction set&quot; for this processor family to facilitate the work with their limited instruction set. In the case of AS, it is defined in the include file <code>STDDEF47.INC</code>. However, some instructions that could not be realized as macros are &quot;built-ins&quot; and are therefore also available without the include file:</p>
<ul>
<li>the <code>B</code> instruction that automatically chooses the optimal version of the jump instruction (<code>BSS; BS</code>, or <code>BSL</code>);</li>
<li><code>LD</code> in the variant of <code>HL</code> with an immediate operand;</li>
<li><code>ROLC</code> and <code>RORC</code> with a shift amplitude higher than one.</li>
</ul>
<h2 id="tlcs-9000">TLCS-9000</h2>
<p>This was the first time that I implemented a processor for AS which was not yet available at that point of time. And unfortunately, I received back then information that Toshiba had decided no to market this processor at all. This of course had the result that the TLCS-9000 part of the assembler</p>
<ol type="1">
<li>was a &quot;paper design&quot;, i.e. there was so far no chance to test it on real hardware and</li>
<li>the documentation for the &#39;9000 I could get hold <a href="#fn36" class="footnote-ref" id="fnref36" role="doc-noteref"><sup>36</sup></a> of was preliminary and was unclear in a couple of detail issues.</li>
</ol>
<p>So in effect, this target went into &#39;dormant mode&#39;...</p>
<p>...Fast forward 20: all of a sudden, people are contacting me and tell me that Toshiba actually did sell TLCS-9000 chips to customers, and they ask for documentation to do reverse engineering. Maybe this will shed some light on the remaining uncertainties. Nevertheless, errors in this code generator are quite possible (and will of course be fixed!). At least the few examples listed in <a href="#fn37" class="footnote-ref" id="fnref37" role="doc-noteref"><sup>37</sup></a> are assembled correctly.</p>
<p>Displacements included in machine instructions may only have a certain maximum length (e.g. 9 or 13 bits). In case the displacement is longer, a prefix containing the &#39;upper bits&#39; must be prepended to the instruction. AS will automatically insert such prefixes when necessary, however it is also possible to force usage of a prefix by adding a leading <code>&gt;</code>. An example for this:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ld:</span>g<span class="op">.</span>b  <span class="op">(</span><span class="bn">0h</span><span class="op">),</span><span class="dv">0</span>       <span class="co">; no prefix</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ld:</span>g<span class="op">.</span>b  <span class="op">(</span><span class="bn">400000h</span><span class="op">),</span><span class="dv">0</span>  <span class="co">; prefix added automatically</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ld:</span>g<span class="op">.</span>b  <span class="op">(&gt;</span><span class="bn">0h</span><span class="op">),</span><span class="dv">0</span>      <span class="co">; forced prefix</span></span></code></pre></div>
<h2 id="tc9331">TC9331</h2>
<p>Toshiba supplied a (DOS-based) assembler for this processor which was named ASM31T. This assembler supports a number of syntax elements which could not be mapped on the capabilities of AS without risking incompatibilities for existing source files for other targets. The following issues might require changes on programs written for ASM31T:</p>
<ul>
<li>ASM31T supports C-like comments (<code>/* ... */</code>) which may also span multiple lines. Such comments are not supported by AS and have to be replaced by comments beginning with a semicolon.</li>
<li>Similar to ASM31T, AS supports comments with round parentheses (<code>( ... )</code>), however only within a single command argument. Should such a comment contain a comma, this comma will be treated like an argument separator and the comment will not be skipped when parsing the arguments.</li>
<li>ASM31T allows symbol and label names containing a dash. AS does not allow this, because the dash is regarded to be the subtraction operator. It would be unclear whether an expression like <code>end-start</code> represents a single symbol or the difference of two symbols.</li>
<li>ASM31T requires an <code>END</code> statement as the last statement of the program; this is optional for AS.</li>
</ul>
<p>Furthermore, AS currently lacks the capabilities to detect conflicting uses of functional units in a machine instructions. Toshiba&#39;s documentation is a bit difficult to understand in this respect...</p>
<h2 id="29xxx">29xxx</h2>
<p>As it was already described in the discussion of the <code>ASSUME</code> instruction, AS can use the information about the current setting of the RBP register to detect accesses to privileged registers in user mode. This ability is of course limited to direct accesses (i.e. without using the registers IPA...IPC), and there is one more pitfall: as local registers (registers with a number <code>&gt; 127</code>) are addressed relative to the stack pointer, but the bits in RBP always refer to absolute numbers, the check is NOT done for local registers. An extension would require AS to know always the absolute value of SP, which would at least fail for recursive subroutines...</p>
<h2 id="80c16x">80C16x</h2>
<p>As it was already explained in the discussion of the <code>ASSUME</code> instruction, AS tries to hide the fact that the processor has more physical than logical RAM as far as possible. Please keep in mind that the DPP registers are valid only for data accesses and only have an influence on absolute addressing, neither on indirect nor on indexed addresses. AS cannot know which value the computed address may take at runtime... The paging unit unfortunately does not operate for code accesses so one has to work with explicit long or short <code>CALL</code>s, <code>JMP</code>s, or <code>RET</code>s. At least for the &quot;universal&quot; instructions <code>CALL</code> and <code>JMP</code>, AS will automatically use the shortest variant, but at least for the RET one should know where the call came from. <code>JMPS</code> and <code>CALLS</code> principally require to write segment and address separately, but AS is written in a way that it can split an address on its own, e.g. one can write</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>        jmps    <span class="bn">12345h</span></span></code></pre></div>
<p>instead of</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>        jmps    <span class="dv">1</span><span class="op">,</span><span class="bn">2345h</span></span></code></pre></div>
<p>Unfortunately, not all details of the chip&#39;s internal instruction pipeline are hidden: if CP (register bank address), SP (stack), or one of the paging registers are modified, their value is not available for the instruction immediately following. AS tries to detect such situations and will issue a warning in such cases. Once again, this mechanism only works for direct accesses.</p>
<p>Bits defined with the <code>BIT</code> instruction are internally stored as a 12-bit word, containing the address in bits 4...11 and the bit position in the four LSBs. This order allows to refer the next resp. previous bit by incrementing or decrementing the address. This will however not work for explicit bit specifications when a word boundary is crossed. For example, the following expression will result in a range check error:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>        bclr    r5<span class="op">.</span><span class="dv">15</span><span class="op">+</span><span class="dv">1</span></span></code></pre></div>
<p>We need a <code>BIT</code> in this situation:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>msb     bit     r5<span class="op">.</span><span class="dv">15</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>        bclr    msb<span class="op">+</span><span class="dv">1</span></span></code></pre></div>
<p>The SFR area was doubled for the 80C167/165/163: bit 12 flags that a bit lies in the second part. Siemens unfortunately did not foresee that 256 SFRs (128 of them bit addressable) would not suffice for successors of the 80C166. As a result, it would be impossible to reach the second SFR area from F000H...F1DFH with short addresses or bit instructions if the developers had not included a toggle instruction:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>        EXTR    <span class="op">#</span>n</span></code></pre></div>
<p>This instruction has the effect that for the next <code>n</code> instructions (<code>0 &lt; n &lt; 5</code>), it is possible to address the alternate SFR space instead of the normal one. AS does not only generate the appropriate machine code when it encounters this instruction. It also sets an internal flag that will only allow accesses to the alternate SFR space for the next <code>n</code> instructions. Of course, they may not contain jumps... Of course, it is always possible to define bits from either area at any place, and it is always possible to reach all registers with absolute addresses. In contrast, short and bit addressing only works for one area at a time, attempts contradicting to this will result in an error message.</p>
<p>The situation is similar for prefix instructions and absolute resp. indirect addressing: as the prefix argument and the address expression cannot always be evaluated at assembly time, chances for checking are limited and AS will limit itself to warnings...in detail, the situation is as follows:</p>
<ul>
<li>fixed specification of a 64K bank with <code>EXTS</code> or <code>EXTSR</code>: the address expression directly contains the lower 16 bits of the target address. If the prefix and the following instruction have a constant operand, AS will check if the the prefix argument and bits 16...23 of the target address are equal.</li>
<li>fixed specification of a 16K page with <code>EXTP</code> or <code>EXTPR</code>: the address expression directly contains the lower 14 bits of the target address. Bits 14 and 15 are fixed to 0, as the processor ignores them in this mode. If the prefix and the following instruction have a constant operand, AS will check if the the prefix argument and bits 14...23 of the target address are equal.</li>
</ul>
<p>An example to clarify things a bit (the DPP registers have their reset values):</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>        extp    <span class="op">#</span><span class="dv">7</span><span class="op">,#</span><span class="dv">1</span>      <span class="co">; range from 112K...128K</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span>     r0<span class="op">,</span><span class="bn">1cdefh</span>  <span class="co">; results in address 0defh in code</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span>     r0<span class="op">,</span><span class="bn">1cdefh</span>  <span class="co">; --&gt;warning</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>        exts    <span class="op">#</span><span class="dv">1</span><span class="op">,#</span><span class="dv">1</span>      <span class="co">; range from 64K...128K</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span>     r0<span class="op">,</span><span class="bn">1cdefh</span>  <span class="co">; results in address 0cdefh in code</span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mov</span>     r0<span class="op">,</span><span class="bn">1cdefh</span>  <span class="co">; --&gt;warning</span></span></code></pre></div>
<h2 id="pic16c5x16c8x">PIC16C5x/16C8x</h2>
<p>Similar to the MCS-48 family, the PICs split their program memory into several banks because the opcode does not offer enough space for a complete address. AS uses the same automatism for the instructions <code>CALL</code> and <code>GOTO</code>, i.e. the PA bits in the status word are set according to the start and target address. However, this procedure is far more problematic compared to the 48&#39;s:</p>
<ol type="1">
<li>The instructions are not any more one word long (up to three words). Therefore, it is not guaranteed that they can be skipped with a conditional branch.</li>
<li>It is possible that the program counter crosses a page boundary while the program sequence is executed. The setting of PA bits AS assumes may be different from reality.</li>
</ol>
<p>The instructions that operate on register W and another register normally require a second parameter that specifies whether the result shall be stored in W or the register. Under AS, it is valid to omit the second parameter. The assumed target then depends upon the operation&#39;s type: For unary operations, the result is by default stored back into the register. These instructions are:</p>
<blockquote>
<p><code>COMF</code>, <code>DECF</code>, <code>DECFSZ</code>, <code>INCF</code>, <code>INCFSZ</code>, <code>RLF</code>, <code>RRF</code>, and <code>SWAPF</code></p>
</blockquote>
<p>The other operations by default regard W as an accumulator:</p>
<blockquote>
<p><code>ADDWF</code>, <code>ANDWF</code>, <code>IORWF</code>, <code>MOVF</code>, <code>SUBWF</code>, and <code>XORWF</code></p>
</blockquote>
<p>The syntax defined by Microchip to write literals is quite obscure and reminds of the syntax used on IBM 360/370 systems (greetings from the stone-age...). To avoid introducing another branch into the parser, with AS one has to write constants in the Motorola syntax (optionally Intel or C in <code>RELAXED</code> mode).</p>
<h2 id="pic-17c4x">PIC 17C4x</h2>
<p>With two exceptions, the same hints are valid as for its two smaller brothers: the corresponding include file only contains register definitions, and the problems concerning jump instructions are much smaller. The only exception is the <code>LCALL</code> instruction, which allows a jump with a 16-bit address. It is translated with the following &quot;macro&quot;:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>        MOVLW   <span class="op">&lt;</span>addr15<span class="op">...</span><span class="dv">8</span><span class="op">&gt;</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>        MOWF    <span class="dv">3</span></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>        LCALL   <span class="op">&lt;</span>addr0<span class="op">...</span><span class="dv">7</span><span class="op">&gt;</span></span></code></pre></div>
<h2 id="sx2028">SX20/28</h2>
<p>The limited length of the instruction word does not permit specifying a complete program memory address (11 bits) or data memory address (8 bits). The CPU core augments the truncated address from the instruction word with the PA bits from the STATUS registers, respectively with the upper bits of the FSR register. It is possible to inform the assembler via <code>ASSUME</code> instructions about the contents of these two registers. In case that addresses are used that are inaccessible with th current values, a warning is issued.</p>
<h2 id="st6-1">ST6</h2>
<p>These processors have the ability to map their code ROM page-wise into the data area. I am not keen on repeating the whole discussion of the <code>ASSUME</code> instruction at this place, so I refer to the corresponding section (<a href="#st6">ST6</a>) for an explanation how to read constants out of the code ROM without too much headache.</p>
<p>Some builtin &quot;macros&quot; show up when one analyzes the instruction set a bit more in detail. The instructions I found are listed in table <a href="#table-hidden-macros-in-the-st62s-instruction-set">Hidden Macros in the ST62&#39;s Instruction Set</a> (there are probably even more...):</p>
<h5 id="table-hidden-macros-in-the-st62s-instruction-set"><strong>Table:</strong> Hidden Macros in the ST62&#39;s Instruction Set</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">instruction</th>
<th style="text-align: left;">in reality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>CLR A</code></td>
<td style="text-align: left;"><code>SUB A,A</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>SLA A</code></td>
<td style="text-align: left;"><code>ADD A,A</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>CLR addr</code></td>
<td style="text-align: left;"><code>LDI addr,0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>NOP</code></td>
<td style="text-align: left;"><code>JRZ PC+1</code></td>
</tr>
</tbody>
</table>
<p>Especially the last case is a bit astonishing... unfortunately, some instructions are really missing. For example, there is an <code>AND</code> instruction but no <code>OR</code>...not to speak of an <code>XOR</code>. For this reason, the include file <code>STDDEF62.INC</code> contains also some helping macros (additionally to register definitions).</p>
<p>The original assembler AST6 delivered by SGS-Thomson partially uses different pseudo instructions than AS. Apart from the fact that AS does not mark pseudo instructions with a leading dot, the following instructions are identical:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>ASCII<span class="op">,</span> ASCIZ<span class="op">,</span> BLOCK<span class="op">,</span> <span class="dt">BYTE</span><span class="op">,</span> END<span class="op">,</span> ENDM<span class="op">,</span> EQU<span class="op">,</span> ERROR<span class="op">,</span> MACRO<span class="op">,</span> ORG<span class="op">,</span> TITLE<span class="op">,</span> WARNING</span></code></pre></div>
<p>Table <a href="#table-equivalent-instructions-ast6--as">Equivalent Instructions AST6 ↔︎ AS</a> shows the instructions which have AS counterparts with similar function.</p>
<h5 id="table-equivalent-instructions-ast6--as"><strong>Table:</strong> Equivalent Instructions AST6 ↔︎ AS</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">AST6</th>
<th style="text-align: left;">AS</th>
<th style="text-align: left;">meaning/function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>.DISPLAY</code></td>
<td style="text-align: left;"><code>MESSAGE</code></td>
<td style="text-align: left;">output message</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>.EJECT</code></td>
<td style="text-align: left;"><code>NEWPAGE</code></td>
<td style="text-align: left;">new page in assembly listing</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>.ELSE</code></td>
<td style="text-align: left;"><code>ELSEIF</code></td>
<td style="text-align: left;">conditional assembly</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>.ENDC</code></td>
<td style="text-align: left;"><code>ENDIF</code></td>
<td style="text-align: left;">conditional assembly</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>.IFC</code></td>
<td style="text-align: left;"><code>IF...</code></td>
<td style="text-align: left;">conditional assembly</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>.INPUT</code></td>
<td style="text-align: left;"><code>INCLUDE</code></td>
<td style="text-align: left;">insert include file</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>.LIST</code></td>
<td style="text-align: left;"><code>LISTING, MACEXP_DFT</code></td>
<td style="text-align: left;">settings for listing</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>.PL</code></td>
<td style="text-align: left;"><code>PAGE</code></td>
<td style="text-align: left;">page length of listing</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>.ROMSIZE</code></td>
<td style="text-align: left;"><code>CPU</code></td>
<td style="text-align: left;">set target processor</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>.VERS</code></td>
<td style="text-align: left;"><code>VERSION</code> (symbol)</td>
<td style="text-align: left;">query version</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>.SET</code></td>
<td style="text-align: left;"><code>EVAL</code></td>
<td style="text-align: left;">redefine variables</td>
</tr>
</tbody>
</table>
<h2 id="st7">ST7</h2>
<p>In <a href="#fn38" class="footnote-ref" id="fnref38" role="doc-noteref"><sup>38</sup></a>, the <code>.w</code> postfix to signify 16-bit addresses is only defined for memory indirect operands. It is used to mark that a 16-bit address is stored at a zero page address. AS additionally allows this postfix for absolute addresses or displacements of indirect address expressions to force 16-bit displacements in spite of an 8-bit value (0...255).</p>
<h2 id="st9-1">ST9</h2>
<p>The ST9&#39;s bit addressing capabilities are quite limited: except for the <code>BTSET</code> instruction, only bits within the current set of working registers are accessible. A bit address is therefore of the following style:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>        rn<span class="op">.[!]</span>b</span></code></pre></div>
<p>whereby <code>!</code> means an optional complement of a source operand. If a bit is defined symbolically, the bit&#39;s register number is stored in bits 7...4, the bit&#39;s position is stored in bits 3...1 and the optional complement is kept in bit 0. AS distinguishes explicit and symbolic bit addresses by the missing dot. A bit&#39;s symbolic name therefore must not contain a dot, thought it would be legal in respect to the general symbol name conventions. It is also valid to invert a symbolically referred bit:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>bit2    bit     r5<span class="op">.</span><span class="dv">3</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>        bld     r0<span class="op">.</span><span class="dv">0</span><span class="op">,!</span>bit2</span></code></pre></div>
<p>This opportunity also allows to undo an inversion that was done at definition of the symbol.</p>
<p>The include file <code>REGST9.INC</code> defines the symbolic names of all on-chip registers and their associated bits. Keep however in mind that the bit definitions only work after previously setting the working register bank to the address of these peripheral registers!</p>
<p>In contrast to the definition file delivered with the AST9 assembler from SGS-Thomson, the names of peripheral register names are only defined as general registers (<code>R...</code>), not also as working registers (<code>r...</code>). The reason for this is that AS does not support register aliases; a tribute to assembly speed.</p>
<h2 id="6804">6804</h2>
<p>To be honest: I only implemented this processor in AS to quarrel about SGS-Thomson&#39;s peculiar behaviour. When I first read the 6804&#39;s data book, the &quot;incomplete&quot; instruction set and the built-in macros immediately reminded me of the ST62 series manufactured by the same company. A more thorough comparison of the opcodes gave surprising insights: A 6804 opcode can be generated by taking the equivalent ST62 opcode and mirroring all the bits! So Thomson obviously did a bit of processor core recycling...which would be all right if they would not try to hide this: different peripherals, motorola instead of Zilog-style syntax, and the awful detail of <strong>not</strong> mirroring operand fields in the opcode (e.g. bit fields containing displacements). The last item is also the reason that finally convinced me to support the 6804 in AS. I personally can only guess which department at Thomson did the copy...</p>
<p>In contrast to its ST62 counterpart, the include file for the 6804 does not contain instruction macros that help a bit to deal with the limited machine instruction set. This is left as an exercise to the reader!</p>
<h2 id="tms3201x">TMS3201x</h2>
<p>It seems that every semiconductor&#39;s ambition is to invent an own notation for hexadecimal numbers. Texas Instrument took an especially eccentric approach for these processors: a &gt; sign as prefix! The support of such a format in AS would have lead to extreme conflicts with AS&#39;s compare and shift operators. I therefore decided to use the Intel notation, which is what TI also uses for the 340x0 series and the 3201x&#39;s successors...</p>
<p>The instruction word of these processors unfortunately does not have enough bits to store all 8 bits for direct addressing. This is why the data address space is split into two banks of 128 words. AS principally regards the data address space as a linear segment of 256 words and automatically clears bit 7 on direct accesses (an exception is the <code>SST</code> instruction that can only write to the upper bank). The programmer has to take care that the bank flag always has the correct value!</p>
<p>Another hint that is well hidden in the data book: The <code>SUBC</code> instruction internally needs more than one clock for completion, but the control unit already continues to execute the next instruction. An instruction following <code>SUBC</code> therefore may not access the accumulator. AS does not check for such conditions!</p>
<h2 id="tms320c2x">TMS320C2x</h2>
<p>As I did not write this code generator myself (that does not lower its quality by any standard), I can only roughly line out why there are some instructions that force a prefixed label to be untyped, i.e. not assigned to any specific address space: The 2x series of TMS signal processors has a code and a data segment which are both 64 Kbytes large. Depending on external circuitry, code and data space may overlap, e.g. to allow storage of constants in the code area and access them as data. Data storage in the code segment may be necessary because older versions of AS assume that the data segment only consists of RAM that cannot have a defined power-on state in a single board system. They therefore reject storage of contents in other segments than <code>CODE</code>. Without the feature of making symbols untyped, AS would punish every access to a constant in code space with a warning (&quot;symbol out of wrong segment&quot;). To say it in detail, the following instructions make labels untyped:</p>
<blockquote>
<p><code>BSS</code>, <code>STRING</code>, <code>RSTRING</code>, <code>BYTE</code>, <code>WORD</code>, <code>LONG</code>, <code>FLOAT</code>, <code>DOUBLE</code>, <code>EFLOAT</code>, <code>BFLOAT</code> and <code>TFLOAT</code></p>
</blockquote>
<p>If one needs a typed label in front of one of these instructions, one can work around this by placing the label in a separate line just before the pseudo instruction itself. On the other hand, it is possible to place an untyped label in front of another pseudo instruction by defining the label with <code>EQU</code>, e.g.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>&lt;name<span class="op">&gt;</span>  EQU     <span class="op">$</span></span></code></pre></div>
<h2 id="tms320c3xc4x">TMS320C3x/C4x</h2>
<p>The syntax detail that created the biggest amount of headache for me while implementing this processor family is the splitting of parallel instructions into two separate source code lines. Fortunately, both instructions of such a construct are also valid single instructions. AS therefore first generates the code for the first instruction and replaces it by the parallel machine code when a parallel construct is encountered in the second line. This operation can be noticed in the assembly listing by the machine code address that does not advance and the double dot replaced with a <code>R</code>.</p>
<p>Compared to the TI assembler, AS is not as flexible regarding the position of the double lines that signify a parallel operation (<code>||</code>): One either has to place them like a label (starting in the first column) or to prepend them to the second mnemonic. The line parser of AS will run into trouble if you do something else...</p>
<h2 id="tms9900">TMS9900</h2>
<p>Similar to most older TI microprocessor families, TI used an own format for hexadecimal and binary constants. AS instead favours the Intel syntax which is also common for newer processor designs from TI.</p>
<p>The TI syntax for registers allows to use a simple integer number between 0 and 15 instead of a real name (<code>Rx</code> or <code>WRx</code>). This has two consequences:</p>
<ul>
<li><code>R0...R15</code> resp. <code>WR0...WR15</code> are simple predefined integer symbols with values from 0 to 15, and the definition of register aliases is a simple matter of <code>EQU</code>.</li>
<li>In contrast to several other processors, I cannot offer the additional AS feature that allows to omit the character signifying absolute addressing (a sign in this case). As a missing character would mean register numbers (from 0 to 15) in this case, it was not possible to offer the optional omission.</li>
</ul>
<p>Furthermore, TI sometimes uses <code>Rx</code> to name registers and <code>WRx</code> at other places...currently both variants are recognized by AS.</p>
<h2 id="tms70cxx">TMS70Cxx</h2>
<p>This processor family belongs to the older families developed by TI and therefore TI&#39;s assemblers use their proprietary syntax for hexadecimal resp. binary constants (a prefixed <code>&lt;</code> resp. <code>?</code> character). As this format could not be realized for AS, the Intel syntax is used by default. This is the format TI to which also switched over when introducing the successors, of this family, the 370 series of microcontrollers. Upon a closer inspection of both&#39;s machine instruction set, one discovers that about 80% of all instruction are binary upward compatible, and that also the assembly syntax is almost identical - but unfortunately only almost. TI also took the chance to make the syntax more orthogonal and simple. I tried to introduce the majority of these changes also into the 7000&#39;s instruction set:</p>
<ul>
<li>It is valid to use the more common <code>#</code> sign for immediate addressing instead of the percent sign.</li>
<li>If a port address (<code>P...</code>) is used as source or destination in a <code>AND</code>, <code>BTJO</code>, <code>BTJZ</code>, <code>MOV</code>, <code>OR</code>, or <code>XOR</code> instruction, it is not necessary to use the mnemonic variant with an appended <code>P</code> - the general form is sufficient.</li>
<li>The prefixed <code>@</code> sign for absolute or B-relative addressing may be omitted.</li>
<li>Instead of <code>CMPA, CMP</code> with <code>A</code> as target may be written.</li>
<li>Instead of <code>LDA</code> resp. <code>STA</code>, one can simply use the <code>MOV</code> instruction with <code>A</code> as source resp. destination.</li>
<li>One can write <code>MOVW</code> instead of <code>MOVD</code>.</li>
<li>It is valid to abbreviate <code>RETS</code> resp. <code>RETI</code> as <code>RTS</code> resp. <code>RTI</code>.</li>
<li><code>TSTA</code> resp. <code>TSTB</code> may be written as <code>TST A</code> resp. <code>TST B</code>.</li>
<li><code>XCHB B</code> is an alias for <code>TSTB</code>.</li>
</ul>
<p>An important note: these variants are only allowed for the TMS70Cxx - the corresponding 7000 variants are not allowed for the 370 series!</p>
<h2 id="tms370xxx">TMS370xxx</h2>
<p>Though these processors do not have specialized instructions for bit manipulation, the assembler creates (with the help of the <code>DBIT</code> instruction - see there) the illusion as if single bits were addressable. To achieve this, the <code>DBIT</code> instructions stores an address along with a bit position into an integer symbol which may then be used as an argument to the pseudo instructions <code>SBIT0, SBIT1, CMPBIT, JBIT0</code>, and <code>JBIT1</code>. These are translated into the instructions <code>OR, AND, XOR, BTJZ</code>, and <code>BTJO</code> with an appropriate bit mask.</p>
<p>There is nothing magic about these bit symbols, they are simple integer values that contain the address in their lower and the bit position in their upper half. One could construct bit symbols without the <code>DBIT</code> instruction, like this:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>defbit  macro   name<span class="op">,</span>bit<span class="op">,</span>addr</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>name    equ     addr<span class="op">+(</span>bit<span class="op">&lt;&lt;</span><span class="dv">16</span><span class="op">)</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>        endm</span></code></pre></div>
<p>but this technique would not lead to the <code>EQU</code>-style syntax defined by TI (the symbol to be defined replaces the label field in a line). <strong>CAUTION!</strong> Though <code>DBIT</code> allows an arbitrary address, the pseudo instructions can only operate with addresses either in the range from 0...255 or 1000h...10ffh. The processor does not have an absolute addressing mode for other memory ranges...</p>
<h2 id="msp430x">MSP430(X)</h2>
<p>The MSP was designed to be a RISC processor with a minimal power consumption. The set of machine instructions was therefore reduced to the absolute minimum (RISC processors do not have a microcode ROM so every additional instruction has to be implemented with additional silicon that increases power consumption). A number of instructions that are hardwired for other processors are therefore emulated with other instructions. Older versions of AS implemented these instructions via macros in the file <code>REGMSP.INC</code>. If one did not include this file, you got error messages for more than half of the instructions defined by TI. This has been changed in recent versions: as part of adding the 430X instruction set, implementation of these instructions was moved into the assembler&#39;s core. <code>REGMSP.INC</code> now only contains addresses of I/O registers. If you need the old macros for some reason, they have been moved to the file <code>EMULMSP.INC</code>.</p>
<p>Instruction emulation also covers some special cases not handled by the original TI assembler. For instance,</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>        rlc  <span class="fu">@r</span><span class="dv">6</span><span class="op">+</span></span></code></pre></div>
<p>is automatically assembled as</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>        addc <span class="fu">@r</span><span class="dv">6</span><span class="op">+,-</span><span class="dv">2</span><span class="op">(</span>r6<span class="op">)</span></span></code></pre></div>
<h2 id="tms1000">TMS1000</h2>
<p>At last, world&#39;s first microcontroller finally also supported in AS - it took long to fill this gap, but now it is done. This target has some pitfalls that will be discussed shortly in this section.</p>
<p>First, the instruction set of these controllers is partially defined via the ROM mask, i.e. the function of some opcodes may be freely defined to some degree. AS only knows the instructions and codings that are described as default codings in <a href="#fn39" class="footnote-ref" id="fnref39" role="doc-noteref"><sup>39</sup></a>. If you have a special application with an instruction set deviating from this, you may define and modify instructions via macros and the <code>DB</code> instruction.</p>
<p>Furthermore, keep in mind that branches and subroutine calls only contain the lower 6 bits of the target address. The upper 4 resp. 5 bits are fetched from page and chapter registers that have to be set beforehand. AS cannot check whether these registers have been set correctly by the programmer! At least for the cas of staying in the same chapter, there are the assembler pseudo instructions <code>CALLL</code> resp. <code>BL</code> that combine an <code>LDP</code> and <code>CALL/BR</code> instruction. Regarding the limited amount of program memory, this is a convenient yet inefficient variant.</p>
<h2 id="cop8--scmp">COP8 &amp; SC/MP</h2>
<p>National unfortunately also decided to use the syntax well known from IBM mainframes (and much hated by me...) to write non-decimal integer constants. Just like with other processors, this does not work with AS&#39;s parser. ASMCOP however fortunately also seems to allow the C syntax, which is why this became the default for the COP series and the SC/MP...</p>
<h2 id="sc144xxx">SC144xxx</h2>
<p>Originally, National offered a relatively simple assembler for this series of DECT controllers. An much more powerful assembler has been announced by IAR, but it is not available up to now. However, since the development tools made by IAR are as much target-independent as possible, one can roughly estimate the pseudo instructions it will support by looking at other available target platforms. With this in mind, the (few) SC144xx-specific instructions <code>DC</code>, <code>DC8</code>, <code>DW16</code>, <code>DS</code>, <code>DS8</code>, <code>DS16</code>, <code>DW</code> were designed. Of course, I didn&#39;t want to reinvent the wheel for pseudo instructions whose functionality is already part of the AS core. Therefore, here is a little table with equivalences. The statements <code>ALIGN</code>, <code>END</code>, <code>ENDM</code>, <code>EXITM</code>, <code>MACRO</code>, <code>ORG</code>, <code>RADIX</code>, <code>SET</code>, and <code>REPT</code> both exist for the IAR assembler and AS and have same functionality. Changes are needed for the following instructions:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">IAR</th>
<th style="text-align: left;">AS</th>
<th style="text-align: left;">Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>#include</code></td>
<td style="text-align: left;"><code>include</code></td>
<td style="text-align: left;">include file</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>#define</code></td>
<td style="text-align: left;"><code>SET, EQU</code></td>
<td style="text-align: left;">define symbol</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>#elif</code>, <code>ELIF</code>, <code>ELSEIF</code></td>
<td style="text-align: left;"><code>ELSEIF</code></td>
<td style="text-align: left;">start another IF branch</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>#else</code>, <code>ELSE</code></td>
<td style="text-align: left;"><code>ELSE</code></td>
<td style="text-align: left;">last branch of an IF construct</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>#endif</code>, <code>ENDIF</code></td>
<td style="text-align: left;"><code>ENDIF</code></td>
<td style="text-align: left;">ends an IF construct</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>#error</code></td>
<td style="text-align: left;"><code>ERROR</code>, <code>FATAL</code></td>
<td style="text-align: left;">create error message</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>#if, IF</code></td>
<td style="text-align: left;"><code>IF</code></td>
<td style="text-align: left;">start an IF construct</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>#ifdef</code></td>
<td style="text-align: left;"><code>IFDEF</code></td>
<td style="text-align: left;">symbol defined ?</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>#ifndef</code></td>
<td style="text-align: left;"><code>IFNDEF</code></td>
<td style="text-align: left;">symbol not defined ?</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>#message</code></td>
<td style="text-align: left;"><code>MESSAGE</code></td>
<td style="text-align: left;">output message</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>=</code>, <code>DEFINE</code>, <code>EQU</code></td>
<td style="text-align: left;"><code>=</code>, <code>EQU</code></td>
<td style="text-align: left;">fixed value assignment</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>EVEN</code></td>
<td style="text-align: left;"><code>ALIGN 2</code></td>
<td style="text-align: left;">force PC to be equal</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>COL</code>, <code>PAGSIZ</code></td>
<td style="text-align: left;"><code>PAGE</code></td>
<td style="text-align: left;">set page size for listing</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ENDR</code></td>
<td style="text-align: left;"><code>ENDM</code></td>
<td style="text-align: left;">end REPT construct</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>LSTCND</code>, <code>LSTOUT</code></td>
<td style="text-align: left;"><code>LISTING</code></td>
<td style="text-align: left;">control amount of listing</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>LSTEXP</code>, <code>LSTREP</code></td>
<td style="text-align: left;"><code>MACEXP</code></td>
<td style="text-align: left;">list expanded macros?</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>LSTXRF</code></td>
<td style="text-align: left;"><code>&lt;command line&gt;</code></td>
<td style="text-align: left;">generate cross reference</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>PAGE</code></td>
<td style="text-align: left;"><code>NEWPAGE</code></td>
<td style="text-align: left;">new page in listing</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>REPTC</code></td>
<td style="text-align: left;"><code>IRPC</code></td>
<td style="text-align: left;">repetition with character replacement</td>
</tr>
</tbody>
</table>
<p>There is no direct equivalent for <code>CASEON</code>, <code>CASEOFF</code>, <code>LOCAL</code>, <code>LSTPAG</code>, <code>#undef</code>, and <code>REPTI</code>.</p>
<p>A 100% equivalent is of course impossible as long as there is no C-like preprocessor in AS. C-like comments unfortunately are also impossible at the moment. Caution: When modifying IAR codes for AS, do not forget to move converted preprocessor statements out of column 1 as AS reserves this column exclusively for labels!</p>
<h2 id="ns32xxx">NS32xxx</h2>
<p>As one might expect from a CISC processor, the NS32xxx series provides sophisticated and complex addressing modes. National defied the assembly syntax for each of them in its manuals, and this is also the syntax AS implements. However, as for every architecture that was supported by third-party tools, there are deviations and extensions, and I added a few of them to AS:</p>
<p>The syntax to use PC-relative addressing, as defined by National, is:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>     movb r0<span class="op">,*+</span>disp</span></code></pre></div>
<p>This of course quite clearly expresses what is happening at runtime, one however has to compute the distance himself if a certain memory location is to be addressed:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>     movb r0<span class="op">,*+(</span>addr<span class="op">-*)</span></span></code></pre></div>
<p>The first simplification is that under certain conditions, it is sufficient to just write:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>     movb r0<span class="op">,</span>addr</span></code></pre></div>
<p>since absolute addressing is marked by a prefix. This is allowed under the following conditions:</p>
<ul>
<li>Immediate addressing is not allowed, e.g. because the operand is the destination and there is no risk os ambiguities.</li>
<li>An index extension is used (appended in square brackets), which must not be combined with immediate addressing.</li>
</ul>
<p>As an alternative, AS also supports the following way to use PC-relative addressing:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>     movb r0<span class="op">,</span>addr<span class="op">(</span>pc<span class="op">)</span></span></code></pre></div>
<p>Analog to the 68000, the distance is computed automatically.</p>
<p>The external mode, which is written this way in National syntax:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>     movb r0<span class="op">,</span>ext<span class="op">(</span>disp1<span class="op">)+</span>disp2</span></code></pre></div>
<p>there is another supported syntax variant:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>     movb r0<span class="op">,</span>disp2<span class="op">(</span>disp1<span class="op">(</span>ext<span class="op">))</span></span></code></pre></div>
<p>which used to be common in UNIX environments.</p>
<h2 id="μpd78c1x">μPD78(C)1x</h2>
<p>For relative, unconditional instructions, there is the <code>JR</code> instruction (branch distance -32...+31, one byte), and the <code>JRE</code> instruction (branch distance -256...+255, two bytes). AS furthermore knows the <code>J</code> pseudo instruction, which automatically selects the shortest possible variant.</p>
<p>Architecture and instruction set of these processors are coarsely related to the Intel 8080/8085 - thi is also true for the mnemonics. The addressing mode (direct, indirect, immediate) is packed into the mnemonic, and 16 bit registers (BC, DE, HL) are written with just one letter. However, since NEC itself also uses at some places written-out register names and parentheses to signify indirect addressing, I decided to support some alternative notations next to the &#39;official&#39; ones. Some non-NEC tools like disassemblers seem to use these notations either:</p>
<ul>
<li>It is allowed to use <code>BC</code>, <code>(B)</code>, or <code>(BC)</code> instead of <code>B</code>.</li>
<li>It is allowed to use <code>DE</code>, <code>(D)</code>, or <code>(DE)</code> instead of <code>D</code>.</li>
<li>It is allowed to use <code>HL</code>, <code>(H)</code>, or <code>(HL)</code> instead of <code>H</code>.</li>
<li>It is allowed to use <code>DE+</code>, <code>(D+)</code>, <code>(DE+)</code>, or <code>(DE)+</code> instead of <code>D+</code>.</li>
<li>It is allowed to use <code>HL+</code>, <code>(H+)</code>, <code>(HL+)</code>, or <code>(HL)+</code> instead of <code>H+</code>.</li>
<li>It is allowed to use <code>DE-</code>, <code>(D-)</code>, <code>(DE-)</code>, or <code>(DE)-</code> instead of <code>D-</code>.</li>
<li>It is allowed to use <code>HL-</code>, <code>(H-)</code>, <code>(HL-)</code>, or <code>(HL)-</code> instead of <code>H-</code>.</li>
<li>It is allowed to use <code>DE++</code>, <code>(D++)</code>, <code>(DE++)</code>, or <code>(DE)++</code> instead of <code>D++</code>.</li>
<li>It is allowed to use <code>HL++</code>, <code>(H++)</code>, <code>(HL++)</code>, or <code>(HL)++</code> instead of <code>H++</code>.</li>
<li>It is allowed to use <code>DE–</code>, <code>(D–)</code>, <code>(DE–)</code>, or <code>(DE)–</code> instead of <code>D–</code>.</li>
<li>It is allowed to use <code>HL–</code>, <code>(H–)</code>, <code>(HL–)</code>, or <code>(HL)–</code> instead of <code>H–</code>.</li>
<li>It is allowed to use <code>HL+A</code>, <code>A+H</code>, <code>A+HL</code>, <code>(H+A)</code>, <code>(HL+A)</code>, <code>(A+H)</code>, or <code>(A+HL)</code> instead of <code>H+A</code>.</li>
<li>It is allowed to use <code>HL+B</code>, <code>B+H</code>, <code>B+HL</code>, <code>(H+B)</code>, <code>(HL+B)</code>, <code>(B+H)</code>, or <code>(B+HL)</code> instead of <code>H+B</code>.</li>
<li>It is allowed to use <code>HL+EA</code>, <code>EA+H</code>, <code>EA+HL</code>, <code>(H+EA)</code>, <code>(HL+EA)</code>, <code>(EA+H)</code>, or <code>(EA+HL)</code> instead of <code>H+EA</code>.</li>
</ul>
<h2 id="75k0-1">75K0</h2>
<p>Similar to other processors, the assembly language of the 75 series also knows pseudo bit operands, i.e. it is possible to assign a combination of address and bit number to a symbol that can then be used as an argument for bit oriented instructions just like explicit expressions. The following three instructions for example generate the same code:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>ADM     sfr     <span class="bn">0fd8h</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>SOC     bit     ADM<span class="op">.</span><span class="dv">3</span></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>        skt     <span class="bn">0fd8h</span><span class="op">.</span><span class="dv">3</span></span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>        skt     ADM<span class="op">.</span><span class="dv">3</span></span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a>        skt     SOC</span></code></pre></div>
<p>AS distinguishes direct and symbolic bit accesses by the missing dot in symbolic names; it is therefore forbidden to use dots in symbol names to avoid misunderstandings in the parser.</p>
<p>The storage format of bit symbols mostly accepts the binary coding in the machine instructions themselves: 16 bits are used, and there is a &quot;long&quot; and a &quot;short&quot; format. The short format can store the following variants:</p>
<ul>
<li>direct accesses to the address range from <code>0FBxH</code> to <code>0FFxH</code></li>
<li>indirect accesses in the style of <code>Addr.@L</code> (<code>0FC0H ≤ Addr ≤ 0FFFH</code>)</li>
<li>indirect accesses in the style of <code>@H+d4.bit</code></li>
</ul>
<p>The upper byte is set to 0, the lower byte contains the bit expression coded according to <a href="#fn40" class="footnote-ref" id="fnref40" role="doc-noteref"><sup>40</sup></a>. The long format in contrast only knows direct addressing, but it can cover the whole address space (given a correct setting of MBS and MBE). A long expression stores bits 0...7 of the address in the lower byte, the bit position in bits 8 and 9, and a constant value of 01 in bits 10 and 11. The highest bits allow to distinguish easily between long and short addresses via a check if the upper byte is 0. Bits 12...15 contain bits 8...11 of the address; they are not needed to generate the code, but they have to be stored somewhere as the check for correct banking can only take place when the symbol is actually used.</p>
<h2 id="78k0">78K0</h2>
<p>NEC uses different ways to mark absolute addressing in its data books:</p>
<ul>
<li>absolute short: no prefix</li>
<li>absolute long: prefix of <code>!</code></li>
<li>PC relative: prefix of <code>$</code></li>
</ul>
<p>Under AS, these prefixes are only necessary if one wants to force a certain addressing mode and the instruction allows different variants. Without a prefix, AS will automatically select the shortest variant. It should therefore rarely be necessary to use a prefix in practice.</p>
<h2 id="78k278k378k4">78K2/78K3/78K4</h2>
<p>Analogous to the 78K0, NEC here also uses dollar signs and exclamation marks to specify different lengths of address expressions. The selection between long and short addresses is done automatically (both in RAM and SFR areas), only relative addressing has to be selected explicitly, if an instruction supports both variants (like <code>BR</code>).</p>
<p>An additional remark (which is also true for the 78K0): Those who want to use Motorola syntax via <code>RELAXED</code>, might have to put hexadecimal constants in parentheses, since the leading dollar sign might be misunderstood as relative addressing...</p>
<h2 id="μpd772x">μPD772x</h2>
<p>Both the 7720 and 7725 are provided by the same code generator and are extremely similar in their instruction set. One should however not believe that they are binary compatible: To get space for the longer address fields and additional instructions, the bit positions of some fields in the instruction word have changed, and the instruction length has changed from 23 to 24 bits. The code format therefore uses different header ids for both CPUs.</p>
<p>They both have in common that in addition to the code and data segment, there is also a ROM for storage of constants. In the case of AS, it is mapped onto the <code>ROMDATA</code> segment!</p>
<h2 id="f2mc16l-1">F<sup>2</sup>MC16L</h2>
<p>Along with the discussion of the <code>ASSUME</code> statement, it has already been mentioned that it is important to inform AS about the correct current values of all bank registers - if your program uses more than 64K RAM or 64K ROM. With these assumptions in mind, AS checks every direct memory access for attempts to access a memory location that is currently not in reach. Of course, standard situations only require knowledge of DTB and DPR for this purpose, since ADB resp. SSB/USB are only used for indirect accesses via RW2/RW6 resp. RW3/RW7 and this mechanism anyway doesn&#39;t work for indirect accesses. However, similar to the 8086, it is possible to place a prefix in front of an instruction to replace DTB by a different register. AS therefore keeps track of used segment prefixes and toggles appropriately for the next <em>machine instruction</em>. A pseudo instruction placed between the prefix and the machine instruction does <em>not</em> reset the toggle. This is also true for pseudo instructions that store data or modify the program counter. Which doesn&#39;t make much sense anyway...</p>
<h2 id="mn161x">MN161x</h2>
<p>This target is special because there are two different code generators one may choose from. The first one was kindly provided by Haruo Asano and that may be reached via the CPU names <code>MN1610</code> resp.<code>MN1613</code>. The other one was written by me and is activated via the CPU names <code>MN1610ALT</code> resp. <code>MN1613ALT</code>. If you want to use the MN1613&#39;s extended address space of 256 KWords, or if you want to experiment with the MN1613&#39;s floating point formant, you have to use the <code>ALT</code> target.</p>
<h2 id="cdp180x">CDP180x</h2>
<p>This family of processors supports both long and short branches: a short branch is only possible within the same 256 byte memory page, and a long branch is possible to any target in the 64K address space. The assembly syntax provides different mnemonics for both variants (the long variant with a leading &#39;L&#39;), but there is no variant that would let the assembler decide itself between long or short. AS supports such &#39;pseudo instructions&#39; as an extension:</p>
<ul>
<li><code>JMP</code> becomes <code>BR</code> or <code>LBR</code>.</li>
<li><code>JZ</code> becomes <code>BZ</code> or <code>LBZ</code>.</li>
<li><code>JNZ</code> becomes <code>BNZ</code> or <code>LBNZ</code>.</li>
<li><code>JDF</code> becomes <code>BDF</code> or <code>LBDF</code>.</li>
<li><code>JPZ</code> becomes <code>BPZ</code> or <code>LBPZ</code>.</li>
<li><code>JGE</code> becomes <code>BGE</code> or <code>LBGE</code>.</li>
<li><code>JNF</code> becomes <code>BNF</code> or <code>LBNF</code>.</li>
<li><code>JM</code> becomes <code>BM</code> or <code>LBM</code>.</li>
<li><code>JL</code> becomes <code>BL</code> or <code>LBL</code>.</li>
<li><code>JQ</code> becomes <code>BQ</code> or <code>LBQ</code>.</li>
<li><code>JNQ</code> becomes <code>BNQ</code> or <code>LBNQ</code>.</li>
</ul>
<h2 id="kenbak">KENBAK</h2>
<p>The KENBAK-1 was developed in 1970, at a time when the first microprocessor was still three years away. One may assume that for the few hobbyists that could afford the kit back then, this was their first and only computer. As a consequence, they had nothing they could run an assembler on, the KENBAK-1 itself with its 256 bytes of memory was way too small for such a task. The preferred method was to use pre-printed tables, which had fields to fill in instructions and machine codes. Once this &quot;programming job&quot; was done, one would enter the machine code manually via the computer&#39;s switch row.</p>
<p>The effect of this is that though the KENBAK&#39;s assembly language is described in the manual, there is no real formal definition of it. When Grant Stockly released new KENBAK kits a few years ago, he did a first implementation of the KENBAK on my assembler. Unfortunately, this never went upstream. I tried to take up his ideas in my implementation, but on the other hand I also tried to offer a syntax that should be familiar to programmers of 6502, Z80 or similar processors. The following table lists the syntax differences:</p>
<!-- markdownlint-disable MD056 -->

<table>
<thead>
<tr class="header">
<th style="text-align: left;">Stock</th>
<th style="text-align: left;">Alternative</th>
<th style="text-align: left;">Remark</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Arithmetic/Logic (ADD/SUB/LOAD/STORE/AND/OR/LNEG)</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><em>instr</em> <code>Constant</code>, <em>Reg</em>, <em>Wert</em>,</td>
<td style="text-align: left;"><em>instr</em> <em>Reg</em>, <em>#Wert</em></td>
<td style="text-align: left;">immediate</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em>instr</em> <code>Memory</code>, <em>Reg</em>, <em>Addr</em>,</td>
<td style="text-align: left;"><em>instr</em> <em>Reg</em>, <em>Addr</em></td>
<td style="text-align: left;">direct</td>
</tr>
<tr class="even">
<td style="text-align: left;"><em>instr</em> <code>Indirect</code>, <em>Reg</em>, <em>Addr</em>,</td>
<td style="text-align: left;"><em>instr</em> <em>Reg</em>, <em>(Addr)</em></td>
<td style="text-align: left;">direct</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em>instr</em> <code>Indexed</code>, <em>Reg</em>, <em>Addr</em>,</td>
<td style="text-align: left;"><em>instr</em> <em>Reg</em>, <em>Addr</em>,X</td>
<td style="text-align: left;">indexed</td>
</tr>
<tr class="even">
<td style="text-align: left;"><em>instr</em> <code>Indirect-Indexed</code>, <em>Reg</em>, <em>Addr</em>,</td>
<td style="text-align: left;"><em>instr</em> <em>Reg</em>, <em>(Addr)</em>,X</td>
<td style="text-align: left;">indirect-indexed</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Jumps</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>JPD</code> <em>Reg</em>, <em>Cond</em>, <em>Addr</em></td>
<td style="text-align: left;"><code>JP</code> <em>Reg</em>, <em>Cond</em>, <em>Addr</em></td>
<td style="text-align: left;">conditional-direct</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>JPI</code> <em>Reg</em>, <em>Cond</em>, <em>Addr</em></td>
<td style="text-align: left;"><code>JP</code> <em>Reg</em>, <em>Cond</em>, <em>(Addr)</em></td>
<td style="text-align: left;">conditional-indirect</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>JMD</code> <em>Reg</em>, <em>Cond</em>, <em>Addr</em></td>
<td style="text-align: left;"><code>JM</code> <em>Reg</em>, <em>Cond</em>, <em>Addr</em></td>
<td style="text-align: left;">conditional-direct</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>JMI</code> <em>Reg</em>, <em>Cond</em>, <em>Addr</em></td>
<td style="text-align: left;"><code>JM</code> <em>Reg</em>, <em>Cond</em>, <em>(Addr)</em></td>
<td style="text-align: left;">conditional-indirect</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>JPD</code> <code>Unconditional</code>, <em>Cond</em>, <em>Addr</em></td>
<td style="text-align: left;"><code>JP</code> <em>Addr</em></td>
<td style="text-align: left;">unconditional-direct</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>JPI</code> <code>Unconditional</code>, <em>Cond</em>, <em>Addr</em></td>
<td style="text-align: left;"><code>JP</code> <em>(Addr)</em></td>
<td style="text-align: left;">unconditional-indirect</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>JMD</code> <code>Unconditional</code>, <em>Cond</em>, <em>Addr</em></td>
<td style="text-align: left;"><code>JM</code> <em>Addr</em></td>
<td style="text-align: left;">unconditional-direct</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>JMI</code> <code>Unconditional</code>, <em>Cond</em>, <em>Addr</em></td>
<td style="text-align: left;"><code>JM</code> <em>(Addr)</em></td>
<td style="text-align: left;">unconditional-indirect</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Jump Conditions</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Non-zero</code></td>
<td style="text-align: left;"><code>NZ</code></td>
<td style="text-align: left;"> <code>≠ 0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Zero</code></td>
<td style="text-align: left;"><code>Z</code></td>
<td style="text-align: left;"> <code>= 0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Negative</code></td>
<td style="text-align: left;"><code>N</code></td>
<td style="text-align: left;"> <code>&lt; 0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Positive</code></td>
<td style="text-align: left;"><code>P</code></td>
<td style="text-align: left;"> <code>≥ 0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Positive-Non-zero</code></td>
<td style="text-align: left;"><code>PNZ</code></td>
<td style="text-align: left;"> <code>&gt; 0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Skips</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>SKP 0</code>, <em>bit</em>, <em>Addr</em></td>
<td style="text-align: left;"><code>SKP0</code> <em>bit</em>, <em>Addr</em> <em>[,Dest]</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>SKP 1</code>, <em>bit</em>, <em>Addr</em></td>
<td style="text-align: left;"><code>SKP1</code> <em>bit</em>, <em>Addr</em> <em>[,Dest]</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Bit Manipulation</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>SET 0</code>, <em>bit</em>, <em>Addr</em></td>
<td style="text-align: left;"><code>SET0</code> <em>bit</em>, <em>Addr</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>SET 1</code>, <em>bit</em>, <em>Addr</em></td>
<td style="text-align: left;"><code>SET1</code> <em>bit</em>, <em>Addr</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Shifts/Rotates</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>SHIFT LEFT</code>, <em>cnt</em>, <em>Reg</em></td>
<td style="text-align: left;"><code>SFTL</code> <em>[cnt,]</em> <em>Reg</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>SHIFT RIGHT</code>, <em>cnt</em>, <em>Reg</em></td>
<td style="text-align: left;"><code>SFTR</code> <em>[cnt,]</em> <em>Reg</em></td>
<td style="text-align: left;">arithmetic Shift</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ROTATE LEFT</code>, <em>cnt</em>, <em>Reg</em></td>
<td style="text-align: left;"><code>ROTL</code> <em>[cnt,]</em> <em>Reg</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ROTATE RIGHT</code>, <em>cnt</em>, <em>Reg</em></td>
<td style="text-align: left;"><code>ROTR</code> <em>[cnt,]</em> <em>Reg</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<!-- markdownlint-enable MD056 -->

<p>There is no pseudo instruction to switch between these syntax variants. They may both be used anytime and in an arbitrary mix.</p>
<p>The target address <em>[Dest]</em> that may optionally be added to skip instructions will not become part of the machine code. The assembler only checks whether the processor wil actually skip to the given address. This allows for instance to check whether one actually tries to skip a one-byte instruction. If the shift count argument <em>[cnt]</em> is omitted, a one-bit shift/rotate is coded.</p>
<!-- markdownlint-enable MD030 -->

<!-- markdownlint-enable MD025 -->

<!-- markdownlint-disable MD001 -->

<h1 id="file-formats">File Formats</h1>
<!-- markdownlint-disable MD001 -->

<!-- markdownlint-disable MD025 -->

<!-- markdownlint-disable MD030 -->

<p>In this chapter, the formats of files AS generates shall be explained whose formats are not self-explanatory.</p>
<h2 id="code-files">Code Files</h2>
<p>The format for code files generated by the assembler must be able to separate code parts that were generated for different target processors; therefore, it is a bit different from most other formats. Though the assembler package contains tools to deal with code files, I think is a question of good style to describe the format in short:</p>
<p>If a code file contains multi-byte values, they are stored in little endian order. This rule is already valid for the 16-bit magic word <code>$1489</code>, i.e. every code file starts with the byte sequence <code>$89</code>/<code>$14</code>.</p>
<p>This magic word is followed by an arbitrary number of &quot;records&quot;. A record may either contain a continuous piece of the code or certain additional information. Even without switching to different processor types, a file may contain several code-containing records, in case that code or constant data areas are interrupted by reserved memory areas that should not be initialized. This way, the assembler tries to keep the file as short as possible.</p>
<p>Common to all records is a header byte which defines the record&#39;s type and its contents. Written in a PASCALish way, the record structure can be described in the following way:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>FileRecord <span class="op">=</span> RECORD CASE Header<span class="op">:</span><span class="dt">Byte</span> OF</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>        $00:(Creator<span class="op">:</span>ARRAY<span class="op">[]</span> OF Char<span class="op">)</span><span class="co">;</span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>        $01..</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>        $7f:(StartAdr <span class="op">:</span> LongInt<span class="co">;</span></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a>                Length   <span class="op">:</span> <span class="dt">Word</span><span class="co">;</span></span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a>                <span class="bu">Data</span>     <span class="op">:</span> ARRAY<span class="op">[</span><span class="fl">0.</span><span class="op">..</span>Length<span class="op">-</span><span class="dv">1</span><span class="op">]</span> OF <span class="dt">Byte</span><span class="op">)</span><span class="co">;</span></span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a>        $80:(EntryPoint<span class="op">:</span>LongInt<span class="op">)</span><span class="co">;</span></span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a>        $81:(Header   <span class="op">:</span> <span class="dt">Byte</span><span class="co">;</span></span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a>                <span class="bu">Segment</span>  <span class="op">:</span> <span class="dt">Byte</span><span class="co">;</span></span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a>                Gran     <span class="op">:</span> <span class="dt">Byte</span><span class="co">;</span></span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a>                StartAdr <span class="op">:</span> LongInt<span class="co">;</span></span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a>                Length   <span class="op">:</span> <span class="dt">Word</span><span class="co">;</span></span>
<span id="cb248-13"><a href="#cb248-13" aria-hidden="true" tabindex="-1"></a>                <span class="bu">Data</span>     <span class="op">:</span> ARRAY<span class="op">[</span><span class="fl">0.</span><span class="op">..</span>Length<span class="op">-</span><span class="dv">1</span><span class="op">]</span> OF <span class="dt">Byte</span><span class="op">)</span><span class="co">;</span></span>
<span id="cb248-14"><a href="#cb248-14" aria-hidden="true" tabindex="-1"></a>        <span class="pp">END</span></span></code></pre></div>
<p>This description does not express fully that the length of data fields is variable and depends on the value of the <code>Length</code> entries.</p>
<p>A record with a header byte of $81 is a record that may contain code or data from arbitrary segments. The first byte (<code>Header</code>) describes the processor family the following code resp. data was generated for, as shown in the following table.</p>
<h5 id="table-header-bytes-for-the-different-processor-families"><strong>Table:</strong> Header Bytes for the Different Processor Families</h5>
<!-- markdownlint-disable MD056 -->

<table>
<thead>
<tr class="header">
<th style="text-align: center;">Header</th>
<th style="text-align: left;">Family</th>
<th style="text-align: center;">Header</th>
<th style="text-align: left;">Family</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>$01</code></td>
<td style="text-align: left;">680x0, 6833x</td>
<td style="text-align: center;"><code>$02</code></td>
<td style="text-align: left;">ATARI_VECTOR</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$03</code></td>
<td style="text-align: left;">M*Core</td>
<td style="text-align: center;"><code>$04</code></td>
<td style="text-align: left;">XGATE</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$05</code></td>
<td style="text-align: left;">PowerPC</td>
<td style="text-align: center;"><code>$06</code></td>
<td style="text-align: left;">XCore</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$07</code></td>
<td style="text-align: left;">TMS1000</td>
<td style="text-align: center;"><code>$08</code></td>
<td style="text-align: left;">NS32xxx</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$09</code></td>
<td style="text-align: left;">DSP56xxx</td>
<td style="text-align: center;"><code>$0a</code></td>
<td style="text-align: left;">CP1600</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$11</code></td>
<td style="text-align: left;">65xx/MELPS-740</td>
<td style="text-align: center;"><code>$12</code></td>
<td style="text-align: left;">MELPS-4500</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$13</code></td>
<td style="text-align: left;">M16</td>
<td style="text-align: center;"><code>$14</code></td>
<td style="text-align: left;">M16C</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$15</code></td>
<td style="text-align: left;">F<sup>2</sup>MC8L</td>
<td style="text-align: center;"><code>$16</code></td>
<td style="text-align: left;">F<sup>2</sup>MC16L</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$19</code></td>
<td style="text-align: left;">65816/MELPS-7700</td>
<td style="text-align: center;"><code>$1a</code></td>
<td style="text-align: left;">PDK13</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$1b</code></td>
<td style="text-align: left;">PDK14</td>
<td style="text-align: center;"><code>$1c</code></td>
<td style="text-align: left;">PDK15</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$1d</code></td>
<td style="text-align: left;">PDK16</td>
<td style="text-align: center;"><code>$21</code></td>
<td style="text-align: left;">MCS-48</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$25</code></td>
<td style="text-align: left;">SYM53C8xx</td>
<td style="text-align: center;"><code>$27</code></td>
<td style="text-align: left;">KENBAK</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$29</code></td>
<td style="text-align: left;">29xxx</td>
<td style="text-align: center;"><code>$2a</code></td>
<td style="text-align: left;">i960</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$31</code></td>
<td style="text-align: left;">MCS-51</td>
<td style="text-align: center;"><code>$32</code></td>
<td style="text-align: left;">ST9</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$33</code></td>
<td style="text-align: left;">ST7</td>
<td style="text-align: center;"><code>$35</code></td>
<td style="text-align: left;">Z8000</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$35</code></td>
<td style="text-align: left;">Super8</td>
<td style="text-align: center;"><code>$36</code></td>
<td style="text-align: left;">MN161x</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$37</code></td>
<td style="text-align: left;">2650</td>
<td style="text-align: center;"><code>$38</code></td>
<td style="text-align: left;">1802/1805</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$39</code></td>
<td style="text-align: left;">MCS-96/196/296</td>
<td style="text-align: center;"><code>$3a</code></td>
<td style="text-align: left;">8X30x</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$3b</code></td>
<td style="text-align: left;">AVR</td>
<td style="text-align: center;"><code>$3c</code></td>
<td style="text-align: left;">XA</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$3d</code></td>
<td style="text-align: left;">AVR (8-Bit Code-Segment)</td>
<td style="text-align: center;"><code>$3e</code></td>
<td style="text-align: left;">8008</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$3f</code></td>
<td style="text-align: left;">4004/4040</td>
<td style="text-align: center;"><code>$40</code></td>
<td style="text-align: left;">H16</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$41</code></td>
<td style="text-align: left;">8080/8085</td>
<td style="text-align: center;"><code>$42</code></td>
<td style="text-align: left;">8086...V35</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$43</code></td>
<td style="text-align: left;">SX20</td>
<td style="text-align: center;"><code>$44</code></td>
<td style="text-align: left;">F8</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$45</code></td>
<td style="text-align: left;">S12Z</td>
<td style="text-align: center;"><code>$46</code></td>
<td style="text-align: left;">78K4</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$47</code></td>
<td style="text-align: left;">TMS320C6x</td>
<td style="text-align: center;"><code>$48</code></td>
<td style="text-align: left;">TMS9900</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$49</code></td>
<td style="text-align: left;">TMS370xxx</td>
<td style="text-align: center;"><code>$4a</code></td>
<td style="text-align: left;">MSP430</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$4b</code></td>
<td style="text-align: left;">TMS320C54x</td>
<td style="text-align: center;"><code>$4c</code></td>
<td style="text-align: left;">80C166/167</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$4d</code></td>
<td style="text-align: left;">OLMS-50</td>
<td style="text-align: center;"><code>$4e</code></td>
<td style="text-align: left;">OLMS-40</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$4f</code></td>
<td style="text-align: left;">MIL STD 1750</td>
<td style="text-align: center;"><code>$50</code></td>
<td style="text-align: left;">HMCS-400</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$51</code></td>
<td style="text-align: left;">Z80/180/380</td>
<td style="text-align: center;"><code>$52</code></td>
<td style="text-align: left;">TLCS-900</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$53</code></td>
<td style="text-align: left;">TLCS-90</td>
<td style="text-align: center;"><code>$54</code></td>
<td style="text-align: left;">TLCS-870</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$55</code></td>
<td style="text-align: left;">TLCS-47</td>
<td style="text-align: center;"><code>$56</code></td>
<td style="text-align: left;">TLCS-9000</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$57</code></td>
<td style="text-align: left;">TLCS-870/C</td>
<td style="text-align: center;"><code>$58</code></td>
<td style="text-align: left;">NEC 78K3</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$59</code></td>
<td style="text-align: left;">eZ8</td>
<td style="text-align: center;"><code>$5a</code></td>
<td style="text-align: left;">TC9331</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$5b</code></td>
<td style="text-align: left;">KCPSM3</td>
<td style="text-align: center;"><code>$5c</code></td>
<td style="text-align: left;">LatticeMico8</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$5d</code></td>
<td style="text-align: left;">NEC 75xx</td>
<td style="text-align: center;"><code>$5e</code></td>
<td style="text-align: left;">68RS08</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$5f</code></td>
<td style="text-align: left;">COP4</td>
<td style="text-align: center;"><code>$60</code></td>
<td style="text-align: left;">78K2</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$61</code></td>
<td style="text-align: left;">6800, 6301, 6811</td>
<td style="text-align: center;"><code>$62</code></td>
<td style="text-align: left;">6805/HC08</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$63</code></td>
<td style="text-align: left;">6809</td>
<td style="text-align: center;"><code>$64</code></td>
<td style="text-align: left;">6804</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$65</code></td>
<td style="text-align: left;">68HC16</td>
<td style="text-align: center;"><code>$66</code></td>
<td style="text-align: left;">68HC12</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$67</code></td>
<td style="text-align: left;">ACE</td>
<td style="text-align: center;"><code>$68</code></td>
<td style="text-align: left;">H8/300(H)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$69</code></td>
<td style="text-align: left;">H8/500</td>
<td style="text-align: center;"><code>$6a</code></td>
<td style="text-align: left;">807x</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$6b</code></td>
<td style="text-align: left;">KCPSM</td>
<td style="text-align: center;"><code>$6c</code></td>
<td style="text-align: left;">SH7000</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$6d</code></td>
<td style="text-align: left;">SC14xxx</td>
<td style="text-align: center;"><code>$6e</code></td>
<td style="text-align: left;">SC/MP</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$6f</code></td>
<td style="text-align: left;">COP8</td>
<td style="text-align: center;"><code>$70</code></td>
<td style="text-align: left;">PIC16C8x</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$71</code></td>
<td style="text-align: left;">PIC16C5x</td>
<td style="text-align: center;"><code>$72</code></td>
<td style="text-align: left;">PIC17C4x</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$73</code></td>
<td style="text-align: left;">TMS-7000</td>
<td style="text-align: center;"><code>$74</code></td>
<td style="text-align: left;">TMS3201x</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$75</code></td>
<td style="text-align: left;">TMS320C2x</td>
<td style="text-align: center;"><code>$76</code></td>
<td style="text-align: left;">TMS320C3x/C4x</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$77</code></td>
<td style="text-align: left;">TMS320C20x/C5x</td>
<td style="text-align: center;"><code>$78</code></td>
<td style="text-align: left;">ST6</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$79</code></td>
<td style="text-align: left;">Z8</td>
<td style="text-align: center;"><code>$7a</code></td>
<td style="text-align: left;">µPD78(C)10</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$7b</code></td>
<td style="text-align: left;">75K0</td>
<td style="text-align: center;"><code>$7c</code></td>
<td style="text-align: left;">78K0</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$7d</code></td>
<td style="text-align: left;">µPD7720</td>
<td style="text-align: center;"><code>$7e</code></td>
<td style="text-align: left;">µPD7725</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$7f</code></td>
<td style="text-align: left;">µPD77230</td>
<td style="text-align: center;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<!-- markdownlint-enable MD056 -->

<p>The <code>Segment</code> field signifies the address space the following code belongs to. The assignment is defined in the following table.</p>
<h5 id="table-codings-of-the-segment-field"><strong>Table:</strong> Codings of the <code>Segment</code> Field</h5>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">number</th>
<th style="text-align: left;">segment</th>
<th style="text-align: center;">number</th>
<th style="text-align: left;">segment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>$00</code></td>
<td style="text-align: left;"><code>&lt;undefined&gt;</code></td>
<td style="text-align: center;"><code>$01</code></td>
<td style="text-align: left;"><code>CODE</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$02</code></td>
<td style="text-align: left;"><code>DATA</code></td>
<td style="text-align: center;"><code>$03</code></td>
<td style="text-align: left;"><code>IDATA</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$04</code></td>
<td style="text-align: left;"><code>XDATA</code></td>
<td style="text-align: center;"><code>$05</code></td>
<td style="text-align: left;"><code>YDATA</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>$06</code></td>
<td style="text-align: left;"><code>BDATA</code></td>
<td style="text-align: center;"><code>$07</code></td>
<td style="text-align: left;"><code>IO</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>$08</code></td>
<td style="text-align: left;"><code>REG</code></td>
<td style="text-align: center;"><code>$09</code></td>
<td style="text-align: left;"><code>ROMDATA</code></td>
</tr>
</tbody>
</table>
<p>The <code>Gran</code> field describes the code&#39;s &quot;granularity&quot;, i.e. the size of the smallest addressable unit in the following set of data. This value is a function of processor type and segment and is an important parameter for the interpretation of the following two fields that describe the block&#39;s start address and its length: While the start address refers to the granularity, the <code>Length</code> value is always expressed in bytes! For example, if the start address is $300 and the length is 12, the resulting end address would be $30b for a granularity of 1, however $303 for a granularity of 4! Granularities that differ from 1 are rare and mostly appear in DSP CPU&#39;s that are not designed for byte processing. For example, a DSP56K&#39;s address space is organized in 64 Kwords of 16 bits. The resulting storage capacity is 128 Kbytes, however it is organized as 2<sup>16</sup> words that are addressed with addresses 0, 1, 2, ...65535!</p>
<p>The start address is always 32 bits in size, independent of the processor family. In contrast, the length specification has only 16 bits, i.e. a record may have a maximum length of 4+4+2+(64K-1) = 65545 bytes.</p>
<p>Data records with a Header ranging from $01 to $7f present a shortcut and preserve backward compatibility to earlier definitions of the file format: in their case, the Header directly defines the processor type, the target segment is fixed to <code>CODE</code> and the granularity is implicitly given by the processor type, rounded up to the next power of two. AS prefers to use these records whenever data or code should go into the <code>CODE</code> segment.</p>
<p>A record with a Header of $80 defines an entry point, i.e. the address where execution of the program should start. Such a record is the result of an <code>END</code> statement with a corresponding address as argument.</p>
<p>The last record in a file bears the Header $00 and has only a string as data field. This string does not have an explicit length specification; its end is equal to the file&#39;s end. The string contains only the name of the program that created the file and has no further meaning.</p>
<h2 id="debug-files">Debug Files</h2>
<p>Debug files may optionally be generated by AS. They deliver important information for tools used after assembly, like disassemblers or debuggers. AS can generate debug files in one of three formats: On the one hand, the object format used by the AVR tools from Atmel respectively a NoICE-compatible command file, and on the other hand an own format. The first two are described in detail in <a href="#fn41" class="footnote-ref" id="fnref41" role="doc-noteref"><sup>41</sup></a> resp. the NoICE documentations, which is why the following description limits itself to the AS-specific MAP format:</p>
<p>The information in a MAP file is split into three groups:</p>
<ul>
<li>symbol table</li>
<li>memory usage per section</li>
<li>machine addresses of source lines</li>
</ul>
<p>The second item is listed first in the file. A single entry in this list consists of two numbers that are separated by a <code>:</code> character:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>&lt;line number<span class="op">&gt;:&lt;</span>address<span class="op">&gt;</span></span></code></pre></div>
<p>Such an entry states that the machine code generated for the source statement in a certain line is stored at the mentioned address (written in hexadecimal notation). With such an information, a debugger can display the corresponding source lines while stepping through a program. As a program may consist of several include files, and due to the fact that a lot of processors have more than one address space (though admittedly only one of them is used to store executable code), the entries described above have to be sorted. AS does this sorting in two levels: The primary sorting criteria is the target segment, and the entries in one of these sections are sorted according to files. The sections resp. subsections are separated by special lines in the style of</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Segment</span> <span class="op">&lt;</span>segment name<span class="op">&gt;</span></span></code></pre></div>
<p>resp.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="dt">File</span> <span class="op">&lt;</span><span class="dt">file</span> name<span class="op">&gt;</span></span></code></pre></div>
<p>The source line info is followed by the symbol table. Similar to the source line info, the symbol table is primarily sorted by the segments individual symbols are assigned to. In contrast to the source line info, an additional section <code>NOTHING</code> exists which contains the symbols that are not assigned to any specific segment (e.g. symbols that have been defined with a simple <code>EQU</code> statement). A section in the symbol table is started with a line of the following type:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>Symbols in Segment <span class="op">&lt;</span>segment name<span class="op">&gt;</span></span></code></pre></div>
<p>The symbols in a section are sorted according to the alphabetical order of their names, and one symbol entry consists of exactly one line. Such a line consists of six fields witch are separated by at least a single space:</p>
<p>The first field is the symbol&#39;s name, possibly extended by a section number enclosed in brackets. Such a section number limits the range of validity for a symbol. The second field designates the symbol&#39;s type: <code>Int</code> stands for integer values, <code>Float</code> for floating point numbers, and <code>String</code> for character arrays. The third field finally contains the symbol&#39;s value. If the symbol contains a string, it is necessary to use a special encoding for control characters and spaces. Without such a coding, spaces in a string could be misinterpreted as delimiters to the next field. AS uses the same syntax that is also valid for assembly source files: Instead of the character, its ASCII value with a leading backslash (<code>\</code>) is inserted. For example, the string</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>This is a test</span></code></pre></div>
<p>becomes</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>This<span class="op">\</span><span class="dv">032</span><span class="er">is</span><span class="op">\</span><span class="dv">032</span><span class="op">\</span>a<span class="op">\</span><span class="dv">032</span><span class="er">test</span></span></code></pre></div>
<p>The numerical value always has three digits and has to be interpreted as a decimal value. Naturally, the backslash itself also has to be coded this way.</p>
<p>The fourth field specifies - if available - the size of the data structure placed at the address given by the symbol. A debugger may use this information to automatically display variables in their correct length when they are referred symbolically. In case AS does not have any information about the symbol size, this field simply contains the value -1.</p>
<p>The fifth field states via the values 0 or 1 if the symbol has been used during assembly. A program that reads the symbol table can use this field to skip unused symbols as they are probably unused during the following debugging/disassembly session.</p>
<p>Finally, the sixth field states via the values 0 or 1 if the symbol is a constant (0) or variable(1). Constant symbols are set once, e.g. via the <code>EQU</code> statement or a label, while variables are allowed to change their value during the course of assembly. The MAP file lists the final value.</p>
<p>The third section in a debug file describes the program&#39;s sections in detail. The need for such a detailed description arises from the sections&#39; ability to limit the validity range of symbols. A symbolic debugger for example cannot use certain symbols for a reverse translation, depending on the current PC value. It may also have to regard priorities for symbol usage when a value is represented by more than one symbol. The definition of a section starts with a line of the following form:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>Info for Section nn ssss pp</span></code></pre></div>
<p><code>nn</code> specifies the section&#39;s number (the number that is also used in the symbol table as a postfix for symbol names), <code>ssss</code> gives its name and <code>pp</code> the number of its parent section. The last information is needed by a re-translator to step upward through a tree of sections until a fitting symbol is found. This first line is followed by a number of further lines that describe the code areas used by this section. Every single entry (exactly one entry per line) either describes a single address or an address range given by a lower and an upper bound (separation of lower and upper bound by a minus sign). These bounds are &quot;inclusive&quot;, i.e. the bounds themselves also belong to the area. Is is important to note that an area belonging to a section is not additionally listed for the section&#39;s parent sections (an exception is of course a deliberate multiple allocation of address areas, but you would not do this, would you?). On the one hand, this allows an optimized storage of memory areas during assembly. On the other hand, this should not be an obstacle for symbol back-translation as the single entry already gives an unambiguous entry point for the symbol search path. The description of a section is ended by an empty line or the end of the debug file.</p>
<p>Program parts that lie out of any section are not listed separately. This implicit &quot;root section&quot; carries the number -1 and is also used as parent section for sections that do not have a real parent section.</p>
<p>It is possible that the file contains empty lines or comments (semi colon at line start). A program reading the file has to ignore such lines.</p>
<!-- markdownlint-enable MD030 -->

<!-- markdownlint-enable MD025 -->

<!-- markdownlint-disable MD001 -->

<h1 id="utility-programs">Utility Programs</h1>
<!-- markdownlint-disable MD025 -->

<!-- markdownlint-disable MD030 -->

<p>To simplify the work with the assembler&#39;s code format a bit, I added some tools to aid processing of code files. These programs are released under the same license terms as stated in section
<a href="#license-agreement">License Agreement</a>!</p>
<p>Common to all programs are the possible return codes they may deliver upon completion:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">return code</th>
<th style="text-align: left;">error condition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: left;">no errors</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: left;">error in command line parameters</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: left;">I/O error</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: left;">file format error</td>
</tr>
</tbody>
</table>
<p>Just like AS, all programs take their input from STDIN and write messages to STDOUT (resp. error messages to STDERR). Therefore, input and output redirections should not be a problem.</p>
<p>In case that numeric or address specifications have to be given in the command line, they may also be written in hexadecimal notation, either by all ending in <code>h</code>, or by prepending a dollar character or a <code>0x</code> like in C. (e.g. <code>10h</code>, <code>$10</code>, or <code>0x10</code> instead of 16).</p>
<p>Unix shells however assign a special meaning to the dollar sign, which makes it necessary to escape a dollar sign with a backslash. The <code>0x</code> variant is definitely more comfortable in this case.</p>
<p>Otherwise, calling conventions and variations are equivalent to those of AS (except for PLIST and AS2MSG); i.e. it is possible to store frequently used parameters in an environment variable (whose name is constructed by appending CMD to the program&#39;s name, i.e. <code>BINDCMD</code> for BIND), to negate options, and to use all upper- resp. lower-case writing (for details on this, see <a href="#start-up-command-parameters">Start-Up Command, Parameters</a>).</p>
<p>Address specifications always relate to the granularity of the processor currently in question; for example, on a PIC, an address difference of 1 means a word and not a byte.</p>
<h2 id="plist">PLIST</h2>
<p>PLIST is the simplest one of the five programs supplied: its purpose is simply to list all records that are stored in a code file. As the program does not do very much, calling is quite simple:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>    PLIST <span class="kw">&lt;</span>file name<span class="kw">&gt;</span></span></code></pre></div>
<p>The file name will automatically be extended with the extension <code>P</code> if it doesn&#39;t already have one.</p>
<p><strong>CAUTION!</strong> At this place, no wildcards are allowed! If there is a necessity to list several files with one command, use the following &quot;mini batch&quot;:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="er">%n</span> <span class="er">in</span> <span class="er">(*.p)</span> <span class="er">do</span> <span class="er">plist</span> <span class="er">%n</span></span></code></pre></div>
<p>PLIST prints the code file&#39;s contents in a table style, whereby exactly one line will be printed per record. The individual rows have the following meanings:</p>
<ul>
<li>code type: the processor family the code has been generated for.</li>
<li>start address: absolute memory address that expresses the load destination for the code.</li>
<li>length: length of this code chunk in bytes.</li>
<li>end address: last address of this code chunk. This address is calculated as start address+length-1.</li>
</ul>
<p>All outputs are in hexadecimal notation.</p>
<p>Finally, PLIST will print a copyright remark (if there is one in the file), together with a summarized code length.</p>
<p>Simply said, PLIST is a sort of DIR for code files. One can use it to examine a file&#39;s contents before one continues to process it.</p>
<h2 id="bind">BIND</h2>
<p>BIND is a program that allows to concatenate the records of several code files into a single file. A filter function is available that can be used to copy only records of certain types. Used in this way, BIND can also be used to split a code file into several files.</p>
<p>The general syntax of BIND is</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>    BIND <span class="kw">&lt;</span>source file(s<span class="kw">)&gt;</span> <span class="kw">&lt;</span>target file<span class="kw">&gt;</span> [options]</span></code></pre></div>
<p>Just like AS, BIND regards all command line arguments that do not start with a <code>+</code>, <code>-</code> or <code>/</code> as file specifications, of which the last one must designate the destination file. All other file specifications name sources, which may again contain wildcards.</p>
<p>Currently, BIND defines only one command line option:</p>
<ul>
<li><code>f &lt;Header[,Header]&gt;</code>: sets a list of record headers that should be copied. Records with other header IDs will not be copied. Without such an option, all records will be copied. The headers given in the list correspond to the <code>HeaderID</code> field of the record structure described in <a href="#code-files">Code Files</a>. Individual headers in this list are separated with commas.</li>
</ul>
<p>For example, to filter all MCS-51 code out of a code file, use BIND in the following way:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>    BIND <span class="kw">&lt;</span>source name<span class="kw">&gt;</span> <span class="kw">&lt;</span>target name<span class="kw">&gt;</span> -f $31</span></code></pre></div>
<p>If a file name misses an extension, the extension <code>P</code> will be added automatically.</p>
<h2 id="p2hex">P2HEX</h2>
<p>P2HEX is an extension of BIND. It has all command line options of BIND and uses the same conventions for file names. In contrary to BIND, the target file is written as a Hex file, i.e. as a sequence of lines which represent the code as ASCII hex numbers.</p>
<p>P2HEX knows nine different target formats, which can be selected via the command line parameter <code>F</code>:</p>
<ul>
<li>Motorola S-Records (<code>-F Moto</code>)</li>
<li>MOS Hex (<code>-F MOS</code>)</li>
<li>Intel Hex (Intellec-8, <code>-F Intel</code>)</li>
<li>16-Bit Intel Hex (MCS-86, <code>-F Intel16</code>)</li>
<li>32-Bit Intel Hex (<code>-F Intel32</code>)</li>
<li>Tektronix Hex (<code>-F Tek</code>)</li>
<li>Texas Instruments DSK (<code>\-F DSK</code>)</li>
<li>Atmel AVR Generic (<code>-F Atmel</code>, see <a href="#fn42" class="footnote-ref" id="fnref42" role="doc-noteref"><sup>42</sup></a>)</li>
<li>Lattice Mico8 prom_init (<code>-F Mico8</code>)</li>
<li>C arrays, for inclusion into C(++) source files (<code>-F C</code>)</li>
</ul>
<p>If no target format is explicitly specified, P2HEX will automatically choose one depending in the processor type: S-Records for Motorola CPUs, Hitachi, and TLCS-900, MOS for 65xx/MELPS, DSK for the 16 bit signal processors from Texas, Atmel Generic for the AVRs, and Intel Hex for the rest. Depending on the start addresses width, the S-Record format will use Records of type 1, 2, or 3, however, records in one group will always be of the same type. This automatism can be partially suppressed via the command line option</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>    -M <span class="kw">&lt;</span>1<span class="kw">|</span>2<span class="kw">|3&gt;</span></span></code></pre></div>
<p>A value of 2 resp. 3 assures that that S records with a minimum type of 2 resp. 3 will be used, while a value of 1 corresponds to the full automatism.</p>
<p>Normally, the AVR format always uses an address length of 3 bytes. Some programs however do not like that...which is why there is a switch</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>    -avrlen <span class="kw">&lt;</span>2<span class="kw">|3&gt;</span></span></code></pre></div>
<p>that allows to reduce the address length to two bytes in case of emergency.</p>
<p>The Mico8 format is different from all the other formats in having no address fields - it is plain list of all instruction words in program memory. When using it, be sure that the used address range (as displayed e.g. by PLIS) starts at zero and is continuous.</p>
<p>The Intel, MOS and Tektronix formats are limited to 16 bit addresses, the 16-bit Intel format reaches 4 bits further. Addresses that are to long for a given format will be reported by P2HEX with a warning; afterwards, they will be truncated (!).</p>
<p>For the PIC microcontrollers, the switch</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>    -m <span class="kw">&lt;</span>0...3<span class="kw">&gt;</span></span></code></pre></div>
<p>allows to generate the three different variants of the Intel Hex format. Format 0 is INHX8M which contains all bytes in a Lo-Hi-Order. Addresses become double as large because the PICs have a word-oriented address space that increments addresses only by one per word. This format is also the default. With Format 1 (INHX16M), bytes are stored in their natural order. This is the format Microchip uses for its own programming devices. Format 2 (INHX8L) resp. 3 (INHX8H) split words into their lower resp. upper bytes. With these formats, P2HEX has to be called twice to get the complete information, like in the following example:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>    p2hex test <span class="at">-m</span> 2</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">rename</span> test.hex test.obl</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>    p2hex test <span class="at">-m</span> 3</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">rename</span> test.hex test.obh</span></code></pre></div>
<p>For the Motorola format, P2HEX additionally uses the S5 record type mentioned in <a href="#fn43" class="footnote-ref" id="fnref43" role="doc-noteref"><sup>43</sup></a>. This record contains the number of data records (S1/S2/S3) to follow. As some programs might not know how to deal with this record, one can suppress it with the option</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>    +5</span></code></pre></div>
<p>The C format is different in the sense that it always has to be selected explicitly. The output file is basically a complete piece of C or C++ code that contains the data as a list of C arrays. Additionally to the data itself, a list of descriptors is written that describes the start, length, and end address of each data block. The contents of these descriptors may be configured via the option</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>    -cformat <span class="kw">&lt;</span>format<span class="kw">&gt;</span></span></code></pre></div>
<p>Each letter in <code>format</code> defines an element of the descriptor:</p>
<ul>
<li>A <code>d</code> or <code>D</code> defines a pointer to the data itself. Usage of a lower or upper case letter defines whether lowercase or uppercase letters are used for hexadecimal constants.</li>
<li>An <code>s</code> or <code>S</code> defines the start address of the data, either as <em>unsigned</em> or <em>unsigned long</em>.</li>
<li>An <code>l</code> or <code>L</code> defines the length of the data, either as <em>unsigned</em> or <em>unsigned long</em>.</li>
<li>An <code>e</code> or <code>E</code> defines the end address of the data, specifically the last address used by the data, either as <em>unsigned</em> or <em>unsigned long</em>.</li>
</ul>
<p>In case a source file contains code record for different processors, the different hex formats will also show up in the target file - it is therefore strongly advisable to use the filter function.</p>
<p>Apart form this filter function, P2HEX also supports an address filter, which is useful to split the code into several parts (e.g. for a set of EPROMs):</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>    -r <span class="kw">&lt;</span>start address<span class="kw">&gt;</span>-<span class="kw">&lt;</span>end address<span class="kw">&gt;</span></span></code></pre></div>
<p>The start address is the first address in the window, and the end address is the last address in the window, <strong>not</strong> the first address that is out of the window. For example, to split an 8051 program into 4 2764 EPROMs, use the following commands:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>    p2hex <span class="kw">&lt;</span>source file<span class="kw">&gt;</span> eprom1 <span class="at">-f</span> $31 <span class="at">-r</span> $0000-$1fff</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>    p2hex <span class="kw">&lt;</span>source file<span class="kw">&gt;</span> eprom2 <span class="at">-f</span> $31 <span class="at">-r</span> $2000-$3fff</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>    p2hex <span class="kw">&lt;</span>source file<span class="kw">&gt;</span> eprom3 <span class="at">-f</span> $31 <span class="at">-r</span> $4000-$5fff</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>    p2hex <span class="kw">&lt;</span>source file<span class="kw">&gt;</span> eprom4 <span class="at">-f</span> $31 <span class="at">-r</span> $6000-$7fff</span></code></pre></div>
<p>It is allowed to specify a single dollar character or &#39;0x&#39; as start or stop address. This means that the lowest resp. highest address found in the source file shall be taken as start resp. stop address. The default range is &#39;0x-0x&#39;, i.e. all data from the source file is transferred.</p>
<p><strong>CAUTION!</strong> This type of splitting does not change the absolute addresses that will be written into the files! If the addresses in the individual hex files should rather start at 0, one can force this with the additional switch</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>    -a</span></code></pre></div>
<p>On the other hand, to move the addresses to a different location, one may use the switch</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>    -R <span class="kw">&lt;</span>value<span class="kw">&gt;</span></span></code></pre></div>
<p>The value given is an <em>offset</em>, i.e. it is added to the addresses given in the code file.</p>
<p>By using an offset, it is possible to move a file&#39;s contents to an arbitrary position. This offset is simply appended to a file&#39;s name, surrounded with parentheses. For example, if the code in a file starts at address 0 and you want to move it to address 1000 hex in the hex file, append <code>($1000)</code> to the file&#39;s name (without spaces!).</p>
<p>In case the source file(s) not only contain data for the code segment, the switch</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>    -segment <span class="kw">&lt;</span>name<span class="kw">&gt;</span></span></code></pre></div>
<p>allows to select the segment data is extracted from and converted to HEX format. The segment names are the same as for the <code>SEGMENT</code> pseudo instruction (<a href="#segment">SEGMENT</a>). The TI DSK is a special case since it has the ability to distinguish between data and code in one file. If TI DSK is the output format, P2HEX will automatically extract data from both segments if no segment was specified explicitly.
Similar to the <code>-r</code> option, the argument</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>    -d <span class="kw">&lt;</span>start<span class="kw">&gt;</span>-<span class="kw">&lt;</span>end<span class="kw">&gt;</span></span></code></pre></div>
<p>allows to designate the address range that should be written as data instead of code.</p>
<p>The option</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>    -e <span class="kw">&lt;</span>address<span class="kw">&gt;</span></span></code></pre></div>
<p>is valid for the DSK, Intel, and Motorola formats. Its purpose is to set the entry address that will be inserted into the hex file. If such a command line parameter is missing, P2HEX will search a corresponding entry in the code file. If even this fails, no entry address will be written to the hex file (DSK/Intel) or the field reserved for the entry address will be set to 0 (Motorola).</p>
<p>Unfortunately, one finds different statements about the last line of an Intel-Hex file in literature. Therefore, P2HEX knows three different variants that may be selected via the command-line parameter <code>i</code> and an additional number:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>    0  :00000001FF</span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>    1  :00000001</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>    2  :0000000000</span></code></pre></div>
<p>By default, variant 0 is used which seems to be the most common one.</p>
<p>If the target file name does not have an extension, an extension of <code>HEX</code> is supposed.</p>
<p>By default, P2HEX will print a maximum of 16 data bytes per line, just as most other tools that output Hex files. If you want to change this, you may use the switch</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>    -l <span class="op">&lt;</span>count<span class="op">&gt;</span></span></code></pre></div>
<p>The allowed range of values goes from 2 to 254 data bytes; odd values will implicitly be rounded down to an even count.</p>
<p>In most cases, the temporary code files generated by AS are not of any further need after P2HEX has been run. The command line option</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>    -k</span></code></pre></div>
<p>allows to instruct P2HEX to erase them automatically after conversion.</p>
<p>In contrast to BIND, P2HEX will not produce an empty target file if only one file name (i.e. the target name) has been given. Instead, P2HEX will use the corresponding code file. Therefore, a minimal call in the style of</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>    P2HEX <span class="kw">&lt;</span>name<span class="kw">&gt;</span></span></code></pre></div>
<p>is possible, to generate <code>&lt;name&gt;.hex</code> out of <code>&lt;name&gt;.p</code>.</p>
<h2 id="p2bin">P2BIN</h2>
<p>P2BIN works similar to P2HEX and offers the same options (except for the a and i options that do not make sense for binary files), however, the result is stored as a simple binary file instead of a hex file. Such a file is for example suitable for programming an EPROM.</p>
<p>P2BIN knows three additional options to influence the resulting binary file:</p>
<ul>
<li><p><code>l &lt;8 bit number&gt;</code>: sets the value that should be used to fill unused memory areas. By default, the value $ff is used. This value assures that every half-way intelligent EPROM burner will skip these areas. This option allows to set different values, for example if you want to generate an image for the EPROM versions of MCS-48 microcontrollers (empty cells of their EPROM array contain zeroes, so $00 would be the correct value in this case).</p></li>
<li><p><code>s</code>: commands the program to calculate a checksum of the binary file. This sum is printed as a 32-bit value, and the two&#39;s complement of the least significant bit will be stored in the file&#39;s last byte. This way, the modulus- 256-sum of the file will become zero.</p></li>
<li><p><code>m</code>: is designed for the case that a CPU with a 16- or 32-bit data bus is used and the file has to be split for several EPROMs. The argument may have the following values:</p>
<ul>
<li><code>ALL</code>: copy everything</li>
<li><code>ODD</code>: copy all bytes with an odd address</li>
<li><code>EVEN</code>: copy all bytes with an even address</li>
<li><code>BYTE0...BYTE3</code>: copy only bytes with an address of <code>4n+0 ... 4n+3</code></li>
<li><code>WORD0, WORD1</code>: copy only the lower resp. upper 16- bit word of a 32-bit word</li>
</ul></li>
</ul>
<p>To avoid confusions: If you use this option, the resulting binary file will become smaller because only a part of the source will be copied. Therefore, the resulting file will be smaller by a factor of 2 or 4 compared to <code>ALL</code>. This is just natural...</p>
<p>In case the code file does not contain an entry address, one may set it via the <code>-e</code> command line option just like with P2HEX. Upon request, P2BIN prepends the resulting image with this address. The command line option</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode dosbat"><code class="sourceCode dosbat"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>    -S</span></code></pre></div>
<p>activates this function. It expects a numeric specification ranging from 1 to 4 as parameter which specifies the length of the address field in bytes. This number may optionally be prepended wit a <code>L</code> or <code>B</code> letter to set the endian order of the address. For example, the specification <code>B4</code> generates a 4 byte address in big endian order, while a specification of <code>L2</code> or simply <code>2</code> creates a 2 byte address in little endian order.</p>
<h2 id="as2msg">AS2MSG</h2>
<p>AS2MSG is not a tool in the real sense, it is a filter that was designed to simplify the work with the assembler for (fortunate) users of Borland Pascal 7.0. The DOS IDEs feature a &#39;tools&#39; menu that can be extended with own programs like AS. The filter allows to directly display the error messages paired with a line specification delivered by AS in the editor window. A new entry has to be added to the tools menu to achieve this (Options/Tools/New). Enter the following values:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>    - Title<span class="op">:</span> <span class="op">~</span>m<span class="op">~</span>acro assembler</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>    - Program path<span class="op">:</span> AS</span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>    - Command line<span class="op">:</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>        -E <span class="op">!</span><span class="dv">1</span> <span class="op">$</span>EDNAME <span class="op">$</span>CAP MSG<span class="op">(</span>AS2MSG<span class="op">)</span> <span class="op">$</span>NOSWAP <span class="op">$</span>SAVE ALL</span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>    - assign a hotkey if wanted <span class="op">(</span>e<span class="op">.</span>g<span class="op">.</span> Shift<span class="op">-</span>F7<span class="op">)</span></span></code></pre></div>
<p>The -E option assures that Turbo Pascal will not become puzzled by STDIN and STDERR.</p>
<p>I assume that AS and AS2MSG are located in a directory listed in the <code>PATH</code> variable. After pressing the appropriate hotkey (or selecting AS from the tools menu), as will be called with the name of the file loaded in the active editor window as parameter. The error messages generated during assembly are redirected to a special window that allows to browse through the errors. <code>Ctrl-Enter</code> jumps to an erroneous line. The window additionally contains the statistics AS prints at the end of an assembly. These lines obtain the dummy line number 1.</p>
<p><code>TURBO.EXE</code> (Real Mode) and <code>BP.EXE</code> (Protected Mode) may be used for this way of working with AS. I recommend however BP, as this version does not have to &#39;swap&#39; half of the DOS memory before before AS is called.</p>
<!-- markdownlint-enable MD030 -->

<!-- markdownlint-enable MD025 -->

<h1 id="error-messages">Error Messages</h1>
<!-- markdownlint-disable MD025 -->

<!-- markdownlint-disable MD030 -->

<p>Here is a list of all error messages emitted by AS. Each error message
is described by:</p>
<ul>
<li>the internal error number (it is displayed only if AS is started with the <code>-n</code> option)</li>
<li>the text of the error message</li>
<li>error type:
<ul>
<li>⚠️Warning: informs the user that a possible error was found, or that some inefficient binary code could be generated. The assembly process is not stopped.</li>
<li>⛔Error: an error was detected. The assembly process continues, but no binary code is emitted.</li>
<li>💀Fatal: unrecoverable error. The assembly process is terminated.</li>
</ul></li>
<li>reason of the error: the situation originating the error.</li>
<li>argument: a further explanation of the error message.</li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Code</th>
<th style="text-align: center;">Type</th>
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Argument</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">useless displacement</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">680x0, 6809 and COP8 CPUs: an address displacement of 0 was given. An address expression without displacement is generated, and a convenient number of NOPs are emitted to avoid phasing errors.</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">short addressing possible</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">680x0-, 6502 and 68xx CPUs: a given memory location can be reached using short addressing. A short addressing instruction is emitted, together with the required number of NOPs to avoid phasing errors.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">20</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">short jump possible</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">680x0- and 8086 CPUs can execute jumps using a short or long displacement. If a shorter jump was not explicitly requested, in the first pass room for the long jump is reserved. Then the code for the shorter jump is emitted, and the remaining space is filled with NOPs to avoid phasing errors.</td>
</tr>
<tr class="even">
<td style="text-align: center;">30</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">no sharefile created, SHARED ignored</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A <code>SHARED</code> directive was found, but on the command line no options were specified, to generate a shared file.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">40</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">FPU possibly cannot read this value (<code>&gt;=1E1000</code>)</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The BCD-floating point format used by the 680x0-FPU allows such a large exponent, but according to the latest datasheets, this cannot be fully interpreted. The corresponding word is assembled, but the associated function is not expected to produce the correct result.</td>
</tr>
<tr class="even">
<td style="text-align: center;">50</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">privileged instruction</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A Supervisor-mode directive was used, that was not preceded by an explicit <code>SUPMODE ON</code> directive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">60</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">distance of 0 not allowed for short jump (NOP created instead)</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A short jump with a jump distance equal to 0 is not allowed by 680x0 resp. COP8 processors, since the associated code word is used to identify long jump instruction. Instead of a jump instruction, AS emits a NOP</td>
</tr>
<tr class="even">
<td style="text-align: center;">70</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">symbol out of wrong segment</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The symbol used as an operand comes from an address space that cannot be addressed together with the given instruction</td>
</tr>
<tr class="odd">
<td style="text-align: center;">75</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">segment not accessible</td>
<td style="text-align: left;">The name of the inaccessible segment</td>
<td style="text-align: left;">The symbol used as an operand belongs to an address space that cannot be accessed with any of the segment registers of the 8086</td>
</tr>
<tr class="even">
<td style="text-align: center;">80</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">change of symbol values forces additional pass</td>
<td style="text-align: left;">name of the symbol that changed value.</td>
<td style="text-align: left;">A symbol changed value, with respect to previous pass. This warning is emitted only if the <code>-r</code> option is used.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">90</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">overlapping memory usage</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The analysis of the usage list shows that part of the program memory was used more than once. The reason can be an excessive usage of <code>ORG</code> directives.</td>
</tr>
<tr class="even">
<td style="text-align: center;">95</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">overlapping register usage</td>
<td style="text-align: left;">The offending argument</td>
<td style="text-align: left;">The instruction uses whole registers or parts thereof in a non-allowed way.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">100</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">none of the CASE conditions was true</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A <code>SWITCH...CASE</code> directive without <code>ELSECASE</code> clause was executed, and none of the <code>CASE</code> conditions was found to be true.</td>
</tr>
<tr class="even">
<td style="text-align: center;">110</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">page might not be addressable</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The symbol used as an operand was not found in the memory page defined by an <code>ASSUME</code> directive (ST6, 78(C)10).</td>
</tr>
<tr class="odd">
<td style="text-align: center;">120</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">register number must be even</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The CPU allows to concatenate only register pairs, whose start address is even (RR0, RR2, ..., only for Z8).</td>
</tr>
<tr class="even">
<td style="text-align: center;">130</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">obsolete instruction, usage discouraged</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The instruction used, although supported, was superseded by a new instruction. Future versions of the CPU could no more implement the old instruction.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">140</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">unpredictable execution of this instruction</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The addressing mode used for this instruction is allowed, however a register is used in such a way that its contents cannot be predicted after the execution of the instruction.</td>
</tr>
<tr class="even">
<td style="text-align: center;">150</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">localization operator senseless out of a section</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A prefixed must be used, so that it is explicitly referred to the local symbols used in the section. When the operator is used out of a section, there are no local symbols, because this operator is useless in this context.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">160</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">senseless instruction</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The instruction used has no meaning, or it can be substituted by an other instruction, shorter and more rapidly executed.</td>
</tr>
<tr class="even">
<td style="text-align: center;">170</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">unknown symbol value forces additional pass</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">AS expects a forward definition of a symbol, i.e. a symbol was used before it was defined. A further pass must be executed. This warning is emitted only if the <code>-r</code> option was used.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">180</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">address is not properly aligned</td>
<td style="text-align: left;">none.</td>
<td style="text-align: left;">An address was used that is not an exact multiple of the operand size. Although the CPU datasheet forbids this, the address could be stored in the instruction word, so AS simply emits a warning.</td>
</tr>
<tr class="even">
<td style="text-align: center;">190</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">I/O-address must not be used here</td>
<td style="text-align: left;">none.</td>
<td style="text-align: left;">The addressing mode or the address used are correct, but the address refers to the peripheral registers, and it cannot be used in this circumstance.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">200</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">possible pipelining effects</td>
<td style="text-align: left;">the register probably causing the problem.</td>
<td style="text-align: left;">A register is used in a series of instructions, so that a sequence of instructions probably does not generate the desired result. This usually happens when a register is used before its new content was effectively loaded in it.</td>
</tr>
<tr class="even">
<td style="text-align: center;">210</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">multiple use of address register in one instruction</td>
<td style="text-align: left;">the register used more than once.</td>
<td style="text-align: left;">A register used for the addressing is used once more in the same instruction, in a way that results in a modification of the register value. The resulting address does not have a well defined value.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">220</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">memory location is not bit addressable</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Via a <code>SFRB</code> statement, it was tried to declare a memory cell as bit addressable which is not bit addressable due to the 8051&#39;s architectural limits.</td>
</tr>
<tr class="even">
<td style="text-align: center;">230</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">stack is not empty</td>
<td style="text-align: left;">the name of the stack and its remaining depth</td>
<td style="text-align: left;">At the end of a pass, a stack defined by the program is not empty.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">240</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">NUL character in string, result is undefined</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A string constant contains a NUL character. Though this works with the Pascal version, it is a problem for the C version of AS since C itself terminates strings with a NUL character. i.e. the string would have its end for C just at this point...</td>
</tr>
<tr class="even">
<td style="text-align: center;">250</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">instruction crosses page boundary</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The parts of a machine statement partially lie on different pages. As the CPU&#39;s instruction counter does not get incremented across page boundaries, the processor would fetch at runtime the first byte of the old page instead of the instruction&#39;s following byte; the program would execute incorrectly.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">260</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">range overflow</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A numeric value was out of the allowed range. AS brought the value back into the allowed range by truncating upper bits, but it is not guaranteed that meaningful and correct code is generated by this.</td>
</tr>
<tr class="even">
<td style="text-align: center;">270</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">negative argument for DUP</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The repetition argument of a DUP directive was smaller than 0. Analogous to a count of exactly 0, no data is stored.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">280</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">single X operand interpreted as indexed and not implicit addressing</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A single X operand may be interpreted either as register X or x-indexed addressing with zero displacement, since Motorola does not specify this variant. AS chooses the latter, which may not be the desired one.</td>
</tr>
<tr class="even">
<td style="text-align: center;">300</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">bit number will be truncated</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">This instruction only operates on byte resp. long word operands. bit numbers beyond 7 resp. 31 will be treated modulo-8 resp. modulo-32 by the CPU.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">310</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">invalid register pointer value</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Valid values for the RP register range from 0x00 to 0x70 resp. 0xf0, because all other areas are unused on the Z8.</td>
</tr>
<tr class="even">
<td style="text-align: center;">320</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">macro argument redefined</td>
<td style="text-align: left;">name of the macro parameter</td>
<td style="text-align: left;">A macro parameter was assigned two or more different values. This may happen by usage of keyword arguments. The last argument is actually used.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">330</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">deprecated instruction</td>
<td style="text-align: left;">the instruction that should be used instead.</td>
<td style="text-align: left;">This instruction is deprecated and should not be used any more in new programs.</td>
</tr>
<tr class="even">
<td style="text-align: center;">340</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">source operand is longer or same size as destination operand</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The source operand&#39;s size is larger than the destination operand&#39;s size, expressed in bits. Sign or zero extension does not make sense with these arguments. See the CPU&#39;s reference manual for its behaviour in this situation.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">350</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">TRAP number represents valid instruction</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A TRAP with this number uses the same machine code as a machine instruction supported by the CPU.</td>
</tr>
<tr class="even">
<td style="text-align: center;">360</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">Padding added</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The amount of bytes placed in memory is odd; one half of the last 16 bit word remains unused.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">370</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">register number wraparound</td>
<td style="text-align: left;">the argument holding the register count</td>
<td style="text-align: left;">The start register number plus the count of registers results in a last register beyond the end of the register bank.</td>
</tr>
<tr class="even">
<td style="text-align: center;">380</td>
<td style="text-align: center;">⚠️Warning</td>
<td style="text-align: left;">using indexed instead of indirect addressing</td>
<td style="text-align: left;">the argument holding the indirect addressing expression</td>
<td style="text-align: left;">Indirect addressing is not allowed at this place. Instead, indexed addressing with a dummy displacement of zero will be used.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1000</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">symbol double defined</td>
<td style="text-align: left;">the name of the offending symbol, and the line number where it was defined for the first time, according to the symbol table.</td>
<td style="text-align: left;">A new value is assigned to a symbol, using a label or a <code>EQU, PORT, SFR, LABEL, SFRB</code> or <code>BIT</code> instruction: however this can be done only using <code>SET/EVAL</code>.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1010</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">symbol undefined</td>
<td style="text-align: left;">the name of the undefined symbol.</td>
<td style="text-align: left;">A symbol is still not defined in the symbol table, also after a second pass.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1020</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid symbol name</td>
<td style="text-align: left;">the wrong symbol</td>
<td style="text-align: left;">A symbol does not fulfill the requirements that symbols must have to be considered valid by AS. Please pay attention that more stringent syntax rules exist for macros and function parameters.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1090</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid format</td>
<td style="text-align: left;">the known formats for this command</td>
<td style="text-align: left;">The instruction format used does not exist for this instruction.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1100</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">useless attribute</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The instruction (processor or pseudo) cannot be used with a point-suffixed attribute.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1105</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">attribute may only be one character long</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The attribute following a point after an instruction must not be longer or shorter than one character.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1107</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">undefined attribute</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">This instruction uses an invalid attribute.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1110</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">wrong number of operands</td>
<td style="text-align: left;">the expected number of arguments resp. operands</td>
<td style="text-align: left;">The number of arguments issued for the instruction (processor or pseudo) does not conform with the accepted number of operands.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1112</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">failed splitting argument into parts</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">For some targets (e.g. DSP56000), the comma-separated have to be split into individual operands, which failed.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1115</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">wrong number of operations</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The number of options given with this command is not correct.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1120</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">addressing mode must be immediate</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The instruction can be used only with immediate operands (preceded by <code>#</code>).</td>
</tr>
<tr class="even">
<td style="text-align: center;">1130</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid operand size</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Although the operand is of the right type, it does not have the correct length (in bits).</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1131</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">conflicting operand sizes</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The operands used have different length (in bits)</td>
</tr>
<tr class="even">
<td style="text-align: center;">1132</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">undefined operand size</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">It is not possible to estimate, from the opcode and from the operands, the size of the operand (a trouble with 8086 assembly). You must define it with a <code>BYTE or WORD</code> <code>PTR</code> prefix.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1133</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expected integer or string, but got floating point number</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">A floating point number cannot be used as argument at this place.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1134</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expected integer, but got floating point number</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">A floating point number cannot be used as argument at this place.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1136</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expected floating point number, but got string</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">A string cannot be used as argument at this place.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1137</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">operand type mismatch</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The two arguments of an operator are not of same data type (integer/float/string).</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1138</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expected string, but got integer</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">An integer cannot be used as argument at this place.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1139</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expected string, but got floating point number</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">An floating point number cannot be used as argument at this place.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1140</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">too many arguments</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">No more than 20 arguments can be given to any instruction</td>
</tr>
<tr class="even">
<td style="text-align: center;">1141</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expected integer, but got string</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">A string cannot be used as argument at this place.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1142</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expected integer or floating point number, but got string</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">A string cannot be used as argument at this place.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1143</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expected string</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">Only a string (enclosed in single quotes) may be used as argument at this place.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1144</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expected integer</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">Only an integer number may be used as argument at this place.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1145</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expected integer, floating point number or string but got register</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">A register symbol may not be used as argument at this place.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1146</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expected integer or string</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">A floating point number or register symbol may not be used as argument at this place.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1147</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expected register</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">Only an register may be used as argument at this place.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1148</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">register symbol for different target</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">The used register symbol was defined for a target different from the current one and is not compatible.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1200</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unknown instruction</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An instruction was used that is neither an AS instruction, nor a known machine instruction for the current processor type.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1300</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">number of opening/closing brackets does not match</td>
<td style="text-align: left;">the wrong expression</td>
<td style="text-align: left;">The expression parser found an expression enclosed by parentheses, where the number of opening and closing parentheses does not match.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1310</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">division by 0</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An expression on the right side of a division or modulus operation was found to be equal to 0.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1315</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">range underflow</td>
<td style="text-align: left;">the value of the word and the allowed minimum (in most cases, maybe I will complete this one day...)</td>
<td style="text-align: left;">An integer word underflowed the allowed range.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1320</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">range overflow</td>
<td style="text-align: left;">the value of the world, and the allowed maximum (in most cases, maybe I will complete this one day...)</td>
<td style="text-align: left;">An integer word overflowed the allowed range.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1322</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">not a power of two</td>
<td style="text-align: left;">The value in question</td>
<td style="text-align: left;">only powers of two (1, 2, 4, 8,...) are allowed at this place.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1325</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">address is not properly aligned</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The given address does not correspond with the size needed by the data transfer, i.e., it is not an integral multiple of the operand size. Not all processor types can use unaligned data.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1330</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">distance too big</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The displacement used for an address is too large.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1340</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">short addressing not allowed</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The address of the operand is outside of the address space that can be accessed using short-addressing mode.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1350</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">addressing mode not allowed here</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">the addressing mode used, although usually possible, cannot be used here.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1351</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">address must be even</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">At this point, only even addresses are allowed, since the low order bits are used for other purposes or are reserved.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1352</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">address must be aligned</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">At this point, only aligned (i.e. a multiple of 2, 4, 8...) addresses are allowed, since the low order bits are used for other purposes or are reserved.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1355</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">addressing mode not allowed in parallel operation</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The addressing mode(s) used are allowed in sequential, but not in parallel instructions</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1360</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">undefined condition</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The branch condition used for a conditional jump does not exist.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1365</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">incompatible conditions</td>
<td style="text-align: left;">the condition where the incompatibility was detected.</td>
<td style="text-align: left;">The used combination of conditions is not possible in a single instruction.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1366</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unknown flag</td>
<td style="text-align: left;">the argument using the flag in question</td>
<td style="text-align: left;">The given flag does not exist.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1367</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">duplicate flag</td>
<td style="text-align: left;">the argument duplicating the flag</td>
<td style="text-align: left;">The given flag has already been used in the list of flags.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1368</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unknown interrupt</td>
<td style="text-align: left;">the argument using the interrupt in question</td>
<td style="text-align: left;">The given interrupt does not exist.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1369</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">duplicate interrupt</td>
<td style="text-align: left;">the argument duplicating the interrupt</td>
<td style="text-align: left;">The given interrupt has already been used in the list of interrupt.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1370</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">jump distance too big</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">the jump instruction and destination are too apart to execute the jump with a single step</td>
</tr>
<tr class="even">
<td style="text-align: center;">1375</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">jump distance is odd</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Since instruction must only be located at even addresses, the jump distance between two instructions must always be even, and the LSB of the jump distance is used otherwise. This issue was not verified here. The reason is usually the presence of an odd number of data in bytes or a wrong <code>ORG</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1376</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">skip target mismatch</td>
<td style="text-align: left;">the given (intended) jump target</td>
<td style="text-align: left;">The given branch target is not the address the processor would jump to if the skip instruction were executed.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1380</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid argument for shifting</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">only a constant or a data register can be used for defining the shift size. (only for 680x0)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1390</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">operand must be in range 1..8</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">constants for shift size or <code>ADDQ</code> argument can be only within the 1..8 range (only for 680x0)</td>
</tr>
<tr class="even">
<td style="text-align: center;">1400</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">shift amplitude too big</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">(no more used)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1410</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid register list</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The register list argument of <code>MOVEM</code> or <code>FMOVEM</code> has a wrong format (only for 680x0)</td>
</tr>
<tr class="even">
<td style="text-align: center;">1420</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid addressing mode for CMP</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The operand combination used with the <code>CMP</code> instruction is not allowed (only for 680x0)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1430</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid CPU type</td>
<td style="text-align: left;">the unknown processor type</td>
<td style="text-align: left;">The processor type used as argument for <code>CPU</code> command is unknown to AS.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1431</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid FPU type</td>
<td style="text-align: left;">the unknown co-processor type</td>
<td style="text-align: left;">The co-processor type used as argument for <code>FPU</code> command is unknown to AS.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1432</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid PMMU type</td>
<td style="text-align: left;">the unknown MMU type</td>
<td style="text-align: left;">The MMU type used as argument for <code>PMMU</code> command is unknown to AS.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1440</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid control register</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The control register used by a <code>MOVEC</code> is not (yet) available for the processor defined by the <code>CPU</code> command.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1445</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid register</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The register used, although valid, cannot be used in this context.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1446</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">register(s) listed more than once</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A register appears more than once in the list of registers to be saved or restored.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1447</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">register bank mismatch</td>
<td style="text-align: left;">the register in question</td>
<td style="text-align: left;">An address expression uses registers from different banks.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1448</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">undefined register length</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">Registers of different size may be used at this place, and the register length cannot be deduced from the address alone.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1449</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid operation on register</td>
<td style="text-align: left;">the register in question</td>
<td style="text-align: left;">This operation may not be applied to this register, e.g. because the register is read-only or write-only.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1450</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">RESTORE without SAVE</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A <code>RESTORE</code> command was found, that cannot be coupled with a corresponding <code>SAVE</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1460</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">missing RESTORE</td>
<td style="text-align: left;">none.</td>
<td style="text-align: left;">After the assembling pass, a <code>SAVE</code> command was missing.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1465</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unknown macro control instruction</td>
<td style="text-align: left;">the dubious option.</td>
<td style="text-align: left;">A macro option parameter is unknown to AS.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1470</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">missing ENDIF/ENDCASE</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">after the assembling, some of the <code>IF</code>- or <code>CASE</code>- constructs were found without the closing command</td>
</tr>
<tr class="even">
<td style="text-align: center;">1480</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid IF-structure</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The command structure in a <code>IF</code>- or <code>SWITCH</code>- sequence is wrong.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1483</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">section name double defined</td>
<td style="text-align: left;">the multiple-defined name</td>
<td style="text-align: left;">In this program module a section with the same name still exists.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1484</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unknown section</td>
<td style="text-align: left;">the unknown name</td>
<td style="text-align: left;">In the current scope, there are no sections with this name</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1485</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">missing ENDSECTION</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Not all the sections were properly closed.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1486</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">wrong ENDSECTION</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The given <code>ENDSECTION</code> does not refer to the most deeply nested one.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1487</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">ENDSECTION without SECTION</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An <code>ENDSECTION</code> command was found, but the associated section was not defined before.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1488</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unresolved forward declaration</td>
<td style="text-align: left;">the name of the unresolved symbol, plus the position of the forward declaration in the source.</td>
<td style="text-align: left;">A symbol declared with a <code>FORWARD</code> or <code>PUBLIC</code> statement could not be resolved.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1489</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">conflicting FORWARD  ↔︎ PUBLIC-declaration</td>
<td style="text-align: left;">the name of the symbol.</td>
<td style="text-align: left;">A symbol was defined both as public and private.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1490</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">wrong numbers of function arguments</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The number of arguments used for referencing a function does not match the number of arguments defined in the function definition.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1495</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unresolved literals (missing LTORG)</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">At the end of the program, or just before switching to another processor type, unresolved literals still remain.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1500</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">instruction not allowed on</td>
<td style="text-align: left;">The processor variants that would support this instruction.</td>
<td style="text-align: left;">Although the instruction is correct, it cannot be used with the selected member of the CPU family.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1501</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">FPU instructions are not enabled</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">FPU instruction set extensions must be enabled to use this instruction.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1502</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">PMMU instructions are not enabled</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">PMMU instruction set extensions must be enabled to use this instruction.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1503</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">full PMMU instruction set is not enabled</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">This instruction is only contained in the 68851&#39;s instruction set, not in the reduced instruction set of the integrated PMMU.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1504</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">Z80 syntax was not allowed</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">This instruction is only allowed if Z80 syntax for 8080/8085 instructions has been enabled.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1505</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">addressing mode not allowed on</td>
<td style="text-align: left;">The processor variants that would support this addressing mode.</td>
<td style="text-align: left;">Although the addressing mode used is correct, it cannot be used with the selected member of the CPU family.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1506</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">not allowed in exclusive Z80 syntax mode</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">This instruction is no longer allowed if exclusive Z80 syntax mode for 8080/8085 instructions has been set.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1507</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">FPU instruction not supported on ...</td>
<td style="text-align: left;">The instruction in question</td>
<td style="text-align: left;">Although this FPU instruction exists, it cannot be used on the selected type of FPU.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1508</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">Custom instructions are not enabled</td>
<td style="text-align: left;">The instruction in question</td>
<td style="text-align: left;">Custom instruction set extensions must be enabled to use this instruction.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1510</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid bit position</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Either the number of bits specified is not allowed, or the command is not completely specified.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1520</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">only ON/OFF allowed</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">This pseudo command accepts as argument either <code>ON</code> or <code>OFF</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;">1530</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">stack is empty or undefined</td>
<td style="text-align: left;">the name of the stack in question</td>
<td style="text-align: left;">It was tried to access a stack via a <code>POPV</code> instruction that was either never defined or already emptied.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1540</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">not exactly one bit set</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Not exactly one bit was set in a mask passed to the <code>BITPOS</code> function.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1550</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">ENDSTRUCT without STRUCT</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An <code>ENDSTRUCT</code> instruction was found though there is currently no structure definition in progress.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1551</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">open structure definition</td>
<td style="text-align: left;">the innermost, unfinished structure definition</td>
<td style="text-align: left;">After end of assembly, not all <code>STRUCT</code> instructions have been closed with appropriate <code>ENDSTRUCT</code>s.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1552</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">wrong ENDSTRUCT</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">the name parameter of an <code>ENDSTRUCT</code> instruction does not correspond to the innermost open structure definition.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1553</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">phase definition not allowed in structure definition</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">What should I say about that? <code>PHASE</code> inside a record simply does not make sense and only leads to confusion...</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1554</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid <code>STRUCT</code> directive</td>
<td style="text-align: left;">the unknown directive</td>
<td style="text-align: left;">Only <code>EXTNAMES</code>, <code>NOEXTNAMES</code>, <code>DOTS</code>, and <code>NODOTS</code> are allowed as directives of a <code>STRUCT</code> statement.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1555</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">structure re-defined</td>
<td style="text-align: left;">the name of the structure</td>
<td style="text-align: left;">A structure of this name has already been defined.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1556</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unresolvable structure element reference</td>
<td style="text-align: left;">the name of the element itself and the referenced one</td>
<td style="text-align: left;">An element in a structure references to another element, however this referenced element was not defined or itself has an unresolvable reference.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1557</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">duplicate structure element</td>
<td style="text-align: left;">name of the element</td>
<td style="text-align: left;">The structure already contains an element of this name.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1560</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">instruction is not repeatable</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">This machine instruction cannot be repeated via a <code>RPT</code> construct.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1600</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unexpected end of file</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">It was tried to read past the end of a file with a <code>BINCLUDE</code> statement.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1700</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">ROM-offset must be in range 0..63</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The ROM table of the 680x0 coprocessor has only 64 entries.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1710</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid function code</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The only function code arguments allowed are SFC, DFC, a data register, or a constant in the interval of 0..15 (only for 680x0 MMU).</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1720</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid function code mask</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Only a number in the interval 0..15 can be used as function code mask (only for 680x0 MMU)</td>
</tr>
<tr class="even">
<td style="text-align: center;">1730</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid MMU register</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The MMU does not have a register with this name (only for 680x0 MMU).</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1740</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">level must be in range 0..7</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The level for <code>PTESTW</code> and <code>PTESTR</code> must be a constant in the range of 0...7 (only for 680x0 MMU).</td>
</tr>
<tr class="even">
<td style="text-align: center;">1750</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid bit mask</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The bit mask used for a bit field command has a wrong format (only for 680x0).</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1760</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid register pair</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The register here defined cannot be used in this context, or there is a syntactic error (only for 680x0).</td>
</tr>
<tr class="even">
<td style="text-align: center;">1800</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">open macro definition</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An incomplete macro definition was found. Probably an <code>ENDM</code> statement is missing.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1801</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">IRP without ENDM</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An incomplete IRP block was found. Probably an <code>ENDM</code> statement is missing.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1802</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">IRPC without ENDM</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An incomplete IRPC block was found. Probably an <code>ENDM</code> statement is missing.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1803</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">REPT without ENDM</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An incomplete REPT block was found. Probably an <code>ENDM</code> statement is missing.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1804</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">WHILE without ENDM</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An incomplete WHILE block was found. Probably an <code>ENDM</code> statement is missing.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1805</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">EXITM not called from within macro</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;"><code>EXITM</code> is designed to terminate a macro expansion. This instruction only makes sense within macros and an attempt was made to call it in the absence of macros.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1810</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">more than 10 macro parameters</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A macro cannot have more than 10 parameters</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1811</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">keyword argument not defined in macro</td>
<td style="text-align: left;">used keyword resp. macro parameter</td>
<td style="text-align: left;">a keyword argument referred to a parameter the called macro does not provide.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1812</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">positional argument no longer allowed after keyword argument</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">position and keyword arguments may be mixed in one macro call, however only keyword arguments are allowed after the first keyword argument.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1815</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">macro double defined</td>
<td style="text-align: left;">the multiply defined macro name.</td>
<td style="text-align: left;">A macro was defined more than once in a program section.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1820</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expression must be evaluatable in first pass</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The command used has an influence on the length of the emitted code, so that forward references cannot be resolved here.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1830</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">too many nested IFs</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">(no more implemented)</td>
</tr>
<tr class="even">
<td style="text-align: center;">1840</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">ELSEIF/ENDIF without IF</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A <code>ELSEIF</code>- or <code>ENDIF</code>- command was found, that is not preceded by an <code>IF</code>- command.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1850</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">nested / recursive macro call</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">(no more implemented)</td>
</tr>
<tr class="even">
<td style="text-align: center;">1860</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unknown function</td>
<td style="text-align: left;">The name of the unknown function</td>
<td style="text-align: left;">The function invoked was not defined before.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1870</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">function argument out of definition range</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The argument does not belong to the allowed argument range associated to the referenced function.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1880</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">floating point overflow</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Although the argument is within the range allowed to the function arguments, the result is not valid</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1890</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid value pair</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The base-exponent pair used in the expression cannot be computed</td>
</tr>
<tr class="even">
<td style="text-align: center;">1900</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">instruction must not start on this address</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">No jumps can be performed by the selected CPU from this address.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1905</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid jump target</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">No jumps can be performed by the selected CPU to this address.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1910</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">jump target not on same page</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Jump command and destination must be in the same memory page.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1911</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">jump target not in same section</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Jump command and destination must be in the same (64K) memory section.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1920</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">code overflow</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An attempt was made to generate more than 1024 code or data bytes in a single memory page.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1925</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">address overflow</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The address space for the processor type actually used was filled beyond the maximum allowed limit.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1930</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">constants and placeholders cannot be mixed</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Instructions that reserve memory, and instructions that define constants cannot be mixed in a single pseudo instruction.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1940</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">code must not be generated in structure definition</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">a <code>STRUCT</code> construct is only designed to describe a data structure and not to create one; therefore, no instructions are allowed that generate code.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1950</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">parallel construct not possible here</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Either these instructions cannot be executed in parallel, or they are not close enough each other, to do parallel execution.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1960</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid segment</td>
<td style="text-align: left;">The name of the segment used.</td>
<td style="text-align: left;">The referenced segment cannot be used here.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1961</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unknown segment</td>
<td style="text-align: left;">The name of the segment used</td>
<td style="text-align: left;">The segment referenced with a <code>SEGMENT</code> command does not exist for the CPU used.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1962</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unknown segment register</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The segment referenced here does not exist (8086 only)</td>
</tr>
<tr class="even">
<td style="text-align: center;">1970</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid string</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The string has an invalid format.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1980</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid register name</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The referenced register does not exist, or it cannot be used here.</td>
</tr>
<tr class="even">
<td style="text-align: center;">1985</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid argument</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The command used cannot be performed with the <code>REP</code>-prefix.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1990</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">indirect mode not allowed</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Indirect addressing cannot be used in this way</td>
</tr>
<tr class="even">
<td style="text-align: center;">1995</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">not allowed in current segment</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">(no more implemented)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1996</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">not allowed in maximum mode</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">This register can be used only in minimum mode</td>
</tr>
<tr class="even">
<td style="text-align: center;">1997</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">not allowed in minimum mode</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">This register can be used only in maximum mode</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2000</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">execution packet crosses address boundary</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An execution packet must not cross a 32-byte address boundary</td>
</tr>
<tr class="even">
<td style="text-align: center;">2001</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">multiple use of same execution unit</td>
<td style="text-align: left;">the name of the execution unit</td>
<td style="text-align: left;">One of the CPU&#39;s execution units was used more than once in an execution packet</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2002</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">multiple long read operations</td>
<td style="text-align: left;">one of the functional units executing a long read</td>
<td style="text-align: left;">An execution packet contains more than one long read operation, which is not allowed</td>
</tr>
<tr class="even">
<td style="text-align: center;">2003</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">multiple long write operations</td>
<td style="text-align: left;">one of the functional units executing a long write</td>
<td style="text-align: left;">An execution packet contains more than one long write operation, which is not allowed</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2004</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">long read with write operation</td>
<td style="text-align: left;">one of the execution units executing the conflicting operations</td>
<td style="text-align: left;">An execution packet contains both a long read and a write operation, which is not allowed.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2005</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">too many reads of one register</td>
<td style="text-align: left;">the name of the register referenced too often</td>
<td style="text-align: left;">The same register was referenced more than four times in the same execution packet.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2006</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">overlapping destinations</td>
<td style="text-align: left;">the name of the register in question</td>
<td style="text-align: left;">The same register was written more than one time in the same instruction packet, which is not allowed.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2008</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">too many absolute branches in one execution packet</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An execution packet contains more than one direct branch, which is not allowed.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2009</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">instruction cannot be executed on this unit</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">This instruction cannot be executed on this functional unit.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2010</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid escape sequence</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The special character defined using a backslash sequence is not defined</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2020</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid combination of prefixes</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The prefix combination here defined is not allowed, or it cannot be translated into binary code</td>
</tr>
<tr class="even">
<td style="text-align: center;">2030</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">constants cannot be redefined as variables</td>
<td style="text-align: left;">the name of the symbol in question</td>
<td style="text-align: left;">A symbol that has once been declared as constant with <code>EQU</code> must not be modified afterwards with <code>SET</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2035</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">variables cannot be redefined as constants</td>
<td style="text-align: left;">the name of the symbol in question</td>
<td style="text-align: left;">A symbol that has once been declared as variable with <code>SET</code> must not be redeclared afterwards as constant (e.g. with <code>EQU</code>).</td>
</tr>
<tr class="even">
<td style="text-align: center;">2040</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">structure name missing</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A structure&#39;s definition lacks the identifier name for the new structure</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2050</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">empty argument</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Empty strings must not be used in the argument list for this statement</td>
</tr>
<tr class="even">
<td style="text-align: center;">2060</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unimplemented instruction</td>
<td style="text-align: left;">the instruction that was used</td>
<td style="text-align: left;">The used machine instruction is principally known to the assembler, however, it is currently not implemented, du to lack of documentation from the processor manufacturer.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2070</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unnamed structure is not part of another structure</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An unnamed structure or union always must be part of another structure or union.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2080</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">STRUCT ended by ENDUNION</td>
<td style="text-align: left;">name of the structure (if available)</td>
<td style="text-align: left;">ENDUNION may only be used to finalize the definition of a union and not of a structure.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2090</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">Memory address mot on active memory page</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The target address is not within the page that is currently addressable via the page register.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2100</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unknown macro expansion argument</td>
<td style="text-align: left;">the unknown argument</td>
<td style="text-align: left;">An argument to <code>MACEXP</code> could not be interpreted.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2105</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">too many macro expansion arguments</td>
<td style="text-align: left;">the argument that busted the limit</td>
<td style="text-align: left;">The number macro expansion arguments exceeds the allowed limit.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2110</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">contradicting macro expansion specifications</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">A specification about macro expansion and its precise opposite may not be used in the same <code>MACEXP</code> instruction.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2130</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">expected error did not occur</td>
<td style="text-align: left;">The error that was expected</td>
<td style="text-align: left;">An error or warning announced via <code>EXPECT</code> did not occur in the instruction block terminated via <code>ENDEXPECT</code>.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2140</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">nesting of EXPECT/ENDEXPECT not allowed</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">Code blocks framed via <code>EXPECT/ENDEXPECT</code> must not contain nested <code>EXPECT/ENDEXPECT</code> blocks.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2150</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">missing ENDEXPECT</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">An instruction block opened via <code>EXPECT</code> was not closed via <code>ENDEXPECT</code>.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2160</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">ENDEXPECT without EXPECT</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">There is no matching previous <code>EXPECT</code> to an <code>ENDEXPECT</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2170</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">no default checkpoint register defined</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">No checkpoint register was specified for a type 12 instruction and no default checkpoint register had previously been defined via the <code>CKPT</code> statement.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2180</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid bit field</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">The bit field is not in the required syntax <code>(start,count)</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2190</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">argument value missing</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">Arguments must have the form &#39;variable=value&#39;.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2200</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unknown argument</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">This variable is not supported by the selected target platform.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2210</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">index register must be 16 bit</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">Z8000 index registers must have a size of 16 bits (Rn).</td>
</tr>
<tr class="even">
<td style="text-align: center;">2211</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">I/O address register must be 16 bit</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">Z8000 registers used to address I/O addresses must have a size of 16 bits (Rn).</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2212</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">address register in segmented mode must be 32 bit</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">Z8000 registers to address memory in segmented mode must have a size of 32 bits (RRn).</td>
</tr>
<tr class="even">
<td style="text-align: center;">2213</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">address register in non-segmented mode must be 16 bit</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">Z8000 registers to address memory in non-segmented mode must have a size of 16 bits (Rn).</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2220</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid structure argument</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">The argument does not match any pattern of allowed arguments when expanding a structure.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2221</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">too many array dimensions</td>
<td style="text-align: left;">the dimension argument that was &#39;too much&#39;</td>
<td style="text-align: left;">Arrays of structures are limited to being three-dimensional.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2230</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unknown integer notation</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">The given integer notation does not exist, or the leading plus resp. minus sign is missing.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2231</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid list of integer notations</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The requested changes to the list of usable integer notations cannot be applied, because they would result in a contradiction. Currently, the only such case are 0hex and 0oct which cannot be used at the same time.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2240</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid scale</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">The given argument cannot be used as scaling factor.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2250</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">conflicting string options</td>
<td style="text-align: left;">the option in question</td>
<td style="text-align: left;">The string option is in contradiction to a previously given option.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2251</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unknown string option</td>
<td style="text-align: left;">the option in question</td>
<td style="text-align: left;">The string option does not exist.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2252</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid cache invalidate mode</td>
<td style="text-align: left;">the argument in question</td>
<td style="text-align: left;">Only data, instruction, or both caches may be invalidated.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2253</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">invalid config list</td>
<td style="text-align: left;">The list in question or one of its elements</td>
<td style="text-align: left;">The configuration list is either syntactically incorrect or contains invalid elements.</td>
</tr>
<tr class="even">
<td style="text-align: center;">2254</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">conflicting config options</td>
<td style="text-align: left;">the option in question</td>
<td style="text-align: left;">The option is in contradiction to a previously given option or repeats a previous one.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2255</td>
<td style="text-align: center;">⛔Error</td>
<td style="text-align: left;">unknown config option</td>
<td style="text-align: left;">the option in question</td>
<td style="text-align: left;">The option does not exist.</td>
</tr>
<tr class="even">
<td style="text-align: center;">10001</td>
<td style="text-align: center;">💀Fatal</td>
<td style="text-align: left;">error in opening file</td>
<td style="text-align: left;">description of the I/O error</td>
<td style="text-align: left;">An error was detected while trying to open a file for input.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">10002</td>
<td style="text-align: center;">💀Fatal</td>
<td style="text-align: left;">error in writing listing</td>
<td style="text-align: left;">description of the I/O error</td>
<td style="text-align: left;">An error happened while AS was writing the listing file.</td>
</tr>
<tr class="even">
<td style="text-align: center;">10003</td>
<td style="text-align: center;">💀Fatal</td>
<td style="text-align: left;">file read error</td>
<td style="text-align: left;">description of the I/O error</td>
<td style="text-align: left;">An error was detected while reading a source file.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">10004</td>
<td style="text-align: center;">💀Fatal</td>
<td style="text-align: left;">file write error</td>
<td style="text-align: left;">description of the I/O error</td>
<td style="text-align: left;">While AS was writing a code or share file, an error happened.</td>
</tr>
<tr class="even">
<td style="text-align: center;">10006</td>
<td style="text-align: center;">💀Fatal</td>
<td style="text-align: left;">heap overflow</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The memory available is not enough to store all the data needed by AS. Try using the DPMI or OS/2 version of AS.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">10007</td>
<td style="text-align: center;">💀Fatal</td>
<td style="text-align: left;">stack overflow</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">The program stack crashed, because too complex formulas, or a bad disposition of symbols and/or macros were used. Try again, using AS with the option <code>-A</code>.</td>
</tr>
<tr class="even">
<td style="text-align: center;">10008</td>
<td style="text-align: center;">💀Fatal</td>
<td style="text-align: left;">INCLUDE nested too deeply</td>
<td style="text-align: left;">the INCLUDE statement that exceeded the limit</td>
<td style="text-align: left;">The include nesting depth has exceeded the given limit (200 by default). The limit may be raised via the <code>-maxinclevel</code> command line argument, a wrong (recursive) inclusion is however the more probable cause.</td>
</tr>
</tbody>
</table>
<h1 id="io-error-messages">I/O Error Messages</h1>
<p>The following error messages are generated not only by AS, but also by the auxiliary programs, like PLIST, BIND, P2HEX, and P2BIN. Only the most probable error messages are here explained. Should you meet an undocumented error message, then you probably met a program bug! Please inform us immediately about this!!</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Code</th>
<th style="text-align: center;">Message</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">file not found</td>
<td style="text-align: left;">The file requested does not exist, or it is stored on another drive.</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">path not found</td>
<td style="text-align: left;">The path of a file does not exist, or it is on another drive.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">too much open files</td>
<td style="text-align: left;">There are no more file handles available. Increase their number according to your platform.</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">file access not allowed</td>
<td style="text-align: left;">Either the network access rights do not allow the file access, or an attempt was done to rewrite or rename a protected file.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">6</td>
<td style="text-align: center;">invalid file handler</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">12</td>
<td style="text-align: center;">invalid access mode</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">15</td>
<td style="text-align: center;">invalid drive letter</td>
<td style="text-align: left;">The required drive does not exist.</td>
</tr>
<tr class="even">
<td style="text-align: center;">16</td>
<td style="text-align: center;">The file cannot be deleted</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">17</td>
<td style="text-align: center;">RENAME cannot be done on this drive</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">100</td>
<td style="text-align: center;">Unexpected end of file</td>
<td style="text-align: left;">A file access tried to go beyond the end of file, although according to its structure this should not happen. The file is probably corrupted.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">101</td>
<td style="text-align: center;">disk full</td>
<td style="text-align: left;">This is self explaining! Please, clean up !</td>
</tr>
<tr class="even">
<td style="text-align: center;">102</td>
<td style="text-align: center;">ASSIGN failed</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">103</td>
<td style="text-align: center;">file not open</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">104</td>
<td style="text-align: center;">file not open for reading</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">105</td>
<td style="text-align: center;">file not open for writing</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">106</td>
<td style="text-align: center;">invalid numerical format</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">150</td>
<td style="text-align: center;">the disk is write-protected</td>
<td style="text-align: left;">When you don&#39;t use a hard disk as work medium storage, you should sometimes remove the protecting tab from your diskette!</td>
</tr>
<tr class="even">
<td style="text-align: center;">151</td>
<td style="text-align: center;">unknown device</td>
<td style="text-align: left;">you tried to access a peripheral unit that is unknown to DOS. This should not usually happen, since the name should be automatically interpreted as a filename.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">152</td>
<td style="text-align: center;">drive not ready</td>
<td style="text-align: left;">close the disk drive door.</td>
</tr>
<tr class="even">
<td style="text-align: center;">153</td>
<td style="text-align: center;">unknown DOS function</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">154</td>
<td style="text-align: center;">invalid disk checksum</td>
<td style="text-align: left;">A bad read error on the disk. Try again; if nothing changes, reformat the floppy disk resp. begin to take care of your hard disk!</td>
</tr>
<tr class="even">
<td style="text-align: center;">155</td>
<td style="text-align: center;">invalid FCB</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">156</td>
<td style="text-align: center;">position error</td>
<td style="text-align: left;">the diskette/hard disk controller has not found a disk track. See nr. 154!</td>
</tr>
<tr class="even">
<td style="text-align: center;">157</td>
<td style="text-align: center;">format unknown</td>
<td style="text-align: left;">DOS cannot read the diskette format</td>
</tr>
<tr class="odd">
<td style="text-align: center;">158</td>
<td style="text-align: center;">sector not found</td>
<td style="text-align: left;">As nr. 156, but the controller this time could not find a disk sector in the track.</td>
</tr>
<tr class="even">
<td style="text-align: center;">159</td>
<td style="text-align: center;">end of paper</td>
<td style="text-align: left;">You probably redirected the output of AS to a printer. Assembler printout can be very long...</td>
</tr>
<tr class="odd">
<td style="text-align: center;">160</td>
<td style="text-align: center;">device read error</td>
<td style="text-align: left;">The operating system detected an unclassifiable read error</td>
</tr>
<tr class="even">
<td style="text-align: center;">161</td>
<td style="text-align: center;">device write error</td>
<td style="text-align: left;">The operating system detected an unclassifiable write error</td>
</tr>
<tr class="odd">
<td style="text-align: center;">162</td>
<td style="text-align: center;">general failure error</td>
<td style="text-align: left;">The operating system has absolutely no idea of what happened to the device.</td>
</tr>
</tbody>
</table>
<!-- markdownlint-enable MD030 -->

<!-- markdownlint-enable MD025 -->

<h1 id="pseudo-instructions-and-integer-syntax">Pseudo-Instructions and Integer Syntax</h1>
<!-- markdownlint-disable MD001 -->

<!-- markdownlint-disable MD025 -->

<!-- markdownlint-disable MD030 -->

<!-- markdownlint-disable MD036 -->

<p>This appendix is designed as a quick reference to look up all pseudo instructions provided by AS. The list is ordered in two parts: The first part lists the instructions that are always available, and this list is followed by lists that enumerate the instructions additionally available for a certain processor family.</p>
<h4 id="instructions-that-are-always-available">Instructions that are always available</h4>
<blockquote>
<p><code>=</code> <code>:=</code> <code>ALIGN</code> <code>BINCLUDE</code> <code>CASE</code> <code>CHARSET</code> <code>CPU</code> <code>DEPHASE</code> <code>DOTTEDSTRUCTS</code> <code>ELSE</code> <code>ELSECASE</code> <code>ELSEIF</code> <code>END</code> <code>ENDCASE</code> <code>ENDIF</code> <code>ENDM</code> <code>ENDS</code> <code>ENDSECTION</code> <code>ENDSTRUCT</code> <code>ENUM</code> <code>ENUMCONF</code> <code>ERROR</code> <code>EQU</code> <code>EXITM</code> <code>FATAL</code> <code>FORWARD</code> <code>FUNCTION</code> <code>GLOBAL</code> <code>IF</code> <code>IFB</code> <code>IFDEF</code> <code>IFEXIST</code> <code>IFNB</code> <code>IFNDEF</code> <code>IFNEXIST</code> <code>IFNUSED</code> <code>IFUSED</code> <code>INCLUDE</code> <code>INTSYNTAX</code> <code>IRP</code> <code>LABEL</code> <code>LISTING</code> <code>MACEXP</code> <code>MACECP_DFT</code> <code>MACEXP_OVR</code> <code>MACRO</code> <code>MESSAGE</code> <code>NEWPAGE</code> <code>NEXTENUM</code> <code>ORG</code> <code>PAGE</code> <code>PHASE</code> <code>POPV</code> <code>PUSHV</code> <code>PRTEXIT</code> <code>PRTINIT</code> <code>PUBLIC</code> <code>READ</code> <code>RELAXED</code> <code>REPT</code> <code>RESTORE</code> <code>RORG</code> <code>SAVE</code> <code>SECTION</code> <code>SEGMENT</code> <code>SHARED</code> <code>STRUC</code> <code>STRUCT</code> <code>SWITCH</code> <code>TITLE</code> <code>UNION</code> <code>WARNING</code> <code>WHILE</code></p>
</blockquote>
<p>Additionally, there are:</p>
<ul>
<li><code>SET</code> resp. <code>EVAL</code>, in case <code>SET</code> is already a machine instruction.</li>
<li><code>SHIFT</code> resp. <code>SHFT</code>, in case <code>SHIFT</code> is already a machine instruction.</li>
</ul>
<h4 id="motorola-680x0mcf5xxx">Motorola 680x0/MCF5xxx</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>DC[.&lt;size&gt;]</code> <code>DS[.&lt;size&gt;]</code> <code>FULLPMMU</code> <code>FPU</code> <code>PADDING</code> <code>PMMU</code> <code>REG</code> <code>SUPMODE</code></p>
</blockquote>
<h4 id="motorola-56xxx">Motorola 56xxx</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>DC</code> <code>DS</code> <code>XSFR</code> <code>YSFR</code></p>
</blockquote>
<h4 id="powerpc-1">PowerPC</h4>
<p><em>Default Integer Syntax: C</em></p>
<blockquote>
<p><code>BIGENDIAN</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>REG</code> <code>SUPMODE</code></p>
</blockquote>
<h4 id="motorola-m-core">Motorola M-Core</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>DC[.&lt;size&gt;]</code> <code>DS[.&lt;size&gt;]</code> <code>REG</code> <code>SUPMODE</code></p>
</blockquote>
<h4 id="motorola-xgate">Motorola XGATE</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>ADR</code> <code>BYT</code> <code>BYTE</code> <code>DC[.&lt;size&gt;]</code> <code>DFS</code> <code>DS[.&lt;size&gt;]</code> <code>FCB</code> <code>FCC</code> <code>FDB</code> <code>PADDING</code> <code>REG</code> <code>RMB</code></p>
</blockquote>
<h4 id="motorola-68xxhitachi-63xx">Motorola 68xx/Hitachi 63xx</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>ADR</code> <code>BYT</code> <code>BYTE</code> <code>DB</code> <code>DC[.&lt;size&gt;]</code> <code>DFS</code> <code>DS[.&lt;size&gt;]</code> <code>DW</code> <code>FCB</code> <code>FCC</code> <code>FDB</code> <code>PADDING</code> <code>RMB</code></p>
</blockquote>
<h4 id="motorolafreescale-680568hcs08">Motorola/Freescale 6805/68HC(S)08</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>ADR</code> <code>BYT</code> <code>BYTE</code> <code>DB</code> <code>DC[.&lt;size&gt;]</code> <code>DFS</code> <code>DS[.&lt;size&gt;]</code> <code>DW</code> <code>FCB</code> <code>FCC</code> <code>FDB</code> <code>PADDING</code> <code>RMB</code></p>
</blockquote>
<h4 id="motorola-6809hitachi-6309">Motorola 6809/Hitachi 6309</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>ADR</code> <code>ASSUME</code> <code>BYT</code> <code>BYTE</code> <code>DB</code> <code>DC[.&lt;size&gt;]</code> <code>DFS</code> <code>DS[.&lt;size&gt;]</code> <code>DW</code> <code>FCB</code> <code>FCC</code> <code>FDB</code> <code>PADDING</code> <code>RMB</code></p>
</blockquote>
<h4 id="motorola-68hc12">Motorola 68HC12</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>ADR</code> <code>BYT</code> <code>BYTE</code> <code>DB</code> <code>DC[.&lt;size&gt;]</code> <code>DFS</code> <code>DS[.&lt;size&gt;]</code> <code>DW</code> <code>FCB</code> <code>FCC</code> <code>FDB</code> <code>PADDING</code> <code>RMB</code></p>
</blockquote>
<h4 id="nxp-s12z">NXP S12Z</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>ADR</code> <code>BYT</code> <code>BYTE</code> <code>DB</code> <code>DC[.&lt;size&gt;]</code> <code>DEFBIT</code> <code>DEFBITFIELD</code> <code>DFS</code> <code>DS[.&lt;size&gt;]</code> <code>DW</code> <code>FCB</code> <code>FCC</code> <code>FDB</code> <code>PADDING</code> <code>RMB</code></p>
</blockquote>
<h4 id="motorola-68hc16">Motorola 68HC16</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>ADR</code> <code>ASSUME</code> <code>BYT</code> <code>BYTE</code> <code>DB</code> <code>DC[.&lt;size&gt;]</code> <code>DFS</code> <code>DS[.&lt;size&gt;]</code> <code>DW</code> <code>FCB</code> <code>FCC</code> <code>FDB</code> <code>PADDING</code> <code>RMB</code></p>
</blockquote>
<h4 id="freescale-68rs08">Freescale 68RS08</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>ADR</code> <code>ASSUME</code> <code>BYT</code> <code>BYTE</code> <code>DB</code> <code>DC[.&lt;size&gt;]</code> <code>DFS</code> <code>DS[.&lt;size&gt;]</code> <code>DW</code> <code>FCB</code> <code>FCC</code> <code>FDB</code> <code>PADDING</code></p>
</blockquote>
<h4 id="hitachi-h8300lh">Hitachi H8/300(L/H)</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>BIT</code> <code>DC[.&lt;size&gt;]</code> <code>DS[.&lt;size&gt;]</code> <code>MAXMODE</code> <code>PADDING</code> <code>REG</code></p>
</blockquote>
<h4 id="hitachi-h8500">Hitachi H8/500</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>ASSUME</code> <code>BIT</code> <code>DATA</code> <code>DC[.&lt;size&gt;]</code> <code>DS[.&lt;size&gt;]</code> <code>MAXMODE</code> <code>PADDING</code> <code>REG</code></p>
</blockquote>
<h4 id="hitachi-sh7x00">Hitachi SH7x00</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>COMPLITERALS</code> <code>DC[.&lt;size&gt;]</code> <code>DS[.&lt;size&gt;]</code> <code>LTORG</code> <code>PADDING</code> <code>REG</code> <code>SUPMODE</code></p>
</blockquote>
<h4 id="hitachi-hmcs400">Hitachi HMCS400</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>DATA</code> <code>RES</code> <code>SFR</code></p>
</blockquote>
<h4 id="hitachi-h16">Hitachi H16</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>BIT</code> <code>DC[.&lt;size&gt;]</code> <code>DS[.&lt;size&gt;]</code> <code>REG</code> <code>SUPMODE</code></p>
</blockquote>
<h4 id="65xxmelps-740">65xx/MELPS-740</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>ADR</code> <code>ASSUME</code> <code>BYT</code> <code>BYTE</code> <code>DFS</code> <code>FCB</code> <code>FCC</code> <code>FDB</code> <code>RMB</code></p>
</blockquote>
<h4 id="65816melps-7700">65816/MELPS-7700</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>ADR</code> <code>ASSUME</code> <code>BYT</code> <code>BYTE</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>DFS</code> <code>FCB</code> <code>FCC</code> <code>FDB</code> <code>RMB</code></p>
</blockquote>
<h4 id="mitsubishi-melps-4500">Mitsubishi MELPS-4500</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>DATA</code> <code>RES</code> <code>SFR</code></p>
</blockquote>
<h4 id="mitsubishi-m16">Mitsubishi M16</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>REG</code></p>
</blockquote>
<h4 id="mitsubishi-m16c">Mitsubishi M16C</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>REG</code></p>
</blockquote>
<h4 id="intel-4004">Intel 4004</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DATA</code> <code>DS</code> <code>REG</code></p>
</blockquote>
<h4 id="intel-8008">Intel 8008</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>PORT</code> <code>Z80SYNTAX</code></p>
</blockquote>
<h4 id="intel-mcs-48">Intel MCS-48</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>ASSUME</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>REG</code></p>
</blockquote>
<h4 id="intel-mcs-251">Intel MCS-(2)51</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>BIGENDIAN</code> <code>BIT</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>PORT</code> <code>REG</code> <code>SFR</code> <code>SFRB</code> <code>SRCMODE</code></p>
</blockquote>
<h4 id="intel-mcs-96">Intel MCS-96</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>ASSUME</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="intel-80808085">Intel 8080/8085</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>PORT</code></p>
</blockquote>
<h4 id="intel-808680186nec-v3035">Intel 8086/80186/NEC V30/35</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>ASSUME</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>PORT</code></p>
</blockquote>
<h4 id="intel-i960">Intel i960</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>FPU</code> <code>REG</code> <code>SPACE</code> <code>SUPMODE</code> <code>WORD</code></p>
</blockquote>
<h4 id="signetics-8x30x">Signetics 8X30x</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>LIV</code> <code>RIV</code></p>
</blockquote>
<h4 id="signetics-2650">Signetics 2650</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="philips-xa">Philips XA</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>ASSUME</code> <code>BIT</code> <code>DB</code> <code>DC[.&lt;size&gt;]</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS[.&lt;size&gt;]</code> <code>DT</code> <code>DW</code> <code>PADDING</code> <code>PORT</code> <code>REG</code> <code>SUPMODE</code></p>
</blockquote>
<h4 id="atmel-avr">Atmel AVR</h4>
<p><em>Default Integer Syntax: C</em></p>
<blockquote>
<p><code>BIT</code> <code>DATA</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>PACKING</code> <code>PORT</code> <code>REG</code> <code>RES</code> <code>SFR</code></p>
</blockquote>
<h4 id="amd-29k">AMD 29K</h4>
<p><em>Default Integer Syntax: C</em></p>
<blockquote>
<p><code>ASSUME</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>EMULATED</code> <code>ERG</code> <code>SUPMODE</code></p>
</blockquote>
<h4 id="siemens-80c166167">Siemens 80C166/167</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>ASSUME</code> <code>BIT</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>REG</code></p>
</blockquote>
<h4 id="zilog-zx80">Zilog Zx80</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DEFB</code> <code>DEFW</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>EXTMODE</code> <code>LWORDMODE</code></p>
</blockquote>
<h4 id="zilog-z8">Zilog Z8</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DEFBIT</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>REG</code> <code>SFR</code></p>
</blockquote>
<h4 id="zilog-z8000">Zilog Z8000</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DEFBIT</code> <code>DEFBITB</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>PORT</code> <code>REG</code></p>
</blockquote>
<h4 id="xilinx-kcpsm">Xilinx KCPSM</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>CONSTANT</code> <code>NAMEREG</code> <code>REG</code></p>
</blockquote>
<h4 id="xilinx-kcpsm3">Xilinx KCPSM3</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>CONSTANT</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>NAMEREG</code> <code>PORT</code> <code>REG</code></p>
</blockquote>
<h4 id="latticemico8">LatticeMico8</h4>
<p><em>Default Integer Syntax: C</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>PORT</code> <code>REG</code></p>
</blockquote>
<h4 id="toshiba-tlcs-900">Toshiba TLCS-900</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>MAXIMUM</code> <code>SUPMODE</code></p>
</blockquote>
<h4 id="toshiba-tlcs-90">Toshiba TLCS-90</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="toshiba-tlcs-870c">Toshiba TLCS-870(/C)</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="toshiba-tlcs-470a">Toshiba TLCS-47(0(A))</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>ASSUME</code> <code>DB</code> <code>DN</code> <code>DD</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>PORT</code></p>
</blockquote>
<h4 id="toshiba-tlcs-9000">Toshiba TLCS-9000</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>REG</code></p>
</blockquote>
<h4 id="toshiba-tc9331">Toshiba TC9331</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<h4 id="microchip-pic16c5x">Microchip PIC16C5x</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>DATA</code> <code>RES</code> <code>SFR</code> <code>ZERO</code></p>
</blockquote>
<h4 id="microchip-pic16c8x">Microchip PIC16C8x</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>DATA</code> <code>RES</code> <code>SFR</code> <code>ZERO</code></p>
</blockquote>
<h4 id="microchip-pic17c42">Microchip PIC17C42</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>DATA</code> <code>RES</code> <code>SFR</code> <code>ZERO</code></p>
</blockquote>
<h4 id="parallax-sx20">Parallax SX20</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>BIT</code> <code>DATA</code> <code>SFR</code> <code>ZERO</code></p>
</blockquote>
<h4 id="sgs-thomson-st6">SGS-Thomson ST6</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>ASCII</code> <code>ASCIZ</code> <code>ASSUME</code> <code>BIT</code> <code>BYTE</code> <code>BLOCK</code> <code>SFR</code> <code>WORD</code></p>
</blockquote>
<h4 id="sgs-thomson-st7stm8">SGS-Thomson ST7/STM8</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DC[.&lt;size&gt;]</code> <code>DS[.&lt;size&gt;]</code> <code>PADDING</code></p>
</blockquote>
<h4 id="sgs-thomson-st9">SGS-Thomson ST9</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>ASSUME</code> <code>BIT</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>REG</code></p>
</blockquote>
<h4 id="6804-1">6804</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>ADR</code> <code>BYT</code> <code>BYTE</code> <code>DB</code> <code>DFS</code> <code>DS</code> <code>DW</code> <code>FCB</code> <code>FCC</code> <code>FDB</code> <code>RMB</code> <code>SFR</code></p>
</blockquote>
<h4 id="texas-instruments-tms3201x">Texas Instruments TMS3201x</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DATA</code> <code>PORT</code> <code>RES</code></p>
</blockquote>
<h4 id="texas-instruments-tms32c02x">Texas Instruments TMS32C02x</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>BFLOAT</code> <code>BSS</code> <code>BYTE</code> <code>DATA</code> <code>DOUBLE</code> <code>EFLOAT</code> <code>TFLOAT</code> <code>LONG</code> <code>LQxx</code> <code>PORT</code> <code>Qxx</code> <code>RES</code> <code>RSTRING</code> <code>STRING</code> <code>WORD</code></p>
</blockquote>
<h4 id="texas-instruments-tms320c3xc4x">Texas Instruments TMS320C3x/C4x</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>ASSUME</code> <code>BSS</code> <code>DATA</code> <code>EXTENDED</code> <code>SINGLE</code> <code>WORD</code></p>
</blockquote>
<h4 id="texas-instruments-tm32c020xtm32c05xtm32c054x">Texas Instruments TM32C020x/TM32C05x/TM32C054x</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>BFLOAT</code> <code>BSS</code> <code>BYTE</code> <code>DATA</code> <code>DOUBLE</code> <code>EFLOAT</code> <code>TFLOAT</code> <code>LONG</code> <code>LQxx</code> <code>PORT</code> <code>Qxx</code> <code>RES</code> <code>RSTRING</code> <code>STRING</code> <code>WORD</code></p>
</blockquote>
<h4 id="texas-instruments-tms320c6x">Texas Instruments TMS320C6x</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>BSS</code> <code>DATA</code> <code>DOUBLE</code> <code>SINGLE</code> <code>WORD</code></p>
</blockquote>
<h4 id="texas-instruments-tms99xx">Texas Instruments TMS99xx</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>BSS</code> <code>BYTE</code> <code>DOUBLE</code> <code>PADDING</code> <code>SINGLE</code> <code>WORD</code></p>
</blockquote>
<h4 id="texas-instruments-instruments-tms1000">Texas Instruments Instruments TMS1000</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="texas-instruments-tms70cxx">Texas Instruments TMS70Cxx</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="texas-instruments-tms370">Texas Instruments TMS370</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DBIT</code> <code>DN</code> <code>DD</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="texas-instruments-msp430">Texas Instruments MSP430</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>BSS</code> <code>BYTE</code> <code>PADDING</code> <code>REG</code> <code>WORD</code></p>
</blockquote>
<h4 id="national-scmp">National SC/MP</h4>
<p><em>Default Integer Syntax: C</em></p>
<blockquote>
<p><code>BIGENDIAN</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="national-ins807x">National INS807x</h4>
<p><em>Default Integer Syntax: C</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="national-cop4">National COP4</h4>
<p><em>Default Integer Syntax: C</em></p>
<blockquote>
<p><code>ADDR</code> <code>ADDRW</code> <code>BYTE</code> <code>DB</code> <code>DD</code> <code>DQ</code> <code>DS</code> <code>DSB</code> <code>DSW</code> <code>DT</code> <code>DW</code> <code>FB</code> <code>FW</code> <code>SFR</code> <code>WORD</code></p>
</blockquote>
<h4 id="national-cop8">National COP8</h4>
<p><em>Default Integer Syntax: C</em></p>
<blockquote>
<p><code>ADDR</code> <code>ADDRW</code> <code>BYTE</code> <code>DB</code> <code>DD</code> <code>DQ</code> <code>DS</code> <code>DSB</code> <code>DSW</code> <code>DT</code> <code>DW</code> <code>FB</code> <code>FW</code> <code>SFR</code> <code>WORD</code></p>
</blockquote>
<h4 id="national-sc14xxx">National SC14xxx</h4>
<p><em>Default Integer Syntax: C</em></p>
<blockquote>
<p><code>DC</code> <code>DC8</code> <code>DS</code> <code>DS8</code> <code>DS16</code> <code>DW</code> <code>DW16</code></p>
</blockquote>
<h4 id="national-ns32xxx">National NS32xxx</h4>
<blockquote>
<p><code>BYTE</code> <code>CUSTOM</code> <code>DB</code> <code>DD</code> <code>DOUBLE</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>FLOAT</code> <code>FPU</code> <code>LONG</code> <code>PMMU</code> <code>REG</code> <code>SUPMODE</code> <code>WORD</code></p>
</blockquote>
<h4 id="fairchild-ace">Fairchild ACE</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="fairchild-f8">Fairchild F8</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>PORT</code></p>
</blockquote>
<h4 id="nec-μpd78c1x">NEC μPD78(C)1x</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>ASSUME</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="nec-75xx">NEC 75xx</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="nec-75k0">NEC 75K0</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>ASSUME</code> <code>BIT</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>SFR</code></p>
</blockquote>
<h4 id="nec-78k0">NEC 78K0</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="nec-78k2">NEC 78K2</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>BIT</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="nec-78k3">NEC 78K3</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>BIT</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="nec-78k4">NEC 78K4</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>BIT</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="nec-μpd772x">NEC μPD772x</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DATA</code> <code>RES</code></p>
</blockquote>
<h4 id="nec-μpd77230">NEC μPD77230</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DS</code> <code>DW</code></p>
</blockquote>
<h4 id="symbios-logic-sym53c8xx">Symbios Logic SYM53C8xx</h4>
<p><em>Default Integer Syntax: C</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="fujitsu-f2mc8l">Fujitsu F<sup>2</sup>MC8L</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="fujitsu-f2mc16l">Fujitsu F<sup>2</sup>MC16L</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="oki-olms-40">OKI OLMS-40</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DATA</code> <code>RES</code> <code>SFR</code></p>
</blockquote>
<h4 id="oki-olms-50">OKI OLMS-50</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DATA</code> <code>RES</code> <code>SFR</code></p>
</blockquote>
<h4 id="panafacom-mn161x">Panafacom MN161x</h4>
<p><em>Default Integer Syntax: IBM</em></p>
<blockquote>
<p><code>DC</code> <code>DS</code></p>
</blockquote>
<h4 id="padauk-pmcpmspfsxxx">Padauk PMC/PMS/PFSxxx</h4>
<p><em>Default Integer Syntax: C</em></p>
<blockquote>
<p><code>BIT</code> <code>DATA</code> <code>RES</code> <code>SFR</code></p>
</blockquote>
<h4 id="intersil-180x">Intersil 180x</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code></p>
</blockquote>
<h4 id="xmos-xs1">XMOS XS1</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<blockquote>
<p><code>DB</code> <code>DD</code> <code>DQ</code> <code>DN</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>REG</code></p>
</blockquote>
<h4 id="atari-vector">ATARI Vector</h4>
<p><em>Default Integer Syntax: Motorola</em></p>
<h4 id="mil-std-1750">MIL STD 1750</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>DATA</code> <code>EXTENDED</code> <code>FLOAT</code></p>
</blockquote>
<h4 id="kenbak-1">KENBAK</h4>
<p><em>Default Integer Syntax: Intel</em></p>
<blockquote>
<p><code>BIT</code> <code>DB</code> <code>DD</code> <code>DN</code> <code>DQ</code> <code>DS</code> <code>DT</code> <code>DW</code> <code>REG</code></p>
</blockquote>
<h4 id="cp1600">CP1600</h4>
<p><em>Default Integer Syntax: IBM (hex), C (oct)</em></p>
<blockquote>
<p><code>BYTE</code> <code>RES</code> <code>TEXT</code> <code>WORD</code> <code>ZERO</code></p>
</blockquote>
<!-- markdownlint-enable MD036 -->

<!-- markdownlint-enable MD030 -->

<!-- markdownlint-enable MD025 -->

<!-- markdownlint-enable MD001 -->

<h1 id="predefined-symbols">Predefined Symbols</h1>
<!-- markdownlint-disable MD001 -->

<!-- markdownlint-disable MD025 -->

<!-- markdownlint-disable MD030 -->

<!-- markdownlint-disable MD036 -->

<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">data type</th>
<th style="text-align: left;">definition</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ARCHITECTURE</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">predefined</td>
<td style="text-align: left;">target platform AS was compiled for, in the style processor-manufacturer-operating system</td>
</tr>
<tr class="even">
<td style="text-align: left;">BIGENDIAN</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">dynamic(0)</td>
<td style="text-align: left;">storage of constants MSB first?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CASESENSITIVE</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">normal</td>
<td style="text-align: left;">case sensitivity in symbol names?</td>
</tr>
<tr class="even">
<td style="text-align: left;">CONSTPI</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">normal</td>
<td style="text-align: left;">constant Pi (3.1415.....)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DATE</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">predefined</td>
<td style="text-align: left;">date of begin of assembly</td>
</tr>
<tr class="even">
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">predefined</td>
<td style="text-align: left;">0 = logically &quot;false&quot;</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HASFPU</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">dynamic(0)</td>
<td style="text-align: left;">coprocessor instructions enabled?</td>
</tr>
<tr class="even">
<td style="text-align: left;">HASPMMU</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">dynamic(0)</td>
<td style="text-align: left;">MMU instructions enabled?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">INEXTMODE</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">dynamic(0)</td>
<td style="text-align: left;">XM flag set for 4 Gbyte address space?</td>
</tr>
<tr class="even">
<td style="text-align: left;">INLWORDMODE</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">dynamic(0)</td>
<td style="text-align: left;">LW flag set for 32 bit instructions?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">INMAXMODE</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">dynamic(0)</td>
<td style="text-align: left;">processor in maximum mode?</td>
</tr>
<tr class="even">
<td style="text-align: left;">INSUPMODE</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">dynamic(0)</td>
<td style="text-align: left;">processor in supervisor mode?</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">data type</th>
<th style="text-align: left;">definition</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">INSRCMODE</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">dynamic(0)</td>
<td style="text-align: left;">processor in source mode?</td>
</tr>
<tr class="even">
<td style="text-align: left;">FULLPMMU</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">dynamic(0/1)</td>
<td style="text-align: left;">full PMMU instruction set allowed?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LISTON</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">dynamic(1)</td>
<td style="text-align: left;">listing enabled?</td>
</tr>
<tr class="even">
<td style="text-align: left;">MACEXP</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">dynamic(1)</td>
<td style="text-align: left;">expansion of macro constructs in listing enabled?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MOMCPU</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">dynamic(68008)</td>
<td style="text-align: left;">number of target CPU currently set</td>
</tr>
<tr class="even">
<td style="text-align: left;">MOMCPUNAME</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">dynamic(68008)</td>
<td style="text-align: left;">name of target CPU currently set</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MOMFILE</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">special</td>
<td style="text-align: left;">current source file (including include files)</td>
</tr>
<tr class="even">
<td style="text-align: left;">MOMLINE</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">special</td>
<td style="text-align: left;">current line number in source file</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MOMPASS</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">special</td>
<td style="text-align: left;">number of current pass</td>
</tr>
<tr class="even">
<td style="text-align: left;">MOMSECTION</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">special</td>
<td style="text-align: left;">name of current section or empty string if out of any section</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MOMSEGMENT</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">special</td>
<td style="text-align: left;">name of address space currently selected with <code>SEGMENT</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">data type</th>
<th style="text-align: left;">definition</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>NESTMAX</code></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">dynamic(256)</td>
<td style="text-align: left;">maximum nesting level of macro expansions</td>
</tr>
<tr class="even">
<td style="text-align: left;">PADDING</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">dynamic(1)</td>
<td style="text-align: left;">pad byte field to even count?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RELAXED</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">dynamic(0)</td>
<td style="text-align: left;">any syntax allowed integer constants?</td>
</tr>
<tr class="even">
<td style="text-align: left;">PC</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">special</td>
<td style="text-align: left;">current program counter (Thomson)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TIME</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">predefined</td>
<td style="text-align: left;">time of begin of assembly (1. pass)</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">predefined</td>
<td style="text-align: left;">1 = logically &quot;true&quot;</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VERSION</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">predefined</td>
<td style="text-align: left;">version of AS in BCD coding, e.g. 1331 hex for version 1.33p1</td>
</tr>
<tr class="even">
<td style="text-align: left;">WRAPMODE</td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">predefined</td>
<td style="text-align: left;">shortened program counter assumed?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">*</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">special</td>
<td style="text-align: left;">current program counter (Motorola, Rockwell, Microchip, Hitachi)</td>
</tr>
<tr class="even">
<td style="text-align: left;">$</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">special</td>
<td style="text-align: left;">current program counter (Intel, Zilog, Texas, Toshiba, NEC, Siemens, AMD)</td>
</tr>
</tbody>
</table>
<p>To be exact, boolean symbols are just ordinary integer symbols with the difference that AS will assign only two different values to them (0 or 1, corresponding to False or True). AS does not store special symbols in the symbol table. For performance reasons, they are realized with hardcoded comparisons directly in the parser. They therefore do not show up in the assembly listing&#39;s symbol table. Predefined symbols are only set once at the beginning of a pass. The values of dynamic symbols may in contrast change during assembly as they reflect settings made with related pseudo instructions. The values added in parentheses give the value present at the beginning of a pass.</p>
<p>The names given in this table also reflect the valid way to reference these symbols in case-sensitive mode.</p>
<p>The names listed here should be avoided for own symbols; either one can define but not access them (special symbols), or one will receive an error message due to a double-defined symbol. The ugliest case is when the redefinition of a symbol made by AS at the beginning of a pass leads to a phase error and an infinite loop...</p>
<!-- markdownlint-enable MD036 -->

<!-- markdownlint-enable MD030 -->

<!-- markdownlint-enable MD025 -->

<!-- markdownlint-enable MD001 -->

<h1 id="shipped-include-files">Shipped Include Files</h1>
<!-- markdownlint-disable MD001 -->

<!-- markdownlint-disable MD025 -->

<!-- markdownlint-disable MD030 -->

<!-- markdownlint-disable MD036 -->

<p>The distribution of AS contains a couple of include files. Apart from include files that only refer to a specific processor family (and whose function should be immediately clear to someone who works with this family), there are a few processor-independent files which include useful functions. The functions defined in these files shall be explained briefly in the following sections:</p>
<h2 id="bitfuncsinc">BITFUNCS.INC</h2>
<p>This file defines a couple of bit-oriented functions that might be hardwired for other assemblers. In the case of AS however, they are implemented with the help of user-defined functions:</p>
<ul>
<li><em>mask(start,bits)</em> returns an integer with <em>bits</em> bits set starting at position <em>start</em>;</li>
<li><em>invmask(start,bits)</em> returns one&#39;s complement to <em>mask()</em>;</li>
<li><em>cutout(x,start,bits)</em> returns <em>bits</em> bits masked out from <em>x</em> starting at position <em>start</em> without shifting them to position 0;</li>
<li><em>hi(x)</em> returns the second lowest byte (bits 8..15) of <em>x</em>;</li>
<li><em>lo(x)</em> returns the lowest byte (bits 8..15) of <em>x</em>;</li>
<li><em>hiword(x)</em> returns the second lowest word (bits 16..31) of <em>x</em>;</li>
<li><em>loword(x)</em> returns the lowest word (bits 0..15) of <em>x</em>;</li>
<li><em>odd(x)</em> returns TRUE if <em>x</em> is odd;</li>
<li><em>even(x)</em> returns TRUE if <em>x</em> is even;</li>
<li><em>getbit(x,n)</em> extracts bit <em>n</em> out of <em>x</em> and returns it as 0 or 1;</li>
<li><em>shln(x,size,n)</em> shifts a word <em>x</em> of length <em>size</em> to the left by <em>n</em> places;</li>
<li><em>shrn(x,size,n)</em> shifts a word <em>x</em> of length <em>size</em> to the right by <em>n</em> places;</li>
<li><em>rotln(x,size,n)</em> rotates the lowest <em>size</em> bits of an integer <em>x</em> to the left by <em>n</em> places;</li>
<li><em>rotrn(x,size,n)</em> rotates the lowest <em>size</em> bits of an integer <em>x</em> to the right by <em>n</em> places;</li>
</ul>
<h2 id="ctypeinc">CTYPE.INC</h2>
<p>This include file is similar to the C include file <code>ctype.h</code> which
offers functions to classify characters. All functions deliver either
TRUE or FALSE:</p>
<ul>
<li><em>isdigit(ch)</em> becomes TRUE if <em>ch</em> is a valid decimal digit (0..9);</li>
<li><em>isxdigit(ch)</em> becomes TRUE if <em>ch</em> is a valid hexadecimal digit (0..9, A..F, a..f);</li>
<li><em>isupper(ch)</em> becomes TRUE if <em>ch</em> is an uppercase letter, excluding special national characters);</li>
<li><em>islower(ch)</em> becomes TRUE if <em>ch</em> is a lowercase letter, excluding special national characters);</li>
<li><em>isalpha(ch)</em> becomes TRUE if <em>ch</em> is a letter, excluding special national characters;</li>
<li><em>isalnum(ch)</em> becomes TRUE if <em>ch</em> is either a letter or a valid decimal digit;</li>
<li><em>isspace(ch)</em> becomes TRUE if <em>ch</em> is an &#39;empty&#39; character (space, form feed, line feed, carriage return, tabulator);</li>
<li><em>isprint(ch)</em> becomes TRUE if <em>ch</em> is a printable character, i.e. no control character up to code 31;</li>
<li><em>iscntrl(ch)</em> is the opposite to <em>isprint()</em>;</li>
<li><em>isgraph(ch)</em> becomes TRUE if <em>ch</em> is a printable and visible character;</li>
<li><em>ispunct(ch)</em> becomes TRUE if <em>ch</em> is a printable special character (i.e. neither space nor letter nor number);</li>
</ul>
<h1 id="acknowledgments">Acknowledgments</h1>
<blockquote>
<p><em>&quot;If I have seen farther than other men, it is because I stood on the shoulders of giants.&quot;</em></p>
<p><em>–Sir Isaac Newton</em></p>
</blockquote>
<!-- Breaking block quote -->

<blockquote>
<p><em>&quot;If I haven&#39;t seen farther than other men, it is because I stood in the footsteps of giants.&quot;</em></p>
<p><em>–unknown</em></p>
</blockquote>
<p>If one decides to rewrite a chapter that has been out of date for two years, it is almost unavoidable that one forgets to mention some of the good ghosts who contributed to the success this project had up to now. The first &quot;thank you&quot; therefore goes to the people whose names I unwillingly forgot in the following enumeration!</p>
<p>The concept of AS as a universal cross assembler came from Bernhard (C.) Zschocke who needed a &quot;student friendly&quot;, i.e. free cross assembler for his microprocessor course and talked me into extending an already existing 68000 assembler. The rest is history... The microprocessor course held at RWTH Aachen also always provided the most engaged users (and bug-searchers) of new AS features and therefore contributed a lot to today&#39;s quality of AS.</p>
<p>The internet and FTP have proved to be a big help for spreading AS and reporting of bugs. My thanks therefore go to the FTP admins (Bernd Casimir in Stuttgart, Norbert Breidor in Aachen, and Jürgen Meißburger in Jülich). Especially the last one personally engaged a lot to establish a practicable way in Jülich.</p>
<p>As we are just talking about the ZAM: Though Wolfgang E. Nagel is not personally involved into AS, he is at least my boss and always puts at least four eyes on what I am doing. Regarding AS, there seems to be at least one that smiles...</p>
<p>A program like AS cannot be done without appropriate data books and documentation. I received information from an enormous amount of people, ranging from tips up to complete data books. An enumeration follows (as stated before, without guarantee for completeness!):</p>
<p>Ernst Ahlers, Charles Altmann, Marco Awater, Len Bayles, Andreas Bolsch, Rolf Buchholz, Bernd Casimir, Nils Eilers, Gunther Ewald, Michael Haardt, Stephan Hruschka, Peter Kliegelhöfer, Ulf Meinke, Udo Möller, Matthias Paul, Norbert Rosch, Curt J. Sampson, Steffen Schmid, Leonhard Schneider, Ernst Schwab, Michael Schwingen, Oliver Sellke, Christian Stelter, Patrik Strömdahl, Tadashi G. Takaoka, Oliver Thamm, Thorsten Thiele, Leszek Ulman, Rob Warmelink, Andreas Wassatsch, John Weinrich.</p>
<p>...and an ironic &quot;thank you&quot; to Rolf-Dieter-Klein and Tobias Thiel who demonstrated with their ASM68K how one should <strong>not</strong> do it and thereby indirectly gave me the impulse to write something better!</p>
<p>I did not entirely write AS on my own. The DOS version of AS contained the OverXMS routines from Wilbert van Leijen which can move the overlay modules into the extended memory. A really nice library, easy to use without problems!</p>
<p>The TMS320C2x/5x code generators and the file <code>STDDEF2x.INC</code> come from Thomas Sailer, ETH Zurich. It&#39;s surprising, he only needed one weekend to understand my coding and to implement the new code generator. Either that was a long night shift or I am slowly getting old...the same praise goes to Haruo Asano for providing the MN1610/MN1613 code generator.</p>
<!-- markdownlint-enable MD036 -->

<!-- markdownlint-enable MD030 -->

<!-- markdownlint-enable MD025 -->

<!-- markdownlint-enable MD001 -->

<h1 id="frequently-asked-questions">Frequently Asked Questions</h1>
<!-- markdownlint-disable MD025 -->

<!-- markdownlint-disable MD030 -->

<h2 id="editors-note-this-is-alfred-arnolds-faq-section-mostly-unedited-preserved-for-historical-reasons"><strong>EDITOR&#39;s NOTE:</strong> This is Alfred Arnold&#39;s FAQ section, mostly unedited, preserved for historical reasons</h2>
<p>In this chapter, I tried to collect some questions that arise very often together with their answers. Answers to the problems presented in this chapter might also be found at other places in this manual, but one maybe does not find them immediately...</p>
<p>Q:
I am fed up with DOS. Are there versions of AS for other operating systems ?</p>
<p>A:
Apart from the protected mode version that offers more memory when working under DOS, ports exist for OS/2 and Unix systems like Linux (currently in test phase). Versions that help operating system manufacturers located in Redmond to become even richer are currently not planned. I will gladly make the sources of AS available for someone else who wants to become active in this direction. The C variant is probably the best way to start a port into this direction. He should however not expect support from me that goes beyond the sources themselves...</p>
<p>Q:
Is a support of the XYZ processor planned for AS?</p>
<p>A:
New processors are appearing all the time and I am trying to keep pace by extending AS. The stack on my desk labeled &quot;undone&quot; however never goes below the 4 inch watermark... Wishes coming from users of course play an important role in the decision which candidates will be done first. The internet and the rising amount of documentation published in electronic form make the acquisition of data books easier than it used to be, but it always becomes difficult when more exotic or older architectures are wanted. If the processor family in question is not in the list of families that are planned (see chapter 1), adding a data book to a request will have a highly positive influence. Borrowing books is also fine.</p>
<p>Q:
Having a free assembler is really fine, but I now also had use for a disassembler...and a debugger...a simulator would also really be cool!</p>
<p>A:
AS is a project I work on in leisure time, the time I have when I do not have to care of how to make my living. AS already takes a significant portion of that time, and sometimes I make a time-out to use my soldering iron, enjoy a Tangerine Dream CD, watch TV, or simply to fulfill some basic human needs... I once started to write the concept of a disassembler that was designed to create source code that can be assembled and that automatically separates code and data areas. I quickly stopped this project again when I realized that the remaining time simply did not suffice. I prefer to work on one good program than to struggle for half a dozen of mediocre apps. Regarded that way, the answer to the question is unfortunately &quot;no&quot;...</p>
<p>Q:
The screen output of AS is messed up with strange characters, e.g. arrows and brackets. Why?</p>
<p>A:
AS will by default use some ANSI control sequences for screen control. These sequences will appear unfiltered on your screen if you did not install an ANSI driver. Either install an ANSI driver or use the DOS command <code>SET USEANSI=N</code> to turn the sequences off.</p>
<p>Q:
AS suddenly terminates with a stack overflow error while assembling my program. Did my program become to large?</p>
<p>A:
Yes and No. Your program&#39;s symbol table has grown a bit unsymmetrically what lead to high recursion depths while accessing the table. Errors of this type especially happen in the 16-bit-OS/2 version of AS which has a very limited stack area. Restart AS with the <code>-A</code> command line switch. If this does not help, too complex formula expression are also a possible cause of stack overflows. In such a case, try to split the formula into intermediate steps.</p>
<p>Q:
It seems that AS does not assemble my program up to the end. It worked however with an older version of AS (1.39).</p>
<p>A:
Newer versions of AS no longer ignore the <code>END</code> statement; they actually terminate assembly when an <code>END</code> is encountered. Especially older include files made by some users tended to contain an <code>END</code> statement at their end. Simply remove the superfluous <code>END</code> statements.</p>
<p>Q:
I made an assembly listing of my program because I had some more complicated assembly errors in my program. Upon closer investigation of the listing, I found that some branches do not point to the desired target but instead to themselves!</p>
<p>A:
This effect happens in case of forward jumps in the first pass. The formula parser does not yet have the target address in its symbol table, and as it is a completely independent module, it has to think of a value that even does not hurt relative branches with short displacement lengths. This is the current program counter itself...in the second pass, the correct values would have appeared, but the second pass did not happen due to errors in the first one. Correct the other errors first so that AS gets into the second pass, and the listing should look more meaningful again.</p>
<p>Q:
Assembly of my program works perfectly, however I get an empty file when I try to convert it with P2HEX or P2BIN.</p>
<p>A:
You probably did not set the address filter correctly. By default, the filter is disabled, i.e. all data is copied to the HEX or binary file. It is however possible to create an empty file if a manually set range does not fit to the addresses used by your program.</p>
<p>Q:
I cannot enter the dollar character when using P2BIN or P2HEX under Unix. The automatic address range setting does not work, instead I get strange error messages.</p>
<p>A:
Unix shells use the dollar character for expansion of shell variables. If you want to pass a dollar character to an application, prefix it with a backslash (<code>\</code>). In the special case of the address range specification for P2HEX and P2BIN, you may also use <code>0x</code> instead of the dollar character, which removes this problem completely.</p>
<p>Q:
I use AS on a Linux system, the loader program for my target system however runs on a Windows machine. To simplify things, both systems access the same network drive. Unfortunately, the Windows side refuses to read the hex files created by the Linux side :-(</p>
<p>A:
Windows and Linux systems use slightly different formats for text files (hex files are a sort of text files). Windows terminates every line with the characters CR (carriage return) and LF (linefeed), however Linux only uses the linefeed. It depends on the Windows program&#39;s &#39;goodwill&#39; whether it will accept text files in the Linux format or not. If not, it is possible to transfer the files via FTP in ASCII mode instead of a network drive. Alternatively, the hex files can be converted to the Windows format. For example, the program <em>unix2dos</em> can be used to do this, or a small script under Linux:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">awk</span> <span class="st">&#39;{print $0&quot;\r&quot;}&#39;</span> test.hex <span class="op">&gt;</span>test_cr.hex</span></code></pre></div>
<!-- markdownlint-enable MD030 -->

<!-- markdownlint-enable MD025 -->

<h1 id="hints-for-the-as-source-code">Hints for the AS Source Code</h1>
<!-- markdownlint-disable MD001 -->

<!-- markdownlint-disable MD025 -->

<!-- markdownlint-disable MD030 -->

<!-- markdownlint-disable MD036 -->

<h2 id="editors-notes"><strong>EDITOR&#39;s NOTES</strong></h2>
<p>These sections are Alfred Arnold&#39;s writing, mostly unedited. My notes are as follows:</p>
<ol type="1">
<li>I do not support K&amp;R at all, and you are a bad person if you suggest I should.</li>
<li>A lot of it is made irrelevant due to my changes to use C11 and cmake.</li>
</ol>
<h2 id="end-editors-notes"><strong>END EDITOR&#39;s NOTES</strong></h2>
<p>As I already mentioned in the introduction, I release the source code of AS on request. The following shall give a few hints to their usage.</p>
<h2 id="language-preliminaries">Language Preliminaries</h2>
<p>In the beginning, AS was a program written in Turbo-Pascal. This was roughly at the end of the eighties, and there were a couple of reasons for this choice: First, I was much more used to it than to any C compiler, and compared to Turbo Pascal&#39;s IDE, all DOS-based C compilers were just crawling along. In the beginning of 1997 however, it became clear that things had changed: One factor was that Borland had decided to let its confident DOS developers down (once again, explicitly no &#39;thank you&#39;, you boneheads from Borland!) and replaced version 7.0 of Borland Pascal with something called &#39;Delphi&#39;, which is probably a wonderful tool to develop Windows programs which consist of 90% user interface and accidentally a little bit of content, however completely useless for command-line driven programs like AS. Furthermore, my focus of operating systems had made a clear move towards Unix, and I probably could have waited arbitrarily long for a Borland Pascal for Linux (to all those remarking now that Borland would be working on something like that: this is <em>Vapourware</em>, don&#39;t believe them anything until you can go into a shop and actually buy it!). It was therefore clear that C was the way to go.</p>
<p>After this experience what results the usage of &#39;island systems&#39; may have, I put a big emphasize on portability while doing the translation to C; however, since AS for example deals with binary data in an exactly format and uses operating system-specific functions at some places which may need adaptions when one compiles AS the first time for a new platform.</p>
<p>AS is tailored for a C compiler that conforms to the ANSI C standard; C++ is explicitly not required. If you are still using a compiler conforming to the outdated Kernighan&amp;Ritchie standard, you should consider getting a newer compiler: The ANSI C standard has been fixed in 1989 and there should be an ANSI C compiler for every contemporary platform, maybe by using the old compiler to build GNU-C. Though there are some switches in the source code to bring it nearer to K&amp;R, this is not an officially supported feature which I only use internally to support a quite antique Unix. Everything left to say about K&amp;R is located in the file <code>README.KR</code>.</p>
<p>The inclusion of some additional features not present in the Pascal version (e.g. dynamically loadable message files, test suite, automatic generation of the documentation from <em>one</em> source format) has made the source tree substantially more complicated. I will attempt to unravel everything step by step:</p>
<h2 id="encapsulating-system-dependencies">Encapsulating System dependencies</h2>
<h2 id="editors-note-this-is-alfred-arnolds-writing-mostly-unedited-most-of-it-is-made-irrelevant-due-to-my-changes-to-use-c11-and-cmake"><strong>EDITOR&#39;s NOTE:</strong> This is Alfred Arnold&#39;s writing, mostly unedited. Most of it is made irrelevant due to my changes to use C11 and cmake</h2>
<p>As I already mentioned, As has been tailored to provide maximum platform independence and portability (at least I believe so...). This means packing all platform dependencies into as few files as possible. I will describe these files now, and this section is the first one because it is probably one of the most important:</p>
<p>The Build of all components of AS takes place via a central <code>Makefile</code>. To make it work, it has to be accompanied by a fitting <code>Makefile.def</code> that gives the platform dependent settings like compiler flags. The subdirectory <code>Makefile.def-samples</code> contains a couple of includes that work for widespread platforms (but which need not be optimal...). In case your platform is not among them, you may take the file <code>Makefile.def.tmpl</code> as a starting point (and send me the result!).</p>
<p>A further component to capture system dependencies is the file <code>sysdefs.h</code>. Practically all compilers predefine a couple of preprocessor symbols that describe the target processor and the used operating system. For example, on a Sun Sparc under Solaris equipped with the GNU compiler, the symbols <code>__sparc</code> and <code>__SVR4</code>. <code>sysdefs.h</code> exploits these symbols to provide a homogeneous environment for the remaining, system-independent files. Especially, this covers integer data types of a specific length, but it may also include the (re)definition of C functions which are not present or non-standard-like on a specific platform. It&#39;s best to read this files yourself if you like to know which things may occur... Generally, the <code>#ifdef</code> statement are ordered in two levels: First, a specific processor platform is selected, the the operating systems are sorted out in such a section.</p>
<p>If you port AS to a new platform, you have to find two symbols typical for this platform and extend <code>sysdefs.h</code> accordingly. Once again, I&#39;m interested in the result...</p>
<h2 id="system-independent-files">System-Independent Files</h2>
<p>...represent the largest part of all modules. Describing all functions in detail is beyond the scope of this description (those who want to know more probably start studying the sources, my programming style isn&#39;t that horrible either...), which is why I can only give a short list at this place with all modules their function:</p>
<h3 id="modules-used-by-as">Modules Used by AS</h3>
<h4 id="asc">as.c</h4>
<p>This file is AS&#39;s root: it contains the <em>main()</em> function of AS, the processing of all command line options, the overall control of all passes and parts of the macro processor.</p>
<h4 id="asmallgc">asmallg.c</h4>
<p>This module processes all statements defined for all processor targets, e.g. <code>EQU</code> and <code>ORG</code>. The <code>CPU</code> pseudo-op used to switch among different processor targets is also located here.</p>
<h4 id="asmcodec">asmcode.c</h4>
<p>This module contains the bookkeeping needed for the code output file. It exports an interface that allows to open and close a code file and offers functions to write code to (or take it back from) the file. An important job of this module is to buffer the write process, which speeds up execution by writing the code in larger blocks.</p>
<h4 id="asmdebugc">asmdebug.c</h4>
<p>AS can optionally generate debug information for other tools like simulators or debuggers, allowing a backward reference to the source code. They get collected in this module and can be output after assembly in one of several formats.</p>
<h4 id="asmdefc">asmdef.c</h4>
<p>This modules only contains declarations of constants used in different places and global variables.</p>
<h4 id="asmfnumsc">asmfnums.c</h4>
<p>AS assigns internally assigns incrementing numbers for each used source file. These numbers are used for quick referencing. Assignment of numbers and the conversion between names and numbers takes place here.</p>
<h4 id="asmifc">asmif.c</h4>
<p>Here ara ll routines located controlling conditional assembly. The most important exported variable is a flag called <code>IfAsm</code> which controls whether code generation is currently turned on or off.</p>
<h4 id="asminclistc">asminclist.c</h4>
<p>This module holds the definition of the list structure that allows AS to print the nesting of include files to the assembly list file.</p>
<h4 id="asmitreec">asmitree.c</h4>
<p>When searching for the mnemonic used in a line of code, a simple linear comparison with all available machine instructions (as it is still done in most code generators, for reasons of simplicity and laziness) is not necessary the most effective method. This module defines two improved structures (binary tree and hash table) which provide a more efficient search and are destined to replace the simple linear search on a step-by-step basis...priorities as needed...</p>
<h4 id="asmmacc">asmmac.c</h4>
<p>Routines to store and execute macro constructs are located in this module. The real macro processor is (as already mentioned) in <code>as.c</code>.</p>
<h4 id="asmparsc">asmpars.c</h4>
<p>Here we really go into the innards: This module stores the symbol tables (global and local) in two binary trees. Further more, there is a quite large procedure <code>EvalExpression</code> which analyzes and evaluates a (formula) expression. The procedure returns the result (integer, floating point, or string) in a variant record. However, to evaluate expressions during code generation, one should better use the functions <code>EvalIntExpression</code>, <code>EvalFloatExpression</code>, and <code>EvalStringExpression</code>. Modifications for the sake of adding new target processors are unnecessary in this modules and should be done with extreme care, since you are touching something like &#39;AS&#39;s roots&#39;.</p>
<h4 id="asmsubc">asmsub.c</h4>
<p>This module collects a couple of commonly used subroutines which primarily deal with error handling and &#39;advanced&#39; string processing.</p>
<h4 id="bpemuc">bpemu.c</h4>
<p>As already mentioned at the beginning, AS originally was a program written in Borland Pascal. For some intrinsic functions of the compiler, it was simpler to emulate those than to touch all places in the source code where they are used. Well...</p>
<h4 id="chunksc">chunks.c</h4>
<p>This module defines a data type to deal with a list of address ranges. This functionality is needed by AS for allocation lists; furthermore, P2BIN and P2HEX use such lists to warn about overlaps.</p>
<h4 id="cmdargc">cmdarg.c</h4>
<p>This module implements the overall mechanism of command line arguments. It needs a specification of allowed arguments, splits the command line and triggers the appropriate callbacks. In detail, the mechanism includes the following:</p>
<ul>
<li>Processing of arguments located in an environment variable or a corresponding file;</li>
<li>Return of a set describing which command line arguments have not been processed;</li>
<li>A backdoor for situations when an overlaying IDE converts the passed command line completely into upper or lower case.</li>
</ul>
<h4 id="codepseudoc">codepseudo.c</h4>
<p>You will find at this place pseudo instructions that are used by a subset of code generators. On the one hand, this is the Intel group of <code>DB..DT</code>, and on the other hand their counterparts for 8/16 bit CPUs from Motorola or Rockwell. Someone who wants to extend AS by a processor fitting into one of these groups can get the biggest part of the necessary pseudo instructions with one call to this module.</p>
<h4 id="codevarsc">codevars.c</h4>
<p>For reasons of memory efficiency, some variables commonly used by diverse code generators.</p>
<h4 id="as_endianc">as_endian.c</h4>
<p>Yet another bit of machine dependence, however one you do not have to spend attention on: This module automatically checks at startup whether a host machine is little or big endian. Furthermore, checks are made if the type definitions made for integer variables in <code>sysdefs.h</code> really result in the correct lengths.</p>
<h4 id="headidsc">headids.c</h4>
<p>At this place, all processor families supported by AS are collected with their header IDs (see <a href="#code-files">Code Files</a>) and the output format to be used by default by P2HEX. The target of this table is to centralize the addition of a new processor as most as possible, i.e. in contrast to earlier versions of AS, no further modifications of tool sources are necessary.</p>
<h4 id="ioerrsc">ioerrs.c</h4>
<p>The conversion from error numbers to clear text messages is located here. I hope I&#39;ll never hit a system that does not define the numbers as macros, because I would have to rewrite this module completely...</p>
<h4 id="nlmessagesc">nlmessages.c</h4>
<p>The C version of AS reads all messages from files at runtime after the language to be used is clear. The format of message files is not a simple one, but instead a special compact and pre-indexed format that is generated at runtime by a program called &#39;rescomp&#39; (we will talk about it later). This module is the counterpart to rescomp that reads the correct language part into a character field and offers functions to access the messages.</p>
<h4 id="nlsc">nls.c</h4>
<p>This module checks which country-dependent settings (date and time format, country code) are present at runtime. Unfortunately, this is a highly operating system-dependent task, and currently, there are only three methods defines: The MS-DOS method, the OS/2 method and the typical Unix method via <em>locale</em> functions. For all other systems, there is unfortunately currently only <code>NO_NLS</code> available...</p>
<h4 id="stdhandlc">stdhandl.c</h4>
<p>On the one hand, here is a special open function located knowing the special strings <code>!0...!2</code> as file names and creating duplicates of the standard file handles <em>stdin, stdout,</em> and <em>stderr</em>. On the other hand, investigations are done whether the standard output has been redirected to a device or a file. On no-Unix systems, this unfortunately also incorporates some special operations.</p>
<h4 id="stringlistsc">stringlists.c</h4>
<p>This is just a little &#39;hack&#39; that defines routines to deal with linear lists of strings, which are needed e.g. in the macro processor of AS.</p>
<h4 id="strutilc">strutil.c</h4>
<p>Some commonly needed string operations have found their home here.</p>
<h4 id="versionc">version.c</h4>
<p>The currently valid version is centrally stored here for AS and all other tools.</p>
<h4 id="codec">code????.c</h4>
<p>These modules form the main part of AS: each module contains the code generator for a specific processor family.</p>
<h3 id="additional-modules-for-the-tools">Additional Modules for the Tools</h3>
<h4 id="hexc">hex.c</h4>
<p>A small module to convert integer numbers to hexadecimal strings. It&#39;s not absolutely needed in C any more (except for the conversion of <em>long long</em> variables, which unfortunately not all <code>printf()</code>&#39;s support), but it somehow survived the porting from Pascal to C.</p>
<h4 id="p2binc">p2bin.c</h4>
<p>The sources of P2BIN.</p>
<h4 id="p2hexc">p2hex.c</h4>
<p>The sources of P2HEX.</p>
<h4 id="pbindc">pbind.c</h4>
<p>The sources of BIND.</p>
<h4 id="plistc">plist.c</h4>
<p>The sources of PLIST.</p>
<h4 id="toolutilsc">toolutils.c</h4>
<p>All subroutines needed by several tools are collected here, e.g. for reading of code files.</p>
<h2 id="modules-needed-during-the-build-of-as">Modules Needed During the Build of AS</h2>
<h4 id="rescompc">rescomp.c</h4>
<p>This is AS&#39;s &#39;resource compiler&#39;, i.e. the tool that converts a readable file with string resources into a fast, indexed format.</p>
<h4 id="test_driverc">test_driver.c</h4>
<p>This is used by <em>ctest</em> to run tests.</p>
<h2 id="generation-of-message-files">Generation of Message Files</h2>
<p>As already mentioned, the C source tree of AS uses a dynamic load principle for all (error) messages. In contrast to the Pascal sources where all messages were bundled in an include file and compiled into the programs, this method eliminates the need to provide AS in multiple language variants; there is only one version which checks for the language to be used upon runtime and loads the corresponding component from the message files. Just to remind: Under DOS and OS/2, the <code>COUNTRY</code> setting is queried, while under Unix, the environment variables <code>LC_MESSAGES, LC_ALL,</code> and <code>LANG</code> are checked.</p>
<h3 id="format-of-the-source-files">Format of the Source Files</h3>
<p>A source file for the message compiler <em>rescomp</em> usually has the suffix
<code>.res</code>. The message compiler generates one or two files from a source:</p>
<ul>
<li>a binary file which is read at runtime by AS resp. its tools</li>
<li>optionally one further C header file assigning an index number to all messages. These index numbers in combination with an index table in the binary file allow a fast access to to individual messages at runtime.</li>
</ul>
<p>The source file for the message compiler is a pure ASCII file and can therefore be modified with any editor. It consists of a sequence of control commands with parameters. Empty lines and lines beginning with a semicolon are ignored. Inclusion of other files is possible via the <code>Include</code> statement:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">Include</span> <span class="op">&lt;</span>Datei<span class="op">&gt;</span></span></code></pre></div>
<p>The first two statements in every source file must be two statements describing the languages defined in the following. The more important one is <code>Langs</code>, e.g.:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>    Langs DE<span class="op">(</span><span class="dv">049</span><span class="op">)</span> EN<span class="op">(</span><span class="dv">001</span><span class="op">,</span><span class="dv">061</span><span class="op">)</span></span></code></pre></div>
<p>describes that two languages will be defined in the rest of the file. The first one shall be used under Unix when the language has been set to <code>DE</code> via environment variable. Similarly, It shall be used under DOS and OS/2 when the country code was set to 049. Similarly, the second set shall be used for the settings <code>DE</code> resp. 061 or 001. While multiple &#39;telephone numbers&#39; may point to a single language, the assignment to a Unix language code is a one-to-one correspondence. This is no problem in practice since the <code>LANG</code> variables Unix uses describe subversions via appendices, e.g.:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>    de<span class="op">.</span>de</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>    de<span class="op">.</span>ch</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>    en<span class="op">.</span>us</span></code></pre></div>
<p>AS only compares the beginning of the strings and therefore still comes to the right decision. The <code>Default</code> statement defines the language that shall be used if either no language has been set at all or a language is used that is not mentioned in the argument list of <code>Langs</code>. This is typically the english language:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>    Default EN</span></code></pre></div>
<p>These definitions are followed by an arbitrary number of <code>Message</code> statements, i.e. definitions of messages:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>    Message ErrName</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>     &quot;: Fehler <span class="st">&quot;</span></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>     &quot;: error <span class="st">&quot;</span></span></code></pre></div>
<p>In case <em>n</em> languages were announced via the <code>Langs</code> statement, the message compiler takes <strong>exactly</strong> the following <em>n</em> as the strings to be stored. It is therefore impossible to leave out certain languages for individual messages, and an empty line following the strings should in no way be misunderstood as an end marker for the list; inserted lines between statements only serve purposes of better readability. It is however allowed to split individual messages across multiple lines in the source file; all lines except for the last one have to be ended with a backslash as continuation character:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>    Message TestMessage2</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>     &quot;Dies ist eine<span class="st">&quot; </span><span class="op">\</span></span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a><span class="st">     &quot;</span>zweizeilige Nachricht<span class="st">&quot;</span></span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a>     &quot;This is a<span class="st">&quot; </span><span class="op">\</span></span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a><span class="st">     &quot;</span>two<span class="op">-</span>line message<span class="st">&quot;</span></span></code></pre></div>
<p>As already mentioned, source files are pure ASCII files; national special characters may be placed in message texts (and the compiler will correctly pass them to the resulting file), a big disadvantage however is that such a file is not fully portable any more: in case it is ported to another system using a different coding for national special characters, the user will probably be confronted with funny characters at runtime...special characters should therefore always be written via special sequences borrowed from HTML resp. SGML (see the following table). Linefeeds can be inserted into a line via <code>\n</code>, similar to C.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Sequence...</th>
<th style="text-align: left;">results in...</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>&amp;auml; &amp;ouml; &amp;uuml;</code></td>
<td style="text-align: left;">ä ö ü (Umlauts)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&amp;Auml; &amp;Ouml; &amp;Uuml;</code></td>
<td style="text-align: left;">Ä Ö Ü</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&amp;szlig;</code></td>
<td style="text-align: left;">ß (sharp s)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&amp;agrave; &amp;egrave; &amp;igrave; &amp;ograve;</code></td>
<td style="text-align: left;">á é í ó</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&amp;ugrave;</code></td>
<td style="text-align: left;">ú</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&amp;Agrave; &amp;Egrave; &amp;Igrave; &amp;Ograve;</code></td>
<td style="text-align: left;">Á É Í Ó</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&amp;Ugrave;</code></td>
<td style="text-align: left;">Ú (Grave accent)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&amp;aacute; &amp;eacute; &amp;iacute; &amp;oacute;</code></td>
<td style="text-align: left;">à è ì ò</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&amp;uacute;</code></td>
<td style="text-align: left;">ù</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&amp;Aacute; &amp;Eacute; &amp;Iacute; &amp;Oacute;</code></td>
<td style="text-align: left;">À È Ì Ò</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&amp;Uacute;</code></td>
<td style="text-align: left;">Ù (Acute accent)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&amp;acirc; &amp;ecirc; &amp;icirc; &amp;ocirc;</code></td>
<td style="text-align: left;">â ê î ô</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&amp;ucirc;</code></td>
<td style="text-align: left;">û</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&amp;Acirc; &amp;Ecirc; &amp;Icirc; &amp;Ocirc;</code></td>
<td style="text-align: left;">Â Ê Î Ô</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&amp;Ucirc;</code></td>
<td style="text-align: left;">Û (Circumflex accent)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&amp;ccedil; &amp;Ccedil;</code></td>
<td style="text-align: left;">ç Ç (Cedilla)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&amp;ntilde; &amp;Ntilde;</code></td>
<td style="text-align: left;">ñ Ñ</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&amp;aring; &amp;Aring;</code></td>
<td style="text-align: left;">åÅ</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&amp;aelig; &amp;Aelig;</code></td>
<td style="text-align: left;">æÆ</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&amp;iquest; &amp;iexcl;</code></td>
<td style="text-align: left;">¿ ¡ (inverted ! or ?)</td>
</tr>
</tbody>
</table>
<h2 id="creation-of-documentation">Creation of Documentation</h2>
<p>A source distribution of AS contains this documentation in Markdown format.</p>
<h2 id="test-suite">Test Suite</h2>
<p>Since AS deals with binary data of a precisely defined structure, it is naturally sensitive for system and compiler dependencies. To reach at least a minimum amount of secureness that everything went right during compilation, a set of test sources is provided in the subdirectory <code>tests</code> that allows to test the freshly built assembler. These programs are primarily trimmed to find faults in the translation of the machine instruction set, which are commonplace when integer lengths vary. Target-independent features like the macro processors or conditional assembly are only casually tested, since I assume that they work everywhere when they work for me...</p>
<p>The test run is started via a simple <code>ctest --build-run-dir build --test-dir build -j</code>. Each test program is assembled, converted to a binary file, and compared to a reference image. A test is considered to be passed if and only if the reference image and the newly generated one are identical on a bit-by-bit basis. At the end of the test, the assembly time for every test is printed (those who want may extend the file BENCHES with these results), accompanied with a success or failure message. Track down every error that occurs, even if it occurs in a processor target you are never going to use! It is always possible that this points to an error that may also come up for other targets, but by coincidence not in the test cases.</p>
<h2 id="adding-a-new-target-processor">Adding a New Target Processor</h2>
<p>The probably most common reason to modify the source code of AS is to add a new target processor. Apart from adding the new module to the Makefile, there are few places in other modules that need a modification. The new module will do the rest by registering itself in the list of code generators. I will describe the needed steps in a cookbook style in the following sections:</p>
<h4 id="choosing-the-processors-name">Choosing the Processor&#39;s Name</h4>
<p>The name chosen for the new processor has to fulfill two criteria:</p>
<ol type="1">
<li>The name must not be already in use by another processor. If one starts AS without any parameters, a list of the names already in use will be printed.</li>
<li>If the name shall appear completely in the symbol <code>MOMCPU</code>, it may not contain other letters than A..F (except right at the beginning). The variable <code>MOMCPUNAME</code> however will always report the full name during assembly. Special characters are generally disallowed, lowercase letters will be converted by the <code>CPU</code> command to uppercase letters and are therefore senseless in the processor name.</li>
</ol>
<p>The first step for registration is making an entry for the new processor (family) in the file <code>headids.c</code>. As already mentioned, this file is also used by the tools and specifies the code ID assigned to a processor family, along with the default hex file format to be used. I would like to have some coordination before choosing the ID...</p>
<h4 id="definition-of-the-code-generator-module">Definition of the Code Generator Module</h4>
<p>The unit&#39;s name that shall be responsible for the new processor should bear at least some similarity to the processor&#39;s name (just for the sake of uniformity) and should be named in the style of <code>code....</code>. The head with include statements is best taken from another existing code generator.</p>
<p>Except for an initialization function that has to be called at the beginning of the <code>main()</code> function in module <code>as.c</code>, the new module neither has to export variables nor functions as the complete communication is done at runtime via indirect calls. They are simply done by a call to the function <code>AddCPU</code> for each processor type that shall be treated by this unit:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>        CPUxxxx<span class="op">:=</span>AddCPU<span class="op">(</span><span class="ch">&#39;X</span><span class="er">XXX</span><span class="ch">&#39;</span><span class="op">,</span>SwitchTo_xxxx<span class="op">);</span></span></code></pre></div>
<p><code>&#39;XXXX&#39;</code> is the name chosen for the processor which later must be used in assembler programs to switch AS to this target processor. <code>SwitchTo_xxxx</code> (abbreviated as the &quot;switcher&quot; in the following) is a procedure without parameters that is called by AS when the switch to the new processor actually takes place. <code>AddCPU</code> delivers an integer value as result that serves as an internal &quot;handle&quot; for the new processor. The global variable <code>MomCPU</code> always contains the handle of the target processor that is currently set. The value returned by <code>AddCPU</code> should be stored in a private variable of type <code>CPUVar</code> (called <code>CPUxxxx</code> in the example above). In case a code generator module implements more than one processor (e.g. several processors of a family), the module can find out which instruction subset is currently allowed by comparing <code>MomCPU</code> against the stored handles.</p>
<p>The switcher&#39;s task is to &quot;reorganize&quot; AS for the new target processor. This is done by changing the values of several global variables:</p>
<ul>
<li><code>ValidSegs</code>: Not all processors have all address spaces defined by AS. This set defines which subset the <code>SEGMENT</code> instruction will enable for the currently active target processor. At least the <code>CODE</code> segment has to be enabled. The complete set of allowed segments can be looked up the file <code>fileformat.h</code> (<code>Seg....</code> constants).</li>
<li><code>SegInits</code>: This array stores the initial program counter values for the individual segments (i.e. the values the program counters will initially take when there is no <code>ORG</code> statement). There are only a few exceptions (like logically separated address spaces that physically overlap) which justify other initial values than 0.</li>
<li><code>Grans</code>: This array specifies the size of the smallest addressable element in bytes for each segment, i.e. the size of an element that increases an address by 1. Most processors need a value of 1, even if they are 16- or 32-bit processors, but the PICs and signal processors are cases where higher values are required.</li>
<li><code>ListGrans</code>: This array specifies the size of byte groups that shall be shown in the assembly listing. For example, instruction words of the 68000 are always 2 bytes long though the code segment&#39;s granularity is 1. The <code>ListGran</code> entry therefore has to be set to 2.</li>
<li><code>SegLimits</code>: This array stores the highest possible address for each segment, e.g. 65535 for a 16-bit address space. This array need not be filled in case the code generator takes over the <code>ChkPC</code> method.</li>
<li><code>ConstMode</code>: This variable may take the values <code>ConstModeIntel</code>, <code>ConstModeMoto</code>, or <code>ConstModeC</code> and rules which syntax has to be used to specify the base of integer constants.</li>
<li><code>PCSymbol</code>: This variable contains the string an assembler program may use to to get the current value of the program counter. Intel processors for example usually use a dollar sign.</li>
<li><code>TurnWords</code>: If the target processor uses big-endian addressing and one of the fields in <code>ListGran</code> is larger than one, set this flag to true to get the correct byte order in the code output file.</li>
<li><code>SetIsOccupied</code>: Some processors have a <code>SET</code> machine instruction. If this callback is set to a non-NULL value, the code generator may report back whether <code>SET</code> shall not be interpreted as pseudo instruction. The return value may be constant <code>True</code> or or e.g. depend on the number of argument if a differentiation is possible.</li>
<li><code>HeaderID</code>: This variable contains the ID that is used to mark the current processor family in the the code output file (see the description of the code format described by AS). I urge to contact me before selecting the value to avoid ambiguities. Values outside the range of <span class="math inline">01..</span>7f should be avoided as they are reserved for special purposes (like a future extension to allow linkable code). Even though this value is still hard-coded in most code generators, the preferred method is now to fetch this value from <code>headids.h</code> via <code>FindFamilyByName</code>.</li>
<li><code>NOPCode</code>: There are some situations where AS has to fill unused code areas with NOP statements. This variable contains the machine code of the NOP statement.</li>
<li><code>DivideChars</code>: This string contains the characters that are valid separation characters for instruction parameters. Only extreme exotics like the DSP56 require something else than a single comma in this string.</li>
<li><code>HasAttrs</code>: Some processors like the 68k series additionally split an instruction into mnemonic and attribute. If the new processor also does something like that, set this flag to true and AS will deliver the instructions&#39; components readily split in the string variables <code>OpPart</code> and <code>AttrPart</code>. If this flag is however set to false, no splitting will take place and the instruction will be delivered as a single piece in <code>OpPart</code>. <code>AttrPart</code> will stay empty in this case. One really should set this flag to false if the target processor does not have attributes as one otherwise looses the opportunity to use macros with a name containing dots (e.g. to emulate other assemblers).</li>
<li><code>AttrChars</code>: In case <code>HasAttrs</code> is true, this string has to contain all characters that can separate mnemonic and attribute. In most cases, this string only contains a single dot.</li>
</ul>
<p>Do not assume that any of these variables has a predefined value; set them <strong>all</strong>!!</p>
<p>Apart from these variables, some function pointers have to be set that form the link form AS to the &quot;active&quot; parts of the code generator:</p>
<ul>
<li><code>MakeCode</code>: This routine is called after a source line has been split into mnemonic and parameters. The mnemonic is stored into the variable <code>OpPart</code>, and the parameters can be looked up in the array <code>ArgStr</code>. The number of arguments may be read from <code>ArgCnt</code>. The binary code has to be stored into the array <code>BAsmCode</code>, its length into <code>CodeLen</code>. In case the processor is word oriented like the 68000 (i.e. the <code>ListGran</code> element corresponding to the currently active segment is 2), the field may be addressed word-wise via <code>WAsmCode</code>. There is also <code>DAsmCode</code> for extreme cases... The code length has to be given in units corresponding to the current segment&#39;s granularity.</li>
<li><code>SwitchFrom</code>: This parameter-less procedure enables the code generator module to do &quot;cleanups&quot; when AS switches to another target processor. This hook allows e.g. to free memory that has been allocated in the generator and that is not needed as long as the generator is not active. It may point to an empty procedure in the simplest case. One example for the usage of this hook is the module <code>CODE370</code> that builds its instruction tables dynamically and frees them again after usage.</li>
<li><code>IsDef</code>: Some processors know additional instructions that impose a special meaning on a label in the first row like <code>EQU</code> does. One example is the <code>BIT</code> instruction found in an 8051 environment. This function has to return TRUE if such a special instruction is present. In the simplest case (no such instructions), the routine may return a constant FALSE.</li>
</ul>
<p>Optionally, the code generator may additionally set the following function pointers:</p>
<ul>
<li><code>ChkPC</code> : Though AS internally treats all program counters as either 32 or 64 bits, most processors use an address space that is much smaller. This function informs AS whether the current program counter has exceeded its allowed range. This routine may of course be much more complicated in case the target processor has more than one address space. One example is in module <code>code16c8x.c</code>. In case everything is fine, the function has to return TRUE, otherwise FALSE. The code generator only has to implement this function if it did not set up the array <code>SegLimits</code>. This may e.g. become necessary when the allowed range of addresses in a segment is non-continuous.</li>
<li><code>InternSymbol</code> : Some processors, e.g. such with a register bank in their internal RAM, predefine such &#39;registers&#39; as symbols, and it wouldn&#39;t make much sense to define them in a separate include file with 256 or maybe more <code>EQU</code>s. This hook allows access to the code generator of AS: It obtains an expression as an ASCII string and sets up the passed structure of type <em>TempResult</em> accordingly when one of these &#39;built-in&#39; symbols is detected. The element <code>Typ</code> has to be set to <code>TempNone</code> in case the check failed. Errors messages from this routine should be avoided as unidentified names could signify ordinary symbols (the parser will check this afterwards). Be extreme careful with this routine as it allows you to intervene into the parser&#39;s heart!</li>
<li><code>DissectBit</code> : In case the target platform supports bit objects, i.e. objects that pack both a register or memory address and a bit position into one integer number, this is the callback to dissect such a packed representation and transform it back into a source-code like, human-readable form. This provides better readability of the listing.</li>
<li><code>DissectReg</code> : In case the target platform supports register symbols, this is the callback that translates register number and size back to a source-code like, human-readable form. Again, this function is used for the listing.</li>
<li><code>QualifyQuote</code> : This optional callback allows to define on a per-platform base situations when a single quotation character does <em>not</em> lead in a character string. An example for this is the Z80&#39;s alternate register bank, which is written as <code>AF&#39;</code>, or the hexadecimal constant syntax <code>H&#39;...</code> used on some Hitachi processors.</li>
</ul>
<p>By the way: People who want to become immortal may add a copyright string. This is done by adding a call to the procedure <code>AddCopyright</code> in the module&#39;s initialization part (right next to the <code>AddCPU</code> calls):</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>       AddCopyright<span class="op">(</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;Intel 80986 code generator (C) 2010 Jim Bonehead&quot;</span><span class="op">);</span></span></code></pre></div>
<p>The string passed to <code>AddCopyright</code> will be printed upon program start in addition to the standard message.</p>
<p>If needed, the unit may also use its initialization part to hook into a list of procedures that are called prior to each pass of assembly. Such a need for example arises when the module&#39;s code generation depends on certain flags that can be modified via pseudo instructions. An example is a processor that can operate in either user or supervisor mode. In user mode, some instructions are disabled. The flag that tells AS whether the following code executes in user or supervisor mode might be set via a special pseudo instruction. But there must also be an initialization that assures that all passes start with the same state. The hook offered via <code>AddInitPassProc</code> offers a chance to do such initializations. The callback function passed to it is called before a new pass is started.</p>
<p>The function chain built up via calls to <code>AddCleanUpProc</code> operates similar to <code>AddInitPassProc</code>: It enables code generators to do clean-ups after assembly (e.g. freeing of literal tables). This makes sense when multiple files are assembled with a single call of AS. Otherwise, one would risk to have &#39;junk&#39; in tables from the previous run. No module currently uses this feature.</p>
<h4 id="writing-the-code-generator-itself">Writing the Code Generator itself</h4>
<p>Now we finally reached the point where your creativity is challenged: It is up to you how you manage to translate mnemonic and parameters into a sequence of machine code. The symbol tables are of course accessible (via the formula parser) just like everything exported from <code>ASMSUB</code>. Some general rules (take them as advises and not as laws...):</p>
<ul>
<li>Try to split the instruction set into groups of instructions that have the same operand syntax and that differ only in a few bits of their machine code. For example, one can do all instructions without parameters in a single table this way.</li>
<li>Most processors have a fixed spectrum of addressing modes. Place the parsing of an address expression in a separate routine so you an reuse the code.</li>
<li>The subroutine <code>WrError</code> defines a lot of possible error codes and can be easily extended. Use this! It is no good to simply issue a &quot;syntax error&quot; on all error conditions!</li>
</ul>
<p>Studying other existing code generators should also prove to be helpful.</p>
<h4 id="modifications-of-tools">Modifications of Tools</h4>
<p>A microscopic change to the tolls&#39; sources is still necessary, namely to the routine <code>Granularity()</code> in <code>toolutils.c</code>: in case one of the processor&#39;s address spaces has a granularity different to 1, the switch statement in this place has to be adapted accordingly, otherwise PLIST, P2BIN, and P2HEX start counting wrong...</p>
<h2 id="localization-to-a-new-language">Localization to a New Language</h2>
<p>You are interested in this topic? Wonderful! This is an issue that is often neglected by other programmers, especially when they come from the country on the other side of the big lake...</p>
<p>The localization to a new language can be split into two parts: the adaption of program messages and the translation of the manual. The latter one is definitely a work of gigantic size, however, the adaption of program messages should be a work doable on two or three weekends, given that one knows both the new and one of the already present messages. Unfortunately, this translation cannot be done on a step-by-step basis because the resource compiler currently cannot deal with a variable amount of languages for different messages, so the slogan is &#39;all or nothing&#39;.</p>
<p>The first operation is to add the new language to <code>header.res</code>. The two-letter-abbreviation used for this language is best fetched from the nearest Unix system (in case you don&#39;t work on one anyway...), the international telephone prefix from a DOS manual.</p>
<p>When this is complete, one can rebuild all necessary parts with a simple <code>cmake --build build -j</code> and obtains an assembler that supports one more language. Do not forget to forward the results to me. This way, all users will benefit from this with the next release :-)</p>
<!-- markdownlint-enable MD036 -->

<!-- markdownlint-enable MD030 -->

<!-- markdownlint-enable MD025 -->

<!-- markdownlint-enable MD001 -->

<h1 id="bibliography">Bibliography</h1>
<!-- markdownlint-disable MD053 -->

<!-- markdownlint-enable MD053 -->

<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>Steve Williams: <em>68030 Assembly Language Reference.</em> Addison-Wesley, Reading, Massachusetts, 1989<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Toshiba Corp.: <em>16-Bit Microcontroller TLCS-900 Series Users Manual.</em> 1992<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Hitachi Semiconductor and IC Div.: <em>H8/500 Series Programming Manual.</em> (21-20, 1st Edition Feb. 1989)<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Mitsubishi Electric: <em>M16 Family Software Manual.</em> First Edition, Sept. 1994<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Mitsubishi Electric: <em>M16C Software Manual.</em> First Edition, Rev. C, 1996<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>size depends on target processor<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>only on variants supporting the <code>MOVX</code> instruction<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>size depends on target processor<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>only on variants supporting the <code>MOVX</code> instruction<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>Initial value 80h. As the 8051 does not have any RAM beyond 80h, this value has to be adapted with ORG for the 8051 as target processor!<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>Initial value 80h. As the 8051 does not have any RAM beyond 80h, this value has to be adapted with ORG for the 8051 as target processor!<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>initial value 400h.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>size depends on target processor<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>size depends on target processor<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>size and availability depend on target processor<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>As the Z180 still can address only 64K logically, the whole address space can only be reached via <code>PHASE</code> instructions!<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>size depends on target processor<a href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18"><p>size depends on target processor<a href="#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn19"><p>initial value 800h resp. 0C00h<a href="#fnref19" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn20"><p>area for program code is limited to 1 MByte<a href="#fnref20" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn21"><p>device dependant<a href="#fnref21" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn22"><p>device dependant<a href="#fnref22" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn23"><p>device dependant<a href="#fnref23" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn24"><p>device dependant<a href="#fnref24" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn25"><p>device dependant<a href="#fnref25" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn26"><p>device dependant<a href="#fnref26" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn27"><p>device dependant<a href="#fnref27" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn28"><p>device dependant<a href="#fnref28" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn29"><p>device dependant<a href="#fnref29" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn30"><p>Motorola Inc.: <em>PowerPC(tm) MPC505 RISC Microcontroller Technical Summary.</em> 1994<a href="#fnref30" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn31"><p>Hirotsugu Kakugawa: <em>A memo on the secret features of 6309.</em> (available via World Wide Web: <a href="http://www.cs.umd.edu/users/fms/comp/CPUs/6309.txt">http://www.cs.umd.edu/users/fms/comp/CPUs/6309.txt</a>)<a href="#fnref31" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn32"><p>Motorola Inc.: <em>PowerPC 601 RISC Microprocessor User&#39;s Manual.</em> 1993<a href="#fnref32" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn33"><p>Motorola Inc.: <em>DSP56000/DSP56001 Digital Signal Processor User&#39;s Manual.</em> Rev. 2, 1990<a href="#fnref33" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn34"><p>Mitsubishi Electric: <em>Single-Chip 16-Bit Microcomputers.</em> Enlarged edition, 1991<a href="#fnref34" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn35"><p>Toshiba Corp.: <em>16-Bit Microcontroller TLCS-900 Series Users Manual.</em> 1992<a href="#fnref35" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn36"><p>Toshiba Corp.: <em>TLCS-9000/16 Instruction Set Manual Version 2.2.</em> 1. Feb 1994<a href="#fnref36" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn37"><p>Toshiba Corp.: <em>TLCS-9000/16 Instruction Set Manual Version 2.2.</em> 1. Feb 1994<a href="#fnref37" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn38"><p>SGS-Thomson Microelectronics: <em>ST7 Family Programming Manual.</em> June 1995<a href="#fnref38" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn39"><p>Texas Instruments: <em>TMS 1000 Series MOS/LSI One-Chip Microcomputers Programmer&#39;s Reference Manual.</em> CM122-1 1275, 1975<a href="#fnref39" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn40"><p>NEC Corp.: _μCOM-75x Family 4-bit CMOS Microcomputer User&#39;s Manual._ Vol. I+II (no year of release given)<a href="#fnref40" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn41"><p>Atmel Corp.: <em>8-Bit AVR Assembler and Simulator Object File Formats (Preliminary).</em> (part of the AVR tools documentation)<a href="#fnref41" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn42"><p>Atmel Corp.: <em>8-Bit AVR Assembler and Simulator Object File Formats (Preliminary).</em> (part of the AVR tools documentation)<a href="#fnref42" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn43"><p>Digital Research: <em>CP/M 68K Operating System User&#39;s Guide.</em> 1983<a href="#fnref43" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
